```mermaid
graph TD;
  5GMM-NULL["5GMM-NULL (INITIAL)"];
  5GMM-REGISTERED["5GMM-REGISTERED (FINAL)"];
  UE["UE (User Equipment)"];
  AMF["AMF (Access and Mobility Management Function)"];
  UE -->|The UE communicates with the AMF over the N1 reference point for control plane signaling.| AMF;
  5GMM-IDLE["5GMM-IDLE (INTERMEDIATE)"];
  5GMM-CONNECTED["5GMM-CONNECTED (INTERMEDIATE)"];
  SMF["SMF (Session Management Function)"];
  UPF["UPF (User Plane Function)"];
  PCF["PCF (Policy Control Function)"];
  NRF["NRF (Network Repository Function)"];
  AUSF["AUSF (Authentication Server Function)"];
  SEAF["SEAF (Security Anchor Function)"];
  5GMM-NULL -->|UE sends REGISTRATION REQUEST and completes security mode control procedure| 5GMM-REGISTERED;
  AMF -->|AMF initiates security mode control procedure with UE| UE;
  AMF -->|AMF receives authentication information from AUSF| AUSF;
  AUSF -->|AUSF provides KSEAF and optionally the SUPI to the SEAF| SEAF;
  SEAF -->|SEAF provides ngKSI and the KAMF to the AMF| AMF;
  5GMM-DEREGISTERED["5GMM-DEREGISTERED (FINAL)"];
  5GMM-DEREGISTERED.PLMN-SEARCH["5GMM-DEREGISTERED.PLMN-SEARCH (FINAL)"];
  5GMM-DEREGISTERED.NO-SUPI["5GMM-DEREGISTERED.NO-SUPI (FINAL)"];
  5GMM-DEREGISTERED.LIMITED-SERVICE["5GMM-DEREGISTERED.LIMITED-SERVICE (FINAL)"];
  5GMM-NULL -->|UE sends REGISTRATION REQUEST message| 5GMM-CONNECTED;
  5GMM-CONNECTED -->|AMF sends REGISTRATION ACCEPT message| 5GMM-REGISTERED;
  5GMM-CONNECTED -->|AMF sends REGISTRATION REJECT message| 5GMM-DEREGISTERED;
  5GMM-CONNECTED -->|AMF sends REGISTRATION REJECT message| 5GMM-DEREGISTERED.PLMN-SEARCH;
  5GMM-CONNECTED -->|AMF sends REGISTRATION REJECT message| 5GMM-DEREGISTERED.NO-SUPI;
  5GMM-CONNECTED -->|AMF sends REGISTRATION REJECT message| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  AMF -->|AMF informs the SMF to release PDU sessions.| SMF;
  AMF -->|AMF may interact with NRF to discover SMF instances.| NRF;
  AMF -->|AMF may interact with PCF to obtain policy rules.| PCF;
  SMF -->|SMF controls UPF for user plane traffic forwarding.| UPF;
  5GMM-NULL -->|AMF rejects REGISTRATION REQUEST.| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  5GMM-NULL -->|AMF rejects REGISTRATION REQUEST.| 5GMM-DEREGISTERED.PLMN-SEARCH;
  5GMM-REGISTERED.PLMN-SEARCH["5GMM-REGISTERED.PLMN-SEARCH (INTERMEDIATE)"];
  5GMM-REGISTERED.NO-CELL-AVAILABLE["5GMM-REGISTERED.NO-CELL-AVAILABLE (INTERMEDIATE)"];
  5GMM-REGISTERED.NON-ALLOWED-SERVICE["5GMM-REGISTERED.NON-ALLOWED-SERVICE (INTERMEDIATE)"];
  5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE["5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE (INTERMEDIATE)"];
  5GMM-SERVICE-REQUEST-INITIATED["5GMM-SERVICE-REQUEST-INITIATED (INTERMEDIATE)"];
  5GMM-DEREGISTERED -->|Initial registration procedure completed| 5GMM-REGISTERED;
  5GMM-REGISTERED.NORMAL-SERVICE["5GMM-REGISTERED.NORMAL-SERVICE (INTERMEDIATE)"];
  5GMM-REGISTERED.ATTEMPTING-_REGISTRATION-UPDATE["5GMM-REGISTERED.ATTEMPTING- REGISTRATION-UPDATE (INTERMEDIATE)"];
  5GMM-REGISTERED.NORMAL-SERVICE -->|Network accepts MICO mode, no T3324 value received, UE in 5GMM-IDLE mode over 3GPP access| 5GMM-REGISTERED.NO-CELL-AVAILABLE;
  5GMM-REGISTERED.NON-ALLOWED-SERVICE -->|Network accepts MICO mode, no T3324 value received, UE in 5GMM-IDLE mode over 3GPP access| 5GMM-REGISTERED.NO-CELL-AVAILABLE;
  Any -->|Registration request is not for onboarding services in SNPN, for 3GPP access| 5GMM-DEREGISTERED.PLMN-SEARCH;
  Any -->|Registration request is not for onboarding services in SNPN, for non-3GPP access| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION["5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION (INTERMEDIATE)"];
  Unspecified -->|REGISTRATION REJECT with cause #22 (Congestion)| 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION;
  Unspecified -->|REGISTRATION REJECT with cause #73 (Serving network not authorized) via 3GPP access| 5GMM-DEREGISTERED.PLMN-SEARCH;
  Unspecified -->|REGISTRATION REJECT with cause #73 (Serving network not authorized) via non-3GPP access| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  Unspecified -->|Lower layer failure before REGISTRATION COMPLETE| 5GMM-REGISTERED;
  Unknown -->|Reception of SERVICE ACCEPT message (except for case h in subclause 5.6.1.1)| 5GMM-REGISTERED;
  5GMM-REGISTERED-INITIATED["5GMM-REGISTERED-INITIATED (INTERMEDIATE)"];
  5GMM-DEREGISTERED -->|UE sends REGISTRATION REQUEST message to AMF| 5GMM-REGISTERED-INITIATED;
  5GMM-REGISTERED -->|UE sends REGISTRATION REQUEST message to AMF| 5GMM-REGISTERED-INITIATED;
  5GMM-DEREGISTERED -->|REGISTRATION REJECT received| 5GMM-DEREGISTERED.PLMN-SEARCH;
  5GMM-DEREGISTERED -->|REGISTRATION REJECT received| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  AAA_server_of_the_CH_or_the_DCS["AAA server of the CH or the DCS (AAA Server)"];
  5G-RG["5G-RG (5G Residential Gateway)"];
  UE -->|UE interacts with AAA server for authentication purposes.| AAA_server_of_the_CH_or_the_DCS;
  5G-RG -->|5G-RG sends AUTHENTICATION RESPONSE to AMF. AMF sends EAP messages to 5G-RG.| AMF;
  5U3_ROAMING_NOT_ALLOWED["5U3 ROAMING NOT ALLOWED (INTERMEDIATE)"];
  UDM["UDM (Unified Data Management)"];
  W-AGF["W-AGF (Wireline Access Gateway Function)"];
  AUN3_device["AUN3 device (Authentication and Authorization for non-3GPP access)"];
  ANY -->|Receipt of AUTHENTICATION REJECT message| 5GMM-DEREGISTERED;
  ANY -->|Receipt of REGISTRATION REJECT message| 5GMM-DEREGISTERED.PLMN-SEARCH;
  ANY -->|Receipt of REGISTRATION REJECT message| 5GMM-DEREGISTERED.NO-SUPI;
  ANY -->|Receipt of REGISTRATION REJECT message| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  AMF -->|AMF retrieves subscription data from UDM.| UDM;
  SMF -->|SMF receives policy rules from PCF.| PCF;
  Unknown -->|Receiving AUTHENTICATION REJECT message| 5GMM-DEREGISTERED.PLMN-SEARCH;
  5GMM-DEREGISTERED.NO-CELL-AVAILABLE["5GMM-DEREGISTERED.NO-CELL-AVAILABLE (FINAL)"];
  Unknown -->|Reception of 5GMM cause #31 (Redirection to EPC required) via 3GPP access in single-registration mode.| 5GMM-DEREGISTERED.NO-CELL-AVAILABLE;
  Unknown -->|Registration request is not for onboarding services in SNPN, for non-3GPP access| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  5GMM-REGISTERED -->|UE sends REGISTRATION REQUEST for mobility and periodic registration update and receives REGISTRATION ACCEPT| 5GMM-REGISTERED;
  5GMM-REGISTERED -->|UE is registering for onboarding services in SNPN| 5GMM-DEREGISTERED.PLMN-SEARCH;
  5GMM-REGISTERED -->|UE receives a message indicating N1 mode not allowed| 5GMM-DEREGISTERED.LIMITED-SERVICE;
  5GMM-CONNECTED -->|UE changes radio capability for NG-RAN or E-UTRAN| 5GMM-IDLE;
  5GMM-IDLE -->|UE sends REGISTRATION REQUEST and receives SERVICE ACCEPT| 5GMM-REGISTERED;
  5GMM-REGISTERED.LIMITED-SERVICE["5GMM-REGISTERED.LIMITED-SERVICE (INTERMEDIATE)"];
  5GMM-NULL -->|Initial registration request rejected.| 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION;
  5GMM-REGISTERED -->|REGISTRATION ACCEPT received via a non-CAG cell.| 5GMM-REGISTERED.LIMITED-SERVICE;
  5GMM-REGISTERED -->|REGISTRATION ACCEPT received via a non-CAG cell.| 5GMM-REGISTERED.PLMN-SEARCH;
  N3IWF["N3IWF (Non-3GPP Interworking Function)"];
  TNGF["TNGF (Trusted Non-3GPP Gateway Function)"];
  AMF -->|AMF interacts with UPF for user plane setup during registration.| UPF;
  5GMM-REGISTERED -->|REGISTRATION REJECT with cause #79 (UAS services not allowed)| 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION;
  5GMM-REGISTERED -->|REGISTRATION REJECT with cause #77 (Wireline access area not allowed)| 5GMM-DEREGISTERED;
  5GMM-NULL -->|REGISTRATION REQUEST message with 5GS registration type IE set to 'initial registration' or 'emergency registration' received before a SERVICE REJECT message has been sent or the service request procedure has been completed| 5GMM-NULL;
  5GMM-DEREGISTERED-INITIATED["5GMM-DEREGISTERED-INITIATED (INTERMEDIATE)"];
  Unknown -->|AMF triggers SMF to release PDU session(s)| 5GMM-DEREGISTERED-INITIATED;
  SMF -->|SMF sends PDU SESSION ESTABLISHMENT REJECT message to the UE in response to PDU SESSION ESTABLISHMENT REQUEST message and indicates unsuccessful establishment of a PDU session.| UE;
  UE -->|The UE interacts with the SMF for PDU session management, including inter-system change procedures.| SMF;
  Network["Network (Network Element)"];
  N/A -->|UE sends PDU SESSION ESTABLISHMENT REQUEST to SMF| N/A;
  5GMM-COMMON-PROCEDURE-INITIATED["5GMM-COMMON-PROCEDURE-INITIATED (INTERMEDIATE)"];
  5GMM-REGISTERED -->|Transmission of AUTHENTICATION REQUEST message| 5GMM-COMMON-PROCEDURE-INITIATED;
  ATTEMPTING-REGISTRATION["ATTEMPTING-REGISTRATION (INTERMEDIATE)"];
  5GMM-NULL -->|UE attempts initial registration| ATTEMPTING-REGISTRATION;
  ATTEMPTING-REGISTRATION -->|Successful registration procedure| 5GMM-REGISTERED;
  ATTEMPTING-REGISTRATION -->|Registration failure| 5GMM-NULL;
  5GMM-REGISTERED -->|Transition to connected mode| 5GMM-CONNECTED;
```
