sequenceDiagram
    Note over All: Initial Registration Initiation (UE)
    participant UE
    participant AMF
    participant Network
    UE->>AMF: Send REGISTRATION REQUEST (5GS registration type IE, UE status IE, ATTACH REQUEST (in EPS NAS message container IE), 5G-GUTI (in Additional GUTI IE and/or 5GS mobile identity IE), SUCI (in 5GS mobile identity IE), PEI (in 5GS mobile identity IE), 5GS update type IE, MICO indication IE, T3324 IE, Requested T3512 IE, Requested DRX parameters IE, Requested NB-N1 mode DRX parameters IE, Requested extended DRX parameters IE, LADN indication IE, Requested NSSAI IE, Network slicing indication IE, 5GMM capability IE, S1 UE network capability IE, Payload container type IE, UE STATE INDICATION message, Additional information requested IE, Requested WUS assistance information IE, Requested PEIPS assistance information IE, N5GC indication IE, AUN3 indication IE, Service-level-AA container IE, Last visited registered TAI)
    participant UE
    participant AMF
    participant Network
    UE->>UE: Start timer T3510 (T3510)
    participant UE
    participant AMF
    participant Network
    UE->>UE: Stop timer T3502 (if running) (T3502)
    participant UE
    participant AMF
    participant Network
    UE->>UE: Stop timer T3511 (if running) (T3511)
    participant UE
    participant AMF
    participant Network
    UE->>UE: Start timer T3519 (if SUCI included and T3519 not running) (T3519, SUCI)
    Note over All: 5GMM Common Procedure Initiation (Network)
    participant UE
    participant AMF
    participant Network
    AMF->>Network: Initiate 5GMM common procedures ()
    participant UE
    participant AMF
    participant Network
    Network->>Network: Skip authentication (if configured and emergency registration) ()
    Note over All: Initial Registration Accepted (Network)
    participant UE
    participant AMF
    participant Network
    AMF->>UE: Send REGISTRATION ACCEPT (TAI list, Service area list IE, List of equivalent PLMNs, List of equivalent SNPNs, 5G-GUTI, LADN information IE, Extended LADN information IE, CAG information list IE, Extended CAG information list IE, Negotiated WUS assistance information IE, Negotiated PEIPS assistance information IE, 5GS network feature support IE, T3324 IE, T3512 value IE, Non-3GPP de-registration timer value IE, T3447 value IE, T3448 value IE, Truncated 5G-S-TMSI configuration IE, Service-level-AA container IE, List of PLMNs to be used in disaster condition IE, Disaster roaming wait range IE, Disaster return wait range IE, Forbidden TAI(s) for the list of "5GS forbidden tracking areas for roaming" IE, Forbidden TAI(s) for the list of "5GS forbidden tracking areas for regional provision of service" IE, RAN timing synchronization IE, Feature authorization indication IE, 5GS registration result IE, Allowed NSSAI IE, Mapped S-NSSAI(s), Rejected NSSAI IE, Extended rejected NSSAI IE, Partially rejected NSSAI IE, Partially allowed NSSAI IE, Pending NSSAI IE, NSSRG information IE, Alternative NSSAI IE, S-NSSAI time validity information IE, S-NSSAI location validity information IE, On-demand NSSAI IE, NSAG information IE, UE radio capability ID IE, UE radio capability ID deletion indication IE, MICO indication IE, Unavailability configuration IE, Discontinuous coverage maximum time offset IE, RAT utilization control IE, SOR transparent container IE, NSSAI inclusion mode IE, Operator-defined access category definitions IE, Extended emergency number list IE, Ciphering key data IE, Negotiated DRX parameters IE, Negotiated NB-N1 mode DRX parameters IE, Negotiated extended DRX parameters IE)
    participant UE
    participant AMF
    participant Network
    AMF->>AMF: Store information elements from REGISTRATION REQUEST (5GMM capability, S1 UE network capability, UE security capability)
    participant UE
    participant AMF
    participant Network
    AMF->>AMF: Start timer T3550 (T3550)
    participant UE
    participant AMF
    participant Network
    AMF->>AMF: Initiate UUAA-MM procedure (if conditions met) ()
    Note over All: Initial Registration Not Accepted (Network)
    participant UE
    participant AMF
    participant Network
    AMF->>UE: Send REGISTRATION REJECT (5GMM cause value, T3346 value IE, Rejected NSSAI IE, Extended rejected NSSAI IE, RAT utilization control IE, CAG information list IE, Extended CAG information list IE, N3IWF identifier IE, TNAN information IE, Forbidden TAI(s) for the list of "5GS forbidden tracking areas for roaming" IE, Forbidden TAI(s) for the list of "5GS forbidden tracking areas for regional provision of service" IE)
    Note over All: UE Actions on REGISTRATION ACCEPT (UE)
    participant UE
    participant AMF
    participant Network
    UE->>UE: Reset registration attempt counter ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Enter state 5GMM-REGISTERED ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Set 5GS update status to 5U1 UPDATED ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Reset PLMN/SNPN-specific counters ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store TAI list ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store list of equivalent PLMNs/SNPNs ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store LADN information ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store extended LADN information ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Update CAG information list ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store 5G-GUTI ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store PEIPS assistance information ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store UE radio capability ID ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store NSSAI information ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store NSAG information ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store alternative NSSAI ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store S-NSSAI time/location validity information ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Store on-demand NSSAI ()
    participant UE
    participant AMF
    participant Network
    UE->>AMF: Send REGISTRATION COMPLETE (if needed) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Set timer T3512 (if T3512 value IE received) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Set timer T3324 (if T3324 value IE received) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Set non-3GPP de-registration timer (if non-3GPP de-registration timer value IE received) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle MPS/MCS indicator ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle Restriction on use of enhanced coverage ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle Discontinuous coverage maximum time offset ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle Unavailability configuration ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle MBSR authorization ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle RAT utilization control ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle SOR transparent container ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle Operator-defined access category definitions ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle T3447 value ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle T3448 value ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle Truncated 5G-S-TMSI configuration ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle service-level-AA response ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle List of PLMNs to be used in disaster condition IE ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle Disaster roaming/return wait range IE ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle RAN timing synchronization IE ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle NSSAI inclusion mode ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle network slice replacement ()
    Note over All: UE Actions on REGISTRATION REJECT (UE)
    participant UE
    participant AMF
    participant Network
    UE->>UE: Abort initial registration procedure ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Set 5GS update status ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Reset registration attempt counter ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Enter state (5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION, 5GMM-DEREGISTERED.PLMN-SEARCH, 5GMM-DEREGISTERED.LIMITED-SERVICE, or 5GMM-DEREGISTERED.NO-SUPI) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Delete 5G-GUTI, last visited registered TAI, TAI list, ngKSI ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Update forbidden lists ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Start timer T3346 (if applicable) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Start timer T3245 (if applicable) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Disable N1 mode capability (if applicable) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle EMM parameters (if applicable) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Inform upper layers of failure ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle rejected NSSAI ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle RAT utilization control ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle CAG information list ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle Satellite NG-RAN disabling ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Perform PLMN/SNPN selection ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Start timer T3526 (if applicable) ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle SOR transparent container ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle access for localized services in SNPN ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Handle network slice replacement ()
    Note over All: Network Actions on REGISTRATION COMPLETE (Network)
    participant UE
    participant AMF
    participant Network
    AMF->>AMF: Stop timer T3550 ()
    participant UE
    participant AMF
    participant Network
    UE->>UE: Enter state 5GMM-REGISTERED ()
    participant UE
    participant AMF
    participant Network
    AMF->>AMF: Consider parameters valid ()
