{
  "chunks": [
    "ETSI TS 124 501 V18.9.0 (2025-01) 5G; Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3 () TECHNICAL SPECIFICATION Reference RTS/TSGC-0124501vi90 Keywords 5G In case of any existing or perceived difference in 26 Scope References Definitions and abbreviations to N1 mode in 5GMM-CONNECTED mode UEs not operating in SNPN access operation mode over 3GPP access 4.5.2A Determination of the access identities and access category associated with a request for access for UEs operating in SNPN access operation mode over 3GPP access indication tracking areas tracking areas 4.8.4A Core Network selection and redirection for UEs using CIoT optimizations 4.8.4A.1 Core network selection 4.8.4A.2 Redirection of the UE by the core network Elementary procedures for 5GS mobility management 5.3.12A Handling of local emergency numbers received via 3GPP access and non-3GPP access 5.3.12A.1 General 5.3.12A.2 Receiving a REGISTRATION ACCEPT message via non-3GPP access indication 5.3.19A Specific requirements for UE configured to use timer T3245 5.3.19A.1 UE not operating in SNPN access operation mode 5.3.19A.2 UE operating in SNPN access operation mode 5.4.1.2.3A Procedures related to EAP methods other than EAP-AKA' and EAP-TLS 5.4.1.2.3B Procedures related to EAP methods used for primary authentication of an N5GC device 5.4.1.2.3C Procedures related to EAP methods used for primary authentication of an AUN3 device 5.5.1.2.6A Initial registration for initiating an emergency PDU session not accepted by the network accepted by the network 5.5.1.3.6A Mobility and periodic registration update for an emergency services fallback not accepted by the network and non-3GPP access to-UE relay 5.6.1.6A Service request procedure for an emergency services fallback not accepted by the network Elementary procedures for 5GS session management 6.1.4a Coordination between 5GSM and SM 6.2.4.2a IPv6 prefix delegation via DHCPv6 6.2.5.1.2A Void 6.3.1A Service-level authentication and authorization procedure 6.3.1A.1 General 6.3.1A.2 Service-level authentication and authorization procedure initiation 6.3.1A.3 Service-level authentication and authorization procedure accepted by the UE 6.3.1A.4 Abnormal cases on the network side 6.3.1A.5 Abnormal cases in the UE 6.4.1.5A Handling the maximum number of allowed active user-plane resources for PDU sessions of UEs in NB-N1 mode Handling of unknown, unforeseen, and erroneous protocol data Scope The present document specifies the non-access stratum (NAS) procedures in the 5G system (5GS) used by the protocols for: - mobility management between the user equipment (UE) and the access and mobility management function (AMF) for both 3GPP access and non-3GPP access; and - session management between the user equipment (UE) and the session management function (SMF) for both 3GPP access and non-3GPP access.",
    "The 5GS mobility management (5GMM) protocol defined in the present document provides procedures for the control of mobility when the user equipment (UE) is using the NG radio access network (NG-RAN), non-3GPP access network, or both. The 5GMM protocol also provides control of security for the NAS protocols. The 5GS session management (5GSM) protocol defined in the present document provides procedures for the handling of 5GS PDU sessions. Together with the bearer control provided by the access stratum, this protocol is used for the control of user-plane resources. For both NAS protocols the present document specifies procedures for the support of inter-system mobility between the NG-RAN and the evolved universal terrestrial radio access (E-UTRAN), between the NG-RAN and the non-3GPP access network connected to the EPC, and between the non-3GPP access network connected to the 5G core network (5GCN) and the E-UTRAN.",
    "For both NAS protocols the present document specifies procedures for the support of mobility between the NG-RAN and the non-3GPP access network connected to the 5GCN. In addition, the present document specifies the procedures in the 5GS for UE policy delivery service between the UE and the policy control function (PCF) for both 3GPP access and non-3GPP access. The present document is applicable to the UE, the access and mobility management function (AMF), the session management function (SMF), and the PCF in the 5GS. The clauses and subclauses in the present document are common for both 3GPP access and non-3GPP access unless it is explicitly stated that they apply to 3GPP access only or non-3GPP access only. References The following documents contain provisions which, through reference in this text, constitute provisions of the present document. - References are either specific (identified by date of publication, edition number, version number, etc.) or non-specific.",
    "- For a specific reference, subsequent revisions do not apply. - For a non-specific reference, the latest version applies. In the case of a reference to a 3GPP document (including a GSM document), a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document. [1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\". [1A] 3GPP TS 22.011: \"Service accessibility\". [2] 3GPP TS 22.101: \"Service aspects; Service principles\". [3] 3GPP TS 22.261: \"Service requirements for the 5G system; Stage 1\". [4] 3GPP TS 23.003: \"Numbering, addressing and identification\". [4A] 3GPP TS 23.040: \"Technical realization of Short Message Service (SMS)\". [4B] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\". [5] 3GPP TS 23.122: \"Non-Access-Stratum functions related to Mobile Station (MS) in idle mode\". [6] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".",
    "[6A] 3GPP TS 23.216: \"Single Radio Voice Call Continuity (SRVCC); Stage 2\". [6AB] 3GPP TS 23.256: \"Support of Uncrewed Aerial Systems (UAS) connectivity, identification and tracking; Stage 2\". [6B] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\". [6C] 3GPP TS 23.287: \"Architecture enhancements for 5G System (5GS) to support Vehicle-to- Everything (V2X) services\". [6D] 3GPP TS 23.316: \"Wireless and wireline convergence access support for the 5G System (5GS)\". [6E] 3GPP TS 23.304: \"Proximity based Services (ProSe) in the 5G System (5GS)\". [7] 3GPP TS 23.401: \"GPRS enhancements for E-UTRAN access\". [8] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\". [9] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\". [10] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System; Stage 2\". [10A] 3GPP TS 23.548: \"5G System Enhancements for Edge Computing; Stage 2\". [11] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General aspects\".",
    "[12] 3GPP TS 24.008: \"Mobile Radio Interface Layer 3 specification; Core Network Protocols; Stage 3\". [13] 3GPP TS 24.011: \"Point-to-Point Short Message Service (SMS) support on mobile radio interface\". [13A] 3GPP TS 24.080: \"Mobile radio interface layer 3 Supplementary services specification; Formats and coding\". [13B] 3GPP TS 24.193: \"Access Traffic Steering, Switching and Splitting; Stage 3\". [13C] 3GPP TS 24.173: \"IMS Multimedia telephony communication service and supplementary services; Stage 3\". [13D] 3GPP TS 24.174: \"Support of multi-device and multi-identity in the IP Multimedia Subsystem (IMS); Stage 3\". [14] 3GPP TS 24.229: \"IP multimedia call control protocol based on Session Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\". [14AA] 3GPP TS 24.237: \"IP Multimedia (IM) Core Network (CN) subsystem IP Multimedia Subsystem (IMS) service continuity; Stage 3\". [14A] 3GPP TS 24.250: \"Protocol for Reliable Data Service; Stage 3\".",
    "[15] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet System (EPS); Stage 3\". [16] 3GPP TS 24.302: \"Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access networks; Stage 3\" [17] 3GPP TS 24.368: \"Non-Access Stratum (NAS) configuration Management Object (MO)\". [18] 3GPP TS 24.502: \"Access to the 3GPP 5G System (5GS) via non-3GPP access networks; Stage 3\". [19] 3GPP TS 24.526: \"UE policies for 5G System (5GS); Stage 3\". [19BA] 3GPP TS 24.539: \"5G System (5GS); Network to TSN translator (TT) protocol aspects; Stage 3\". [19A] 3GPP TS 24.535: \"Device-Side Time-Sensitive Networking (TSN) Translator (DS-TT) to Network-Side TSN Translator (NW-TT) protocol aspects; Stage 3\". [19B] 3GPP TS 24.587: \"Vehicle-to-Everything (V2X) services in 5G System (5GS); Protocol aspects; Stage 3\" [19C] 3GPP TS 24.588: \"Vehicle-to-Everything (V2X) services in 5G System (5GS); User Equipment (UE) policies; Stage 3\" [19D] Void.",
    "[19E] 3GPP TS 24.554: \"Proximity-service (ProSe) in 5G System (5GS) protocol aspects; Stage 3\". [19F] 3GPP TS 24.555: \"Proximity-services (ProSe) in 5G System (5GS); User Equipment (UE) policies; Stage 3\". [20] 3GPP TS 24.623: \"Extensive Markup Language (XML) Configuration Access Protocol (XCAP) over the Ut interface for Manipulating Supplementary Services\". [20AA] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based Architecture; Stage 3\". [20A] 3GPP TS 29.502: \"5G System; Session Management Services; Stage 3\". [20AB] 3GPP TS 29.503: \"5G System; Unified Data Management Services; Stage 3\". [20B] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services; Stage 3\". [21] 3GPP TS 29.525: \"5G System; UE Policy Control Service; Stage 3\". [21A] 3GPP TS 29.526: \"5G System; Network Slice-Specific Authentication and Authorization (NSSAA) services; Stage 3\".",
    "[21B] 3GPP TS 29.256: \"5G System; Uncrewed Aerial Systems Network Function (UAS-NF); Aerial Management Services; Stage 3. [22] 3GPP TS 31.102: \"Characteristics of the Universal Subscriber Identity Module (USIM) application\". [22A] 3GPP TS 31.111: \"USIM Application Toolkit (USAT)\". [22B] 3GPP TS 31.115: \"Secured packet structure for (Universal) Subscriber Identity Module (U)SIM Toolkit applications\". [23] 3GPP TS 33.102: \"3G security; Security architecture\". [23A] 3GPP TS 33.401: \"3GPP System Architecture Evolution; Security architecture\". [24] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\". [24A] 3GPP TS 33.535: \"Authentication and Key Management for Applications (AKMA) based on 3GPP credentials in the 5G System (5GS)\". [24B] 3GPP TS 33.256: \"Security aspects of Uncrewed Aerial Systems (UAS)\". [25] 3GPP TS 36.323: \"NR; Packet Data Convergence Protocol (PDCP) specification\".",
    "[25A] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Radio Resource Control (RRC) protocol specification\". [25B] 3GPP TS 36.300: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Overall description\". [25C] 3GPP TS 36.304: \"Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) procedures in idle mode\". [25D] 3GPP TS 36.306: \"Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE) radio access capabilities\". [25E] 3GPP TS 36.321: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Medium Access Control (MAC) protocol specification\". [26] 3GPP TS 37.355: \"LTE Positioning Protocol (LPP)\". [26A] 3GPP TS 38.355: \"Sidelink Positioning Protocol (SLPP); Protocol specification\". [27] 3GPP TS 38.300: \"NR; NR and NG-RAN Overall Description; Stage 2\". [28] 3GPP TS 38.304: \"New Generation Radio Access Network; User Equipment (UE) procedures in Idle mode\".",
    "[28A] 3GPP TS 38.306: \"New Generation Radio Access Network; User Equipment (UE) radio access capabilities\". [29] 3GPP TS 38.323: \"Evolved Universal Terrestrial Radio Access (E-UTRA); Packet Data Convergence Protocol (PDCP) specification\". [30] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC); Protocol Specification\". [31] 3GPP TS 38.413: \"NG Radio Access Network (NG-RAN); NG Application Protocol (NGAP)\". [31A] IEEE Std 802.3™-2022: \"Ethernet\". [31AA] 3GPP TS 38.509: \"Special conformance testing functions for User Equipment (UE)\". [32] IETF RFC 768: \"User Datagram Protocol\". [33] IETF RFC 793: \"Transmission Control Protocol.\" [33A] IETF RFC 3095: \"RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP and uncompressed\". [33B] Void. [33C] Void. [33D] IETF RFC 8415: \"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)\". [33E] IETF RFC 2131: \"Dynamic Host Configuration Protocol\". [33F] IETF RFC 2132: \"DHCP Options and BOOTP Vendor Extensions\".",
    "[34] IETF RFC 3748: \"Extensible Authentication Protocol (EAP)\". [34A] IETF RFC 3843: \"RObust Header Compression (ROHC): A Compression Profile for IP\". [35] Void. [35A] IETF RFC 4122: \"A Universally Unique IDentifier (UUID) URN Namespace\". [36] IETF RFC 4191: \"Default Router Preferences and More-Specific Routes\". [36A] IETF RFC 5905: \"Network Time Protocol Version 4: Protocol and Algorithms Specification\". [37] IETF RFC 7542: \"The Network Access Identifier\". [38] IETF RFC 4303: \"IP Encapsulating Security Payload (ESP)\". [38A] IETF RFC 4815: \"RObust Header Compression (ROHC): Corrections and Clarifications to RFC 3095\". [38B] IETF RFC 4861: \"Neighbor Discovery for IP version 6 (IPv6)\". [39] IETF RFC 4862: \"IPv6 Stateless Address Autoconfiguration\". [39A] IETF RFC 5225: \"RObust Header Compression (ROHC) Version 2: Profiles for RTP, UDP, IP, ESP and UDP Lite\". [39B] IETF RFC 5795: \"The RObust Header Compression (ROHC) Framework\".",
    "[40] IETF RFC 5448: \"Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')\". [40A] IETF RFC 6603: \"Prefix Exclude Option for DHCPv6-based Prefix Delegation\". [40B] IETF RFC 6846: \"RObust Header Compression (ROHC): A Profile for TCP/IP (ROHC-TCP)\". [41] IETF RFC 7296: \"Internet Key Exchange Protocol Version 2 (IKEv2)\". [42] ITU-T Recommendation E.212: \"The international identification plan for public networks and subscriptions\", 2016-09-23. [43] IEEE Std 802-2014: \"IEEE Standard for Local and Metropolitan Area Networks: Overview and Architecture\" (30 June 2014). [43A] Void [43B] IEEE Std 1588™-2019: \"IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems\". [43C] Void. [43D] Void. [43E] Void. [44] Void. [45] Void. [46] Void. [47] Void. [48] IEEE: \"Guidelines for Use of Extended Unique Identifier (EUI), Organizationally Unique Identifier (OUI), and Company ID (CID)\".",
    "[49] BBF TR-069: \"CPE WAN Management Protocol\". [50] BBF TR-369: \"User Services Platform (USP)\". [51] 3GPP TS 37.340: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and NR; Multi- connectivity; Stage 2\". [52] IETF RFC 8106:\"IPv6 Router Advertisement Options for DNS Configuration\". [53] 3GPP TS 23.247: \"Architectural enhancements for 5G multicast-broadcast services; Stage 2\". [54] 3GPP TS 23.380: \"IMS Restoration Procedures\". [55] IETF RFC 3948: \"UDP Encapsulation of IPsec ESP Packets\". [56] 3GPP TS 33.503: \"Security Aspects of Proximity based Services (ProSe) in the 5G System (5GS)\". [57] 3GPP TS 33.246: \"Security of Multimedia Broadcast/Multicast Service (MBMS)\". [58] 3GPP TS 38.321: \"NR; Medium Access Control (MAC); Protocol specification\".",
    "[59] IEEE Std 802.11™-2020: \"Information Technology- Telecommunications and information exchange between systems-Local and metropolitan area networks-Specific requirements-Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications\". [60] 3GPP TS 24.577: \"Aircraft-to-Everything (A2X) services in 5G System (5GS) protocol aspects; Stage 3\". [61] 3GPP TS 24.578: \"Aircraft-to-Everything (A2X) services in 5G System (5GS); UE policies\". [62] 3GPP TS 24.514: \"Ranging based services and sidelink positioning in 5G system (5GS); Stage 3\". [63] 3GPP TS 23.586: \"Architectural Enhancements to support Ranging based services and Sidelink Positioning\". [64] 3GPP TS 24.572: \"User Plane Location Services (LCS) Protocols And Procedures; Stage 3\". [65] 3GPP TS 24.575: \"5G System; Multicast/Broadcast UE pre-configuration Management Object (MO)\". [66] IETF RFC 4291:\" IP Version 6 Addressing Architecture\".",
    "[67] 3GPP TS 38.305: \"Stage 2 functional specification of User Equipment (UE) positioning in NG- RAN\". [68] 3GPP TS 23.271: \"Functional stage 2 description of Location Services (LCS)\". [69] 3GPP TS 26.522: \"5G Real-time Media Transport Protocol Configurations\". [70] IETF RFC 8285: \"A General Mechanism for RTP Header Extensions\". Definitions and abbreviations The non-access stratum (NAS) described in the present document forms the highest stratum of the control plane between the UE and the AMF (reference point \"N1\" see 3GPP TS 23.501 [8]) for both 3GPP and non-3GPP access.",
    "Main functions of the protocols that are part of the NAS are: a) support of mobility of the user equipment (UE) including also common procedures such as authentication, identification, generic UE configuration update and security mode control procedures; b) support of session management procedures to establish and maintain data connectivity between the UE and the data network; and c) NAS transport procedure to provide a transport of SMS, LPP, SLPP, LCS, UPP-CMI container, UE policy container, SOR transparent container and UE parameters update information payload.",
    "Principles for the handing of 5GS security contexts and for the activation of ciphering and integrity protection, when a NAS signalling connection is established, are provided in subclause 4.4. For the support of the above functions, the following procedures are supplied within this specification: a) elementary procedures for 5GS mobility management in clause 5; and b) elementary procedures for 5GS session management in clause 6. Signalling procedures for the control of NAS security are described as part of the 5GMM common procedures in subclause 5.4. Complete NAS transactions consist of specific sequences of elementary procedures. Examples of such specific sequences can be found in 3GPP TS 23.502 [9]. The NAS for 5GS follows the protocol architecture model for layer 3 as described in 3GPP TS 24.007 [11].",
    "The UE's usage setting defined in 3GPP TS 24.301 [15] applies to voice capable UEs in 5GS and indicates whether the UE has preference for voice services over data services or vice-versa, where: a) voice services include IMS voice; and b) data services include any kind of user data transfer without a voice media component. The UE's usage setting can be set to: a) \"voice centric\"; or b) \"data centric\". If the UE is capable of S1 mode, there is a single UE's usage setting at the UE which applies to both 5GS and EPS.",
    "If the UE operates in single-registration mode, whenever the IMS voice availability is determined or changes, the UE shall execute procedures according to table 4.3.4.1: Table 4.3.4.1: Change of IMS voice availability for a UE in single-registration mode Change of IMS voice available condition Procedure to execute \"IMS voice not available\" over 3GPP access only and the UE's usage setting is \"voice centric\" Disable the N1 mode capability for 3GPP access, if the UE is only registered over 3GPP access (see subclause 4.9.2). (NOTE 2) \"IMS voice not available\" over non-3GPP access only and the UE's usage setting is \"voice centric\" Disable the N1 mode capability for non-3GPP access (see subclause 4.9.3), if the UE is only registered over non-3GPP access.",
    "(NOTE 2) \"IMS voice not available\" over both 3GPP access and non-3GPP access, and the UE's usage setting is \"voice centric\" Disable the N1 mode capability for 3GPP access (see subclause 4.9.2) and non-3GPP access (see subclause 4.9.3), if the UE is registered over both 3GPP access and non-3GPP access. Disable the N1 mode capability for 3GPP access (see subclause 4.9.2), if the UE is only registered over 3GPP access Disable the N1 mode capability for non-3GPP access (see subclause 4.9.3), if the UE is only registered over non-3GPP access. (NOTE 1, NOTE 2) NOTE 1: If the UE is registered over 3GPP access and has a persistent PDU session, then the UE waits until the radio bearer associated with the persistent PDU session has been released.",
    "NOTE 2: If the UE determines \"IMS voice not available\" upon receipt of a 5GS session management reject message including a back-off timer value, and the re-attempt indicator indicates that the UE is not allowed to re-attempt the procedure in S1 mode then, upon inter-system change from N1 mode to S1 mode, the UE proceeds as specified in 3GPP TS 24.301 [15], subclause 4.3.2.4, Change or determination of IMS registration status. The security parameters for authentication, integrity protection and ciphering are tied together in a 5G NAS security context and identified by a key set identifier (ngKSI). The relationship between the security parameters is defined in 3GPP TS 33.501 [24]. Before security can be activated, the AMF and the UE need to establish a 5G NAS security context. Usually, the 5G NAS security context is created as the result of a primary authentication and key agreement procedure between the AMF and the UE.",
    "A new 5G NAS security context may also be created during an N1 mode to N1 mode handover. Alternatively, during inter-system change from S1 mode to N1 mode, the AMF not supporting interworking without N26 and the UE operating in single-registration mode may derive a mapped 5G NAS security context from an EPS security context that has been established while the UE was in S1 mode. The 5G NAS security context is taken into use by the UE and the AMF, when the AMF initiates a security mode control procedure, during an N1 mode to N1 mode handover, or during the inter-system change procedure from S1 mode to N1 mode. The 5G NAS security context which has been taken into use by the network most recently is called current 5G NAS security context. This current 5G NAS security context can be of type native or mapped, i.e. originating from a native 5G NAS security context or mapped 5G NAS security context.",
    "The key set identifier ngKSI is assigned by the AMF either during the primary authentication and key agreement procedure or, for the mapped 5G NAS security context, during the inter-system change. The ngKSI consists of a value and a type of security context parameter indicating whether a 5G NAS security context is a native 5G NAS security context or a mapped 5G NAS security context. When the 5G NAS security context is a native 5G NAS security context, the ngKSI has the value of KSIAMF, and when the current 5G NAS security context is of type mapped, the ngKSI has the value of KSIASME. The 5G NAS security context which is indicated by an ngKSI can be taken into use to establish the secure exchange of NAS messages when a new N1 NAS signalling connection is established without executing a new primary authentication and key agreement procedure (see subclause 5.4.1) or when the AMF initiates a security mode control procedure.",
    "For this purpose, the initial NAS messages (i.e. REGISTRATION REQUEST, DEREGISTRATION REQUEST, SERVICE REQUEST and CONTROL PLANE SERVICE REQUEST) and the SECURITY MODE COMMAND message contain an ngKSI in the ngKSI IE indicating the current 5G NAS security context used to integrity protect the NAS message. In the present document, when the UE is required to delete an ngKSI, the UE shall set the ngKSI to the value \"no key is available\" and consider also the associated keys KAMF or K'AMF, 5G NAS ciphering key and 5G NAS integrity key invalid (i.e. the 5G NAS security context associated with the ngKSI as no longer valid). In the initial registration procedure, when the key KAUSF, is invalid, the UE shall delete the ngKSI. NOTE: In some specifications the term ciphering key sequence number might be used instead of the term key set identifier (KSI).",
    "As described in subclause 4.8 in order to interwork with E-UTRAN connected to EPC, the UE supporting both S1 mode and N1 mode can operate in either single-registration mode or dual-registration mode. A UE operating in dual- registration mode shall independently maintain and use both EPS security context (see 3GPP TS 24.301 [15]) and 5G NAS security context. When the UE operating in dual-registration mode performs an EPS attach procedure, it shall take into use an EPS security context and follow the handling of this security context as specified in 3GPP TS 24.301 [15]. However, when the UE operating in dual-registration mode performs an initial registration procedure, it shall take into use a 5G NAS security context and follow the handling of this security context as described in the present specification.",
    "The UE and the AMF need to be able to maintain two 5G NAS security contexts simultaneously, i.e. a current 5G NAS security context and a non-current 5G NAS security context, since: a) after a 5G re-authentication, the UE and the AMF can have both a current 5G NAS security context and a non- current 5G NAS security context which has not yet been taken into use (i.e. a partial native 5G NAS security context); and b) after an inter-system change from S1 mode to N1 mode, the UE and the AMF can have both a mapped 5G NAS security context, which is the current 5G NAS security context, and a non-current native 5G NAS security context that was created during a previous access in N1 mode.",
    "The number of 5G NAS security contexts that need to be maintained simultaneously by the UE and the AMF is limited by the following requirements: a) after a successful 5G (re-)authentication, which creates a new partial native 5G NAS security context, the AMF and the UE shall delete the non-current 5G NAS security context, if any; b) when a partial native 5G NAS security context is taken into use through a security mode control procedure, the AMF shall delete the previously current 5G NAS security context. If the UE does not support multiple records of NAS security context storage for multiple registration (see 3GPP TS 31.102 [22]), the UE shall delete the previously current 5G NAS security context.",
    "If the UE supports multiple records of NAS security context storage for multiple registration, the UE shall: 1) replace the previously current 5G NAS security context stored in the first 5G security context of that access (see 3GPP TS 31.102 [22]) with the new 5G security context (taken into use through a security mode control procedure), when the UE activates the new 5G security context for the same PLMN and access; 1a) replace the previously current 5G NAS security context stored in the first 5G security context of that access (see 3GPP TS 31.102 [22]) with the new 5G security context (taken into use through a security mode control procedure), when the UE activates the new 5G security context for a different PLMN over that access but the previously current 5G NAS security context is not associated with the 5G-GUTI of the other access; or 2) store the previously current 5G NAS security context in the second 5G security context of that access (see 3GPP TS 31.102 [22]) and store the new 5G security context (taken into use through a security mode control procedure) in the first 5G security context, when the UE activates the new 5G security context for a different PLMN over that access but the previously current 5G NAS security context is associated with the 5G-GUTI of the other access; c) when the AMF and the UE create a 5G NAS security context using \"null integrity protection algorithm\" and \"null ciphering algorithm\" during an initial registration procedure for emergency services, or a registration procedure for mobility and periodic registration update for a UE that has an emergency PDU session (see subclause 5.4.2.2), the AMF and the UE shall delete the previous current 5G NAS security context.",
    "The UE shall not update the USIM and non-volatile ME memory with the current 5G NAS security context and shall delete the current 5G NAS security context when the UE is deregistered from emergency services (e.g. before registering for normal service); d) when a new mapped 5G NAS security context or 5G NAS security context created using \"null integrity protection algorithm\" and \"null ciphering algorithm\" is taken into use during the inter-system change from S1 mode to N1 mode, the AMF and the UE shall not delete the previously current native 5G NAS security context, if any.",
    "Instead, the previously current native 5G NAS security context shall become a non-current native 5G NAS security context, and the AMF and the UE shall delete any partial native 5G NAS security context; If no previously current native 5G NAS security context exists, the AMF and the UE shall not delete the partial native 5G NAS security context, if any; e) when the AMF and the UE derive a new mapped 5G NAS security context during inter-system change from S1 mode to N1 mode, the AMF and the UE shall delete any existing current mapped 5G NAS security context; f) when a non-current full native 5G NAS security context is taken into use by a security mode control procedure, then the AMF and the UE shall delete the previously current mapped 5G NAS security context; g) when the UE or the AMF moves from 5GMM-REGISTERED to 5GMM-DEREGISTERED state, if the current 5G NAS security context is a mapped 5G NAS security context and a non-current full native 5G NAS security context exists, then the non-current 5G NAS security context shall become the current 5G NAS security context.",
    "Furthermore, the UE and the AMF shall delete any mapped 5G NAS security context or partial native 5G NAS security context. h) when the UE operating in single-registration mode in a network supporting N26 interface performs an inter- system change from N1 mode to S1 mode: 1) if the UE has a mapped 5G NAS security context and the inter-system change is performed in: i) 5GMM-IDLE mode, the UE shall delete the mapped 5G NAS security context after the successful completion of the tracking area update procedure or attach procedure (see 3GPP TS 24.301 [15]); or ii) 5GMM-CONNECTED mode, the UE shall delete the mapped 5G NAS security context after the completion of the inter-system change.",
    "After deletion of the mapped 5G NAS security context, if the UE has a non-current full native 5G NAS security context, then the non-current full native 5G NAS security context shall become the current full native 5G NAS security context; and i) when the UE operating in single-registration mode in a network supporting N26 interface performs an inter- system change from S1 mode to N1 mode in 5GMM-IDLE mode, if the UE has a non-current full native 5G NAS security context, then the UE shall make the non-current full native 5G NAS security context as the current native 5G NAS security context. The UE shall delete the mapped 5G NAS security context, if any.",
    "change from S1 mode to N1 mode in 5GMM-CONNECTED mode In order for the UE operating in single-registration mode in a network supporting N26 interface to derive a mapped 5G NAS security context for an inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the AMF shall construct a mapped 5G NAS security context from the EPS security context received from the source MME as indicated in 3GPP TS 33.501 [24]. The AMF shall select the 5G NAS security algorithms and derive the 5G NAS keys (i.e. KNASenc and KNASint). The AMF shall define an ngKSI for the newly derived K'AMF key such that the value field is taken from the eKSI of the KASME key and the type field is set to indicate a mapped security context and associate this ngKSI with the newly created mapped 5G NAS security context. The AMF shall then include the message authentication code, selected NAS algorithms, NCC and generated ngKSI in the S1 mode to N1 mode NAS transparent container IE (see subclause 9.11.2.9).",
    "When the UE operating in single-registration mode in a network supporting N26 interface receives the command to perform inter-system change to N1 mode in 5GMM-CONNECTED mode, the UE shall derive a mapped K'AMF, as indicated in 3GPP TS 33.501 [24], using the KASME from the EPS security context. Furthermore, the UE shall also derive the 5G NAS keys from the mapped K'AMF using the selected NAS algorithm identifiers included in the S1 mode to N1 mode NAS transparent container IE and associate this mapped 5G NAS security context with the ngKSI value received. The UE shall then verify the received NAS MAC. In case the received NAS MAC is not verified successfully (see subclause 4.4.3.3) the UE shall discard the content of the received S1 mode to N1 mode NAS transparent container IE and inform the lower layers that the received S1 mode to N1 mode NAS transparent container is invalid.",
    "When the UE operating in single-registration mode in a network supporting N26 interface has a PDN connection for emergency bearer services and has no current EPS security context, the AMF shall set 5G-IA0 and 5G-EA0 as the selected 5G NAS security algorithms in the S1 mode to N1 mode NAS transparent container IE. The AMF shall create a locally generated K'AMF. The AMF shall set the ngKSI value of the associated security context to \"000\" and the type of security context flag to \"mapped security context\" in the S1 mode to N1 mode NAS transparent container IE. When the UE operating in single-registration mode in a network supporting N26 interface receives the command to perform inter-system change to N1 mode in 5GMM-CONNECTED mode (see 3GPP TS 38.331 [30]) and has a PDN connection for emergency bearer services, if 5G-IA0 and 5G-EA0 as the selected 5G NAS security algorithms are included in the S1 mode to N1 mode NAS transparent container IE, the UE shall create a locally generated K'AMF.",
    "Furthermore, the UE shall set the ngKSI value of the associated security context to the KSI value received. After the new mapped 5G NAS security context is taken into use for the 3GPP access following a successful inter system change from S1 mode to N1 mode in 5GMM-CONNECTED mode and the UE is registered with the same PLMN over the 3GPP access and non-3GPP access: a) if a native 5G NAS security context is used on the non-3GPP access and: 1) the UE is in 5GMM-IDLE mode over non-3GPP access, then the AMF and the UE shall activate and take into use the new mapped 5G NAS security context on the 3GPP access for the non-3GPP access as described in 3GPP TS 33.501 [24] after the AMF sends or the UE receives the REGISTRATION ACCEPT message respectively. The UE and AMF shall keep the native 5G NAS security context which was used on the non- 3GPP access and make it a non-current native 5G NAS security context.",
    "The non-current native 5G NAS security context may be re-activated later using the security mode control procedure; or 2) the UE is in 5GMM-CONNECTED mode over non-3GPP access, in order to activate the native 5G NAS security context over the 3GPP access that is active on the non-3GPP access the AMF shall send the SECURITY MODE COMMAND message over the 3GPP access as described in 3GPP TS 33.501 [24].",
    "The SECURITY MODE COMMAND message shall include the same ngKSI to identify the native 5G NAS security context that is used on the non-3GPP access; or b) if a mapped 5G NAS security context is used on the non-3GPP access and: 1) the UE is in 5GMM-IDLE mode over non-3GPP access, the AMF and the UE shall activate and take into use the new mapped 5G NAS security context active on the 3GPP access for the non-3GPP access as described in 3GPP TS 33.501 [24] after the AMF sends or the UE receives the REGISTRATION ACCEPT message respectively; or 2) the UE is in 5GMM-CONNECTED mode over non-3GPP access, in order to activate the same mapped 5G NAS security context over one access that is used on the other access the AMF shall send the SECURITY MODE COMMAND message over one-access as described in 3GPP TS 33.501 [24]. The SECURITY MODE COMMAND message shall include the same ngKSI to identify the mapped 5G NAS security context that is used over the other access.",
    "If the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode is not completed successfully, the AMF and the UE operating in single-registration mode in a network supporting N26 interface shall delete the new mapped 5G NAS security context. Secure exchange of NAS messages via a NAS signalling connection is usually established by the AMF during the registration procedure by initiating a security mode control procedure. After successful completion of the security mode control procedure, all NAS messages exchanged between the UE and the AMF are sent integrity protected using the current 5G security algorithms, and except for the messages specified in subclause 4.4.5, all NAS messages exchanged between the UE and the AMF are sent ciphered using the current 5G security algorithms.",
    "During inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, secure exchange of NAS messages is established between the AMF and the UE by: a) the transmission of NAS security related parameters encapsulated in the AS signalling from the AMF to the UE triggering the inter-system change in 5GMM-CONNECTED mode (see 3GPP TS 33.501 [24]). The UE uses these parameters to generate the mapped 5G NAS security context (see subclause 8.6.2 of 3GPP TS 33.501 [24]); and b) after the inter-system change in 5GMM-CONNECTED mode, the transmission of a REGISTRATION REQUEST message from the UE to the AMF. The UE shall send this message integrity protected using the mapped 5G NAS security context and further protect this message as specified in subclause 4.4.6 and subclause 5.5.1.3.2. After the AMF receives the REGISTRATION REQUEST message: 1) if the AMF decides to take the native 5G NAS security context into use, the security mode control procedure is performed.",
    "From this time onward, all NAS messages exchanged between the UE and the AMF are sent integrity protected using the native 5G NAS security context, and except for the messages specified in subclause 4.4.5, all NAS messages exchanged between the UE and the AMF are sent ciphered using the native 5G NAS security context; or 2) if the AMF decides to take the mapped 5G NAS security context into use, from this time onward, all NAS messages exchanged between the UE and the AMF are sent integrity protected using the mapped 5G NAS security context, and except for the messages specified in subclause 4.4.5, all NAS messages exchanged between the UE and the AMF are sent ciphered using the mapped 5G NAS security context.",
    "During inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, if the UE is operating in single- registration mode and: a) if the UE has a valid native 5G NAS security context, the UE shall transmit a REGISTRATION REQUEST message integrity protected with the native 5G NAS security context. The UE shall include the ngKSI indicating the native 5G NAS security context value in the REGISTRATION REQUEST message. After receiving the REGISTRATION REQUEST message including the ngKSI indicating a native 5G NAS security context value, the AMF shall check whether the ngKSI included in the REGISTRATION REQUEST message belongs to a 5G NAS security context available in the AMF, and shall verify the MAC of the REGISTRATION REQUEST message.",
    "If the verification is successful, the AMF deletes the EPS security context received from the source MME if any, and the AMF re-establishes the secure exchange of NAS messages by either: 1) replying with a REGISTRATION ACCEPT message that is integrity protected and ciphered using the native 5G NAS security context. From this time onward, all NAS messages exchanged between the UE and the AMF are sent integrity protected and except for the messages specified in subclause 4.4.5, all NAS messages exchanged between the UE and the AMF are sent ciphered; or 2) initiating a security mode control procedure. This can be used by the AMF to take a non-current 5G NAS security context into use or to modify the current 5G NAS security context by selecting new NAS security algorithms. b) if the UE has no valid native 5G NAS security context, the UE shall send the REGISTRATION REQUEST message without integrity protection and encryption.",
    "After receiving the REGISTRATION REQUEST message without integrity protection and encryption: 1) if N26 interface is supported: i) if an EPS security context received from the source MME does not include the NAS security algorithms set to EIA0 and EEA0, the AMF shall either create a fresh mapped 5G NAS security context (see subclause 8.6.2 of 3GPP TS 33.501 [24]) or trigger a primary authentication and key agreement procedure to create a fresh native 5G NAS security context; or ii) if an EPS security context received from the source MME includes the NAS security algorithms set to EIA0 and EEA0, the AMF shall trigger a primary authentication and key agreement procedure to create a fresh native 5G NAS security context; or 2) if N26 interface is not supported, the AMF shall trigger a primary authentication and key agreement procedure.",
    "The newly created 5G NAS security context is taken into use by initiating a security mode control procedure and this context becomes the current 5G NAS security context in both the UE and the AMF. This re-establishes the secure exchange of NAS messages. During an N1 mode to N1 mode handover, secure exchange of NAS messages is established between the AMF and the UE by: - the transmission of NAS security related parameters encapsulated in the AS signalling from the target AMF to the UE triggering the N1 mode to N1 mode handover (see 3GPP TS 33.501 [24]). The UE uses these parameters to create a new 5G NAS security context. The secure exchange of NAS messages shall be continued after N1 mode to N1 mode handover. It is terminated after inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode or when the NAS signalling connection is released.",
    "When a UE in 5GMM-IDLE mode establishes a new NAS signalling connection and has a valid current 5G NAS security context, the UE shall transmit the initial NAS message integrity protected with the current 5G NAS security context and further protect this message as specified in subclause 4.4.6. The UE shall include the ngKSI indicating the current 5G NAS security context value in the initial NAS message. The AMF shall check whether the ngKSI included in the initial NAS message belongs to a 5G NAS security context available in the AMF, and shall verify the MAC of the NAS message. If the verification is successful, the AMF may re-establish the secure exchange of NAS messages: a) by replying with a NAS message that is integrity protected and ciphered using the current 5G NAS security context.",
    "From this time onward, all NAS messages exchanged between the UE and the AMF are sent integrity protected and except for the messages specified in subclause 4.4.5, all NAS messages exchanged between the UE and the AMF are sent ciphered; or b) by initiating a security mode control procedure. This can be used by the AMF to take a non-current 5G NAS security context into use or to modify the current 5G NAS security context by selecting new NAS security algorithms. When a UE attempts multiple registrations in the same or different serving network, both the AMF and the UE shall follow the behavior specified in subclause 6.3.2 of 3GPP TS 33.501 [24]. The UE may support multiple records of NAS security context storage for multiple registration (see 3GPP TS 31.102 [22]).",
    "If the UE supports multiple records of NAS security context storage for multiple registration, the UE can select the appropriate one among the stored 5G security contexts to protect the initial NAS message (see 3GPP TS 33.501 [24]). NOTE: For the case when the UE has two records of NAS security context stored and is attempting registration to the PLMN associated with the 5G-GUTI (or an equivalent PLMN) for that access, the UE uses the first NAS security context of that access to protect the initial NAS message. For the case when the UE has two records of NAS security context stored and is attempting registration to the PLMN associated with the second record (or an equivalent PLMN) of that access, the UE uses the second NAS security context of that access to protect the initial NAS message.",
    "For other cases when the UE has two records of NAS security context stored and is attempting registration to a PLMN which is not associated with any NAS security context record, the UE uses either record of the NAS security context of that access to protect the initial NAS message. Each 5G NAS security context shall be associated with two separate counters NAS COUNT per access type in the same PLMN: one related to uplink NAS messages and one related to downlink NAS messages. If the 5G NAS security context is used for access via both 3GPP and non-3GPP access in the same PLMN, there are two NAS COUNT counter pairs associated with the 5G NAS security context. The NAS COUNT counters use 24-bit internal representation and are independently maintained by UE and AMF. The NAS COUNT shall be constructed as a NAS sequence number (8 least significant bits) concatenated with a NAS overflow counter (16 most significant bits).",
    "When NAS COUNT is input to NAS ciphering or NAS integrity algorithms it shall be considered to be a 32-bit entity which shall be constructed by padding the 24-bit internal representation with 8 zeros in the most significant bits. The value of the uplink NAS COUNT that is stored or read out of the USIM or non-volatile memory as described in annex C, is the value that shall be used in the next NAS message. The value of the downlink NAS COUNT that is stored or read out of the USIM or non-volatile memory as described in annex C, is the largest downlink NAS COUNT used in a successfully integrity checked NAS message. The value of the uplink NAS COUNT stored in the AMF is the largest uplink NAS COUNT used in a successfully integrity checked NAS message. The value of the downlink NAS COUNT stored in the AMF is the value that shall be used in the next NAS message. The NAS sequence number part of the NAS COUNT shall be exchanged between the UE and the AMF as part of the NAS signalling.",
    "After each new or retransmitted outbound SECURITY PROTECTED 5GS NAS MESSAGE message, the sender shall increase the NAS COUNT number by one, except for the initial NAS messages if the lower layers indicated the failure to establish the RRC connection (see 3GPP TS 38.331 [30]). Specifically, on the sender side, the NAS sequence number shall be increased by one, and if the result is zero (due to wrap around), the stored NAS overflow counter shall also be incremented by one (see subclause 4.4.3.5).",
    "If, through implementation-dependent means, the receiver determines that the NAS message is a replay of an earlier NAS message, then the receiver handles the received NAS message as described in subclause 4.4.3.2. Otherwise, in order to determine the estimated NAS COUNT value to be used for integrity verification of a received NAS message: - The sequence number part of the estimated NAS COUNT value shall be equal to the sequence number in the received NAS message; and - If the receiver can guarantee that this NAS message was not previously accepted, then the receiver may select the estimated NAS overflow counter so that the estimated NAS COUNT value is lower than the stored NAS COUNT value; otherwise, the receiver selects the estimated NAS overflow counter so that the estimated NAS COUNT value is higher than the stored NAS COUNT value.",
    "During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, when a mapped 5G NAS security context is derived and taken into use, the AMF shall set both the uplink and downlink NAS COUNT counters of this 5G NAS security context to zero. The UE shall set both the uplink and downlink NAS COUNT counters of this 5G NAS security context to zero. During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the AMF shall increment the downlink NAS COUNT by one after it has created an S1 mode to N1 mode NAS transparent container (see subclause 9.11.2.9). During the inter-system change from N1 mode to S1 mode in 5GMM-CONNECTED mode, the AMF shall increment the downlink NAS COUNT by one after it has created an N1 mode to S1 mode NAS transparent container (see subclause 9.11.2.7).",
    "During N1 mode to N1 mode handover: a) if the new 5G NAS security context is created with the same KAMF, the AMF shall signal the 8 least significant bits of the current downlink NAS COUNT value in an Intra N1 mode NAS transparent container (see subclause 9.11.2.6). The AMF shall then increment the downlink NAS COUNT by one; or b) if the new 5G NAS security context is created with a new KAMF, the AMF shall signal the 8 least significant bits of the current downlink NAS COUNT value in an Intra N1 mode NAS transparent container (see subclause 9.11.2.6) and shall then set both the uplink and downlink NAS COUNT counters of this 5G NAS security context to zero. The AMF shall then increment the downlink NAS COUNT by one. The UE shall also set both the uplink and downlink NAS COUNT counters to zero.",
    "NOTE: During the inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode, the S1 mode to N1 mode NAS transparent container (see subclause 9.11.2.9) is treated as an implicit SECURITY MODE COMMAND message for the UE and the AMF, and therefore the AMF regards the sending of the S1 mode to N1 mode NAS transparent container as the sending of an initial SECURITY MODE COMMAND message in order to derive and take into use a mapped 5G NAS security context for the purpose of the NAS COUNT handling. The sender shall use its locally stored NAS COUNT as input to the ciphering algorithm. The receiver shall use the NAS sequence number included in the received message and an estimate for the NAS overflow counter as defined in subclause 4.4.3.1 to form the NAS COUNT input to the deciphering algorithm. The input parameters to the NAS ciphering algorithm are the BEARER ID, DIRECTION bit, NAS COUNT, NAS encryption key and the length of the key stream to be generated by the encryption algorithm.",
    "When applying initial NAS message protection to the REGISTRATION REQUEST, DEREGISTRATION REQUEST or SERVICE REQUEST message as described in subclause 4.4.6, the length of the key stream is set to the length of the entire plain NAS message that is included in the NAS message container IE, i.e. the value part of the NAS message container IE, that is to be ciphered. When applying initial NAS message protection to the CONTROL PLANE SERVICE REQUEST message as described in subclause 4.4.6, the length of the key stream is set to the length of: a) the value part of the CIoT small data container IE that is to be ciphered; or b) the value part of the NAS message container IE that is to be ciphered. For the UE, integrity protected signalling is mandatory for the 5GMM NAS messages once a valid 5G NAS security context exists and has been taken into use.",
    "For the network, integrity protected signalling is mandatory for the 5GMM NAS messages once a secure exchange of 5GS NAS messages has been established for the NAS signalling connection. Integrity protection of all NAS signalling messages is the responsibility of the NAS. It is the network which activates integrity protection. The use of \"null integrity protection algorithm\" 5G-IA0 (see subclause 9.11.3.34) in the current 5G NAS security context is only allowed: a) for an unauthenticated UE for which establishment of emergency services is allowed; b) for a W-AGF acting on behalf of an FN-RG; c) for a W-AGF acting on behalf of an N5GC device; and d) for a 5G-RG acting on behalf of an AUN3 device. For setting the security header type in outbound NAS messages, the UE and the AMF shall apply the same rules irrespective of whether the \"null integrity protection algorithm\" or any other integrity protection algorithm is indicated in the 5G NAS security context.",
    "If the \"null integrity protection algorithm\"5G-IA0 has been selected as an integrity protection algorithm, the receiver shall regard the NAS messages with the security header indicating integrity protection as integrity protected. Details of the integrity protection and verification of NAS signalling messages are specified in 3GPP TS 33.501 [24]. When a NAS message needs to be sent both ciphered and integrity protected, the NAS message is first ciphered and then the ciphered NAS message and the NAS sequence number are integrity protected by calculating the MAC. NOTE: NAS messages that are ciphered with the \"null ciphering algorithm\" 5G-EA0 are regarded as ciphered (see subclause 4.4.5). When a NAS message needs to be sent only integrity protected and unciphered, the unciphered NAS message and the NAS sequence number are integrity protected by calculating the MAC.",
    "When a 5GSM message is piggybacked in a 5GMM message, there is only one Sequence number IE and one Message authentication code IE for the 5GMM message piggybacking the 5GSM message. The use of ciphering in a network is an operator option subject to AMF configuration. When operation of the network without ciphering is configured, the AMF shall indicate the use of \"null ciphering algorithm\" 5G-EA0 (see subclause 9.11.3.34) in the current 5G NAS security context for all UEs. For setting the security header type in outbound NAS messages, the UE and the AMF shall apply the same rules irrespective of whether the \"null ciphering algorithm\" or any other ciphering algorithm is indicated in the 5G NAS security context.",
    "When the UE establishes a new N1 NAS signalling connection, it shall apply security protection to the initial NAS message as described in subclause 4.4.6. The UE shall start the ciphering and deciphering of NAS messages when the secure exchange of NAS messages has been established for an N1 NAS signalling connection. From this time onward, unless explicitly defined, the UE shall send all NAS messages ciphered until the N1 NAS signalling connection is released, or the UE performs inter-system change to S1 mode. The AMF shall start ciphering and deciphering of NAS messages as described in subclause 4.4.2.5. From this time onward, except for the SECURITY MODE COMMAND message, the AMF shall send all NAS messages ciphered until the N1 NAS signalling connection is released, or the UE performs inter-system change to S1 mode. Ciphering is never applied directly to 5GSM messages, but to the 5GMM message in which the 5GSM message is included.",
    "Once the encryption of NAS messages has been started between the AMF and the UE, the receiver shall discard the unciphered NAS messages which shall have been ciphered according to the rules described in this specification. If the \"null ciphering algorithm\" 5G-EA0 has been selected as a ciphering algorithm, the NAS messages with the security header indicating ciphering are regarded as ciphered. Details of ciphering and deciphering of NAS signalling messages are specified in 3GPP TS 33.501 [24]. When the UE needs to access the 5GS, the UE not operating as an IAB-node (see 3GPP TS 23.501 [8]), not acting as a 5G ProSe layer-2 UE-to-network relay UE (see 3GPP TS 23.304 [6E]) whose access attempt is triggered by a 5G ProSe layer-2 remote UE, and not acting as an NCR-MT node (see 3GPP TS 38.300 [27]), first performs access control checks to determine if the access is allowed.",
    "Access control checks shall be performed for the access attempts defined by the following list of events: NOTE 1: Although the UE operating as an IAB-node or as an NCR-MT node skips the access control checks, the UE operating as an IAB-node or as an NCR-MT node determines an access category and one or more access identities for each access attempt in order to derive an RRC establishment cause. In this case the NAS provides the RRC establishment cause but does not provide the access category and the one or more access identities to the lower layers. NOTE 1A: Although the UE acting as a 5G ProSe layer-2 UE-to-network relay UE skips the access control checks, the UE determines an access category and one or more access identities for each access attempt in order to derive an RRC establishment cause.",
    "a) the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication over 3GPP access and an event that requires a transition to 5GMM-CONNECTED mode occurs; and b) the UE is in 5GMM-CONNECTED mode over 3GPP access or 5GMM-CONNECTED mode with RRC inactive indication and one of the following events occurs: 1) 5GMM receives an MO-IMS-registration-related-signalling-started indication, an MO-MMTEL-voice-call- started indication, an MO-MMTEL-video-call-started indication or an MO-SMSoIP-attempt-started indication from upper layers; 2) 5GMM receives a request from upper layers to send a mobile originated SMS over NAS unless the request triggered a service request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode; 3) 5GMM receives a request from upper layers to send an UL NAS TRANSPORT message for the purpose of PDU session establishment unless the request triggered a service request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode; 4) 5GMM receives a request from upper layers to send an UL NAS TRANSPORT message for the purpose of UE-requested PDU session modification procedure unless the request triggered a service request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication to 5GMM- CONNECTED mode; 5) 5GMM receives a request to re-establish the user-plane resources for an existing PDU session; 6) 5GMM is notified that an uplink user data packet is to be sent for a PDU session with suspended user-plane resources; 7) 5GMM receives a request from upper layers to send a mobile originated location request unless the request triggered a service request procedure to transition the UE from 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication to 5GMM-CONNECTED mode; 8) 5GMM receives a request from upper layers to send a mobile originated signalling transaction towards the PCF by sending an UL NAS TRANSPORT message including a UE policy container (see 3GPP TS 24.587 [19B] and 3GPP TS 24.554 [19E]) unless the request triggered a service request procedure to transition the UE from 5GMM-IDLE mode to 5GMM-CONNECTED mode; and 9) 5GMM receives an indication from lower layers of the RAN timing synchronization status change, and decides to transition the UE from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM- CONNECTED mode as specified in subclause 5.3.1.4. NOTE 2: 5GMM specific procedures initiated by NAS in 5GMM-CONNECTED mode or 5GMM-CONNECTED mode with RRC inactive indication are not subject to access control, e.g. a registration procedure after PS handover will not be prevented by access control (see subclause 5.5).",
    "NOTE 3: LPP messages, SLPP messages, or location event report messages transported in the UL NAS TRANSPORT message sent in response to a mobile terminating or network induced location request, and the corresponding access attempts are handled as MT access. NOTE 4: Initiating a mobile originated signalling transaction towards the UDM by sending an UL NAS TRANSPORT message including an SOR transparent container is not supported. Therefore, access control for these cases has not been specified. When the NAS detects one of the above events, the NAS needs to perform the mapping of the kind of request to one or more access identities and one access category and lower layers will perform access barring checks for that request based on the determined access identities and access category. NOTE 5: The NAS is aware of the above events through indications provided by upper layers or through determining the need to start 5GMM procedures through normal NAS behaviour, or both.",
    "To determine the access identities and the access category for a request, the NAS checks the reason for access, types of service requested and profile of the UE including UE configurations, against a set of access identities and access categories defined in 3GPP TS 22.261 [3], namely: a) a set of standardized access identities; b) a set of standardized access categories; and c) a set of operator-defined access categories, if available. For the purpose of determining the applicable access identities from the set of standardized access identities defined in 3GPP TS 22.261 [3], the NAS shall follow the requirements set out in: a) subclause 4.5.2 and the rules and actions defined in table 4.5.2.1, if the UE is not operating in SNPN access operation mode over 3GPP access; or b) subclause 4.5.2A and the rules and actions defined in table 4.5.2A.1, if the UE is operating in SNPN access operation mode over 3GPP access.",
    "In order to enable access barring checks for access attempts identified by lower layers in 5GMM-CONNECTED mode with RRC inactive indication, the UE provides the applicable access identities to lower layers. NOTE 6: When and how the NAS provides the applicable access identities to lower layers is UE implementation specific. NOTE 7: Although the UE operating as an IAB-node or as an NCR-MT node skips the access control checks, the UE provides the applicable access identities to lower layers for access attempts identified by lower layers in 5GMM-CONNECTED mode with RRC inactive indication.",
    "For the purpose of determining the applicable access category from the set of standardized access categories and operator-defined access categories defined in 3GPP TS 22.261 [3], the NAS shall follow the requirements set out in: a) subclause 4.5.2 and the rules and actions defined in table 4.5.2.2, if the UE is not operating in SNPN access operation mode over 3GPP access; or b) subclause 4.5.2A and the rules and actions defined in table 4.5.2A.2, if the UE is operating in SNPN access operation mode over 3GPP access.",
    "related signalling Access attempt is for MO IMS registration related signalling (e.g. IMS initial registration, re-registration, subscription refresh) or for NAS signalling connection recovery during ongoing procedure for MO IMS registration related signalling (NOTE 2a) 9 (= MO IMS registration related signalling) UE NAS initiated 5GMM specific procedures Access attempt is for MO signalling 3 (= MO_sig) timing synchronization Access attempt is for mobile originated signalling for the reconnection to the network due to RAN timing synchronization status change 3 (= MO_sig) UE NAS initiated 5GMM connection management procedure or 5GMM NAS transport procedure Access attempt is for MO data 7 (= MO_data) An uplink user data packet is to be sent for a PDU session with suspended user-plane resources No further requirement is to be met 7 (= MO_data) NOTE 1: This includes 5GMM specific procedures while the service is ongoing and 5GMM connection management procedures required to establish a PDU session with request type = \"initial emergency request\" or \"existing emergency PDU session\", or to re-establish user-plane resources for such a PDU session.",
    "This further includes the service request procedure initiated with a SERVICE REQUEST message with the Service type IE set to \"emergency services fallback\". NOTE 2: Access for the purpose of NAS signalling connection recovery during an ongoing service as defined in subclause 4.5.5, or for the purpose of NAS signalling connection establishment following fallback indication from lower layers during an ongoing service as defined in subclause 4.5.5, is mapped to the access category of the ongoing service in order to derive an RRC establishment cause, but barring checks will be skipped for this access attempt.",
    "NOTE 2a: Access for the purpose of NAS signalling connection recovery during an ongoing procedure for MO IMS registration related signalling as defined in subclause 4.5.5, or for the purpose of NAS signalling connection establishment following fallback indication from lower layers during an ongoing procedure for MO IMS registration related signalling as defined in subclause 4.5.5, is mapped to the access category of the MO IMS registration related signalling in order to derive an RRC establishment cause, but barring checks will be skipped for this access attempt. NOTE 3: If the UE selects a new PLMN, then the selected PLMN is used to check the membership; otherwise the UE uses the RPLMNor a PLMN equivalent to the RPLMN. NOTE 4: This includes the 5GMM connection management procedures triggered by the UE-initiated NAS transport procedure for transporting the MO SMS. NOTE 5: The UE configured for NAS signalling low priority is not supported in this release of specification.",
    "If a UE supporting both S1 mode and N1 mode is configured for NAS signalling low priority in S1 mode as specified in 3GPP TS 24.368 [17] or 3GPP TS 31.102 [22], the UE shall ignore the configuration for NAS signalling low priority when in N1 mode. NOTE 6: If the access category applicable for the access attempt is 1, then the UE shall additionally determine a second access category from the range 3 to 7. If more than one access category matches, the access category of the lowest rule number shall be chosen. The UE shall use the second access category only to derive an RRC establishment cause for the access attempt. NOTE 7: \"EAB override\" does not apply, if the UE is not configured to allow overriding EAB (see the \"Override_ExtendedAccessBarring\" leaf of NAS configuration MO in 3GPP TS 24.368 [17] or 3GPP TS 31.102 [22]), or if NAS has not received an indication from the upper layers to override EAB and the UE does not have a PDU session that was established with EAB override.",
    "NOTE 8: For the definition of categories a, b and c associated with access category 1, see 3GPP TS 22.261 [3]. The categories associated with access category 1 are distinct from the categories a, b and c associated with EAB (see 3GPP TS 22.011 [1A]). NOTE 9: This includes: a) the UE-initiated NAS transport procedure for transporting a mobile originated location request; b) the 5GMM connection management procedure triggered by a) above; and c) NAS signalling connection recovery during an ongoing 5GC-MO-LR procedure. NOTE 10: This includes: a) the UE-initiated NAS transport procedure for transporting a mobile originated signalling transaction towards the PCF; b) the 5GMM connection management procedure triggered by a) above; and c) NAS signalling connection recovery during an ongoing UE-requested policy provisioning procedure for V2XP, ProSeP or both (see 3GPP TS 24.587 [19B] and see 3GPP TS 24.554 [19E]).",
    "4.5.2A Determination of the access identities and access category associated with a request for access for UEs operating in SNPN access operation mode over 3GPP access When the UE needs to initiate an access attempt in one of the events listed in subclause 4.5.1, the UE shall determine one or more access identities from the set of standardized access identities, and one access category from the set of standardized access categories and operator-defined access categories, to be associated with that access attempt. The set of the access identities applicable for the request is determined by the UE in the following way: a) for each of the access identities 1, 2, 11, 12, 13, 14 and 15 in table 4.5.2A.1, the UE shall check whether the access identity is applicable in the selected SNPN, if a new SNPN is selected, or otherwise if it is applicable in the RSNPN or equivalent SNPN; and b) if none of the above access identities is applicable, then access identity 0 is applicable.",
    "Table 4.5.2A.1: Access identities Access Identity number UE configuration UE is not configured with any parameters from this table 1 (NOTE 1) UE is configured for multimedia priority service (MPS). 2 (NOTE 2) UE is configured for mission critical service (MCS). 3-10 Reserved for future use 11 (NOTE 3) Access Class 11 is configured in the UE. 12 (NOTE 3) Access Class 12 is configured in the UE. 13 (NOTE 3) Access Class 13 is configured in the UE. 14 (NOTE 3) Access Class 14 is configured in the UE. 15 (NOTE 3) Access Class 15 is configured in the UE.",
    "NOTE 1: Access identity 1 is valid when: - the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, indicates the UE is configured for access identity 1 in the selected SNPN, if a new SNPN is selected, or RSNPN, and the selected SNPN or the RSNPN is the subscribed SNPN, an SNPN equivalent to the subscribed SNPN, or an non-subscribed SNPN of the same country as the subscribed SNPN if the MCC of the SNPN identity of the subscribed SNPN is not the MCC of value 999; - the UE receives the 5GS network feature support IE with the MPS indicator bit set to \"Access identity 1 valid\" from the RSNPN as described in subclause 5.5.1.2.4 and subclause 5.5.1.3.4; or - the UE receives the Priority indicator IE with the MPS indicator bit set to \"Access identity 1 valid\" from the RPLMN as described in subclause 5.4.4.3. NOTE 2: Access identity 2 is used by UEs configured for MCS and is valid when: - the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, indicates the UE is configured for access identity 2 in the selected SNPN, if a new SNPN is selected, or RSNPN, and the selected SNPN or the RSNPN is the subscribed SNPN, or an SNPN equivalent to the subscribed SNPN, or an non-subscribed SNPN of the same country as the subscribed SNPN if the MCC of the SNPN identity of the subscribed SNPN is not the MCC of value 999; or - the UE receives the 5GS network feature support IE with the MCS indicator bit set to \"Access identity 2 valid\" from the RSNPN as described in subclause 5.5.1.2.4 and subclause 5.5.1.3.4. NOTE 3: Access identities 11 and 15 are valid if indicated as configured for the UE in the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, in the selected SNPN, if a new SNPN is selected, or RSNPN, and the selected SNPN or the RSNPN is the subscribed SNPN.",
    "Access identities 12, 13 and 14 are valid if indicated as configured for the UE in the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, in the selected SNPN, if a new SNPN is selected, or RSNPN, and the selected SNPN or the RSNPN in the subscribed SNPN or an non-subscribed SNPN of the same country as the subscribed SNPN if the MCC of the SNPN identity of the subscribed SNPN is not the MCC of value 999. The contents of the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, and the rules specified in table 4.5.2A.1 are used to determine the applicability of access identity 1 in the SNPN.",
    "When the contents of the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, do not indicate the UE is configured for access identity 1 for the SNPN, the UE uses the MPS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message and the MPS indicator bit of the Priority indicator IE in the CONFIGURATION UPDATE COMMAND message to determine if access identity 1 is valid. The contents of the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, and the rules specified in table 4.5.2A.1 are used to determine the applicability of access identity 2 in the SNPN.",
    "When the contents of the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, do not indicate the UE is configured for access identity 2 for the SNPN, the UE uses the MCS indicator bit of the 5GS network feature support IE in the REGISTRATION ACCEPT message to determine if access identity 2 is valid. The contents of the unified access control configuration in the \"list of subscriber data\" stored in the ME (see 3GPP TS 23.122 [5]), if an entry of \"list of subscriber data\" is selected, or in the USIM (see 3GPP TS 31.102 [22]), if the PLMN subscription is selected, and the rules specified in table 4.5.2A.1 are used to determine the applicability of access classes 11 to 15 in the SNPN.",
    "In order to determine the access category applicable for the access attempt, the NAS shall check the rules in table 4.5.2A.2, and use the access category for which there is a match for barring check. If the access attempt matches more than one rule, the access category of the lowest rule number shall be selected. If the access attempt matches more than one operator-defined access category definition, the UE shall select the access category from the operator-defined access category definition with the lowest precedence value (see subclause 4.5.3). NOTE: The case when an access attempt matches more than one rule includes the case when multiple events trigger an access attempt at the same time. When multiple events trigger an access attempt at the same time, how the access attempt is checked for multiple events is up to UE implementation.",
    "Table 4.5.2A.2: Mapping table for access categories Rule # Type of access attempt Requirements to be met Access Category Response to paging or NOTIFICATION over non- 3GPP access ; 5GMM connection management procedure initiated for the purpose of transporting an LPP or SLPP message without an ongoing 5GC-MO-LR or SL-MO-LR procedure; Access attempt to handover of MMTEL voice call, MMTEL video call or SMSoIP from non-3GPP access; Access attempt upon receipt of \"call-pull- initiated\" indication from the upper layers (see 3GPP TS 24.174 [13D]) Access attempt is for MT access, handover of ongoing MMTEL voice call, MMTEL video call or SMSoIP from non-3GPP access; or Access attempt is made upon receipt of \"call-pull-initiated\" indication (3GPP TS 24.174 [13D]) 0 (= MT_acc) Emergency UE is attempting access for an emergency session (NOTE 1, NOTE 2) 2 (= emergency) Access attempt for operator-defined access category UE stores operator-defined access category definitions valid in the SNPN as specified in subclause 4.5.3, and access attempt is matching criteria of an operator-defined access category definition 32-63 (= based on operator classification) Access attempt for delay tolerant service (a) UE is configured for NAS signalling low priority, and (b) the UE received one of the categories a, b or c as part of the parameters for unified access control in the broadcast system information, and the UE is a member of the broadcasted category in the selected SNPN, RSNPN or equivalent SNPN (NOTE 3, NOTE 5, NOTE 6, NOTE 7, NOTE 8) 1 (= delay tolerant) MO MMTel voice call; or MT MMTel voice call Access attempt is for MO MMTel voice call or MT MMTel voice call or for NAS signalling connection recovery during ongoing MO MMTel voice call or ongoing MT MMTel voice call (NOTE 2) 4 (= MO MMTel voice) MO MMTel video call; or MT MMTel video call Access attempt is for MO MMTel video call or MT MMTel video call or for NAS signalling connection recovery during ongoing MO MMTel video call or ongoing MT MMTel video call (NOTE 2) 5 (= MO MMTel video) MO SMS over NAS or MO SMSoIP; or MT SMSoIP Access attempt is for MO SMS over NAS (NOTE 4) or MO SMS over SMSoIP transfer or MT SMS over SMSoIP or for NAS signalling connection recovery during ongoing MO SMS or SMSoIP transfer or MT SMS over SMSoIP (NOTE 2) 6 (= MO SMS and SMSoIP) MO MMTel voice call Access attempt is for MO MMTel voice call or for NAS signalling connection recovery during ongoing MO MMTel voice call (NOTE 2) 4 (= MO MMTel voice) MO MMTel video call Access attempt is for MO MMTel video call or for NAS signalling connection recovery during ongoing MO MMTel video call (NOTE 2) 5 (= MO MMTel video) MO SMS over NAS or MO SMSoIP Access attempt is for MO SMS over NAS (NOTE 4) or MO SMS over SMSoIP transfer or for NAS signalling connection recovery during ongoing MO SMS or SMSoIP transfer (NOTE 2) 6 (= MO SMS and SMSoIP) signalling transaction towards the PCF Access attempt is for mobile originated signalling transaction towards the PCF (NOTE 10) 3 (= MO_sig) with suspend indication When the UE is in 5GMM-IDLE mode or 5GMM-IDLE mode with suspend indication, upon receiving a request from the upper layers for an access attempt, the NAS shall categorize the access attempt into access identities and an access category following: a) subclause 4.5.2, table 4.5.2.1 and table 4.5.2.2, and subclause 4.5.3, if the UE is not operating in SNPN access operation mode over 3GPP access ; or b) subclause 4.5.2A, table 4.5.2A.1 and table 4.5.2A.2, and subclause 4.5.3, if the UE is operating in SNPN access operation mode over 3GPP access , and provide the applicable access identities and the access category to the lower layers for the purpose of access control checking.",
    "In this request to the lower layer the NAS can also provide to the lower layer the RRC establishment cause determined as specified in subclause 4.5.6 of this specification. NOTE 1: The access barring check is performed by the lower layers. NOTE 2: As an implementation option, the NAS can provide the RRC establishment cause to the lower layers after being informed by the lower layers that the access attempt is allowed. If the UE has uplink user data pending for one or more PDU sessions when it builds a REGISTRATION REQUEST or SERVICE REQUEST message as initial NAS message, the UE shall indicate the respective PDU sessions in the Uplink data status IE as specified in subclause 5.5.1.3.2 and 5.6.1.2.1, regardless of the access category for which the access barring check is performed.",
    "If the UE is registered for 5GS services with control plane CIoT 5GS optimization has uplink user data pending for one or more PDU sessions when it builds a CONTROL PLANE SERVICE REQUEST message as initial NAS message, the UE shall indicate the respective PDU sessions as specified in subclause 5.6.1.2.2, regardless of the access category for which the access barring check is performed. NOTE 3: The UE indicates pending user data for all the respective PDU sessions, even if barring timers are running for some of the corresponding access categories. If the lower layers indicate that the access attempt is allowed, the NAS shall initiate the procedure to send the initial NAS message for the access attempt. If the lower layers indicate that the access attempt is barred, the NAS shall not initiate the procedure to send the initial NAS message for the access attempt.",
    "Additionally: a) if the event which triggered the access attempt was an MO-MMTEL-voice-call-started indication or an MO- MMTEL-video-call-started indication: 1) if the UE is operating in the single-registration mode, the UE's usage setting is \"voice centric\" and the UE has not disabled its E-UTRA capability as specified in 3GPP TS 24.301 [15], the UE may attempt to select an E- UTRA cell connected to EPC.",
    "If the UE finds a suitable E-UTRA cell connected to EPC, it then proceeds with the appropriate EMM specific procedures and, if necessary, ESM procedures to make a PDN connection providing access to IMS available; see subclause 4.8.2 and 3GPP TS 24.301 [15]; 2) if the UE is operating in the dual-registration mode, the UE may proceed in S1 mode with the appropriate EMM specific procedures and ESM procedures to make a PDN connection providing access to IMS available; see subclause 4.8.3 and 3GPP TS 24.301 [15]; or 3) otherwise, the NAS shall notify the upper layers that the access attempt is barred.",
    "In this case, upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS shall notify the upper layers that the barring is alleviated for the access category and may initiate the procedure to send the initial NAS message, if still needed; b) if the event which triggered the access attempt was an MO-SMSoIP-attempt-started indication or an MO-IMS- registration-related-signalling-started indication: 1) if the UE is operating in the single-registration mode, the UE may attempt to select an E-UTRA cell connected to EPC.",
    "If the UE finds a suitable E-UTRA cell connected to EPC, it then proceeds with the appropriate EMM specific procedures and, if necessary, ESM procedures to make a PDN connection providing access to IMS available; see subclause 4.8.2 and 3GPP TS 24.301 [15]; 2) if the UE is operating in the dual-registration mode, the UE may proceed in S1 mode with the appropriate EMM specific procedures and ESM procedures to make a PDN connection providing access to IMS available; see subclause 4.8.3 and 3GPP TS 24.301 [15]; or 3) otherwise, the NAS shall notify the upper layers that the access attempt is barred.",
    "In this case, upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS shall notify the upper layers that the barring is alleviated for the access category and may initiate the procedure to send the initial NAS message, if still needed; and c) if the access attempt is for emergency: 1) the NAS shall notify the upper layers that the access attempt is barred. In this case, upon receiving an indication from the lower layers that the barring is alleviated for the access category with which the access attempt was associated, the NAS shall notify the upper layers of that the barring is alleviated for the access category and may initiate the procedure to send the initial NAS message, if still needed. NOTE 4: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP TS 23.167 [6] and 3GPP TS 24.229 [14].",
    "NOTE 5: Barring timers, on a per access category basis, are run by the lower layers. At expiry of barring timers, the indication of alleviation of access barring is indicated to the NAS on a per access category basis. establishment cause When 5GMM requests the establishment of a NAS-signalling connection, the RRC establishment cause used by the UE shall be selected according to one or more access identities (see subclauses 4.5.2 and 4.5.2A) and the determined access category by checking the rules specified in table 4.5.6.1 and table 4.5.6.2. If the access attempt matches more than one rule, the RRC establishment cause of the lowest rule number shall be used.",
    "If the determined access category is an operator-defined access category, then the RRC establishment cause used by the UE shall be selected according to table 4.5.6.1 and table 4.5.6.2 based on one or more access identities (see subclauses 4.5.2 and 4.5.2A) and the standardized access category determined for the operator-defined access category as described in subclause 4.5.3. NOTE 1: Following an RRC release with redirection, the lower layers can set the RRC establishment cause or the resume cause to \"mps-PriorityAccess\" in the case of redirection to an NR cell connected to 5GCN (see 3GPP TS 38.331 [30]) or to \"highPriorityAccess\" in the case of redirection to an E-UTRA cell connected to 5GCN (see 3GPP TS 36.331 [25A]), if the network indicates to the UE during RRC connection release with redirection that the UE has an active MPS session.",
    "NOTE 2: When the UE is acting as a 5G ProSe layer-2 UE-to-network relay UE, it is possible for the lower layer to decide an applicable RRC establishment cause according to the request from the 5G ProSe layer-2 remote UE or according to the indication from upper layers, including the case when the request from the 5G ProSe layer-2 remote UE is for emergency services, as specified in 3GPP TS 38.331 [30].",
    "Table 4.5.6.1: Mapping table for access identities/access categories and RRC establishment cause when establishing N1 NAS signalling connection via NR connected to 5GCN Rule # Access identities Access categories RRC establishment cause is set to Any category mps-PriorityAccess Any category mcs-PriorityAccess 11, 15 Any category highPriorityAccess 12,13,14, Any category highPriorityAccess 0 (= MT_acc) mt-Access 1 (= delay tolerant) Not applicable (NOTE 1) 2 (= emergency) emergency 3 (= MO_sig) mo-Signalling 4 (= MO MMTel voice) mo-VoiceCall 5 (= MO MMTel video) mo-VideoCall 6 (= MO SMS and SMSoIP) mo-SMS 7 (= MO_data) mo-Data 9 (= MO IMS registration related signalling) mo-Data NOTE 1: A UE using access category 1 for the access barring check will determine a second access category in the range 3 to 7 that is to be used for determination of the RRC establishment cause. See subclause 4.5.2, table 4.5.2.2, NOTE 6.",
    "NOTE 2: See subclause 4.5.2, table 4.5.2.1 for use of the access identities of 0, 1, 2, and 11-15.",
    "Table 4.5.6.2: Mapping table for access identities/access categories and RRC establishment cause when establishing N1 NAS signalling connection via E-UTRA connected to 5GCN Rule # Access identities Access categories RRC establishment cause is set to Any category highPriorityAccess Any category highPriorityAccess 11, 15 Any category highPriorityAccess 12,13,14, Any category highPriorityAccess 0 (= MT_acc) mt-Access 1 (= delay tolerant) Not applicable (NOTE 1) 2 (= emergency) emergency 3 (= MO_sig) mo-Signalling 4 (= MO MMTel voice) mo-VoiceCall 5 (= MO MMTel video) mo-VoiceCall 6 (= MO SMS and SMSoIP) mo-Data 7 (= MO_data) mo-Data 9 (= MO IMS registration related signalling) mo-Data 10 (= MO exception data) mo-ExceptionData (NOTE 3) NOTE 1: A UE using access category 1 for the access barring check will determine a second access category in the range 3 to 7 that is to be used for determination of the RRC establishment cause. See subclause 4.5.2, table 4.5.2.2, NOTE 6.",
    "NOTE 2: See subclause 4.5.2, table 4.5.2.1 for use of the access identities of 0, 1, 2, and 11-15. NOTE 3: This applies to the UE in NB-N1 mode. Upon registration to a PLMN or SNPN (except for the registration procedure for periodic registration update, the initial registration for onboarding services in SNPN, and the registration procedure for mobility registration update when registered for onboarding services in SNPN), the UE shall send to the AMF the requested NSSAI which includes one or more S-NSSAIs of the allowed NSSAI for the PLMN or SNPN or the configured NSSAI for the PLMN or SNPN and corresponds to the network slice(s) to which the UE intends to register with, if: a) the UE has a configured NSSAI for the current PLMN or SNPN; b) the UE has an allowed NSSAI for the current PLMN or SNPN; or c) the UE has neither allowed NSSAI for the current PLMN or SNPN nor configured NSSAI for the current PLMN or SNPN and has a default configured NSSAI.",
    "In this case the UE indicates to the AMF that the requested NSSAI is created from the default configured NSSAI. In roaming scenarios, if the mapped S-NSSAI(s) associated to the allowed NSSAI or the configured NSSAI are missing, the UE shall locally set the mapped S-NSSAI to the same value as the received S-NSSAI. Additionally, if the UE receives a Rejected NSSAI IE or an Extended rejected NSSAI IE without associated mapped S-NSSAI(s), and the rejected NSSAI is different from the rejected NSSAI for the failed or revoked NSSAA, the UE shall locally set the mapped S-NSSAI(s) to the same value as the received S-NSSAI. NOTE 1: The above occurs only when the UE is roaming and the AMF compliant with earlier versions of the specification omits providing to the UE a mapped S-NSSAI for one or more S-NSSAIs in, e.g., the allowed NSSAI or configured NSSAI.",
    "Other than S-NSSAIs contained in the NSSAIs described above, the requested NSSAI can be formed based on the S- NSSAI(s) available in the UE (see subclause 5.5.1.3.2 for further details). In roaming scenarios, the UE shall also provide the mapped S-NSSAI(s) for the requested NSSAI. NOTE 2: If the UE did not receive a mapped S-NSSAI for one or more S-NSSAIs in the allowed NSSAI or configured NSSAI, the UE still uses the S-NSSAI as received from the serving network (i.e., without the locally set mapped S-NSSAI) in any NAS message. The AMF verifies if the requested NSSAI is permitted based on the subscribed S-NSSAIs in the UE subscription and, in roaming scenarios the mapped S-NSSAI(s) provided by the UE, and if so then the AMF shall provide the UE with the allowed NSSAI for the PLMN or SNPN, and shall also provide the UE with the mapped S-NSSAI(s) for the allowed NSSAI for the PLMN or SNPN.",
    "Additionally, if the AMF allows one or more subscribed S-NSSAIs for the UE, the AMF may include the allowed subscribed S-NSSAI(s) in the allowed NSSAI in the REGISTRATION ACCEPT message. The AMF shall ensure that there are not two or more S-NSSAIs of the allowed NSSAI which are mapped to the same S-NSSAI of the HPLMN or the subscribed SNPN. If a) all the S-NSSAIs included in the requested NSSAI are rejected, or the requested NSSAI was not included by the UE; b) all default S-NSSAIs are not allowed; and c) the UE is neither registering nor registered for onboarding services in SNPN and the UE is neither registering nor registered for emergency services; then the AMF may reject the registration request (see subclauses 5.5.1.2.5 and 5.5.1.3.5 for further details). In roaming scenarios, if the mapped S-NSSAI(s) associated to requested NSSAI are missing, the AMF shall locally set the mapped S-NSSAI to the same value as the received S-NSSAI.",
    "NOTE 3: In roaming scenarios, when the UE is compliant with earlier versions of the specification or when the serving network does not provide a mapped S-NSSAI for one or more S-NSSAIs in the allowed NSSAI or configured NSSAI, the UE can omit a mapped S-NSSAI for one or more S-NSSAIs in requested NSSAI. The set of network slice(s) for a UE can be changed at any time while the UE is registered to a PLMN or SNPN, and the change may be initiated by the network or the UE. In this case, the allowed NSSAI and associated registration area may be changed during the registration procedure or the generic UE configuration update procedure. The configured NSSAI and the rejected NSSAI may be changed during the registration procedure or the generic UE configuration update procedure. The default configured NSSAI may be changed by sending a UE parameters update transparent container to the UE during the NAS transport procedure. The pending NSSAI may be changed during the registration procedure.",
    "In addition, using the generic UE configuration update procedure, the network may trigger the registration procedure in order to update the allowed NSSAI. The UE in NB-N1 mode does not include the requested NSSAI during the registration procedure if the 5GS registration type IE indicates \"mobility registration updating\", procedure is not initiated to change the slice(s) that the UE is currently registered to, and the UE is still in the current registration area. The AMF does not include the allowed NSSAI during a registration procedure with the 5GS registration type IE indicating \"mobility registration updating\" for the UE in NB-N1 mode, except if the allowed NSSAI has changed for the UE. The UE does not include the requested NSSAI during the registration procedure if the 5GS registration type IE indicates \"SNPN onboarding registration\" or the UE is registered for onboarding services in SNPN.",
    "The AMF does not include the allowed NSSAI during a registration procedure with the 5GS registration type IE indicating \"SNPN onboarding registration\" or during a registration procedure when the UE is registered for onboarding services in SNPN. The UE considers the last received allowed NSSAI as valid until the UE receives a new allowed NSSAI. The UE and network may support network slice-specific authentication and authorization. A serving PLMN or SNPN shall perform network slice-specific authentication and authorization for the S-NSSAI(s) of the HPLMN or the subscribed SNPN which are subject to it based on subscription information.",
    "The UE shall indicate whether it supports network slice-specific authentication and authorization in the 5GMM Capability IE in the REGISTRATION REQUEST message as specified in subclauses 5.5.1.2.2 and 5.5.1.3.2. The upper layer stores an association between each S-NSSAI and its corresponding credentials for the network slice- specific authentication and authorization. NOTE 1: The credentials for network slice-specific authentication and authorization and how to provision them in the upper layer are out of the scope of 3GPP. The network slice-specific authentication and authorization procedure shall not be performed unless the primary authentication and key agreement procedure as specified in the subclause 5.4.1 has successfully been completed. The AMF informs the UE about S-NSSAI(s) for which network slice-specific authentication and authorization (except for re-NSSAA) will be performed or is ongoing in the pending NSSAI.",
    "The AMF informs the UE about S-NSSAI(s) for which NSSAA procedure is completed as success in the allowed NSSAI or in the partially allowed NSSAI. The AMF informs the UE about S-NSSAI(s) for which NSSAA procedure is completed as failure in the rejected NSSAI for the failed or revoked NSSAA. The AMF stores and handles allowed NSSAI, partially allowed NSSAI, pending NSSAI, rejected NSSAI, and 5GS registration result in the REGISTRATION ACCEPT message according to subclauses 5.5.1.2.4 and 5.5.1.3.4. NOTE 2: The AMF maintains the NSSAA procedure status for each S-NSSAI, as specified in 3GPP TS 29.518 [20B] and the NSSAA procedure status for each S-NSSAI is not impacted by NSAC as specified in subclauses 4.6.2.5 and 4.6.3.1. NOTE 3: Upon completion of NSSAA procedures, it can happen that the total number of S-NSSAIs which need to be included in the allowed NSSAI exceeds eight. In this case, it is up to the AMF implementation on how to pick up the S-NSSAIs included in the allowed NSSAI.",
    "NOTE 4: It can happen that one or more S-NSSAIs included in the received allowed NSSAI, are not the S-NSSAIs that the UE intends to register to. In this case, it is up to the UE implementation on how to use these S- NSSAIs. To perform network slice-specific authentication and authorization for an S-NSSAI, the AMF invokes an EAP-based network slice-specific authentication and authorization procedure for the S-NSSAI, see subclause 5.4.7 and 3GPP TS 23.502 [9] using the EAP framework as described in 3GPP TS 33.501 [24]. The AMF updates the allowed NSSAI, the partially allowed NSSAI and the rejected NSSAI using the generic UE configuration update procedure as specified in the subclause 5.4.4 after the network slice-specific authentication and authorization procedure is completed.",
    "The AMF shall send the pending NSSAI containing all S-NSSAIs for which the network slice-specific authentication and authorization procedure (except for re-NSSAA) will be performed or is ongoing in the REGISTRATION ACCEPT message. The AMF shall also include in the REGISTRATION ACCEPT message the allowed NSSAI containing one or more S-NSSAIs from the requested NSSAI which are allowed by the AMF and for which network slice-specific authentication and authorization is not required, if any. The AMF shall also include in the REGISTRATION ACCEPT message the partially allowed NSSAI containing one or more S-NSSAIs from the requested NSSAI which are allowed by the AMF in a list of TAs within the current registration area and for which network slice-specific authentication and authorization is not required, if any.",
    "The network slice-specific re-authentication and re-authorization procedure or the network slice-specific authorization revocation procedure can be invoked by the network for a UE supporting NSSAA at any time.",
    "After the network performs the network slice-specific re-authentication and re-authorization procedure or network slice-specific authorization revocation procedure: a) if network slice-specific re-authentication and re-authorization fails or network slice-specific authorization is revoked for some but not all S-NSSAIs in the allowed NSSAI or the partially allowed NSSAI,, the AMF updates the allowed NSSAI or the partially allowed NSSAI and the rejected NSSAI accordingly using the generic UE configuration update procedure as specified in the subclause 5.4.4 and inform the SMF to release all PDU sessions associated with the S-NSSAI for which network slice-specific re-authentication and re-authorization fails or network slice-specific authorization is revoked; b) if network slice-specific re-authentication and re-authorization fails or network slice-specific authorization is revoked for all S-NSSAIs in the allowed NSSAI or the partially allowed NSSAI but there are one or more default S-NSSAIs which are not subject to network slice-specific authentication and authorization or for which the network slice-specific authentication and authorization has been successfully performed, the AMF updates the allowed NSSAI or the partially allowed NSSAI containing these default S-NSSAIs and the rejected NSSAI accordingly using the generic UE configuration update procedure as specified in the subclause 5.4.4. The AMF shall also inform the SMF to release all PDU sessions associated with the S-NSSAI for which network slice- specific re-authentication and re-authorization fails or network slice-specific authorization is revoked; or c) if network slice-specific re-authentication and re-authorization fails or network slice-specific authorization is revoked for all S-NSSAIs in the allowed NSSAI or the partially allowed NSSAI and all default S-NSSAIs are subject to network slice-specific authentication and authorization, and the network slice-specific authentication and authorization has not been successfully performed for any of these default S-NSSAIs, then AMF performs the network-initiated de-registration procedure and includes the rejected NSSAI in the DEREGISTRATION REQUEST message as specified in the subclause 5.5.2.3 except when the UE has an emergency PDU session established or the UE is establishing an emergency PDU session.",
    "In this case the AMF shall send the CONFIGURATION UPDATE COMMAND message containing rejected NSSAI and inform the SMF to release all PDU sessions associated with the S-NSSAI for which network slice-specific re-authentication and re- authorization fails or network slice-specific authorization is revoked. After the emergency PDU session is released, the AMF performs the network-initiated de-registration procedure as specified in the subclause 5.5.2.3. The UE does not include in the requested NSSAI any of the S-NSSAIs from the pending NSSAI that the UE stores, regardless of the access type.",
    "When the UE storing a pending NSSAI intends to register to one or more additional S- NSSAIs not included in the pending NSSAI, the UE initiates the registration procedure with a requested NSSAI containing these S-NSSAIs as described in subclause 5.5.1.3.2. In this case, the requested NSSAI shall also include one or more S-NSSAIs from the allowed NSSAI or the partially allowed NSSAI, if the UE still wants to use the S-NSSAI(s) from the allowed NSSAI or the partially allowed NSSAI. During the registration procedure, when the AMF receives a requested NSSAI from a UE over an access type, for which there is a pending NSSAI including one or more S-NSSAIs that were previously requested over the same access type, the AMF considers S-NSSAIs included in the requested NSSAI and S-NSSAIs in the pending NSSAI that were previously requested over the same access type as requested S-NSSAIs by the UE.",
    "The AMF handles the requested S- NSSAIs as described in subclause 5.5.1.3.4. When performing the network slice-specific re-authentication and re-authorization procedure if the S-NSSAI is included in the allowed NSSAI for both 3GPP and non-3GPP accesses, and the UE is registered to both 3GPP and non- 3GPP accesses in the same PLMN, then the AMF selects an access type to perform network slice-specific re- authentication and re-authorization based upon operator policy.",
    "If network slice-specific authorization is revoked for an S-NSSAI that is in the current allowed NSSAI for an access type or for an S-NSSAI that is in the current partially allowed NSSAI for 3GPP access type, the AMF shall: a) provide a new allowed NSSAI or a new partially allowed NSSAI, excluding the S-NSSAI for which the network slice-specific authorization is revoked; and b) provide a new rejected NSSAI for the failed or revoked NSSAA, including the S-NSSAI for which the network slice-specific authorization is revoked, with the rejection cause \"S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization\", to the UE using the generic UE configuration update procedure as specified in the subclause 5.4.4 and inform the SMF to release all PDU sessions associated with the S-NSSAI for which the network slice-specific authorization is revoked for this access type.",
    "If the UE requests the establishment of a new PDU session or the modification of a PDU session for an S-NSSAI for which the AMF is performing network slice-specific re-authentication and re-authorization procedure, the AMF may determine to not forward the 5GSM message to the SMF as described in subclause 5.4.5.2.4. NOTE 5: If the AMF receives the HTTP code set to \"4xx\" or \"5xx\" as specified in 3GPP TS 29.500 [20AA] or the AMF detects that the NSSAAF failure as specified in 3GPP TS 29.526 [21A] during the NSSAA procedure for an S-NSSAI, then the AMF considers the NSSAA procedure has failed for this S-NSSAI. The support for network slice replacement by a UE or network is optional.",
    "If the UE and network support network slice replacement, and the AMF determines that an S-NSSAI included in the allowed NSSAI needs to be replaced with an alternative S-NSSAI, the AMF provides: a) the alternative S-NSSAI in the allowed NSSAI, if not included yet; b) the alternative S-NSSAI in the configured NSSAI, if not included yet; c) the alternative S-NSSAI in the NSAG information, if not included yet and the UE supports NSAG; and d) the alternative NSSAI including the mapping information between the S-NSSAI to be replaced and the corresponding alternative S-NSSAI, to the UE, during the generic UE configuration update procedure or during the registration procedure as follows: a) for non-roaming UE, the AMF provides the mapping information between the S-NSSAI included in the allowed NSSAI and the alternative S-NSSAI to the UE; or NOTE 1: In non-roaming scenarios, the alternative S-NSSAI does not have to be part of the subscribed S-NSSAI(s) in the UE subscription.",
    "b) for roaming UE: 1) if the S-NSSAI included in the allowed NSSAI needs to be replaced (i.e., the S-NSSAI to be replaced is part of the VPLMN S-NSSAIs), the AMF provides the mapping information between the S-NSSAI included in the allowed NSSAI and the alternative S-NSSAI to the UE; and 2) if the S-NSSAI included in the mapped S-NSSAI(s) for the allowed NSSAI needs to be replaced (i.e., the S- NSSAI to be replaced is part of the HPLMN S-NSSAIs), the AMF provides the mapping information between the S-NSSAI to be replaced and the alternative S-NSSAI to the UE. NOTE 1A: In roaming scenarios, the alternative S-NSSAI, being part of the HPLMN S-NSSAIs does not have to be part of the subscribed S-NSSAI(s) in the UE subscription.",
    "NOTE 2: It is up to AMF local policy to determine when to provide the mapping information between the S-NSSAI to be replaced and the alternative S-NSSAI to the UE, which can be either when the alternative S-NSSAI is available and there is no established PDU session associated with the S-NSSAI to be replaced, or when the UE has established the first PDU session associated with the S-NSSAI to be replaced. If the requested NSSAI contains alternative S-NSSAI(s) that are not subscribed S-NSSAI(s), the AMF shall verify the alternative S-NSSAI(s) based on the stored alternative NSSAI. If the alternative S-NSSAI is subject to NSSAA, the alternative S-NSSAI provided by AMF shall be part of the subscribed S-NSSAI(s) in the UE subscription. The AMF shall perform NSSAA procedure for such alternative S- NSSAI and perform network slice replacement as specified above after the NSSAA procedure for the alternative S- NSSAI is completed as success.",
    "If re-NSSAA procedure is ongoing for the S-NSSAI to be replaced, the AMF shall continue with the re-NSSAA procedure and perform network slice replacement as specified above after the re-NSSAA procedure for the S-NSSAI to be replaced is completed as success. NOTE 2A: When configuring the alternative S-NSSAI, the maximum number of S-NSSAIs defined for the allowed NSSAI and configured NSSAI in subclause 4.6.2.2 are applicable. If the AMF determines that the replaced S-NSSAI is available again, the AMF provides the updated alternative NSSAI excluding the replaced S-NSSAI and the corresponding alternative S-NSSAI to the UE during the UE configuration update procedure or during the registration procedure. If all the replaced S-NSSAI(s) in alternative NSSAI are available again, the AMF provides the alternative NSSAI with Length of Alternative NSSAI contents set to 0 in the UE configuration update procedure or registration procedure.",
    "NOTE 3: If there is S-NSSAI location validity information for both the S-NSSAI to be replaced and the alternative S-NSSAI, the NS-AoS of the alternative S-NSSAI is the same as or larger than the NS-AoS of the S- NSSAI to be replaced. If the UE is in a cell outside the NS-AoS of the replaced S-NSSAI but within the NS-AoS of the alternative S-NSSAI, the AMF provides the updated allowed NSSAI and partially allowed NSSAI excluding the replaced S-NSSAI, if included, in the allowed NSSAI or partially allowed NSSAI during the UE configuration update procedure or during the registration procedure.",
    "If the alternative S-NSSAI is not part of the subscribed S-NSSAI(s), and: a) the replaced S-NSSAI is removed from the allowed NSSAI or the partially allowed NSSAI; or b) the replaced S-NSSAI is available again, then the AMF shall provide updated allowed NSSAI or partially allowed NSSAI excluding the alternative S-NSSAI to the UE over the current access type during the UE configuration update procedure or during the registration procedure. Additionally, if the alternative S-NSSAI is not included in allowed NSSAI or partially allowed NSSAI over the other access type: a) for case a), the AMF may also provide updated configured NSSAI excluding the alternative S-NSSAI to the UE during the UE configuration update procedure or during the registration procedure; or b) for case b), the AMF shall also provide updated configured NSSAI excluding the alternative S-NSSAI to the UE during the UE configuration update procedure or during the registration procedure.",
    "Based on SMF local configuration, if the replaced S-NSSAI is subject to NSAC or the alternative S-NSSAI is subject to NSAC or both, the SMF may perform NSAC for the replaced S-NSSAI or the alternative S-NSSAI or both. matching deployed tracking areas An operator can choose to let the NS-AoS of an S-NSSAI not match the existing tracking area boundaries (see subclause 5.15.18 of 3GPP TS 23.501 [8]). In order to support this deployment option, the operator has to ensure that an AMF covering the NS-AoS operates as described below. The support for S-NSSAI location validity information by the UE and the network, respectively, is optional. If a UE supports S-NSSAI location validity information, the UE indicates that it supports S-NSSAI location validity information during the registration procedure (see subclause 5.5.1).",
    "The AMF can provide a UE which has indicated that it supports S-NSSAI location validity information with S-NSSAI location validity information (see subclauses 5.4.4 and 5.5.1). The S-NSSAI location validity information consists of, for each of the applicable S-NSSAI(s) in the configured NSSAI: a) an S-NSSAI; and b) a list of cell identities of TA(s) belonging to the registration area where the related S-NSSAI(s) is available in some cells but not all cells of one or more TAs, which represents the NS-AoS of the S-NSSAI. The UE shall consider itself to be inside the NS-AoS if the cell identity of the current serving cell matches any of the identities in the S-NSSAI location validity information. Otherwise, the UE shall consider itself to be outside the NS- AoS of an S-NSSAI. NOTE 1: The cell identity of the current serving cell is received from the lower layers.",
    "For an S-NSSAI in the S-NSSAI location validity information, even if the S-NSSAI is included in the rejected NSSAI with a rejection cause value set to \"S-NSSAI not available in the current registration area\" or is included in the partially rejected NSSAI, the UE is allowed to request the S-NSSAI if the UE determines that it is inside the NS-AoS of the S- NSSAI. For an S-NSSAI limited by NS-AoS, if the UE in 5GMM-CONNECTED mode does not support S-NSSAI location validity information and the AMF determines that: a) the UE is outside the NS-AoS, then the AMF may: 1) provide the UE with an allowed NSSAI or a partially allowed NSSAI excluding the S-NSSAI, and optionally a configured NSSAI excluding the S-NSSAI; and NOTE 2: If excluding the S-NSSAI limited by NS-AoS results in an empty allowed NSSAI or partially allowed NSSAI, the AMF includes one or more default S-NSSAIs in the provided allowed NSSAI or partially allowed NSSAI.",
    "2) indicate to the SMF to release all PDU sessions associated with the S-NSSAI; or b) the UE is in the NS-AoS, then the AMF may update the configured NSSAI to include the S-NSSAI in the configured NSSAI. If the UE that does not support S-NSSAI location validity information requests a PDU session establishment for an S- NSSAI limited by NS-AoS and the AMF determines that the UE is outside the NS-AoS of an S-NSSAI, the AMF may perform S-NSSAI based congestion control for the S-NSSAI as specified in subclauses 5.3.11 and 5.4.5. The S-NSSAI location validity information is only applicable to 3GPP access. In order to enable PDU transmission in a network slice, the UE may request establishment of a PDU session in a network slice towards a data network (DN) which is associated with an S-NSSAI and a data network name (DNN) if there is no established PDU session adequate for the PDU transmission.",
    "The S-NSSAI included is part of allowed NSSAI of the serving PLMN or SNPN, which is an S-NSSAI value valid in the serving PLMN or SNPN, and in roaming scenarios the mapped S-NSSAI is also included for the PDU session if available. See subclause 6.4.1 for further details. The UE determines whether to establish a new PDU session or use one of the established PDU session(s) based on the URSP rules which include S-NSSAIs, if any (see subclause 6.2.9), or based on UE local configuration, as described in subclause 4.2.2 of 3GPP TS 24.526 [19]. If EPS counting is required for a network slice, the network performs network slice admission control for the S- NSSAI(s) subject to NSAC to monitor and control the number of UEs per network slice and number of PDU sessions per network slice during the PDN connection establishment procedure.",
    "If the maximum number of UEs on a network slice associated with an S-NSSAI or the maximum number of PDU sessions on a network slice associated with an S- NSSAI have already been reached, the network rejects the PDN connectivity request using ESM cause #26 \"insufficient resources\" as specifed in 3GPP TS 24.301 [15]. NOTE: If there are more than one S-NSSAI associated with the APN used in the PDN connectivity request and some of but not all associated S-NSSAIs are not available due to either maximum number of UEs reached or maximum number of PDU sessions reached, the network can use the associated S-NSSAI for which maximum number of UEs and maximum number of PDU sessions have not reached to avoid PDN connectivity request rejection.",
    "If: a) the UE and network support network slice replacement; b) the UE is provided with the mapping information between the S-NSSAI to be replaced and the alternative S- NSSAI; and c) the UE decides to establish a new PDU session with the S-NSSAI to be replaced, the UE provides both the S-NSSAI to be replaced and the alternative S-NSSAI during PDU session establishment procedure. If the timer T3584 or timer T3585 is running for the S-NSSAI to be replaced, the UE should not stop the timer during PDU session establishment procedure. If the SMF receives both the S-NSSAI to be replaced and the alternative S-NSSAI during PDU session establishment procedure, the SMF proceeds with the PDU session establishment procedure with the alternative S-NSSAI. If the PDU session establishment request is accepted, the SMF includes the alternative S-NSSAI in the PDU session establishment accept message.",
    "The S-NSSAI for the established PDU session is the S-NSSAI to be replaced and the alternative S-NSSAI on the UE side. If the UE is provided with the mapping of the VPLMN S-NSSAI to a VPLMN alternative S-NSSAI, the UE provides both the VPLMN alternative S-NSSAI and the VPLMN S-NSSAI during PDU session establishment procedure. The AMF sends both VPLMN alternative S-NSSAI and VPLMN S-NSSAI to the SMF. If the UE is provided with the mapping of the HPLMN S-NSSAI to a HPLMN Alternative S-NSSAI, the UE provides both the HPLMN alternative S- NSSAI and the HPLMN S-NSSAI during PDU session establishment procedure. The AMF sends both HPLMN alternative S-NSSAI and HPLMN S-NSSAI to the SMF.",
    "If the SMF receives from the AMF an alternative S-NSSAI for existing PDU session and: a) if the SMF decides to retain the existing PDU session (i.e. the SMF can serve both the alternative S-NSSAI and the S-NSSAI to be replaced with), the SMF sends the alternative S-NSSAI to the UE during network-requested PDU session modification procedure; or b) if the SMF decides to re-activate the existing PDU session and: 1) if the SSC mode of the PDU session is SSC mode 3, the SMF initiates PDU session modification procedure to trigger PDU session reactivation by the UE; or 2) if the SSC mode of the PDU session is SSC mode 1 or SSC mode 2, the SMF initiates PDU session release procedure to trigger PDU session reactivation by the UE, and the UE provides both the S-NSSAI to be replaced and the alternative S-NSSAI during PDU session establishment procedure.",
    "When the replaced S-NSSAI becomes available again, if the SMF receives from the AMF the replaced S-NSSAI for the existing PDU session and: a) if the SMF decides to retain the existing PDU session (i.e. the SMF can serve the replaced S-NSSAI), the SMF sends the replaced S-NSSAI to the UE during network-requested PDU session modification procedure; or b) if the SMF decides to re-activate the existing PDU session and: 1) if the SSC mode of PDU session is SSC mode 3, the SMF sends the replaced S-NSSAI to the UE during PDU session modification procedure to trigger PDU session reactivation by the UE; or 2) if the SSC mode of the PDU session is SSC mode 1 or SSC mode 2, the SMF sends the replaced S-NSSAI to the UE during PDU session release procedure to trigger PDU session reactivation by the UE; and the UE provides the replaced S-NSSAI during PDU establishment procedure.",
    "If the timer T3584 or timer T3585 is running for the replaced S-NSSAI and the replaced S-NSSAI in alternative NSSAI is available and the AMF provides the updated allowed NSSAI and configured NSSAI to the UE, the UE should stop the timer. matching deployed tracking areas If a UE is outside the NS-AoS of an S-NSSAI (see subclause 4.6.2.10), the UE shall not: a) attempt to request the establishment of user plane resources of any PDU session associated with the S-NSSAI; and b) initiate the UE-initiated NAS transport procedure to send CIoT user data to the SMF (see subclause 5.4.5.2.1 case h) nor the service request procedure to send CIoT user data to the SMF (see subclause 5.6.1.1 case d).",
    "If a UE is outside the NS-AoS of an S-NSSAI (see subclause 4.6.2.10), the SMF shall not: a) attempt to establish user plane resources of any PDU session associated with the S-NSSAI; and b) initiate the network-initiated NAS transport procedure to send CIoT user data to the UE (see subclause 5.4.5.3.1 case l). If a UE is outside the NS-AoS of an S-NSSAI (see subclause 4.6.2.10), the UE may initiate the UE-initiated NAS transport procedure carrying the following 5GSM messages for the PDU session associated with the S-NSSAI: a) a PDU SESSION RELEASE REQUEST message; or b) a PDU SESSION MODIFICATION REQUEST message to set the 3GPP PS data off status to \"deactivated\" as specified in 3GPP TS 24.008 [13]. NOTE: A PDU session associated with an S-NSSAI is not released solely because a UE is outside the NS-AoS of the S-NSSAI.",
    "If the SMF cannot determine that the UE is located inside the NS-AoS of the S-NSSAI of an existing PDU session established for this S-NSSAI, the SMF may according to operator's policy: a) attempt to establish the user plane resources for the PDU session; or b) initiate the network-initiated NAS transport procedure to send CIoT user data to the UE (see subclause 5.4.5.3.1 case l). The mobility management procedures defined over 3GPP access are re-used over non-3GPP access with the following exceptions: a) the registration status, and the 5GMM parameters of the UE's 3GPP access and non-3GPP access 5GMM state machine instances are independent in each of these accesses and can be different; b) single-registration mode and dual-registration mode do not apply for 5GMM over non-3GPP access; c) the RPLMN over non-3GPP access can be different from the RPLMN over 3GPP access.",
    "The MCC of the RPLMN over 3GPP access and the MCC of the RPLMN over the non-3GPP access can also be different; d) the registration for 3GPP access and for non-3GPP access are performed separately. Like for 3GPP access, an access stratum connection exists before the UE can perform the registration procedure for non-3GPP access. As at registration over non-3GPP access the UE is allocated a registration area, which is associated with a single TAI, list management of registration areas is not required, and registration updating due to registration area change with the registered PLMN is not performed. Furthermore, the registration procedure for periodic registration update is also not performed.",
    "New registration at change of PLMN is required; e) the 5GMM over non-3GPP access in the UE considers that the N1 NAS signalling connection is established when the lower layers indicate that the access stratum connection is established succcessfully; f) the UE-initiated service request procedure via non-3GPP access is supported. Upon indication from the lower layers of non-3GPP access, that the access stratum connection is established between the UE and the network, the UE in 5GMM-REGISTERED state and in 5GMM-IDLE mode over non-3GPP access shall initiate the service request procedure via non-3GPP access.",
    "The UE may indicate with the service request message the PDU session(s) associated with non-3GPP access to re-establish user-plane resources for which the UE has pending user data to be sent; g) paging procedure is not performed via non-3GPP access; h) service area restrictions do not apply for non-3GPP access other than the wireline access; i) the establishment cause for non-3GPP access is determined according to subclause 4.7.2.2; j) eCall inactivity procedure is not performed via non-3GPP access; k) local area data network (LADN) does not apply for non-3GPP access; l) the Allowed PDU session IE shall not be included in the REGISTRATION REQUEST message or the SERVICE REQUEST message sent over non-3GPP access; m) DRX parameters do not apply for non-3GPP access; n) Mobile initiated connection only mode (MICO) does not apply for non-3GPP access; o) CIoT 5GS optimizations do not apply for non-3GPP access; p) unified access control does not apply for non-3GPP access; q) UE radio capability signalling optimisation (RACS) does not apply for non-3GPP access; r) Closed access group (CAG) does not apply for non-3GPP access; s) the N1 NAS signalling connection release, the paging indication for voice services and reject the paging request do not apply for non-3GPP access.",
    "The Paging restriction IE shall not be included in the REGISTRATION REQUEST message, the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message sent over non-3GPP access. The AMF shall not delete any stored paging restriction preferences for the UE and shall not stop restricting paging when receiving REGISTRATION REQUEST message, SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message over non-3GPP access; t) the partially allowed NSSAI and the partially rejected NSSAI do not apply for non-3GPP access; and u) support for unavailability period (see subclause 5.3.26) does not apply for non-3GPP access. There are a number of situations in which the UE is unable to obtain normal service from a PLMN over non-3GPP access and the UE enters the limited service state over non-3GPP access.",
    "These include: a) no USIM in the ME; b) an \"illegal UE\" or \"illegal ME\" is received when registration, network-initiated de-registration or service request is performed (any USIM in the ME is then considered \"invalid\"); c) a \"5GS services not allowed\" is received when a registration, network-initiated de-registration or service request is performed; d) a \"PLMN not allowed\" is received when registration, network-initiated de-registration or service request is performed; e) a \"Tracking area not allowed\" is received when a registration, network-initiated de-registration or service request is performed; f) a \"Roaming not allowed in this tracking area\" is received when a registration, network-initiated de-registration or service request is performed; g) void; or h) a \"Serving network not authorized\" is received when a registration or service request is performed. In limited service state with a valid USIM in the UE, the network selection is performed as defined in 3GPP TS 24.502 [18].",
    "With the exception of performing initial registration for emergency services, no registration requests are made until a valid USIM is present. For registration for emergency services, the PLMN of the current N3IWF or TNGF is considered as the selected PLMN for the duration the UE is registered for emergency services. In order to interwork with E-UTRAN connected to EPC, the UE supporting both S1 mode and N1 mode can operate in single-registration mode or dual-registration mode (see 3GPP TS 23.501 [8]). Support of single-registration mode is mandatory for UEs supporting both S1 mode and N1 mode. During the EPS attach procedure (see 3GPP TS 24.301 [15]) or initial registration procedure (see subclause 5.5.1.2), the mode for interworking is selected if the UE supports both S1 mode and N1 mode, and the network supports interworking.",
    "The mode for interworking may also be selected during the EPS tracking area updating procedure (see 3GPP TS 24.301 [15]) or registration procedure for mobility and periodic registration update (see subclause 5.5.1.3). For interworking between E-UTRAN connected to EPC and TNGF or N3IWF connected to 5GCN, the UE shall operate as specified in either subclause 4.8.2.3 or subclause 4.8.3. Which subclause the UE follows is chosen by the UE irrespective of the interworking without N26 interface indicator. See subclause 5.1.4.2 for coordination between 5GMM and EMM and subclause 6.1.4.1 for coordination between 5GSM and ESM.",
    "If: a) the UE has registered in neither N1 mode over 3GPP access nor S1 mode yet; and b) the UE has at least one active PDU session associated with non-3GPP access which the UE intends to transfer to EPS, the UE shall initiate an EPS attach procedure and include a PDN CONNECTIVITY REQUEST message with a request type in the ATTACH REQUEST message to activate a default EPS bearer context for one of the active PDU sessions which the UE intends to transfer to EPS (see 3GPP TS 24.301 [15]). The request type is set as follows: - if the PDU session which the UE intends to transfer is a non-emergency PDU session, the request type is set to \"handover\"; and - if the PDU session which the UE intends to transfer is an emergency PDU session, the request type is set to \"handover of emergency bearer services\" and the default bearer to be activated is the default EPS bearer context for the emergency PDU session.",
    "NOTE 1: It is necessary for the UE to support sending an ATTACH REQUEST message containing a PDN CONNECTIVITY REQUEST message with request type set to \"handover\" or \"handover of emergency bearer services\" to transfer a PDU session from N1 mode to S1 mode for interworking between TNGF or N3IWF connected to 5GCN and E-UTRAN. NOTE 2: The order of PDU sessions to be tranferred to EPS is up to UE implementation. After successful completion of the EPS attach procedure where the activated default EPS bearer context is not for emergency service, the UE shall initiate a UE requested PDN connectivity procedure with request type set to \"handover\" for non-emergency PDU session or \"handover of emergency bearer services\" for emergency PDU session in the PDN CONNECTIVITY REQUEST message to transfer each of the other PDU sessions which the UE intends to transfer to EPS, if any.",
    "If: a) the UE has not registered in N1 mode over non-3GPP access yet; and b) the UE has at least one active PDN connection which the UE intends to transfer to TNGF or N3IWF connected to 5GCN, the UE shall initiate an initial registration procedure over non-3GPP access (see subclause 5.5.1.2). After successful completion of the 5GS initial registration in N1 mode over non-3GPP access, the UE shall initiate a UE-requested PDU session establishment procedure with a request type to transfer each of the PDN connections which the UE intends to transfer to TNGF or N3IWF connected to 5GCN, if any.",
    "The request type is set as follows: - if the PDN connection which the UE intends to transfer is a PDN connection for emergency bearer services, the request type is set to \"existing emergency PDU session\" to transfer the PDN connection for emergency bearer services; and - if the PDN connection which the UE intends to transfer is a non-emergency PDN connection, the request type is set to \"existing PDU session\" to transfer the non-emergency PDN connection. NOTE 3: If the UE has no active PDU session associated with non-3GPP access which the UE in N1 mode intends to transfer to EPS or no active PDN connection associated with 3GPP access which the UE in S1 mode intends to transfer to TNGF or N3IWF connected to 5GCN, the interworking between TNGF or N3IWF connected to 5GCN and E-UTRAN is not supported. See subclause 6.1.4.2 for coordination between 5GSM and ESM.",
    "The UE shall re-enable the N1 mode capability when the UE powers off and powers on again, the USIM is removed or an entry of the \"list of subscriber data\" with the SNPN identity of the SNPN is updated. access When the UE disables the N1 mode capability for non-3GPP access, the UE NAS layer shall not initiate any 5GS NAS procedures towards the network over non-3GPP access. When the UE supporting both N1 mode and S1 mode needs to stay in non-3GPP access connected to EPC (e.g. due to the domain selection for UE originating sessions as specified in subclause 4.3.2), in order to prevent unintentional selection of a non-3GPP access network connected to 5GCN, the UE operating in single-registration mode shall not transfer any PDN connection to a non-3GPP access network connected to the 5GCN.",
    "If the disabling of N1 mode capability for non-3GPP access was due to IMS voice is not available over non-3GPP access in 5GS and the UE's usage setting is \"voice centric\", the UE shall re-enable the N1 mode capability for non- 3GPP access when the UE's usage setting is changed from \"voice centric\" to \"data centric\" as specified in subclauses 4.3.3. The UE shall re-enable the N1 mode capability for non-3GPP access when a new PLMN or SNPN is selected over non- 3GPP access. The UE may disable the N1 mode capability for the currently camped PLMN or SNPN over non-3GPP access if no network slice is available for the camped PLMN or SNPN. As an implementation option, the UE may start a timer for re-enabling the N1 mode capability for non-3GPP access, after the N1 mode capability for non-3GPP access was disabled. On the expiry of this timer, the UE should re-enable the N1 mode capability for non-3GPP access. The 5GS in a PLMN supports updating UE parameters via NAS signalling.",
    "The feature enables the HPLMN to securely and dynamically re-configure the UE configuration parameters stored on the USIM and the ME. - In this release of the specification, updates of the following USIM configuration parameters are supported: - routing indicator. - In this release of specification, updates of the following ME configuration parameters are supported: - default configured NSSAI. - disaster roaming information. The 5GS in an SNPN supports updating UE parameters via NAS signalling. The feature enables the SNPN to securely and dynamically re-configure the UE configuration parameter stored on the USIM if the UE used the USIM for registration to the SNPN. - In this release of the specification, updates of the following USIM configuration parameters are supported: - routing indicator. - In this release of specification, updates of the following ME configuration parameters are supported: - routing indicator. - default configured NSSAI.",
    "The update of UE configuration parameters is initiated by the network using the network-initiated downlink NAS transport procedure as described in subclause 5.4.5.3. The ME acknowledgement of successful reception of the updated UE configuration parameter information is sent back to the network using the UE-initiated uplink NAS transport procedure as described in subclause 5.4.5.2. Two types of NPN can be deployed using 5GS: SNPN (see subclause 4.14.2) and PNI-NPN (see subclause 4.14.3). A 5GS can support time synchronization and TSC (see 3GPP TS 23.501 [8], 3GPP TS 23.502 [9], and 3GPP TS 23.503 [10]). This subclause describes NAS-specific aspects of the 5GS features to support time synchronization and TSC. Interworking with EPS is not supported for a PDU session for time synchronization or TSC. Two types of synchronization processes are supported by the 5GS: 5GS synchronization and (g)PTP domain synchronization (see 3GPP TS 23.501 [8]).",
    "For 5GS synchronization, the lower layers provide the 5G internal system clock signalled via the NG-RAN (see 3GPP TS 38.331 [30]) and the UE forwards the 5G internal system clock to the DS-TT(s). For (g)PTP domain synchronization, the UE supports forwarding (g)PTP messages (see 3GPP TS 23.501 [8], 3GPP TS 23.502 [9], and 3GPP TS 24.535 [19A]). For all (g)PTP domains associated with a PDU session: a) if the UE receives (g)PTP message via the PDU session, the UE forwards the (g)PTP messages to the DS-TT associated with the PDU session; or b) if the UE receives (g)PTP messages from the DS-TT associated with the PDU session, the UE forwards the (g)PTP messages via the PDU session. Depending on the 5G access stratum-based time distribution or (g)PTP-based time distribution, the network timing synchronization status of the nodes involved in the operation (e.g., NG-RAN nodes, NW-TTs) may change.",
    "Using the 5GMM protocol, the network can request a supporting UE to reconnect to the network upon receiving an indication of a change in the RAN timing synchronization status. A UE in NB-N1 mode (see 3GPP TS 36.331 [25A]) shall calculate the value of the applicable NAS timer indicated in table 10.2.1 plus 240s. The timer value obtained is used as described in the appropriate procedure subclause of this specification. The NAS timer value shall be calculated at start of a NAS procedure and shall not re-calculate the use of the NAS timer value until the NAS procedure is completed, restarted or aborted. When an AMF that supports NB-N1 mode performs NAS signalling with a UE, which is using NB-N1 mode, the AMF shall calculate the value of the applicable NAS timer indicated in table 10.2.2 plus 240s. The timer value obtained is used as described in the appropriate procedure subclause of this specification.",
    "The NAS timer value shall be calculated at start of a NAS procedure and shall not re-calculate the use of the NAS timer value until the NAS procedure is completed, restarted or aborted. In WB-N1 mode, a UE operating in category CE can operate in either CE mode A or CE mode B (see 3GPP TS 36.306 [25D]). If a UE that supports CE mode B and operates in WB-N1 mode and the UE's usage setting is not set to \"voice centric\" (see 3GPP TS 23.501 [8]), and: a) the use of enhanced coverage is not restricted by the network; or b) CE mode B is not restricted by the network (see 3GPP TS 23.501 [8]); the UE shall apply the value of the applicable NAS timer indicated in table 10.3.1 for WB-N1/CE mode.",
    "A UE that supports CE mode B and operates in WB-N1 mode shall not apply the value of the applicable NAS timer indicated in table 10.3.1 for WB-N1/CE mode before receiving an indication from the network that the use of enhanced coverage is not restricted, or CE mode B is not restricted, as described in this subclause. The NAS timer value obtained is used as described in the appropriate procedure subclause of this specification. The NAS timer value shall be calculated at start of a NAS procedure, and shall not be re-calculated until the NAS procedure is completed, restarted or aborted. If the use of extended NAS timer is indicated by the AMF (see 3GPP TS 23.501 [8] and 3GPP TS 23.502 [9]), the SMF shall calculate the value of the applicable NAS timer indicated in table 10.3.2 for WB-N1/CE mode. The NAS timer value obtained is used as described in the appropriate procedure subclause of this specification.",
    "The NAS timer value shall be calculated at start of a NAS procedure and shall not be re-calculated until the NAS procedure is completed, restarted or aborted. A 5GS can support UAV identification, authentication, and authorization (see 3GPP TS 23.256 [6AB]). This subclause describes NAS-specific aspects of the 5GS features to support UAV identification, authentication, authorization and C2 communication authorization. Before accessing 5GS for UAS services, the UE supporting UAS services must have an assigned CAA-level UAV ID. The UE can be registered to 5GS for UAS services if there is a valid aerial subscription in the UE's subscription. A 5GS can support 3GPP satellite NG-RAN access technology (see 3GPP TS 23.501 [8]). This subclause describes NAS-specific aspects of the 5GS features to support 3GPP satellite NG-RAN access technology.",
    "For 5GS mobility management via a satellite NG-RAN cell the UE shall apply the value of the applicable NAS timer indicated in table 10.2.1 for access via a satellite NG-RAN cell. NOTE 1: The applied NAS timer values are based on the current satellite NG-RAN access RAT type determined based on information from lower layers. The NAS timer value obtained by the UE is used as described in the appropriate procedure subclause of this specification. The NAS timer value shall be calculated at start of a NAS procedure, and shall not be re-calculated until the NAS procedure is completed, restarted or aborted. The access via a satellite NG-RAN cell by a UE is indicated to the AMF by lower layers and shall be stored by the AMF. When an AMF that supports access via satellite NG-RAN cells performs NAS signalling with a UE via satellite NG-RAN cells, the AMF shall calculate the value of the applicable NAS timer indicated in table 10.2.2 for access via a satellite NG-RAN cell.",
    "NOTE 2: The applied NAS timer values are based on the current satellite NG-RAN access RAT type determined based on information from lower layers. The NAS timer value obtained by the network is used as described in the appropriate procedure subclause of this specification. The NAS timer value shall be calculated at start of a NAS procedure and shall not be re-calculated until the NAS procedure is completed, restarted or aborted. The UE and the network may support Minimization of service interruption (MINT). MINT aims to enable a UE to obtain service from a PLMN offering disaster roaming services when a disaster condition applies to the UE determined PLMN with disaster condition.",
    "If the UE supports MINT, the indication of whether disaster roaming is enabled in the UE, the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN', the one or more \"list of PLMN(s) to be used in disaster condition\", disaster roaming wait range and disaster return wait range provisioned by the network, if available, are stored in the non-volatile memory in the ME as specified in annex C and are kept when the UE enters 5GMM-DEREGISTERED state. Annex C specifies condition under which the indication of whether disaster roaming is enabled in the UE, the indication of 'applicability of \"lists of PLMN(s) to be used in disaster condition\" provided by a VPLMN', the one or more \"lists of PLMN(s) to be used in disaster condition\", disaster roaming wait range and disaster return wait range stored in the ME are deleted.",
    "Upon selecting a PLMN for disaster roaming as specified in 3GPP TS 23.122 [5]: a) if the UE does not have a stored disaster roaming wait range, the UE shall perform a registration procedure for disaster roaming services on the selected PLMN as described in subclause 5.5.1; and b) if the UE has a stored disaster roaming wait range, the UE shall generate a random number within the disaster roaming wait range and start a timer with the generated random number. While the timer is running, the UE shall not initiate registration on the selected PLMN except if the UE needs to request an emergency PDU session, in which case the UE shall initiate the registration procedure, set the 5GS registration type IE to \"emergency registration\" in the REGISTRATION REQUEST message and keep the timer running.",
    "Upon expiration of the timer, if the UE does not have an emergency PDU session, the UE shall perform a registration procedure for disaster roaming services as described in subclause 5.5.1 if still camped on the selected PLMN. If the UE has an emergency PDU session when the timer expires, the registration procedure for disaster roaming services as described in subclause 5.5.1 shall be performed after the release of the emergency PDU session, if the UE is still camped on the selected PLMN. If the UE is switched off when the timer for disaster roaming wait range is running, the UE shall behave as follows when the UE is switched on, the USIM in the UE remains the same and the UE selects the PLMN for disaster roaming: - let t1 be the time remaining for the timer for disaster roaming wait range timeout at switch off and let t be the time elapsed between switch off and switch on. If t1 is greater than t, then the timer shall be restarted with the value t1 – t.",
    "If t1 is equal to or less than t, then the timer need not be restarted. If the UE is not capable of determining t, then the UE shall restart the timer with the value t1.",
    "Upon determining that a disaster condition has ended as specified in 3GPP TS 23.122 [6]: a) the UE shall stop the timer started with a generated random number within the disaster roaming wait range, if running; b) the UE shall perform PLMN selection as specified in 3GPP TS 23.122 [5], except if the UE already selected an allowable PLMN as specified in 3GPP TS 23.122 [6]; and c) if the UE selects the UE determined PLMN with disaster condition and has a stored disaster return wait range, which is 1) provided by the PLMN providing disaster roaming services; or 2) provided by the selected PLMN, the UE shall generate a random number within the disaster return wait range, start a timer with the generated random number value and enter 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION state or 5GMM- REGISTERED.ATTEMPTING-REGISTRATION-UPDATE state, if registered.",
    "While the timer is running, the UE shall not initiate registration on the selected PLMN except if the UE needs to request an emergency PDU session, in which case the UE shall initiate the registration procedure, set the 5GS registration type IE to \"emergency registration\" in the REGISTRATION REQUEST message and keep the timer running. Upon expiration of the timer, if the UE does not have an emergency PDU session, the UE shall perform a registration procedure if still camped on the selected PLMN. If the UE has an emergency PDU session when the timer expires, the registration procedure as described in subclause 5.5.1 shall be performed after the release of the emergency PDU session, if the UE is still camped on the selected PLMN. Otherwise, the UE shall perform registration procedure in the selected PLMN.",
    "If the UE is switched off when the timer for disaster return wait range is running, the UE shall behave as follows when the UE is switched on, the USIM in the UE remains the same and the UE selects the UE determined PLMN with disaster condition: - let t1 be the time remaining for the timer for disaster return wait range timeout at switch off and let t be the time elapsed between switch off and switch on. If t1 is greater than t, then the timer shall be restarted with the value t1 – t. If t1 is equal to or less than t, then the timer need not be restarted. If the UE is not capable of determining t, then the UE shall restart the timer with the value t1. When the AMF assigns a registration area to the UE registered for disaster roaming services, the AMF shall only include TAIs covering the area with the disaster condition.",
    "When the AMF determines that the disaster condition has ended and the UE which is registered for disaster roaming services has an emergency PDU session, the AMF shall initiate the generic UE configuration update procedure to indicate that the UE is registered for emergency services as described in subclause 5.4.4.2. Interworking with EPS is not supported for UEs that are registered for disaster roaming services.",
    "When registering for disaster roaming services, the UE indicates to the network that S1 mode is not supported as described in subclause 5.5.1.2.2. While registered for disaster roaming services and upon a need to establish an emergency PDU session or perform emergency services fallback, the UE initiates the registration procedure for mobility and periodic registration update and indicates that S1 mode is supported as described in subclause 5.5.1.3.2. If the UE is registered for disaster roaming services and the registered PLMN is removed from forbidden PLMN lists due to reasons specified in 3GPP TS 23.122 [5] subclause 4.4.6 or in 3GPP TS 23.122 [5] Annex C, then UE shall initiate the de-registration procedure and perform PLMN selection as specified in 3GPP TS 23.122 [5]. A 5GS can support a MBSR-UE and a UE accessing to MBSR (see subclause 5.35A of 3GPP TS 23.501 [8]).",
    "This subclause describes NAS-specific aspects of the 5GS features to support the authorization of the MBSR-UE, and the control of the UE access via MBSR. The AMF authorizes the UE's request to act as a MBSR based on the subscription information. The AMF can indicate to the MBSR-UE that it is allowed or not allowed to operate as MBSR during registration procedure as specified in subclause 5.5.1.2. Enhanced CAG information can be used for the control of UE's access via MBSR. CAG identifier is used to control the access of UE via MBSR. The 5GCN supports the UE access control based on the PLMND ID and CAG identifier broadcast by the MBSR and the CAG-ID authorized based on \"Allowed CAG list\" in the PLMN's entry of \"CAG information list\" stored in the UE. Time validity information can be provided to the UE together with the CAG identifier for accessing to MBSR in order to control that UE not accessing the MBSR cell outside of the time validity information.",
    "For the UE not supporting CAG functionality, the 5GCN can control the access of the UE with managing the forbidden tracking area. Elementary procedures for 5GS mobility management Depending on how they can be initiated, three types of 5GMM procedures can be distinguished: a) 5GMM common procedures: 5GMM common procedure can always be initiated when the UE is in 5GMM-CONNECTED mode. The procedures belonging to this type are: 1) Initiated by the network: i) network-initiated NAS transport; ii) primary authentication and key agreement; iii) security mode control; iv) generic UE configuration update; v) identification; and vi) network slice-specific authentication and authorization; 2) Initiated by the UE: UE-initiated NAS transport. 3) Initiated by the UE or the network and used to report certain error conditions detected upon receipt of 5GMM protocol data: 5GMM status.",
    "b) 5GMM specific procedures: At any time only one UE initiated 5GMM specific procedure can be running for each of the access network(s) that the UE is camping in. The procedures belonging to this type are: 1) Initiated by the UE and used e.g. to register to the network for 5GS services and establish a 5GMM context, to update the location/parameter(s) of the UE: registration. 2) Initiated by the UE or the network and used to deregister from the network for 5GS services and to release a 5GMM context: de-registration. 3) Initiated by the UE and used to deregister from the network for 5GS services and to release a 5GMM context: eCall inactivity procedure. c) 5GMM connection management procedures: 1) Initiated by the UE and used to establish a secure connection to the network or to request the resource reservation for sending data, or both: service request.",
    "The service request procedure can only be initiated if no UE initiated 5GMM specific procedure is ongoing for each of the access network(s) that the UE is camping in. 2) Initiated by the network and used to request the establishment of an N1 NAS signalling connection or to request re-establishment of user-plane resources for the PDU session(s) associated with 3GPP access or to request re-establishment of user-plane resources of the PDU session(s) associated with non-3GPP access over 3GPP access; not applicable for the non-3GPP access network: paging.",
    "3) Initiated by the network and used to request re-establishment of user-plane resources of the PDU session(s) associated with non-3GPP access over 3GPP access or to deliver 5GSM downlink signalling messages associated with non-3GPP access over 3GPP access, when the UE is in 5GMM-CONNECTED mode over 3GPP access and in 5GMM-IDLE mode over non-3GPP access; or Initiated by the network and used to request re-establishment of user-plane resources of the PDU session(s) associated with 3GPP access over 3GPP access or to deliver downlink signalling associated with 3GPP access over 3GPP access, when the UE is in 5GMM-CONNECTED mode over non-3GPP access, and when the UE is in 5GMM-IDLE mode over 3GPP access and not in MICO mode: notification.",
    "NOTE 1: In NB-N1 mode, the UE NAS using 5GS services with control plane CIoT 5GS optimization can wait for the lower layers to complete the transmission of the previous UL NAS TRANSPORT messages carrying control plane user data before providing subsequent NAS messages. Other implementations are possible. NOTE 2: When providing NAS messages to the lower layers for transmission, the UE NAS using 5GS services with control plane CIoT 5GS optimization can prioritize sending NAS signalling messages over the UL NAS TRANSPORT messages carrying control plane user data. How the UE performs this prioritization is implementation specific.",
    "In the following subclauses, the possible 5GMM sublayer states of the UE are described and shown in Figure 5.1.3.2.1.1.1. 5GMM- REGISTERED- INITIATED 5GMM-NULL 5GMM- DEREGISTERED- INITIATED 5GMM-DEREGISTERED 5GMM-REGISTERED Any state - enable N1 mode - disable N1 mode - Deregistration requested (power off) - Initial registration requested - Initial registration rejected or failed - Non-initial registration rejected (e.g. #3, #6, #7) - NW-initiated deregistration requested - Initial registration accepted - Non-initial registration accepted - Non-initial registration rejected or failed (other causes) - Non-initial registration requested - NW-initiated deregistration requested - Local deregistration - Deregistration requested (not power off) - Deregistration accepted 5GMM-SERVICE- REQUEST-INITIATED - SR initiated - SR accepted - SR rejected or failed (e.g. #22, #28) NOTE: Not all possible transitions are shown in this figure.",
    "Figure 5.1.3.2.1.1.1: 5GMM main states in the UE In the state 5GMM-DEREGISTERED, no 5GMM context has been established and the UE location is unknown to the network and hence it is unreachable by a network. In order to establish a 5GMM context, the UE shall start the initial registration procedure. A UE enters the state 5GMM-DEREGISTERED-INITIATED after it has requested release of the 5GMM context by starting the de-registration procedure and is waiting for a response from the network. The state 5GMM-DEREGISTERED is subdivided into a number of substates as described in this subclause. The following substates are not applicable to non-3GPP access: a) 5GMM-DEREGISTERED.PLMN-SEARCH: b) 5GMM-DEREGISTERED.NO-CELL-AVAILABLE; and c) 5GMM-DEREGISTERED.eCALL-INACTIVE. Valid subscriber data are available for the UE before it enters the substates, except for the substate 5GMM- DEREGISTERED.NO-SUPI.",
    "The substate 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION is chosen in the UE if the initial registration procedure failed due to a missing response from the network or due to the circumstances described in subclauses 5.2.2.3.7, 5.5.1.2.4, 5.5.1.2.5, 5.5.1.2.7, 5.5.1.3.4, 5.5.2.3.2 and 5.5.2.3.4. No 5G cell can be selected. This substate is entered either after a first intensive search failed when in substate 5GMM- DEREGISTERED.PLMN-SEARCH or unavailability period is activated for 3GPP access. Cells are searched for at a low rhythm. No 5GS services are offered. This substate is not applicable to non-3GPP access. The state 5GMM-REGISTERED is subdivided into a number of substates as described in this subclause. The following substates are not applicable to non-3GPP access: a) 5GMM-REGISTERED.PLMN-SEARCH: b) 5GMM-REGISTERED.NON-ALLOWED-SERVICE; and c) 5GMM-REGISTERED.NO-CELL-AVAILABLE.",
    "The substate 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE is chosen by the UE if the registration procedure for mobility and periodic registration update failed due to a missing response from the network, or due to the circumstances described in subclauses 5.3.9, 5.5.1.3.5 and 5.5.1.3.7. No 5GMM procedure except registration procedure for mobility and periodic registration update (i.e. the 5GS registration type IE set to \"mobility registration updating\" or \"periodic registration updating\" in the REGISTRATION REQUEST message) and de- registration procedure, shall be initiated by the UE in this substate. No data shall be sent or received. NOTE 1: The registration procedure for mobility and periodic registration update over non-3GPP access can be triggered by, e.g. the change of S1 UE network capability or renegotiating some parameters.",
    "NOTE 2: This substate is entered irrespective whether: a) the UE is camped on a cell which is in the registration area, and the current TAI is not in the list of \"allowed tracking areas\"; or b) the current TAI is in the list of \"non-allowed tracking areas\". 5G coverage has been lost, MICO mode is active in the UE or unavailability period is activated for 3GPP access. If MICO mode is active, the UE can deactivate MICO mode at any time by activating the AS layer when the UE needs to send mobile originated signalling or user data. Otherwise, the UE shall not initiate any 5GMM procedure except for cell and PLMN reselection. This substate is not applicable to non-3GPP access.",
    "In the following subclauses, the possible 5GMM sublayer states of the network are described and shown in Figure 5.1.3.2.3.1.1. 5GMM- COMMON-PROCEDURE- INITIATED 5GMM- DEREGISTERED- INITIATED 5GMM-DEREGISTERED 5GMM-REGISTERED - Common procedure requested - Common procedure failed - Lower layer failure - Common procedure successful - Initial registration successful - Common procedure requested - Initial registration successful - NW-initiated deregistration requested - Deregistration accepted - UE-initiated deregistration requested - Non-initial registration rejected (e.g. #3, #6, #7) - SR rejected (e.g. #3, #6, #7) - Implicit deregistration NOTE: Not all possible transitions are shown in this figure. Figure 5.1.3.2.3.1.1: 5GMM main states in the network In the state 5GMM-REGISTERED, a 5GMM context has been established. Additionally, one or more PDU session(s) may be established at the network.",
    "If both 5GMM and EMM are enabled, a UE, operating in single-registration mode, shall maintain one common registration for 5GMM for 3GPP access and EMM. Coordination between 5GMM for 3GPP access and EMM for a UE, which is capable of N1 mode and S1 mode and operates in dual-registration mode, is not needed, except as specified in subclause 4.8.3. The coordination between 5GMM for 3GPP access and EMM in subclauses 5.1.4.2 and 5.1.4.3 only applies to the UEs operating in single-registration mode. Regarding the coordination of \"SIM/USIM considered invalid\" and \"USIM considered invalid for 5GS services\" between the various mobility management entities see subclause 5.1.5. Coordination between 5GMM and GMM states is not required.",
    "Regardless whether the UE is operating in single-registration mode or dual-registration mode, a) if the UE considers the SIM/USIM invalid for any of: 3GPP access in N1 mode, S1 mode, A/Gb mode or Iu mode, then it considers the SIM/USIM invalid for all of them; and b) if the UE considers the USIM invalid for 5GS services for any of: 3GPP access in N1 mode, S1 mode, A/Gb mode or Iu mode, then it considers the USIM invalid for 5GS services for all of them. The state 5GMM-DEREGISTERED is entered in the UE, when: a) the de-registration is performed either by the UE or by the network (see subclause 5.5.2); b) the registration request is rejected by the AMF (see subclause 5.5.1.2.5 and 5.5.1.3.5); c) the service request is rejected by the AMF (see subclause 5.6.1); d) the UE is switched on; or e) the UE registered for emergency services is in 5GMM-IDLE mode and its periodic registration update timer expires (see subclause 5.3.7).",
    "In state 5GMM-DEREGISTERED, the UE shall behave according to the substate as explained in subclause 5.2.2.3. The UE shall initiate an initial registration procedure if the timer T3346 is not running. If timer T3346 is running, the UE shall initiate an initial registration procedure on the expiry of timer T3346. The UE may initiate an initial registration procedure for emergency services or for a UE configured for high priority access in selected PLMN or SNPN, even if timer T3346 is running. The UE shall perform PLMN selection or SNPN selection. If a new PLMN or SNPN is selected, the UE shall reset the registration attempt counter and initiate the registration procedure for initial registration (see subclause 5.5.1.2.2). If the selected cell in the new PLMN is known not to be able to provide normal service, the UE may initiate the registration procedure for initial registration for emergency services.",
    "The UE camps on a suitable cell or an acceptable cell in a PLMN selected as specified in 3GPP TS 23.122 [5] but initiates no 5GMM signalling with the network and ignores any paging requests. The UE shall leave substate 5GMM-DEREGISTERED.eCALL-INACTIVE state only when one of the following events occur: a) if the USIM is removed, the UE enters substate 5GMM-DEREGISTERED.NO-SUPI; b) if coverage is lost, the UE enters substate 5GMM-DEREGISTERED.PLMN-SEARCH; c) if the UE is deactivated (e.g. powered off) by the user, the UE enters state 5GMM-NULL; d) if the UE receives a request from upper layers to establish an eCall over IMS, the UE enters state 5GMM- DEREGISTERED.ATTEMPTING-REGISTRATION.",
    "The UE then uses the relevant 5GMM and 5GSM procedures to establish the eCall over IMS at the earliest opportunity; or e) if the UE receives a request from upper layers to establish a call to an HPLMN designated non-emergency MSISDN or URI for test or terminal reconfiguration service, the UE enters state 5GMM- DEREGISTERED.ATTEMPTING-REGISTRATION. Once the registration procedure is completed, the UE uses the relevant 5GMM and 5GSM procedures to establish the non-emergency call. The state 5GMM-REGISTERED is entered at the UE, when the initial registration procedure is performed by the UE (see subclause 5.5.1.2.2).",
    "In state 5GMM-REGISTERED, the UE shall behave according to the substate as explained in subclause 5.2.3.2. The UE shall behave as specified in subclause 5.3.5. The UE in 5GMM-REGISTERED.NON-ALLOWED-SERVICE substate, if configured for eCall only mode as specified in 3GPP TS 31.102 [22], shall perform the eCall inactivity procedure at expiry of timer T3444 or timer T3445 (see subclause 5.5.3). The UE shall perform PLMN selection or SNPN selection. If a new PLMN is selected, the UE shall reset the registration attempt counter and initiate a registration procedure for mobility and periodic registration update (see subclause 5.5.1.3).",
    "If a new SNPN is selected, the UE shall reset the registration attempt counter and initiate a mobility registration update if the UE supports access to an SNPN using credentials from a credentials holder or when the SNPNs are equivalent SNPNs or both (see subclause 4.14.2) and the last registered SNPN and the newly selected SNPN are both identified by globally-unique SNPN identities. Otherwise the UE, may perform de-registration locally and shall initiate a registration procedure for initial registration (see subclause 5.5.1.2.2).If the selected cell in the new PLMN is known not to be able to provide normal service, the UE may perform de-registration locally and initiate an initial registration for emergency services. When the UE is in 5GMM-IDLE mode over 3GPP access and needs to transmit an initial NAS message, the UE shall request the lower layer to establish an RRC connection.",
    "Upon indication from the lower layers that the RRC connection has been established, the UE shall consider that the N1 NAS signalling connection over 3GPP access is established and enter 5GMM-CONNECTED mode over 3GPP access. When the UE is in 5GMM-IDLE mode over non-3GPP access, and the UE receives an indication from the lower layers of non-3GPP access, that the access stratum connection is established between the UE and the network, the UE shall send an initial NAS message, consider the N1 NAS signalling connection is established and enter 5GMM- CONNECTED mode over non-3GPP access. Initial NAS messages are: a) REGISTRATION REQUEST message; b) DEREGISTRATION REQUEST message; c) SERVICE REQUEST message; and d) CONTROL PLANE SERVICE REQUEST.",
    "If the UE is capable of both N1 mode and S1 mode and lower layers provide an indication that the current E-UTRA cell is connected to both EPC and 5GCN, for the routing of the REGISTRATION REQUEST message during the initial registration procedure to the appropriate core network (EPC or 5GCN), the UE NAS provides the lower layers with the selected core network type information.",
    "For the routing of the initial NAS message to the appropriate AMF, if the UE holds a 5G-GUTI or 4G-GUTI, the UE NAS provides the lower layers with the UE identity according to the following rules: a) if the registration procedure for mobility and periodic registration update was triggered due to the last CONFIGURATION UPDATE COMMAND message containing the Configuration update indication IE with the Registration bit set to \"registration requested\" and including: 1) no other parameters; 2) one or both of the Allowed NSSAI IE and the Configured NSSAI IE; or 3) the Network slicing indication IE with the Network slicing subscription change indication set to \"Network slicing subscription changed\"; the UE NAS shall not provide the lower layers with the 5G-S-TMSI or the registered GUAMI; b) if the service request procedure was initiated over non-3GPP access, the UE NAS shall provide the lower layers with the registered GUAMI, but shall not provide the lower layers with the 5G-S-TMSI; c) if the initial NAS message other than the SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message was initiated over untrusted non-3GPP access, the UE NAS shall provide the lower layers with the GUAMI of the 5G-GUTI that the UE NAS has selected as specified in the subclause 5.5.1.2.2 and 5.5.1.3.2, but shall not provide the lower layers with the 5G-S-TMSI; if the initial NAS message other than the SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message was initiated over trusted non-3GPP access, the UE NAS shall provide the lower layers with the 5G- GUTI, if available, otherwise shall provide the lower layers with the SUCI; if the UE is the 5G-RG and the initial NAS message other than the SERVICE REQUEST or CONTROL PLANE SERVICE REQUEST message was initiated over wireline access, the UE NAS shall provide the lower layers with the GUAMI of the 5G-GUTI that the UE NAS has selected as specified in the subclause 5.5.1.2.2 and 5.5.1.3.2, if available, otherwise shall not provide the lower layers with any UE identity; d) if the UE does not hold a 5G-GUTI that was previously assigned by the same PLMN with which the UE is performing the registration procedure and if: 1) the UE operating in the single-registration mode performs a registration procedure for mobility and periodic registration update indicating \"mobility registration updating\" following an inter-system change from S1 mode to N1 mode; or 2) the UE which was previously registered in S1 mode before entering state EMM-DEREGISTERED, performs an initial registration procedure, the UE has received the interworking without N26 interface indicator set to \"interworking without N26 interface not supported\" from the network, and the UE holds a 4G-GUTI; then the UE NAS provides the lower layers with a GUAMI part of the 5G-GUTI mapped from 4G-GUTI as specified in 3GPP TS 23.003 [4] with an indication that the GUAMI is mapped from EPS; or e) otherwise: 1) if the tracking area of the current cell is in the registration area, the UE NAS shall provide the lower layers with the 5G-S-TMSI, but shall not provide the registered GUAMI to the lower layers; or 2) if the tracking area of the current cell is not in the registration area, the UE NAS shall provide the lower layers with the GUAMI of the 5G-GUTI that the UE NAS has selected as specified in the subclauses 5.5.1.2.2 and 5.5.1.3.2, but shall not provide the lower layers with the 5G-S-TMSI.",
    "For 3GPP access, if: a) the UE is operating in single-registration mode, the UE does not hold a 5G-GUTI and the UE does not hold a 4G-GUTI; or b) the UE is operating in dual-registration mode and the UE does not hold a 5G-GUTI; the UE NAS does not provide the lower layers with the 5G-S-TMSI or the registered GUAMI. For untrusted non-3GPP access, if the UE does not hold a 5G-GUTI and the UE does not hold a 4G-GUTI, the UE NAS does not provide the lower layers with the 5G-S-TMSI or the registered GUAMI. For trusted non-3GPP access, if the UE does not hold a 5G-GUTI and the UE does not hold a 4G-GUTI, the UE NAS provides the lower layers with the SUCI. For 3GPP access, if a UE operating as an IAB-node performs a registration procedure or service request procedure (see 3GPP TS 23.501 [8]), the UE NAS shall indicate to the lower layers that the establishment of the NAS signalling connection is for a UE operating as an IAB-node.",
    "The UE NAS also provides the lower layers with the identity of the selected PLMN (see 3GPP TS 38.331 [30]) if the UE is not operating in SNPN access operation mode. If the UE is operating in SNPN access operation mode, the UE NAS provides the lower layers with the SNPN identity of the selected SNPN. In a shared network, the UE shall choose one of the PLMN identity(ies) or SNPN identity(ies) as specified in 3GPP TS 23.122 [5] and 3GPP TS 24.502 [18]. The UE NAS layer may provide the lower layers with an NSSAI as specified in subclause 4.6.2.3. If the UE performs initial registration for onboarding services in SNPN or is registered for onboarding services in SNPN, the UE NAS layer shall provide the lower layers with an indication that the connection is for onboarding. This subclause is only applicable for UE's 5GMM mode over 3GPP access. The 5GMM-CONNECTED mode with RRC inactive indication is not supported when the UE is in NB-N1 mode.",
    "The UE is in 5GMM-CONNECTED mode with RRC inactive indication when the UE is in: a) 5GMM-CONNECTED mode over 3GPP access at the NAS layer; and b) RRC_INACTIVE state at the AS layer (see 3GPP TS 38.300 [27]). Unless stated otherwise, the UE behaviour in 5GMM-CONNECTED mode with RRC inactive indication follows the UE behaviour in 5GMM-CONNECTED over 3GPP access, except that: a) the UE shall apply the mobility restrictions; and b) the UE shall perform the PLMN selection procedures as in 5GMM-IDLE mode over 3GPP access. The UE shall transition from 5GMM-CONNECTED mode over 3GPP access to 5GMM-CONNECTED mode with RRC inactive indication upon receiving an indication from the lower layers that the RRC connection has been suspended. NOTE 1: Any pending procedure or uplink data packet when receiving an indication from the lower layers that the RRC connection has been suspended, triggers a request to the lower layers to transition to RRC_CONNECTED state.",
    "This is also the case when the pending procedure or uplink data packet triggered a previous request to the lower layers to transition to RRC_CONNECTED state. If the UE in 3GPP access is configured for eCall only mode as specified in 3GPP TS 31.102 [22] then: - if the UE with the N1 NAS signalling connection established for eCall over IMS moved to 5GMM- CONNECTED mode with RRC inactive indication, the UE shall start timer T3444; and - if the UE with the N1 NAS signalling connection established for a call to an HPLMN designated non-emergency MSISDN or URI for test or terminal reconfiguration service moved to 5GMM-CONNECTED mode with RRC inactive indication, the UE shall start timer T3445.",
    "Upon: a) a trigger of a procedure which requires sending of a NAS message different from a REGISTRATION REQUEST message with the NG-RAN-RCU bit of the 5GS update type IE set to \"UE radio capability update needed\"; b) an uplink user data packet to be sent for a PDU session with suspended user-plane resources; c) a trigger to request resources for 5G ProSe direct discovery over PC5 or 5G ProSe direct communication over PC5; d) a trigger to request resources for V2X communication over PC5 (see 3GPP TS 23.287 [6C]); or e) a trigger to request resources for A2X communication over PC5 (see 3GPP TS 23.256 [6AB]); the UE in 5GMM-CONNECTED mode with RRC inactive indication over 3GPP access shall request the lower layers to transition to RRC_CONNECTED state (see 3GPP TS 38.300 [27]).",
    "For case a) above, if the trigger of the procedure is to request the establishment of a PDU session associated with an S- NSSAI included in the partially allowed NSSAI, the UE shall request the lower layers to transition to RRC_CONNECTED state only if the current TA is in the list of TAs where the S-NSSAI is allowed. For case a) above, if the trigger of the procedure is to request the establishment of a PDU session associated with an S- NSSAI which has S-NSSAI location validity information, the UE shall request the lower layers to transition to RRC_CONNECTED state only if the current cell is in the NS-AoS of the S-NSSAI. For case b) above, the UE which supports S-NSSAI location validity information, and which has received S-NSSAI location validity information from the AMF, shall request the lower layers to transition to RRC_CONNECTED state only if the UE is inside the NS-AoS with respect to the S-NSSAI which is associated with the PDU session with suspended user-plane resources.",
    "For case b) above, if the PDU session is associated with an S-NSSAI included in the partially allowed NSSAI, the UE shall request the lower layers to transition to RRC_CONNECTED state only if the current TA is in the list of TAs where the S-NSSAI is allowed. NOTE 2: If the UE supports Small Data Transmission (SDT) (see 3GPP TS 38.300 [27]), the following applies: a) if the UE due to pending uplink NAS messages or user data packets is requesting the lower layers to transition to RRC_CONNECTED state, but has not received a response from the lower layers, the UE can send the pending NAS messages or user data packets to the lower layers, and can receive multiple downlink NAS messages or multiple downlink user data packets from the lower layers while the UE remains in 5GMM-CONNECTED mode with RRC inactive indication over 3GPP access (i.e., without transitioning to 5GMM-CONNECTED mode).",
    "When the NAS layer triggers the transmission of pending uplink NAS messages or user data packets, and if the SDT is ongoing, the NAS layer will receive the response from the lower layers only after the SDT session has completed or failed; b) the NAS layer is not aware of the classification of NAS messages or the user data packets as belonging to the SDT session at the lower layers; and c) the setting of access category and the RRC establishment cause indicated to the lower layers when sending the pending uplink user data packets while the UE remains in 5GMM-CONNECTED mode with RRC inactive indication, is left to implementation.",
    "Upon a trigger to send a REGISTRATION REQUEST message with the NG-RAN-RCU bit of the 5GS update type IE set to \"UE radio capability update needed\", the UE in 5GMM-CONNECTED mode with RRC inactive indication shall move to 5GMM-IDLE mode over 3GPP access and proceed with the registration procedure for mobility and periodic registration update as specified in subclause 5.5.1.3.2. The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-CONNECTED mode over 3GPP access upon receiving an indication from the lower layers that the UE has transitioned to RRC_CONNECTED state (see 3GPP TS 38.300 [27]). NOTE 3: The AMF can be aware of the transition between 5GMM-CONNECTED mode and 5GMM- CONNECTED mode with RRC inactive indication for a UE (see 3GPP TS 23.502 [9]).",
    "The UE shall trigger a transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode upon selection of a PLMN or SNPN that is not an equivalent PLMN or SNPN to the registered PLMN or SNPN. The UE shall not trigger a transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode upon entering a new PLMN or SNPN which is in the list of equivalent PLMNs or SNPNs. The UE shall trigger a transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode upon receiving REFRESH command from the UICC as specified in subclause 5.4.5.3.3. If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers that the RRC connection has been suspended, the UE shall stay in 5GMM-CONNECTED mode with RRC inactive indication. The UE shall re-initiate any pending procedure that had triggered the request to the lower layers to transition to RRC_CONNECTED state, if still needed.",
    "When the UE in 5GMM-CONNECTED mode with RRC inactive indication receives a fallback indication from lower layers, and the UE has no pending NAS procedure and no pending uplink user data for PDU session(s) with user-plane resources already established, the UE shall: a) enter 5GMM-IDLE mode; and b) initiate the registration procedure for mobility and periodic registration update as specified for case o) in subclause 5.5.1.3.2. If the UE requests the lower layers to transition to RRC_CONNECTED state at initiation of a registration procedure, a service request procedure or a de-registration procedure, upon fallback indication from lower layers, the UE shall: - enter 5GMM-IDLE mode; - proceed with the pending procedure; and - if the pending procedure is a service request or registration request procedure and the SERVICE REQUEST message, the CONTROL PLANE SERVICE REQUEST message or the REGISTRATION REQUEST message does not include UE request type IE with Request type value set to \"NAS signalling connection release\", the UE shall include the Uplink data status IE in the SERVICE REQUEST message, the CONTROL PLANE SERVICE REQUEST message or in the REGISTRATION REQUEST message, indicating the PDU session(s) without active user-plane resources for which the UE has pending user data to be sent, if any, and the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any (see subclauses 5.5.1.3 and 5.6.1 for further details).",
    "If the UE requests the lower layers to transition to RRC_CONNECTED state for other reason than initiation of a registration procedure, or for other reason than a service request procedure, or for other reason than a de-registration procedure, upon fallback indication from lower layers, the UE shall: 1) enter 5GMM-IDLE mode; 2) initiate the service request procedure and include the Uplink data status IE in the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any (see subclause 5.6.1 for further details).",
    "If the procedure that triggered the request to the lower layers to transition to RRC_CONNECTED state is the UE- initiated NAS transport procedure and the UE had SMS, location services message, or CIoT user data to send, the UE shall also include the SMS, location services message, or CIoT user data in the CONTROL PLANE SERVICE REQUEST message as described in subclause 5.6.1.2.2; and 3) upon successful service request procedure completion, proceed with any pending procedure.",
    "If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives a fallback indication from lower layers, and the UE has pending uplink user data for PDU session(s) with user-plane resources already established but no pending NAS procedure, the UE shall: 1) enter 5GMM-IDLE mode; and 2) initiate the service request procedure and include the Uplink data status IE in the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication (see subclause 5.6.1 for further details).",
    "In the above cases when the UE receives a fallback indication from lower layers, if the UE is in non-allowed area or not in allowed area, the UE shall behave as specified in subclause 5.3.5. If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers that the resumption of the RRC connection has failed, and: a) if the lower layers indicate that access barring is applicable for all access categories except categories 0 and 2, or access barring is applicable for all access categories except category 0, the UE shall: 1) stay in 5GMM-CONNECTED mode with RRC inactive indication; b) else, the UE shall: 1) enter 5GMM-IDLE mode; and 2) if the UE - does not have pending uplink user data for PDU session(s) with user-plane resources already established, initiate the registration procedure for mobility and periodic registration update used for mobility (i.e. the 5GS registration type IE set to \"mobility registration updating\" in the REGISTRATION REQUEST message) for N1 NAS signalling connection recovery as specified for case f) in subclause 5.5.1.3.2; or - has pending uplink user data for PDU session(s) with user-plane resources already established or has pending NAS procedure other than a registration, service request, or de-registration procedure, then initiate the service request procedure for N1 NAS signalling connection recovery as specified for case i) or j) in subclause 5.6.1.1. NOTE 4: An indication from the lower layer that the RRC connection has been released with cause \"RRC resume failure\" can be considered as an indication that the resumption of the RRC connection has failed.",
    "The UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode over 3GPP access upon receiving from the lower layers: a) indication of transition from RRC_INACTIVE state to RRC_IDLE state; or b) indication of cell selection to E-UTRAN or another RAT that the UE supports.",
    "If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers about the cell (re-)selection to different RAT that the UE supports, the UE shall initiate the registration procedure for mobility or periodic registration update used for mobility (i.e. the 5GS registration type IE set to \"mobility registration updating\" in the REGISTRATION REQUEST message) as specified in subclause 5.5.1.3.2. If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers of a transition from RRC_INACTIVE state to RRC_IDLE state and 5GMM-REGISTERED.LIMITED-SERVICE is entered, the UE shall subsequently upon entering state 5GMM-REGISTERED.NORMAL-SERVICE and if there is no uplink user data or signalling pending, initiate the registration procedure for mobility and periodic registration update used for mobility (i.e. the 5GS registration type IE set to \"mobility registration updating\" in the REGISTRATION REQUEST message) for N1 NAS signalling connection recovery as specified in subclause 5.5.1.3.2. If the UE in 5GMM-CONNECTED mode with RRC inactive indication receives an indication from the lower layers about RAN paging and the MUSIM UE decides not to initiate the service request procedure with service type set to \"mobile terminated services\" or control plane service type set to \"mobile terminating request\" to respond to the RAN paging, the UE may initiate the service request procedure and set request type to \"NAS signalling connection release\" in the UE request type IE and service type to \"signalling\" in the SERVICE REQUEST message or set request type to \"NAS signalling connection release\" in the UE request type IE and control plane service type set to \"mobile originating request\" in the CONTROL PLANE SERVICE REQUEST message to reject the RAN paging as specified in subclause 5.6.1.2 for case o of subclause 5.6.1.1. The UE may include its paging restriction preferences in the Paging restriction IE in the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message as specified in subclause 5.6.1.2 for case o of subclause 5.6.1.1. NOTE 5: The interworking between the NAS layer and the AS layer triggered by RAN paging is up to UE implementation.",
    "NOTE 6: As an implementation option, the MUSIM UE is allowed to not respond to RAN paging based on the information available in the paging message, e.g. voice service indication. Upon receiving AMF paging indication from the lower layers, the UE shall transition from 5GMM-CONNECTED mode with RRC inactive indication to 5GMM-IDLE mode over 3GPP access and handle the AMF paging same as the paging request received in the 5GMM-IDLE mode over 3GPP access as specified in subclause 5.6.1. If the UE supporting the reconnection to the network due to RAN timing synchronization status change has been requested to reconnect to the network upon receiving an indication of a change in the RAN timing synchronization status (see subclauses 5.4.4.2, 5.5.1.2.4, and 5.5.1.3.4) and the UE receives an indication of a change in the RAN timing synchronization status, the UE in 5GMM-CONNECTED mode with RRC inactive indication shall request the lower layers to transition to RRC_CONNECTED state.",
    "A temporary user identity for 5GS-based services, the 5G globally unique temporary identity (5G-GUTI), is used for identification within the signalling procedures. In case of PLMN the 5G-GUTI is globally unique and in case of SNPN the 5G-GUTI is unique within an SNPN. When the UE is registered to the same PLMN or SNPN over 3GPP and non- 3GPP access, the UE and the AMF maintain one 5G-GUTI that is common to both 3GPP and non-3GPP access. When the UE is required to delete the 5G-GUTI according to a NAS procedure, the UE shall delete the 5G-GUTI only if it is not registered to the same PLMN or SNPN through other access. When the UE is registered to different PLMNs or SNPNs over 3GPP access and non-3GPP access, the UE maintains two 5G-GUTIs, a 5G-GUTI for the registration with a PLMN or SNPN over the 3GPP access and another 5G-GUTI for the registration with another PLMN or SNPN over the non-3GPP access.",
    "In the paging and service request procedures, a shortened form of the 5G-GUTI, the 5G S- temporary mobile subscriber identity (5G-S-TMSI), is used to enable more efficient radio signalling. The purpose of the 5G-GUTI and 5G-S-TMSI is to provide identity confidentiality, i.e., to protect a user from being identified and located by an intruder. The structure of the 5G-GUTI and its derivatives are specified in 3GPP TS 23.003 [4]. The 5G-GUTI has two main components (see 3GPP TS 23.501 [8]): a) the GUAMI; and b) the 5G-TMSI that provides an unambiguous identity of the UE within the AMF(s) identified by the GUAMI. The 5G-S-TMSI has three main components: a) the AMF set ID that uniquely identifies the AMF set within the AMF region; b) the AMF pointer that identifies one or more AMFs within the AMF set; and c) the 5G-TMSI. A UE supporting N1 mode includes a valid 5G-GUTI, if any is available, in the REGISTRATION REQUEST and DEREGISTRATION REQUEST messages.",
    "In the SERVICE REQUEST message, the UE includes a valid 5G-S-TMSI as user identity.",
    "The AMF shall assign a new 5G-GUTI for a particular UE: a) during a successful initial registration procedure; b) during a successful registration procedure for mobility registration update; c) after a successful service request procedure invoked as a response to a paging request from the network and before the: 1) release of the N1 NAS signalling connection; or 2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend indication; as specified in subclause 5.4.4.1; and d) after the AMF receives an indication from the lower layers that it has received the NGAP UE context resume request message as specified in 3GPP TS 38.413 [31] for a UE in 5GMM-IDLE mode with suspend indication and this resumption is a response to a paging request from the network, and before the: 1) release of the N1 NAS signalling connection; or 2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend indication; as specified in subclause 5.4.4.1. The AMF should assign a new 5G-GUTI for a particular UE during a successful registration procedure for periodic registration update.",
    "The AMF may assign a new 5G-GUTI at any time for a particular UE by performing the generic UE configuration update procedure. If a new 5G-GUTI is assigned by the AMF, the UE and the AMF handle the 5G-GUTI as follows: a) Upon receipt of a 5GMM message containing a new 5G-GUTI, the UE considers the new 5G-GUTI as valid and the old 5G-GUTI as invalid, stops timer T3519 if running, and deletes any stored SUCI. The new 5G-GUTI is stored in a non-volatile memory in the USIM if the corresponding file is present in the USIM, else in the non- volatile memory in the ME, as described in annex C. b) The AMF considers the old 5G-GUTI as invalid as soon as an acknowledgement for a registration or generic UE configuration update procedure is received. Service area restrictions are applicable only to 3GPP access and to wireline access. Subclause 5.3.5.2 applies when the UE accesses 5GCN over 3GPP access.",
    "Subclause 5.3.5.3 applies when the 5G-RG or the W-AGF acting on behalf of an FN-CRG (or on behalf of the N5GC device) access 5GCN over wireline access. NOTE: Service area restrictions are not applicable for the W-AGF acting on behalf of the FN-BRG. The UE can request the use of mobile initiated connection only (MICO) mode during the registration procedure (see 3GPP TS 23.501 [8] and 3GPP TS 23.502 [9]). The UE shall not request use of MICO mode over non-3GPP access.",
    "Furthermore, the UE in 3GPP access shall not request the use of MICO mode during: a) a registration procedure for initial registration for emergency services (see subclause 5.5.1.2); b) a registration procedure for initial registration for initiating an emergency PDU session (see subclause 5.5.1.2); c) a registration procedure for mobility and periodic registration update (see subclause 5.5.1.3) for initiating an emergency PDU session if the UE is in the state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION- UPDATE; or d) a registration procedure for mobility and periodic registration update (see subclause 5.5.1.3) when the UE has an emergency PDU session established. If the UE requests the use of MICO mode, the network can accept the use of MICO mode by providing a MICO indication when accepting the registration procedure. The UE may use MICO mode only if the network has provided the MICO indication IE during the last registration procedure.",
    "The UE may also request an active time value together with the MICO mode indication during the registration procedure. If the UE requests an active time by including an active time value, the UE may also include the Requested T3512 value IE to request a particular T3512 value to be allocated. If the network accepts the use of MICO mode and does not include an active time value in T3324 IE to the UE, the AMF may include an \"all PLMN registration area allocated\" indication in the MICO indication IE to the UE. If the UE indicated the support for strictly periodic registration timer in the MICO indication IE to the network, the network may include a \"strictly periodic registration timer supported\" indication in the MICO indication IE to the UE. If the UE requested the use of active time by including an active time value and the network accepts the use of MICO mode and the use of active time, the AMF shall include an active time value in the T3324 IE to the UE.",
    "If the AMF indicates active time value to the UE, AMF should not indicate \"all PLMN registration area allocated\" indication in the MICO indication IE to the UE. Upon entering 5GMM-IDLE mode, AMF shall start the active timer with the active time value indicated to the UE and shall consider the UE is reachable for paging as long as the timer is running. If the UE enters 5GMM-CONNECTED mode over 3GPP access when the active timer is running, the AMF shall stop the active timer. NOTE 1: The active time value assigned by AMF can be different from the active time value requested by the UE. AMF assigns the active time value based on several factors, e.g. local configuration, expected UE behaviour, UE requested active time value, UE subscription information, network policies etc.",
    "If the UE requested an active time and a requested T3512 value and the network accepts the use of MICO mode, the AMF shall take the UE requested T3512 value into consideration when assigning a value of timer T3512 to the UE. If the network accepts the use of MICO mode, the UE may deactivate the AS layer and activate MICO mode by entering the state 5GMM-REGISTERED.NO-CELL-AVAILABLE if: a) the UE is in 5GMM-IDLE mode over 3GPP access; b) the UE is in the 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON-ALLOWED- SERVICE (as described in subclause 5.3.5.2) state for 3GPP access; and c) no T3324 value is received from the network. If the network accepts the use of MICO mode and indicates an active time value to the UE in a successful registration procedure, the UE shall start the timer T3324 with the value received from the network after entering 5GMM-IDLE mode over 3GPP access.",
    "At the expiry of the timer T3324, the UE may deactivate the AS layer and activate MICO mode by entering the state 5GMM-REGISTERED.NO-CELL-AVAILABLE if the UE is in the 5GMM- REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON-ALLOWED-SERVICE (as described in subclause 5.3.5.2) state for 3GPP access. If the UE enters 5GMM-CONNECTED mode over 3GPP access when the timer T3324 is running, the UE shall stop the timer T3324. When MICO mode is activated, all NAS timers are stopped and associated procedures aborted except for timers T3512, T3346, T3447, T3448, T3396, T3526, T3584, T3585, T3587 any back-off timers, T3245, T3247, any slice deregistration inactivity timers, the timer T controlling the periodic search for HPLMN or EHPLMN or higher prioritized PLMNs (see 3GPP TS 23.122 [5]) and the timer TSENSE controlling the periodic search for PLMNs satisfying the operator controlled signal level threshold (see 3GPP TS 23.122 [5]).",
    "NOTE 2: When MICO mode is activated and if the UE is also registered over the non-3GPP access, the AMF will not send a NOTIFICATION message with access type indicating 3GPP access over the non-3GPP access for PDU sessions associated with 3GPP access. The UE may deactivate MICO mode and activate the AS layer at any time. Upon deactivating MICO mode, the UE may initiate 5GMM procedures (e.g., for the transfer of mobile originated signalling or user data). When an emergency PDU session is successfully established after the MICO mode was enabled, the UE and the AMF shall locally disable MICO mode. The UE and the AMF shall not enable MICO mode until the AMF accepts the use of MICO mode in the next registration procedure. To enable an emergency call back, the UE should wait for a UE implementation-specific duration of time before requesting the use of MICO mode after the completion of the emergency services.",
    "If the AMF accepts the use of MICO mode and does not indicate \"strictly periodic registration timer supported\" in the MICO indication IE to the UE, the AMF starts the implicit de-registration timer for 3GPP access when entering 5GMM-IDLE mode for 3GPP access. If AMF accepts the use of MICO mode and indicates \"strictly periodic registration timer supported\" in the MICO indication IE to the UE, AMF shall start the strictly periodic monitoring timer with T3512 value indicated in the T3512 value IE after the registration procedure is completed. The AMF shall neither stop nor reset the strictly periodic monitoring timer when the NAS signalling connection is established or released for the UE. If the strictly periodic monitoring timer expires when NAS signalling connection is established for the UE, AMF shall restart the strictly periodic monitoring timer with the T3512 value, otherwise AMF shall start the implicit de-registration timer.",
    "When an emergency PDU session is successfully established and the MICO mode is disabled, the UE shall stop timer T3512 if running and the AMF shall stop strictly periodic monitoring timer if running. The UE and the AMF shall behave as if no \"strictly periodic registration timer supported\" indication was given to the UE in the last registration attempt. Upon successful completion of an attach procedure or tracking area updating procedure after inter-system change from N1 mode to S1 mode (see 3GPP TS 24.301 [15]), the UE operating in single-registration mode shall locally disable MICO mode. After inter-system change from S1 mode to N1 mode, the UE operating in single-registration mode may re-negotiate MICO mode with the network during the registration procedure for mobility and periodic registration update.",
    "When MICO mode is activated for a UE that has joined one or more multicast MBS sessions, the UE may deactivate MICO mode and activate the AS layer at the MBS start time and at any of the scheduled activation times of a multicast MBS session, if any of those times are available as specified in 3GPP TS 23.247 [53]. When MICO mode is activated for a UE, the UE may deactivate MICO mode and activate the AS layer at the broadcast start time and at any of the scheduled broadcast activation times of a broadcast MBS session if any of those times are available as specified in 3GPP TS 23.247 [53]. NOTE 3: The UE can obtain via the service announcement an MBS start time, a sequence of scheduled activation times (e.g. a first time and a periodicity) or both, of a multicast MBS session as described in 3GPP TS 23.247 [53], or both, which is out of scope of this specification.",
    "Similarly, the UE can obtain via the service announcement a broadcast start time, a sequence of scheduled broadcast activation times (e.g. a first time and a periodicity) or both, of a broadcast MBS session as described in 3GPP TS 23.247 [53], which is out of scope of this specification. NOTE 4: Deactivating MICO mode and activating the AS layer at the MBS start time and the scheduled multicast activation times of a multicast MBS session allows the UE to listen to paging for a multicast MBS session which the has UE joined and to respond to it if received. How long the UE needs to listen to paging is up to UE implementation. Similarly, deactivating MICO mode and activating the AS layer at the broadcast start time and the scheduled broadcast activation times of a broadcast MBS session allows the UE to acquire the traffic of the broadcast MBS session.",
    "If the UE fails to receive paging or data for a multicast MBS session which the UE has joined or data for a broadast MBS session, the UE can as an implementation option initiate 5GMM procedures (e.g. for the transfer of mobile originated signalling or user data) to enter 5GMM-CONNECTED mode over 3GPP access and obtain via the service announcement a new start time, a sequence of scheduled activation times or both. When MICO mode is activated, the UE is allowed to join one or more multicast MBS sessions. In that case, the UE can deactivate MICO mode and activate the AS layer at the MBS start time and at any of the scheduled activation times of a multicast MBS session if any of those times are available as specified in 3GPP TS 23.247 [53], and the UE joins one or more multicast MBS sessions by using the UE-requested PDU session establishment procedure or the UE-requested PDU session modification procedure (see subclauses 6.4.1.2 and 6.4.2.2).",
    "NOTE 5: It is up to UE implementation whether to leave one or more multicast MBS sessions after each deactivation of each multicast MBS session and to re-join again at the next activation time or to keep a multicast MBS session that the UE has joined for the whole period of the session, as described in 3GPP TS 23.247 [53]. The AMF may detect 5GMM signalling congestion and perform general NAS level congestion control. Under the 5GMM signalling congestion conditions the AMF may reject 5GMM signalling requests from UEs as specified in 3GPP TS 23.501 [8].",
    "The AMF should not reject the following: a) requests for emergency services; b) requests for emergency services fallback; c) requests from UEs configured for high priority access in selected PLMN or SNPN; d) DEREGISTRATION REQUEST message; e) requests for mobile terminated services, triggered by paging or a notification procedure; f) requests for initial registration or mobility and periodic registration update, when emergency is indicated by lower layers; and g) requests for mobility registration update when the UE is reporting unavailability information due to discontinuous coverage. When general NAS level congestion control is active, the AMF may include a value for the mobility management back- off timer T3346 in the reject messages. The UE starts the timer T3346 with the value received in the 5GMM reject messages.",
    "To avoid that large numbers of UEs simultaneously initiate deferred requests, the AMF should select the value for the timer T3346 for the rejected UEs so that timeouts are not synchronised. When general NAS level congestion control is active, if the current SNPN is an SNPN selected for localized services in SNPN (see 3GPP TS 23.122 [5]), the AMF may include an appropriate cause value other than 5GMM cause #22 \"congestion\" (e.g., #74 \"Temporarily not authorized for this SNPN\") in the reject messages without including timer T3346 value, to allow the UE to enter state 5GMM-REGISTERED.PLMN-SEARCH or 5GMM- DEREGISTERED.PLMN-SEARCH and perform SNPN selection according to 3GPP TS 23.122 [5]. If the UE is registered in the same PLMN over the 3GPP access and non-3GPP access, and the UE receives the timer T3346 from the AMF, the timer T3346 shall apply to both 3GPP access and non-3GPP access.",
    "If the UE receives the paging message or NOTIFICATION message when timer T3346 is running and the UE is registered to the same PLMN over 3GPP access and non-3GPP access, the UE shall stop the timer T3346 for both accesses and respond to the paging message or NOTIFICATION message as specified in subclause 5.6.2 and subclause 5.6.3. NOTE 1: As an implementation option, MUSIM UE is allowed to not respond to paging based on the information available in the paging message, e.g. voice service indication. If the timer T3346 is running when the UE enters state 5GMM-DEREGISTERED, the UE remains switched on, and the USIM in the UE remains the same, then the timer T3346 is kept running until it expires or it is stopped.",
    "If the UE is switched off when the timer T3346 is running, the UE shall behave as follows when the UE is switched on and the USIM in the UE remains the same: let t1 be the time remaining for T3346 timeout at switch off and let t be the time elapsed between switch off and switch on. If t1 is greater than t, then the timer shall be restarted with the value t1 – t. If t1 is equal to or less than t, then the timer need not be restarted. If the UE is not capable of determining t, then the UE shall restart the timer with the value t1. If the UE enters a new PLMN or SNPN while timer T3346 is running, and the new PLMN or SNPN is not equivalent to the PLMN or SNPN where the UE started timer T3346, the UE shall stop timer T3346 when initiating 5GMM procedures in the new PLMN or SNPN.",
    "After a change in registration area, if the timer T3346 is running and 5GS update status is 5U1 UPDATED then the UE shall set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-REGISTERED.ATTEMPTING- REGISTRATION-UPDATE. If timer T3346 is running or is deactivated, and: a) the UE is a UE configured for high priority access in selected PLMN or SNPN; b) the UE needs to initiate signalling for emergency services or emergency services fallback; or c) the UE needs to report unavailability information due to discontinuous coverage, then the UE is allowed to initiate 5GMM procedures. NOTE 2: UE can, based on implementation, restrict lower layers of non-3GPP access from establishing access stratum connection on a registered PLMN when timer T3346 is running for the same PLMN. The additional requirements in subclause 5.3.12A apply to a UE supporting registration or attach procedures via 3GPP access and registration procedures via non-3GPP access.",
    "In case of PLMN, the network may send a local emergency numbers list or an extended local emergency numbers list or both, in the REGISTRATION ACCEPT message, by including the Emergency number list IE and the Extended emergency number list IE, respectively. The Local emergency numbers list can be updated as described in 3GPP TS 24.301 [15], subclause 5.3.7. In case of SNPN, the network may send an extended local emergency numbers list, in the REGISTRATION ACCEPT message, by including the Extended emergency number list IE. The network shall set the Extended Emergency Number List Validity (EENLV) field within the Extended emergency number list IE to \"Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received\". The UE shall consider the emergency number(s) received in the Extended emergency number list IE valid only in the SNPN from which this IE is received regardless of the received value of the EENLV field within the Extended emergency number list IE.",
    "The UE shall store the local emergency numbers list and the extended local emergency numbers list, as provided by the network. The local emergency numbers list stored in the UE shall be replaced on each receipt of the Emergency number list IE. The extended local emergency numbers list stored in the UE shall be replaced on each receipt of the Extended emergency number list IE. The received local emergency numbers list or the received extended local emergency numbers list or both shall be provided to the upper layers. The emergency number(s) received in the Emergency number list IE are valid only in PLMNs in the same country as the PLMN from which this IE is received. If no Emergency number list IE is contained in the REGISTRATION ACCEPT message, then the stored local emergency numbers list in the UE shall be kept, except if the UE has successfully registered to a PLMN in a country different from that of the PLMN that sent the list.",
    "The emergency number(s) received in the Extended emergency number list IE are valid only in: a) PLMNs in the same country as the PLMN from which this IE is received, if the Extended Emergency Number List Validity (EENLV) field within the Extended emergency number list IE indicates \"Extended Local Emergency Numbers List is valid in the country of the PLMN from which this IE is received\"; and b) the PLMN from which this IE is received, if the EENLV field within the Extended emergency number list IE indicates \"Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received\"; and c) the SNPN from which this IE is received, regardless of the value of the EENLV field within the Extended emergency number list IE. If no Extended Local Emergency Numbers List is contained in the REGISTRATION ACCEPT message, and the registered PLMN or the registered SNPN has not changed, then the stored Extended Local Emergency Numbers List in the UE shall be kept.",
    "If no Extended Local Emergency Numbers List is contained in the REGISTRATION ACCEPT message, but the registered PLMN or the registered SNPN has changed, then: a) if the last received indication in the EENLV field within the Extended emergency number list IE indicates \"Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received\", the stored Extended Local Emergency Numbers List in the UE shall be deleted; and b) if the last received indication in the EENLV field within the Extended emergency number list IE indicates \"Extended Local Emergency Numbers List is valid in the country of the PLMN from which this IE is received\" the list shall be kept except if the UE has successfully registered to a PLMN in a country different from that of the PLMN that sent the stored list.",
    "NOTE: To prevent the misrouting of emergency calls, all operators within a country need to follow the regulation or agree on the setting of the Extended emergency number list IE in accordance to national agreement – either to indicate validity within a country or to indicate validity only within the PLMN. The local emergency numbers list and the extended local emergency numbers list shall be deleted at switch off or removal of the USIM. The UE shall be able to store up to ten entries in the local emergency numbers list and up to twenty entries in the Extended local emergency numbers list, received from the network.",
    "For the use of the local emergency numbers list and the extended local emergency numbers list by the UE see 3GPP TS 24.301 [15], subclause 5.3.7. 5.3.12A Handling of local emergency numbers received via 3GPP access and non-3GPP access 5.3.12A.1 General The requirements in subclause 5.3.12 with the clarifications and additional conditions in subclause 5.3.12A apply to a UE supporting: a) attach procedures (see 3GPP TS 24.301 [15]) or registration procedures via 3GPP access; and b) registration procedures via non-3GPP access. The UE shall ignore the presence or absence of local emergency numbers list, extended local emergency numbers list or both, in a REGISTRATION ACCEPT message received via non-3GPP access and keep the stored local emergency numbers list and the extended local emergency numbers list, if available, unless conditions in subclause 5.3.12A.2 are met.",
    "For the purposes of subclause 5.3.12A, the UE is considered neither registered nor attached over 3GPP access if: 1) the UE supports 3GPP access to EPC, the UE does not support 3GPP access to 5GC, and: a) the EMM sublayer is in the EMM-NULL state, EMM-DEREGISTERED state or EMM-DEREGISTERED- INITIATED state; or 2) the UE supports 3GPP access to 5GC, the UE does not support 3GPP access to EPC, and: a) the 5GMM sublayer is in the 5GMM-NULL state, 5GMM-DEREGISTERED state or 5GMM- DEREGISTERED-INITIATED state; or 3) supports both 3GPP access to EPC and 3GPP access to 5GC, and: a) the EMM sublayer is in the EMM-NULL state, EMM-DEREGISTERED state or EMM-DEREGISTERED- INITIATED state; and a) the 5GMM sublayer is in the 5GMM-NULL state, 5GMM-DEREGISTERED state or 5GMM- DEREGISTERED-INITIATED state.",
    "5.3.12A.2 Receiving a REGISTRATION ACCEPT message via non-3GPP access If the UE can determine the current country and after switch on or after removal of the USIM, has not been registered or has not been attached via 3GPP access in the current country, then the UE shall store the local emergency numbers list or the extended local emergency numbers list or both, as provided by the network with an MCC matching the current country via non-3GPP access. NOTE: The UE determines, as the current country, the country in which it is located in accordance with 3GPP TS 24.502 [18].",
    "The UE shall replace a previously stored local emergency numbers list or a previously stored extended local emergency numbers list or both with a local emergency numbers list or an extended local emergency numbers list or both received in a REGISTRATION ACCEPT message via non-3GPP access, if the previously stored local emergency numbers list was also received via non-3GPP access or the previously stored extended local emergency numbers list was also received via non-3GPP access.",
    "The UE shall replace a previously stored extended local emergency numbers list with an extended local emergency numbers list received in a REGISTRATION ACCEPT message via non-3GPP access, if: a) the UE is neither registered nor attached over 3GPP access; b) the REGISTRATION ACCEPT message is received from a PLMN different from which the stored list was received; and c) the stored indication in the EENLV field within the Extended emergency number list IE indicates \"Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received\".",
    "If no extended local emergency numbers list is contained in a REGISTRATION ACCEPT message received via non- 3GPP access and the UE is neither registered nor attached over 3GPP access, the stored extended local emergency numbers list in the UE shall be discarded if: a) the UE can determine the current country and the UE has successfully registered to a PLMN in the country and that country is different from that of the PLMN that sent the stored list; or b) the REGISTRATION ACCEPT message is received from a PLMN different from which the stored list was received, and the stored indication in the EENLV field within the Extended emergency number list IE indicates \"Extended Local Emergency Numbers List is valid only in the PLMN from which this IE is received\".",
    "The abnormal case 5GMM uplink message transmission failure indication by lower layers can be identified for 5GMM procedures: When it is specified in the relevant procedure that it is up to the UE implementation to re-run the ongoing procedure that triggered that procedure, the procedure can typically be re-initiated using a retransmission mechanism of the uplink message (i.e. the one that has previously failed to be transmitted) with new sequence number and message authentication code information thus avoiding to re-start the whole procedure. NOTE: The transmission failure can happen due to TAI change. The lower layer might take some time to read the system information and determine if the current TAI is changed. Therefore, the information of TAI change can be sent to the NAS layer a little after receiving the transmission failure indication from the lower layer. How to handle the retransmission procedure caused by the possible delayed TAI change information is up to UE implementation.",
    "In order to deal with use of extensive resources from the network, the operator may prevent specific subscribers from using enhanced coverage (see 3GPP TS 23.501 [8]). When in NB-N1 mode, the UE shall indicate support for restriction on use of enhanced coverage. When in WB-N1 mode, the UE supporting either CE mode A or CE mode B shall indicate support for restriction on use of enhanced coverage. The UE supporting restriction on use of enhanced coverage indicates its support for restriction on use of enhanced coverage in the REGISTRATION REQUEST message.",
    "If the UE supports restriction on use of enhanced coverage, the AMF indicates in the REGISTRATION ACCEPT message (see subclause 5.5.1.2 and subclause 5.5.1.3) that: a) when in WB-N1 mode, whether CE mode B is restricted for the UE, or both CE mode A and CE mode B are restricted for the UE, or both CE mode A and CE mode B are not restricted for the UE; or b) when in NB-N1 mode, whether the use of enhanced coverage is restricted or not for the UE.",
    "If: a) the use of enhanced coverage is restricted; b) the use of CE mode B is restricted; or c) the use of CE mode A and CE mode B is restricted, the UE shall not use enhanced coverage in the registered PLMN and in any PLMN which is in the list of equivalent PLMNs. If the UE supports CE mode B and the network determines that a) the use of enhanced coverage is not restricted for the UE; or b) CE mode B is not restricted for the UE, the applicable NAS timer values shall be calculated by the network as described in subclause 4.19 and subclause 4.20.",
    "For a UE that supports restriction on use of enhanced coverage or CE mode B, if: a) the AMF determines to enforce a change in restriction on the use of enhanced coverage or a change in the restriction on the use of CE mode B as described in 3GPP TS 23.501 [8]; and b) the UE is in 5GMM-CONNECTED mode and there is no ongoing registration procedure, the AMF shall initiate the generic UE configuration update procedure to indicate registration requested and release of the N1 NAS signalling connection not requested as described in subclause 5.4.4. After the successful completion of the registration procedure for mobility registration update including change of the restriction on the use of enhanced coverage, for any SMF with which the UE has an established PDU session, the AMF updates the SMF with the indication on the use of extended NAS timer setting as described in 3GPP TS 23.501 [8] and 3GPP TS 23.502 [9].",
    "This subclause specifies the requirements for a UE that is not configured to use timer T3245 (see 3GPP TS 24.368 [17] or 3GPP TS 31.102 [22]) and receives a REGISTRATION REJECT or SERVICE REJECT message without integrity protection with specific 5GMM causes. NOTE: Additional UE requirements for this case, requirements for other 5GMM causes, and requirements for the case when the UE receives an integrity protected reject message are specified in subclauses 5.5.1 and If the UE is operating in SNPN access operation mode, the UE shall maintain, for each of the entries in the \"list of subscriber data\": a) one SNPN-specific attempt counter for 3GPP access. The counter is applicable to access attempts via 3GPP access only; b) one SNPN-specific attempt counter for non-3GPP access, if the UE supports access to SNPN over non-3GPP access.",
    "The counter is applicable in case of access to SNPN over non-3GPP access only; NOTE 1: If the UE accesses to SNPN service directly over non-3GPP access or if the UE accesses to SNPN services via a PLMN, the SNPN-specific attempt counter for non-3GPP access is used. c)one counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events; and d) one counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events, if the UE supports access to SNPN over non-3GPP access. The counter is applicable in case of access to SNPN over non- 3GPP access only. NOTE 2: If the UE accesses to SNPN service directly over non-3GPP access or if the UE accesses to SNPN services via a PLMN, the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events is used.The UE shall store the above counters in its non-volatile memory.",
    "The UE shall erase the attempt counters and reset the event counters to zero when the selected entry of the \"list of subscriber data\" is updated or USIM is removed for the selected PLMN subscription. The counter values shall not be affected by the activation or deactivation of MICO mode or power saving mode (see 3GPP TS 24.301 [15]). The UE implementation-specific maximum value for any of the above counters shall not be greater than 10. NOTE 3: Different counters can use different UE implementation-specific maximum values. If the UE receives a REGISTRATION REJECT or SERVICE REJECT message without integrity protection with 5GMM cause value #3, #6, #7, #12, #13, #15, #27, #72, #74, or #75 before the network has established secure exchange of NAS messages for the N1 NAS signalling connection, the UE shall stop timer T3510 or T3517, if running.",
    "If the SNPN sending the message is an SNPN selected for localized services in SNPN (see 3GPP TS 23.122 [5]) and there is next valid time period(s) for the SNPN, the UE shall start timer T3247 (see 3GPP TS 24.008 [12]) with a random value uniformly drawn from the range between the start time point of the next valid time period for localized services in SNPN and: a) for 5GMM cause value #74: 1) 30 minutes after the start time point of the next valid time period for localized services in SNPN, if the next valid time period is longer than 30 minutes; or 2) the end time point of the next valid time period for localized services in SNPN, if the next valid time period is not longer than 30 minutes; or b) for other 5GMM cause values: 1) 60 minutes after the start time point of the next valid time period for localized services in SNPN, if the next valid time period is longer than 60 minutes; or 2) the end time point of the next valid time period for localized services in SNPN, if the next valid time period is not longer than 60 minutes; otherwise between: a) 15 minutes and 30 minutes for 5GMM cause value #74; or b) 30 minutes and 60 minutes for other 5GMM cause values; if the timer is not running, and take the following actions: a) if the 5GMM cause value received is #3, #6, or #7 and the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN: 1) if the 5GMM cause value is received over 3GPP access: i) if the UE is already registered over another access, the UE shall: A) store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, for non-integrity protected NAS reject message and enter the state 5GMM- DEREGISTERED.LIMITED-SERVICE; and B) search for a suitable cell in another tracking area according to 3GPP TS 38.304 [28]; or ii) otherwise if the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events has a value less than a UE implementation-specific maximum value, the UE shall: A) set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last visited registered TAI, TAI list, and ngKSI for 3GPP access; A1) if the 5GMM cause value received is #3 or #6, delete the list of equivalent SNPNs, if any; B) increment the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events; C) reset the registration attempt counter in case of a REGISTRATION REJECT message or reset the service request attempt counter in case of a SERVICE REJECT message; D) store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, for non-integrity protected NAS reject message, and enter the state 5GMM- DEREGISTERED.LIMITED-SERVICE; and E) search for a suitable cell in another tracking area according to 3GPP TS 38.304 [28].",
    "As a UE implementation option, if access to SNPN over non-3GPP access is available and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription is not considered invalid for non-3GPP access, then the UE may perform registration attempt over non-3GPP access; or iii) otherwise, the UE shall proceed as specified in subclauses 5.5.1 and 5.6.1; 2) if the 5GMM cause value is received over non-3GPP access: i) if the UE is already registered over another access, the UE shall enter the state 5GMM- DEREGISTERED.LIMITED-SERVICE; or ii) otherwise if the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events has a value less than a UE implementation-specific maximum value, the UE shall: A) set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete the 5G-GUTI, last visited registered TAI, TAI list, and ngKSI for non-3GPP access; B) enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE; and C) increment the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events.",
    "As a UE implementation option, if 3GPP access is available and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription is not considered invalid for 3GPP access, then the UE may make a registration attempt over 3GPP access; or iii) otherwise, the UE shall proceed as specified in subclauses 5.5.1 and 5.6.1; b) if the 5GMM cause value received is #12, #13, or #15, the UE shall proceed as specified in subclauses 5.5.1 and mode DRX cycle The UE can request the use of both MICO mode with active time and eDRX during a registration procedure but it is up to the network to decide to enable none, one of them or both (see 3GPP TS 23.501 [8]). If the network accepts the use of both MICO mode with active time (see subclause 5.3.6) and eDRX (see subclause 5.3.16), the extended DRX parameters provided to the UE should allow for multiple paging occasions before the active timer expires.",
    "A UE may indicate its capability to support NR paging subgrouping during registration procedure when the UE: - initiates a registration procedure with 5GS registration type IE not set to \"emergency registration\"; and - does not have an active emergency PDU session. NOTE: The requirements for UE-ID based PEI are specified in 3GPP TS 38.300 [27]. If a UE supporting NR paging subgrouping did not indicate its capability to support NR paging subgrouping during the last registration procedure due to an active emergency PDU session over 3GPP access, the UE shall initiate a registration procedure for mobility and periodic registration update to indicate its capability to support NR paging subgrouping after the emergency PDU session is released over 3GPP access. If the UE indicates support of NR paging subgrouping the UE may include its paging probability information in the Requested PEIPS assistance information IE in the REGISTRATION REQUEST message.",
    "If the UE indicates support of NR paging subgrouping and the network supports and accepts the use of the PEIPS assistance information for the UE, the network provides to the UE the Negotiated PEIPS assistance information, including the Paging subgroup ID, in the REGISTRATION ACCEPT message or the CONFIGURATION UPDATE COMMAND message. The Paging subgroup ID is used to determine the NR paging subgroup for paging the UE. The UE NAS layer shall indicate the Paging subgroup ID to the access stratum layer. The network shall store the Paging subgroup ID in the 5GMM context of the UE. The UE shall use PEIPS assistance information only if the UE received the Negotiated PEIPS assistance information IE during the last registration procedure. If the UE did not receive the Negotiated PEIPS assistance information IE during the last registration procedure, the UE shall delete any existing PEIPS assistance information received from the network.",
    "If the network did not accept the request to use PEIPS assistance information during the registration procedure, the network shall delete the stored PEIPS assistance information for the UE, if available. If the UE supports the use of the PEIPS assistance information and the network supports and accepts the use of the PEIPS assistance information, the network may provide the PEIPS assistance information to the UE by including the Updated PEIPS assistance information IE in the CONFIGURATION UPDATE COMMAND message.",
    "When an emergency PDU session is successfully established over 3GPP access after the UE received the Negotiated PEIPS assistance information IE during the last registration procedure, the UE and the AMF shall not use PEIPS assistance information until: - the successful completion of the PDU session release procedure of the emergency PDU; - the UE receives PEIPS assistance information during a registration procedure with PDU session status IE or upon successful completion of a service request procedure, if the UE or the network locally releases the emergency PDU session; - the successful completion of handover of emergency PDU session to non-3GPP access; or - the successful transfer of the emergency PDU session in 5GS to the EPS or ePDG connected to EPC.",
    "The purpose of the primary authentication and key agreement procedure is to enable mutual authentication between the UE and the network and to provide keying material that can be used between the UE and network in subsequent security procedures, as specified in 3GPP TS 33.501 [24]. Two methods are defined: a) EAP based primary authentication and key agreement procedure. b) 5G AKA based primary authentication and key agreement procedure. The UE and the AMF shall support the EAP based primary authentication and key agreement procedure and the 5G AKA based primary authentication and key agreement procedure. The UE shall support acting as EAP-AKA' peer as specified in IETF RFC 5448 [40]. The AUSF may support acting as EAP-AKA' server as specified in IETF RFC 5448 [40]. The AAA server of the Credentials Holder (CH) or the Default Credentials Server (DCS) may support acting as EAP-AKA' server as specified in IETF RFC 5448 [40].",
    "The EAP-AKA' enables mutual authentication of the UE and the network. The UE can reject the EAP-request/AKA'-challenge message sent by the network. The UE shall proceed with an EAP- request/AKA'-challenge message only if a USIM is present. During a successful EAP based primary authentication and key agreement procedure, the CK and IK are computed by the USIM. CK and IK are then used by the ME as key material to generate an EMSK or MSK. If a USIM is present, the SNN check fails or the UE does not accept AUTN during handling of the EAP-request/AKA'- challenge message as specified in IETF RFC 5448 [40], the UE shall send an EAP-response/AKA'-authentication-reject message as specified in IETF RFC 5448 [40].",
    "If a USIM is present, the SNN check is successful but the UE detects that the sequence number in AUTN is not correct during handling of the EAP-request/AKA'-challenge message as specified in IETF RFC 5448 [40], the UE shall send an EAP-response/AKA'-synchronization-failure message as specified in IETF RFC 5448 [40]. If a USIM is present, the SNN check is successful, the sequence number in AUTN is correct and the UE detects another error during handling of the EAP-request/AKA'-challenge message as specified in IETF RFC 5448 [40], the UE shall send an EAP-response/AKA'-client-error message as specified in IETF RFC 5448 [40]. If a USIM is not present, the UE shall send an EAP-response/AKA'-client-error message as specified in IETF RFC 5448 [40]. For any of the above, the UE shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent. Furthermore, the UE shall stop any of the timers T3510, T3517 or T3521 (if they were running).",
    "Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request/AKA'-challenge from the network, the UE shall stop timer T3520, if running, and then process the EAP- request/AKA'-challenge information as normal. Upon reception of the EAP-response/AKA'-notification message, if earlier procedures for handling an EAP- request/AKA'-challenge message as specified in IETF RFC 5448 [40] were successful, the AUSF or the AAA server of the CH or the DCS shall send an EAP-success message as specified in IETF RFC 5448 [40] and shall consider the procedure complete. NOTE: The AUSF provides the KSEAF to the SEAF. Upon reception of the KSEAF, the SEAF generates the KAMF based on the ABBA and the KSEAF as described in 3GPP TS 33.501 [24], and provides ngKSI and the KAMF to the AMF.",
    "Upon reception of the ngKSI and the KAMF, the AMF creates a partial native 5G NAS security context identified by the ngKSI, and stores the KAMF in the created partial native 5G NAS security context. Upon reception of the EAP-response/AKA'-notification message, if earlier procedures for handling an EAP- request/AKA'-challenge message as specified in IETF RFC 5448 [40] were not successful, the AUSF or the AAA server of the CH or the DCS shall send an EAP-failure message as specified in IETF RFC 5448 [40] and shall consider the procedure complete. If the authentication response (RES) returned by the UE in the AT_RES attribute of the EAP-response/AKA'-challenge message is not valid, the network handling depends upon the type of identity used by the UE in the initial NAS message, that is: a) if the 5G-GUTI was used; or b)- if the SUCI was used.",
    "If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message of the EAP result message transport procedure, initiate an identification procedure to retrieve SUCI from the UE and restart the EAP based primary authentication and key agreement procedure with the received SUCI. If the SUCI was used for identification in the initial NAS message or in a restarted EAP based primary authentication and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the UE after an unsuccessful EAP based primary authentication and key agreement procedure, the network should transport the EAP-failure message in an AUTHENTICATION REJECT message of the EAP result message transport procedure.",
    "Depending on local requirements or operator preference for emergency services, if the UE initiates a registration procedure with 5GS registration type IE set to \"emergency registration\" and the AMF is configured to allow emergency registration without user identity, the AMF needs not follow the procedures specified for transporting the EAP-failure message in the AUTHENTICATION REJECT message of the EAP result message transport procedure in the present subclause. The AMF may include the EAP-failure message in a response of the current 5GMM specific procedure or in the AUTHENTICATION RESULT of the EAP result message transport procedure. The UE may support acting as EAP-TLS peer as specified in 3GPP TS 33.501 [24]. The AUSF may support acting as EAP-TLS server as specified in 3GPP TS 33.501 [24]. The AAA server of the CH or the DCS may support acting as EAP server of such EAP method as specified in 3GPP TS 23.501 [8]. The EAP-TLS enables mutual authentication of the UE and the network.",
    "When initiating an EAP based primary authentication and key agreement procedure using EAP-TLS, the network shall select an ngKSI value. If an ngKSI is contained in an initial NAS message during a 5GMM procedure, the network shall select a different ngKSI value. The network shall send the selected ngKSI value to the UE along with each EAP message. The network shall send the ABBA value as described in subclause 9.11.3.10 to the UE along with the EAP- request message and EAP-success message.",
    "When the EAP based primary authentication and key agreement procedure uses EAP-TLS: a) if the UE operates in SNPN access operation mode and: 1) the default UE credentials for primary authentication, if the UE is registering or registered for onboarding services in SNPN; or 2) credentials in the selected entry of the \"list of subscriber data\", if the UE is not registering or registered for onboarding services in SNPN; contain an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure then the ME shall generate MSK as described in 3GPP TS 33.501 [24] otherwise the ME shall generate EMSK as described in 3GPP TS 33.501 [24]; b) if the AUSF acts as the EAP-TLS server, the AUSF shall generate EMSK as described in 3GPP TS 33.501 [24]; and c) if the AAA server of the CH or the DCS acts as the EAP-TLS server, the AAA server of the CH or the DCS shall generate MSK as described in 3GPP TS 33.501 [24].",
    "When handling of an EAP-request message results into generation of MSK or EMSK, if the UE operates in SNPN access operation mode and: a) the default UE credentials for primary authentication, if the UE is registering or registered for onboarding services in SNPN; or b) credentials in the selected entry of the \"list of subscriber data\", if the UE is not registering or registered for onboarding services in SNPN; contain an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure, then the ME may generate a new KAUSF from the MSK otherwise the ME may generate a new KAUSF from the EMSK.",
    "If the ME generates a new KAUSF, the ME shall generate a new KSEAF from the new KAUSF, and the KAMF from the ABBA received together with the EAP-request message, and the new KSEAF as described in 3GPP TS 33.501 [24], and create a partial native 5G NAS security context identified by the ngKSI value received together with the EAP-request message in subclause 5.4.1.2.4.2, in the volatile memory of the ME. If the KAMF and the partial native 5G NAS security context are created, the ME shall store the KAMF in the created partial native 5G NAS security context. NOTE 1: Generation of the new KAUSF and the new KSEAF does not result into deletion of the valid KAUSF and the valid KSEAF, if any. The ME shall not use the new KAUSF in the verification of SOR transparent container and UE parameters update transparent container, if any are received, until receipt of an EAP-success message.",
    "When the AUSF acts as the EAP-TLS server and handling of an EAP response message results into generation of EMSK, the AUSF shall generate the KAUSF from the EMSK, and the KSEAF from the KAUSF as described in 3GPP TS 33.501 [24]. NOTE 2: When the AAA server of the CH or the DCS acts as the EAP-TLS server, the AAA server of the CH or the DCS provides (via the NSSAAF) the MSK and the SUPI to the AUSF. Upon reception of the MSK, the AUSF generates the KAUSF from the MSK, and the KSEAF from the KAUSF as described in 3GPP TS 33.501 [24]. NOTE 3: The AUSF provides the KSEAF and optionally the SUPI (unless the SEAF provided the AUSF with the SUPI before) to the SEAF as described in 3GPP TS 33.501 [24]. Upon reception of the KSEAF and optionally the SUPI, the SEAF generates the KAMF based on the ABBA, the KSEAF and the SUPI as described in 3GPP TS 33.501 [24], and provides ngKSI and the KAMF to the AMF.",
    "Upon reception of the ngKSI and the KAMF, the AMF creates a partial native 5G NAS security context identified by the ngKSI, and stores the KAMF in the created partial native 5G NAS security context. If the UE does not accept the server certificate of the network, the UE shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent. Furthermore, the UE shall stop any of the retransmission timers that are running (e.g. T3510, T3517 or T3521). Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request message from the network, the UE shall stop timer T3520, if running, and then process the EAP-request message as normally. If the network does not accept the client certificate of the UE, the network handling depends upon the type of identity used by the UE in the initial NAS message, that is: - if the 5G-GUTI was used; or - if the SUCI was used.",
    "If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message of the EAP result message transport procedure, initiate an identification procedure to retrieve SUCI from the UE and restart the EAP based primary authentication and key agreement procedure with the received SUCI. If the SUCI was used for identification in the initial NAS message or in a restarted EAP based primary authentication and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the UE after an unsuccessful the EAP based primary authentication and key agreement procedure, the network should transport the EAP-failure message in an AUTHENTICATION REJECT message of the EAP result message transport procedure.",
    "Depending on local requirements or operator preference for emergency services, if the UE initiates a registration procedure with 5GS registration type IE set to \"emergency registration\" and the AMF is configured to allow emergency registration without user identity, the AMF needs not follow the procedures specified for transporting the EAP-failure message in the AUTHENTICATION REJECT message of the EAP result message transport procedure in the present subclause. The AMF may include the EAP-failure message in a response of the current 5GMM specific procedure or in the AUTHENTICATION RESULT of the EAP result message transport procedure. If the EAP-failure message is received in an AUTHENTICATION REJECT message: a) if the AUTHENTICATION REJECT message has been successfully integrity checked by the NAS: 1) the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.",
    "In case of PLMN, the USIM shall be considered invalid until switching off the UE or the UICC containing the USIM is removed. In case of SNPN, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN and the UE does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN shall be considered invalid until the UE is switched off or the entry is updated; In case of SNPN, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN and the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs, or both, the UE shall consider the selected entry of the \"list of subscriber data\" as invalid until the UE is switched off or the entry is updated.",
    "If the UE is registered for onboarding services in SNPN or is performing initial registration for onboarding services in SNPN, the UE shall store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5]; 2) if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN, the UE shall set: i) the counter for \"SIM/USIM considered invalid for GPRS services\" events, the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events, and the counter for \"SIM/USIM considered invalid for non-GPRS services\" events if maintained by the UE, in case of PLMN; or ii) the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events and the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events in case of SNPN; to UE implementation-specific maximum value.",
    "If the UE is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN, the UE shall set the SNPN-specific attempt counter for the current SNPN to the UE implementation-specific maximum value; and 3) if the UE is operating in single-registration mode, the UE shall handle EMM parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case when the authentication procedure is not accepted by the network. The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and b) if the AUTHENTICATION REJECT message is received without integrity protection, the UE shall start timer T3247 with a random value uniformly drawn from the range between 30 minutes and 60 minutes, if the timer is not running (see subclause 5.3.20).",
    "Additionally, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN, the UE shall: 1) if the AUTHENTICATION REJECT message is received over 3GPP access, and the counter for \"SIM/USIM considered invalid for GPRS services\" events in case of PLMN or the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events in case of SNPN has a value less than a UE implementation-specific maximum value, proceed as specified in subclause 5.3.20, list item 1)-a) of subclause 5.3.20.2 (if the UE is not SNPN enabled or is not operating in SNPN access operation mode) or list item a) 1) of subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for the case that the 5GMM cause value received is #3; 2) if the AUTHENTICATION REJECT message is received over non-3GPP access, and the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events in case of PLMN or the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events in case of SNPN has a value less than a UE implementation-specific maximum value, proceed as specified in subclause 5.3.20, list item 1)-b) of subclause 5.3.20.2 (if the UE is not operating in SNPN access operation mode) or list item a)-2) of subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for the case that the 5GMM cause value received is #3; or 3) otherwise: i) if the AUTHENTICATION REJECT message is received over 3GPP access: A) the UE shall set the update status for 3GPP access to 5U3 ROAMING NOT ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.",
    "In case of PLMN, the UE shall consider the USIM as invalid for 5GS services via 3GPP access and invalid for non-EPS service until switching off the UE or the UICC containing the USIM is removed.",
    "In case of SNPN, if the UE does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the UE shall consider the selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN as invalid for 3GPP access until the UE is switched off or the entry is updated; In case of SNPN, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs, or both, the UE shall consider the selected entry of the \"list of subscriber data\" as invalid for 3GPP access until the UE is switched off or the entry is updated; B) the UE shall set: - the counter for \"SIM/USIM considered invalid for GPRS services\" events and the counter for \"SIM/USIM considered invalid for non-GPRS services\" events if maintained by the UE, in case of PLMN; or - the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events in case of SNPN; to UE implementation-specific maximum value; and C) If the UE is operating in single-registration mode, the UE shall handle 4G-GUTI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case when the authentication procedure is not accepted by the network.",
    "The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and ii) if the AUTHENTICATION REJECT message is received over non-3GPP access: A) the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI. In case of PLMN, the USIM shall be considered invalid for 5GS services via non-3GPP access until switching off the UE or the UICC containing the USIM is removed.",
    "In case of SNPN, the UE shall consider the selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN shall be considered invalid for non-3GPP access until the UE is switched off or the entry is updated; and B) the UE shall set the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events in case of PLMN or the counter for \"the entry for the current SNPN considered invalid for non- 3GPP access\" events in case of SNPN to UE implementation-specific maximum value.",
    "If the UE is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN, the UE shall: 1) if the SNPN-specific attempt counter for the SNPN sending the AUTHENTICATION REJECT message has a value less than a UE implementation-specific maximum value, increment the SNPN-specific attempt counter for the SNPN; or 2) otherwise, the UE shall set the update status to 5U3.ROAMING NOT ALLOWED, delete the stored 5G- GUTI, TAI list, last visited registered TAI, and ngKSI, store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN- SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5].",
    "If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM- DEREGISTERED and delete any stored SUCI.",
    "Upon receiving an EAP-success message, the ME shall: a) delete the valid KAUSF and the valid KSEAF, if any; b) if the ME has not generated a new KAUSF and a new KSEAF and has not created a partial native 5G NAS security context when handling the EAP-request message which resulted into generation of EMSK or MSK as described above: 1) if the UE operates in SNPN access operation mode and: i) the default UE credentials for primary authentication, if the UE is registering or registered for onboarding services in SNPN; or ii) credentials in the selected entry of the \"list of subscriber data\", if the UE is not registering or registered for onboarding services in SNPN; contain an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure then generate a new KAUSF from the MSK otherwise generate a new KAUSF from the EMSK; 2) generate a new KSEAF from the new KAUSF, and the KAMF from the ABBA that was received with the EAP- success message, and the new KSEAF as described in 3GPP TS 33.501 [24]; 3) create a partial native 5G NAS security context identified by the ngKSI value in the volatile memory of the ME; and 4) store the KAMF in the created partial native 5G NAS security context; and c) consider the new KAUSF to be the valid KAUSF, and the new KSEAF to be the valid KSEAF, reset the SOR counter and the UE parameter update counter to zero, store the valid KAUSF, the valid KSEAF, the SOR counter and the UE parameter update counter as specified in annex C, and use the valid KAUSF in the verification of SOR transparent container and UE parameters update transparent container, if any are received.",
    "The UE shall consider the procedure complete. Upon receiving an EAP-failure message, the UE shall delete the partial native 5G NAS security context and shall delete the new KAUSF and the new KSEAF, if any were created when handling the EAP-request message which resulted into generation of EMSK or MSK as described above. The UE shall consider the procedure complete. 5.4.1.2.3A Procedures related to EAP methods other than EAP-AKA' and EAP-TLS 5.4.1.2.3A.1 General This subclause applies when an EAP method: a) supporting mutual authentication; b) supporting EMSK or MSK generation; and c) other than EAP-AKA' and EAP-TLS; is used for primary authentication and key agreement in an SNPN. The UE may support acting as EAP peer of such EAP method as specified in 3GPP TS 33.501 [24]. The AUSF may support acting as EAP server of such EAP method as specified in 3GPP TS 33.501 [24].",
    "The AAA server of the CH or the DCS may support acting as EAP server of such EAP method as specified in 3GPP TS 23.501 [8]. When initiating an EAP based primary authentication and key agreement procedure using such EAP method, the network shall select an ngKSI value. If an ngKSI is contained in an initial NAS message during a 5GMM procedure, the network shall select a different ngKSI value. The network shall send the selected ngKSI value to the UE along with each EAP message. The network shall send the ABBA value as described in subclause 9.11.3.10 to the UE along with the EAP-request message and EAP-success message.",
    "When the EAP based primary authentication and key agreement procedure uses such EAP method: a) if: 1) the default UE credentials for primary authentication, if the UE is registering or registered for onboarding services in SNPN; or 2) credentials in the selected entry of the \"list of subscriber data\", if the UE is not registering or registered for onboarding services in SNPN; contain an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure then the ME shall generate MSK as described in 3GPP TS 33.501 [24] otherwise the ME shall generate EMSK as described in 3GPP TS 33.501 [24]; b) if the AUSF acts as the EAP server, the AUSF shall generate EMSK as described in 3GPP TS 33.501 [24]; and c) if the AAA server of the CH or the DCS acts as the EAP server, the AAA server of the CH or the DCS shall generate MSK as described in 3GPP TS 33.501 [24].",
    "When handling of an EAP-request message results into generation of MSK or EMSK, if: a) the default UE credentials for primary authentication, if the UE is registering or registered for onboarding services in SNPN; or b) credentials in the selected entry of the \"list of subscriber data\", if the UE is not registering or registered for onboarding services in SNPN; contain an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure then the ME may generate a new KAUSF from the MSK otherwise the ME may generate a new KAUSF from the EMSK.",
    "If the ME generates a new KAUSF, the ME shall generate a new KSEAF from the new KAUSF, and the KAMF from the ABBA received together with the EAP-request message, and the new KSEAF as described in 3GPP TS 33.501 [24], and create a partial native 5G NAS security context identified by the ngKSI value received together with the EAP-request message in subclause 5.4.1.2.4.2, in the volatile memory of the ME. If the KAMF and the partial native 5G NAS security context are created, the ME shall store the KAMF in the created partial native 5G NAS security context. NOTE 1: Generation of the new KAUSF and the new KSEAF does not result into deletion of the valid KAUSF and the valid KSEAF, if any. The ME shall not use the new KAUSF in the verification of SOR transparent container and UE parameters update transparent container, if any are received, until receipt of an EAP-success message.",
    "When the AUSF acts as the EAP server and handling of an EAP response message results into generation of EMSK, the AUSF shall generate the KAUSF from the EMSK, and the KSEAF from the KAUSF as described in 3GPP TS 33.501 [24]. NOTE 2: When the AAA server of the CH or the DCS acts as the EAP server and handling of an EAP response message results into generation of MSK, the AAA server of the CH or the DCS provides (via the NSSAAF) the MSK and the SUPI to the AUSF. Upon reception of the MSK, the AUSF generates the KAUSF from the MSK, and the KSEAF from the KAUSF as described in 3GPP TS 33.501 [24]. NOTE 3: The AUSF provides the KSEAF and optionally the SUPI (unless the SEAF provided the AUSF with the SUPI before) to the SEAF as described in 3GPP TS 33.501 [24]. Upon reception of the KSEAF and optionally the SUPI, the SEAF generates the KAMF based on the ABBA, the KSEAF and the SUPI as described in 3GPP TS 33.501 [24], and provides ngKSI and the KAMF to the AMF.",
    "Upon reception of the ngKSI and the KAMF, the AMF creates a partial native 5G NAS security context identified by the ngKSI, and stores the KAMF in the created partial native 5G NAS security context. If the UE fails to authenticate the network, the UE shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent. Furthermore, the UE shall stop any of the retransmission timers that are running (e.g. T3510, T3517 or T3521). Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request message from the network, the UE shall stop timer T3520, if running, and then process the EAP-request message as normally. If the network fails to authenticate the UE, the network handling depends upon the type of identity used by the UE in the initial NAS message, that is: - if the 5G-GUTI was used; or - if the SUCI was used.",
    "If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message of the EAP result message transport procedure, initiate an identification procedure to retrieve SUCI from the UE and restart the EAP based primary authentication and key agreement procedure with the received SUCI. If the SUCI was used for identification in the initial NAS message or in a restarted EAP based primary authentication and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the UE after an unsuccessful the EAP based primary authentication and key agreement procedure, the network should transport the EAP-failure message in an AUTHENTICATION REJECT message of the EAP result message transport procedure.",
    "If the EAP-failure message is received in an AUTHENTICATION REJECT message: a) if the AUTHENTICATION REJECT message has been successfully integrity checked by the NAS: 1) the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.",
    "In case of SNPN, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN and the UE does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN shall be considered invalid until the UE is switched off or the entry is updated; In case of SNPN, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN and the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs, or both, the UE shall consider the selected entry of the \"list of subscriber data\" as invalid until the UE is switched off or the entry is updated.",
    "In case of SNPN, if the UE is registered for onboarding services in SNPN or is performing initial registration for onboarding services in SNPN, the UE shall store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5]; and 2) if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN, the UE shall set the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events and the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events in case of SNPN to UE implementation-specific maximum value.",
    "If the UE is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN, the UE shall set the SNPN-specific attempt counter for the current SNPN to the UE implementation-specific maximum value; and b) if the AUTHENTICATION REJECT message is received without integrity protection, the UE shall start timer T3247 with a random value uniformly drawn from the range between 30 minutes and 60 minutes, if the timer is not running (see subclause 5.3.20).",
    "Additionally, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN, the UE shall: 1) if the AUTHENTICATION REJECT message is received over 3GPP access, and the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events has a value less than a UE implementation- specific maximum value, proceed as specified in list item a) 1) of subclause 5.3.20.3 for the case that the 5GMM cause value received is #3; 2) if the AUTHENTICATION REJECT message is received over non-3GPP access, and the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events has a value less than a UE implementation-specific maximum value, proceed as specified in list item a)-2) of subclause 5.3.20.3 for the case that the 5GMM cause value received is #3; or 3) otherwise: i) if the AUTHENTICATION REJECT message is received over 3GPP access: - the UE shall set the update status for 3GPP access to 5U3 ROAMING NOT ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI; In case of SNPN, if the UE does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN shall be considered invalid for 3GPP access until the UE is switched off or the entry is updated; In case of SNPN, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs, or both, the UE shall consider the selected entry of the \"list of subscriber data\" as invalid until the UE is switched off or the entry is updated; and - the UE shall set the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events to UE implementation-specific maximum value; and ii) if the AUTHENTICATION REJECT message is received over non-3GPP access: - the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI.",
    "The selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN shall be considered invalid for non-3GPP access until the UE is switched off or the entry is updated; and - the UE shall set the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events to UE implementation-specific maximum value.",
    "If the UE is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN, the UE shall: 1) if the SNPN-specific attempt counter for the SNPN sending the AUTHENTICATION REJECT message has a value less than a UE implementation-specific maximum value, increment the SNPN-specific attempt counter for the SNPN; or 2) otherwise, the UE shall set the update status to 5U3.ROAMING NOT ALLOWED, delete the stored 5G- GUTI, TAI list, last visited registered TAI, and ngKSI, store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN- SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5].",
    "If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM- DEREGISTERED and delete any stored SUCI.",
    "Upon receiving an EAP-success message, the ME shall: a) delete the valid KAUSF and the valid KSEAF, if any; b) if the ME has not generated a new KAUSF and a new KSEAF and has not created a partial native 5G NAS security context when handling the EAP-request message which resulted into generation of EMSK as described above: 1) if: i) the default UE credentials for primary authentication, if the UE is registering or registered for onboarding services in SNPN; or ii) credentials in the selected entry of the \"list of subscriber data\", if the UE is not registering or registered for onboarding services in SNPN; contain an indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure then generate a new KAUSF from the MSK otherwise generate a new KAUSF from the EMSK; 2) generate a new KSEAF from the new KAUSF, and the KAMF from the ABBA that was received with the EAP- success message, and the KSEAF as described in 3GPP TS 33.501 [24]; 3) create a partial native 5G NAS security context identified by the ngKSI value in the volatile memory of the ME; and 4) store the KAMF in the created partial native 5G NAS security context; and c) consider the new KAUSF to be the valid KAUSF, and the new KSEAF to be the valid KSEAF, reset the SOR counter and the UE parameter update counter to zero, store the valid KAUSF, the valid KSEAF, the SOR counter and the UE parameter update counter as specified in annex C, and use the valid KAUSF in the verification of SOR transparent container and UE parameters update transparent container, if any are received.",
    "The UE shall consider the procedure complete. Upon receiving an EAP-failure message, the UE shall delete the partial native 5G NAS security context and shall delete the new KAUSF and the new KSEAF, if any were created when handling the EAP-request message which resulted into generation of EMSK or MSK as described above. The UE shall consider the procedure complete. 5.4.1.2.3A.2 EAP-TTLS with two phases of authentication The UE may support acting as EAP peer of EAP-TTLS with two phases of authentication as specified in 3GPP TS 33.501 [24] and acting as peer of a legacy authentication protocol as specified in 3GPP TS 33.501 [24]. The AUSF may support acting as EAP server of EAP-TTLS with two phases of authentication as specified in 3GPP TS 33.501 [24]. The AAA server of the CH or the DCS may support acting a server of a legacy authentication protocol as specified in 3GPP TS 33.501 [24].",
    "When EAP-TTLS with two phases of authentication as specified in 3GPP TS 33.501 [24] is used for primary authentication and key agreement in an SNPN: a) requirements in subclause 5.4.1.2.3A.1 shall apply in addition to requirements specified in 3GPP TS 33.501 [24] annex U; b) indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure is not included in: 1) the default UE credentials for primary authentication, if the UE is registering or registered for onboarding services in SNPN; or 2) credentials in the selected entry of the \"list of subscriber data\", if the UE is not registering or registered for onboarding services in SNPN; and c) the SUPI of the UE is in the form of a SUPI with the SUPI format \"network specific identifier\" containing a network-specific identifier. NOTE: Support of EAP-TTLS with two phases of authentication is based on the informative requirements as specified in 3GPP TS 33.501 [24].",
    "5.4.1.2.3B Procedures related to EAP methods used for primary authentication of an N5GC device 5.4.1.2.3B.1 General This subclause applies when an EAP method: a) supporting mutual authentication; and b) other than EAP-AKA', is used for primary authentication of an N5GC device, when an W-AGF supports acting on behalf of the N5GC device, the AMF supports serving the W-AGF acting on behalf of the N5GC device and the AUSF supports authentication of the N5GC device. EAP-TLS is an example of such EAP method. NOTE 1: Neither the N5GC device nor the AUSF derive any 5G related keys during or after the primary authentication. The AUSF supporting authentication of the N5GC device shall support acting as EAP server of at least one such EAP method as specified in annex O of 3GPP TS 33.501 [24]. NOTE 2: The N5GC device supports acting as EAP peer of at least one such EAP method as specified in annex O of 3GPP TS 33.501 [24], which is also supported by the AUSF.",
    "The W-AGF acting on behalf of the N5GC device provides to the N5GC device an EAP-request message, an EAP- success message or an EAP-failure message received from the network according to subclause 5.4.1.2.1 and sends to the network according to subclause 5.4.1.2.1 an EAP-response provided by the N5GC device. The N5GC device can inform the W-AGF acting on behalf of the N5GC device that the N5GC device fails to authenticate the network. Details of communication between the N5GC device and the W-AGF acting on behalf of the N5GC device are out of scope of this specification. When initiating an EAP based primary authentication and key agreement procedure using such EAP method, the network shall select an ngKSI value. The network shall send the selected ngKSI value to the W-AGF acting on behalf of the N5GC device along with each EAP message.",
    "The network shall send the ABBA value as described in subclause 9.11.3.10 to the W-AGF acting on behalf of the N5GC device along with the EAP-request message and EAP- success message. The W-AGF acting on behalf of the N5GC device shall not forward the ngKSI value or the ABBA value to the N5GC device. NOTE 3: The network provides the ngKSI value and the ABBA value since the ngKSI IE and the ABBA IE are mandatory IEs in AUTHENTICATION REQUEST message. The W-AGF acting on behalf of the N5GC device does not use the ngKSI value or the ABBA value provided by the network. If the N5GC device fails to authenticate the network, the W-AGF acting on behalf of the N5GC device shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent. Furthermore, the W-AGF acting on behalf of the N5GC device shall stop any of the retransmission timers that are running (e.g. T3510, T3517 or T3521).",
    "Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request message from the network, the W-AGF acting on behalf of the N5GC device shall stop timer T3520, if running, and then provides the EAP-request message to the N5GC device as normally. If the network fails to authenticate the N5GC device, the network handling depends upon the type of identity used by the W-AGF acting on behalf of the N5GC device in the initial NAS message, that is: a) if the 5G-GUTI was used; or b) if the SUCI was used. If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message of the EAP result message transport procedure, initiate an identification procedure to retrieve SUCI from the W-AGF acting on behalf of the N5GC device and restart the EAP based primary authentication and key agreement procedure with the received SUCI.",
    "If the SUCI was used for identification in the initial NAS message or in a restarted EAP based primary authentication and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the W-AGF acting on behalf of the N5GC device after an unsuccessful EAP based primary authentication and key agreement procedure, the network should transport the EAP-failure message in an AUTHENTICATION REJECT message of the EAP result message transport procedure. If the EAP-failure message is received in an AUTHENTICATION REJECT message, the W-AGF acting on behalf of the N5GC device shall start timer T3247 with a random value uniformly drawn from the range between 30 minutes and 60 minutes, if the timer is not running (see subclause 5.3.20).",
    "Additionally, the W-AGF acting on behalf of the N5GC device shall: a) if the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events has a value less than a W-AGF implementation-specific maximum value, proceed as specified in list item 1)-b) of subclause 5.3.20.2 for the case that the 5GMM cause value received is #3; or b) otherwise, set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI. The USIM shall be considered invalid for 5GS services via non-3GPP access until switching off or the UICC containing the USIM is removed. If the AUTHENTICATION REJECT message is received by the W-AGF acting on behalf of the N5GC device, the W- AGF acting on behalf of the N5GC device shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any stored SUCI.",
    "Upon receiving an EAP-success message, the W-AGF acting on behalf of the N5GC device shall consider the procedure complete. Upon receiving an EAP-failure message, the W-AGF acting on behalf of the N5GC device shall consider the procedure complete. 5.4.1.2.3C Procedures related to EAP methods used for primary authentication of an AUN3 device 5.4.1.2.3C.1 General This subclause applies when an EAP method is used for primary authentication of an AUN3 device, when a 5G-RG supports acting on behalf of the AUN3 device, the AMF supports serving the 5G-RG acting on behalf of the AUN3 device and the AUSF supports authentication of the AUN3 device. EAP-AKA' and EAP-TLS are examples of such EAP method. The AUSF supporting authentication of the AUN3 device shall support acting as EAP server of at least one such EAP method as specified in annex Z of 3GPP TS 33.501 [24].",
    "The 5G-RG acting on behalf of the AUN3 device provides to the AUN3 device an EAP-request message, an EAP- success message or an EAP-failure message received from the network according to subclause 5.4.1.2.1 and sends to the network according to subclause 5.4.1.2.1 an EAP-response provided by the AUN3 device. Details of communication between the AUN3 device and the 5G-RG acting on behalf of the AUN3 device are out of scope of this specification. When initiating an EAP based primary authentication and key agreement procedure using such EAP method, the network shall select an ngKSI value. The network shall send the selected ngKSI value to the 5G-RG acting on behalf of the AUN3 device along with each EAP message. The network shall send the ABBA value as described in subclause 9.11.3.10 to the 5G-RG acting on behalf of the AUN3 device along with the EAP-request message and EAP- success message.",
    "The 5G-RG acting on behalf of the AUN3 device shall not forward the ngKSI value or the ABBA value to the AUN3 device. NOTE 1: The network provides the ngKSI value and the ABBA value since the ngKSI IE and the ABBA IE are mandatory IEs in AUTHENTICATION REQUEST message. The 5G-RG acting on behalf of the AUN3 device does not use the ngKSI value or the ABBA value provided by the network. If the 5G-RG acting on behalf of the AUN3 device is informed by AUN3 about failure to authenticate the network, the 5G-RG acting on behalf of the AUN3 device shall start timer T3520 when the AUTHENTICATION RESPONSE message containing the EAP-response message is sent. Furthermore, the 5G-RG acting on behalf of the AUN3 device shall stop any of the retransmission timers that are running (e.g. T3510, T3517 or T3521).",
    "Upon receiving an AUTHENTICATION REQUEST message with the EAP message IE containing an EAP-request message from the network, the 5G-RG acting on behalf of the AUN3 device shall stop timer T3520, if running, and then provides the EAP-request message to the AUN3 device as normally. If the network fails to authenticate the AUN3 device, the network handling depends upon the type of identity used by the 5G-RG acting on behalf of the AUN3 device in the initial NAS message, that is: a) if the 5G-GUTI was used; or b) if the SUCI was used. If the 5G-GUTI was used, the network should transport the EAP-failure message in the AUTHENTICATION RESULT message as specified in the EAP result message transport procedure, initiate an identification procedure to retrieve SUCI from the 5G-RG acting on behalf of the AUN3 device and restart the EAP based primary authentication and key agreement procedure with the received SUCI.",
    "If the SUCI was used for identification in the initial NAS message or in a restarted EAP based primary authentication and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the 5G-RG acting on behalf of the AUN3 device after an unsuccessful EAP based primary authentication and key agreement procedure, the network should transport the EAP-failure message in an AUTHENTICATION REJECT message as specified in the EAP result message transport procedure. If the EAP-failure message is received in an AUTHENTICATION REJECT message, the 5G-RG acting on behalf of the AUN3 device shall start timer T3247 with a random value uniformly drawn from the range between 30 minutes and 60 minutes, if the timer is not running (see subclause 5.3.20).",
    "Additionally, the 5G-RG acting on behalf of the AUN3 device shall: a) if the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events has a value less than a 5G-RG implementation-specific maximum value, proceed as specified in list item 1)-b) of subclause 5.3.20.2 for the case that the 5GMM cause value received is #3; or b) otherwise, set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI. The USIM shall be considered invalid for 5GS services via non-3GPP access until switching off or the UICC containing the USIM is removed. If the AUTHENTICATION REJECT message is received by the 5G-RG acting on behalf of the AUN3 device, the 5G- RG acting on behalf of the AUN3 device shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3517, T3519 or T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any stored SUCI.",
    "Upon receiving an EAP-success message from the network, the 5G-RG acting on behalf of the AUN3 device shall consider the procedure complete. The network shall provide: a) the Master session key, if the AUN3 device does not support 5G key hierarchy; or b) the KWAGF key, if the AUN3 device supports 5G key hierarchy; to the 5G-RG along with the EAP-success message as specified in subclauses 5.4.1.2.5.2 and 5.4.2.2. The 5G-RG acting on behalf of the AUN3 device shall derive the Pairwise master key from the Master session key or the KWAGF key as specified in subclause 7B.7 of 3GPP TS 33.501 [24]. The 5G-RG acting on behalf of the AUN3 device provides the EAP-success message to the AUN3 device. NOTE 2: The network is aware from the AUN3 device subscription data in UDM whether the AUN3 device supports 5G key hierarchy or not as specified in subclause 7B.7 of 3GPP TS 33.501 [24].",
    "Upon receiving an EAP-failure message from the network, the 5G-RG acting on behalf of the AUN3 device shall consider the procedure complete. In order to initiate the EAP message reliable transport procedure, the AMF shall create an AUTHENTICATION REQUEST message. The AMF shall set the EAP message IE of the AUTHENTICATION REQUEST message to the EAP-request message to be sent to the UE. The AMF shall set the ngKSI IE of the AUTHENTICATION REQUEST message to the ngKSI value selected in subclause 5.4.1.2.2.2, subclause 5.4.1.2.3.1 or subclause 5.4.1.2.3A.1. In this release of specification, the AMF shall set the ABBA IE of the AUTHENTICATION REQUEST message with the length of ABBA IE to 2 and the ABBA contents to be 2 octets in length with value 0000H as described in subclause 9.11.3.10. The AMF shall send the AUTHENTICATION REQUEST message to the UE, and the AMF shall start timer T3560 (see example in figure 5.4.1.2.4.2.1).",
    "UE AMF AUTHENTICATION RESPONSE AUTHENTICATION REQUEST Stop T3560 Start T3560 Figure 5.4.1.2.4.2.1: EAP message reliable transport procedure Upon receipt of an AUTHENTICATION REQUEST message with the EAP message IE, the UE handles the EAP message received in the EAP message IE and the ABBA of the AUTHENTICATION REQUEST message. The following abnormal cases can be identified: a) Authentication failure (5GMM cause #71 \"ngKSI already in use\"). The UE shall send an AUTHENTICATION FAILURE message, with 5GMM cause #71 \"ngKSI already in use\", to the network and start the timer T3520 (see example in figure 5.4.1.3.7.1). Furthermore, the UE shall stop any of the retransmission timers that are running (e.g. T3510, T3517 or T3521). Upon the first receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #71 \"ngKSI already in use\", the network performs necessary actions to select a new ngKSI and send the same EAP-request message to the UE.",
    "NOTE 1: Upon receipt of an AUTHENTICATION FAILURE message from the UE with 5GMM cause #71 \"ngKSI already in use\", the network can also re-initiate the EAP based primary authentication and key agreement procedure (see subclause 5.4.1.2.2.2). Upon receiving a new AUTHENTICATION REQUEST message with the EAP message IE containing an EAP- request message from the network, the UE shall stop timer T3520, if running, process the EAP-request message as normal. If the network is validated successfully (an AUTHENTICATION REQUEST message that contains a valid ngKSI and EAP-request message is received), the UE shall send the AUTHENTICATION RESPONSE message to the network and shall start any retransmission timers (e.g. T3510, T3517 or T3521) if they were running and stopped when the UE received the first failed AUTHENTICATION REQUEST message.",
    "b) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE message indication from lower layers (if the EAP based primary authentication and key agreement procedure is triggered by a registration procedure). The UE shall stop the timer T3520, if running, and re-initiate the registration procedure. c) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE message indication with change in the current TAI (if the EAP based primary authentication and key agreement procedure is triggered by a service request procedure). The UE shall stop the timer T3520, if running. If the current TAI is not in the TAI list, the EAP based primary authentication and key agreement procedure shall be aborted and a registration procedure for mobility and periodic registration update shall be initiated.",
    "If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing procedure that triggered the EAP based primary authentication and key agreement procedure. d) Transmission failure of AUTHENTICATION RESPONSE message or AUTHENTICATION FAILURE message indication without change in the current TAI (if the authentication procedure is triggered by a service request procedure). The UE shall stop the timer T3520, if running. It is up to the UE implementation how to re-run the ongoing procedure that triggered the EAP based primary authentication and key agreement procedure. e) Network failing the authentication check. If the UE deems that the network has failed the authentication check, then it shall request RRC to locally release the RRC connection and treat the active cell as barred (see 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C]).",
    "The UE shall start any retransmission timers (e.g. T3510, T3517 or T3521), if they were running and stopped when the UE received the first AUTHENTICATION REQUEST message containing an ngKSI that was already in use. f) Change in the current TAI. If that the current TAI is not in the TAI list before the AUTHENTICATION RESPONSE message is sent, the UE may discard sending the AUTHENTICATION RESPONSE message to the network and continue with the initiation of the registration procedure for mobility and periodic registration update as described in subclause 5.5.1.3.2. For item e, if no emergency service is started or is ongoing: The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-IDLE mode, e.g. upon detection of a lower layer failure, release of the N1 NAS signalling connection, or as the result of an inter-system change in 5GMM-CONNECTED mode from N1 mode to S1 mode.",
    "The UE shall deem that the network has failed the authentication check or assume that the authentication is not genuine and proceed as described in item e above if any of the following occurs: - the timer T3520 expires; - the UE detects any combination of the EAP-based authentication failures: transmission of AUTHENTICATION FAILURE message with 5GMM cause #71 \"ngKSI already in use\", transmission of AUTHENTICATION RESPONSE message with an EAP-response message after detecting an error as described in subclause 5.4.1.2.2.4, with an EAP-response message after not accepting of the server certificate as described in subclause 5.4.1.2.3.1 or with an EAP-response message after failing to authenticate the network as described in subclause 5.4.1.2.3A.1, during three consecutive authentication challenges.",
    "The EAP-request/AKA'-challenge challenges shall be considered as consecutive only, if the EAP-request/AKA'- challenge challenges causing the second and third EAP-based authentication failure are received by the UE, while the timer T3520 started after the previous EAP-based authentication failure is running. Not accepting of the server certificate shall be considered as consecutive only, if the EAP-request messages causing the second and third not accepting of the server certificate are received by the UE, while the timer T3520 started after the previous EAP request message causing the previous not accepting of the server certificate is running. NOTE 2: Reception of an EAP-failure message is not considered when determining the three consecutive authentication challenges or three consecutive not accepting of the server certificate.",
    "For item e if there is an emergency service started or is ongoin: The UE shall stop timer T3520, if the timer is running and the UE enters 5GMM-IDLE mode, e.g. upon detection of a lower layer failure, release of the N1 NAS signalling connection, or as the result of an inter-system change in 5GMM-CONNECTED mode from N1 mode to S1 mode.",
    "If a UE has an emergency PDU session established or is establishing an emergency PDU session, and sends an AUTHENTICATION FAILURE message to the AMF with the 5GMM cause appropriate for this cases (i.e. #71) or an AUTHENTICATION RESPONSE message containing an EAP-response message as described in subclause 5.4.1.2.2.4, containing an EAP-response message after not accepting of the server certificate as described in subclause 5.4.1.2.3.1 or containing an EAP-response message after failing to authenticate the network as described in subclause 5.4.1.2.3A.1, and receives the SECURITY MODE COMMAND message before the timeout of timer T3520, the UE shall deem that the network has passed the authentication check successfully, stop timer T3520, respectively, and execute the security mode control procedure.",
    "If a UE has an emergency PDU session established or is establishing an emergency PDU session when timer T3520 expires, the UE shall not deem that the network has failed the authentication check and not behave as described in item e. Instead the UE shall continue using the current security context, if any, release all non- emergency PDU sessions, if any, by initiating UE-requested PDU session release procedure. If there is an ongoing PDU session establishment procedure, the UE shall release all non-emergency PDU sessions upon completion of the PDU session establishment procedure. The UE shall start any retransmission timers (e.g. T3510, T3517 or T3521) if: - they were running and stopped when the UE received the AUTHENTICATION REQUEST message and detected an authentication failure; and - the procedures associated with these timers have not yet been completed. The UE shall consider itself to be registered for emergency services.",
    "In order to initiate the EAP result message transport procedure, the AMF shall create an AUTHENTICATION RESULT message or an AUTHENTICATION REJECT message. The AMF shall set the EAP message IE of the AUTHENTICATION RESULT message to an EAP-success message or an EAP-failure message to be sent to the UE. If the AUTHENTICATION RESULT message is provided to a 5G-RG that is acting on behalf of an AUN3 device and the EAP message IE is set to an EAP-success message, the AMF shall include the AUN3 device security key IE in the AUTHENTICATION RESULT message with its value set to: a) the Master session key, if the AUN3 device does not support 5G key hierarchy; or b) the KWAGF key, if the AUN3 device supports 5G key hierarchy. NOTE: The network is aware from the AUN3 device subscription data in UDM whether the AUN3 device supports 5G key hierarchy or not as specified in subclause 7B.7 of 3GPP TS 33.501 [24].",
    "The AMF shall set the EAP message IE of the AUTHENTICATION REJECT message to an EAP-failure message to be sent to the UE. The AMF shall set the ngKSI IE of the AUTHENTICATION RESULT message or the AUTHENTICATION REJECT message to the ngKSI value selected in subclause 5.4.1.2.2.2, subclause 5.4.1.2.3.1 or subclause 5.4.1.2.3A.1. The AMF shall send the AUTHENTICATION RESULT message or the AUTHENTICATION REJECT message to the UE (see example in figure 5.4.1.2.5.2.1).",
    "UE AMF AUTHENTICATION RESULT AUTHENTICATION REJECT OR Figure 5.4.1.2.5.2.1: EAP result message transport procedure Upon receipt of an AUTHENTICATION RESULT message or an AUTHENTICATION REJECT message with the EAP message IE, the UE handles the EAP message received in the EAP message IE and the ABBA if received of the AUTHENTICATION RESULT message or in the AUTHENTICATION REJECT message, and the 5G-RG that is acting on behalf of an AUN3 device handles the AUN3 device security key IE if received in the AUTHENTICATION RESULT message. The network may initiate a 5G AKA based primary authentication and key agreement procedure for a UE in 5GMM- CONNECTED mode at any time.",
    "For restrictions applicable after handover or inter-system change to N1 mode in 5GMM-CONNECTED mode, see subclause 5.5.1.3.3. The network initiates the 5G AKA based primary authentication and key agreement procedure by sending an AUTHENTICATION REQUEST message to the UE and starting the timer T3560 (see example in figure 5.4.1.3.2.1). The AUTHENTICATION REQUEST message shall contain the parameters necessary to calculate the authentication response (see 3GPP TS 33.501 [24]). This message shall include the ngKSI that will be used by the UE and AMF to identify the KAMF and the partial native security context that is created if the authentication is successful. This message shall also include the ABBA parameter. In this release of specification, the network shall set the length of ABBA IE to 2 and the ABBA contents to be 2 octets in length with value 0000H as described in subclause 9.11.3.10.",
    "If an ngKSI is contained in an initial NAS message during a 5GMM procedure, the network shall include a different ngKSI value in the AUTHENTICATION REQUEST message when it initiates a 5G AKA based primary authentication and key agreement procedure. Figure 5.4.1.3.2.1: 5G AKA based primary authentication and key agreement procedure If the authentication response (RES) returned by the UE is not valid, the network response depends upon the type of identity used by the UE in the initial NAS message, that is: - if the 5G-GUTI was used; or - if the SUCI was used. If the 5G-GUTI was used, the network should initiate an identification procedure to retrieve SUCI from the UE and restart the 5G AKA based primary authentication and key agreement procedure with the received SUCI.",
    "If the SUCI was used for identification in the initial NAS message or in a restarted 5G AKA based primary authentication and key agreement procedure, or the network decides not to initiate the identification procedure to retrieve SUCI from the UE after an unsuccessful 5G AKA based primary authentication and key agreement procedure, the network should send an AUTHENTICATION REJECT message to the UE. The network shall maintain, if any, the 5GMM-context and 5G NAS security context of the UE unchanged. Upon receipt of an AUTHENTICATION REJECT message, 1) if the AUTHENTICATION REJECT message has been successfully integrity checked by the NAS: the UE shall set the update status to 5U3 ROAMING NOT ALLOWED, delete the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI. In case of PLMN, the USIM shall be considered invalid until switching off the UE or the UICC containing the USIM is removed.",
    "In case of SNPN, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN and the UE does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN shall be considered invalid until the UE is switched off or the entry is updated. Additionally, the UE shall consider the USIM as invalid for the current SNPN until switching off or the UICC containing the USIM is removed. In case of SNPN, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN and the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs, or both, the UE shall consider the selected entry of the \"list of subscriber data\" as invalid for 3GPP access until the UE is switched off or the entry is updated.",
    "Additionally, the UE shall consider the USIM as invalid for the entry until switching off or the UICC containing the USIM is removed.",
    "In case of SNPN, if the UE is registered for onboarding services in SNPN or is performing initial registration for onboarding services in SNPN, the UE shall store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5]; and - if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN, the UE shall set: i) the counter for \"SIM/USIM considered invalid for GPRS services\" events, the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events, and the counter for \"SIM/USIM considered invalid for non-GPRS services\" events if maintained by the UE, in case of PLMN; or ii) the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events and the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events in case of SNPN; to UE implementation-specific maximum value.",
    "If the UE is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN, the UE shall set the SNPN-specific attempt counter for the current SNPN to the UE implementation-specific maximum value; and - if the UE is operating in single-registration mode, the UE shall handle EMM parameters, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case when the authentication procedure is not accepted by the network. The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and 2) if the AUTHENTICATION REJECT message is received without integrity protection and if timer T3516 or T3520 is running, the UE shall start timer T3247 with a random value uniformly drawn from the range between 30 minutes and 60 minutes, if the timer is not running (see subclause 5.3.20).",
    "Additionally, if the UE is neither registered for onboarding services in SNPN nor performing initial registration for onboarding services in SNPN, the UE shall: a) if the AUTHENTICATION REJECT message is received over 3GPP access, and the counter for \"SIM/USIM considered invalid for GPRS services\" events in case of PLMN or the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events in case of SNPN has a value less than a UE implementation-specific maximum value, proceed as specified in subclause 5.3.20, list item 1)-a) of subclause 5.3.20.2 (if the UE is not operating in SNPN access operation mode) or list item a)-1) of subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for the case that the 5GMM cause value received is #3; b) if the AUTHENTICATION REJECT message is received over non-3GPP access, and the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events in case of PLMN or the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events in case of SNPN has a value less than a UE implementation-specific maximum value, proceed as specified in subclause 5.3.20, list item 1)-b) of subclause 5.3.20.2 (if the UE is not operating in SNPN access operation mode) or list item a)-2) of subclause 5.3.20.3 (if the UE is operating in SNPN access operation mode) for the case that the 5GMM cause value received is #3.",
    "c) otherwise: i) if the AUTHENTICATION REJECT message is received over 3GPP access: - The UE shall set the update status for 3GPP access to 5U3 ROAMING NOT ALLOWED, delete for 3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI. - In case of PLMN, the UE shall consider the USIM as invalid for 5GS services via 3GPP access and non-EPS service until switching off the UE or the UICC containing the USIM is removed. In case of SNPN, the UE shall consider the entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN shall be considered invalid for 3GPP access until the UE is switched off or the entry is updated. Additionally, the UE shall consider the USIM as invalid for the current SNPN via 3GPP access until switching off or the UICC containing the USIM is removed.",
    "- The UE shall set: - the counter for \"SIM/USIM considered invalid for GPRS services\" events and the counter for \"SIM/USIM considered invalid for non-GPRS services\" events if maintained by the UE, in case of PLMN; or - the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events in case of SNPN; to UE implementation-specific maximum value. - If the UE is operating in single-registration mode, the UE shall handle 4G-GUTI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case when the authentication procedure is not accepted by the network.",
    "The USIM shall be considered as invalid also for non-EPS services until switching off or the UICC containing the USIM is removed; and ii) if the AUTHENTICATION REJECT message is received over non-3GPP access: - the UE shall set the update status for non-3GPP access to 5U3 ROAMING NOT ALLOWED, delete for non-3GPP access only the stored 5G-GUTI, TAI list, last visited registered TAI and ngKSI; - in case of PLMN, the UE shall consider the USIM as invalid for 5GS services via non-3GPP access until switching off the UE or the UICC containing the USIM is removed. In case of SNPN, the UE shall consider the entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN as invalid for non-3GPP access until the UE is switched off or the entry is updated.",
    "Additionally, the UE shall consider the USIM as invalid for the current SNPN and for non- 3GPP access until switching off or the UICC containing the USIM is removed; and - the UE shall set: - the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events to UE implementation-specific maximum value in case of PLMN; or - the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events to UE implementation-specific maximum value in case of SNPN.",
    "If the UE is registered for onboarding services in SNPN or performing initial registration for onboarding services in SNPN, the UE shall: 1) if the SNPN-specific attempt counter for the SNPN sending the AUTHENTICATION REJECT message has a value less than a UE implementation-specific maximum value, increment the SNPN-specific attempt counter for the SNPN; or 2) otherwise, the UE shall set the update status to 5U3.ROAMING NOT ALLOWED, delete the stored 5G- GUTI, TAI list, last visited registered TAI, and ngKSI, store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN- SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5].",
    "If the AUTHENTICATION REJECT message is received by the UE, the UE shall abort any 5GMM signalling procedure, stop any of the timers T3510, T3516, T3517, T3519, T3520 or T3521 (if they were running), enter state 5GMM-DEREGISTERED and delete any stored SUCI. Depending on local requirements or operator preference for emergency services, if the UE initiates a registration procedure with 5GS registration type IE set to \"emergency registration\" and the AMF is configured to allow emergency registration without user identity, the AMF needs not follow the procedures specified for the authentication failure in the present subclause. The AMF may continue a current 5GMM specific procedure. The purpose of the NAS security mode control procedure is to take a 5G NAS security context into use, and initialise and start NAS signalling security between the UE and the AMF with the corresponding 5G NAS keys and 5G NAS security algorithms.",
    "Furthermore, the network may also initiate the security mode control procedure in the following cases: a)- in order to change the 5G NAS security algorithms for a current 5G NAS security context already in use; b) in order to change the value of uplink NAS COUNT used in the latest SECURITY MODE COMPLETE message as described in 3GPP TS 33.501 [24], subclause 6.9.4.4; and c) in order to provide the Selected EPS NAS security algorithms to the UE.",
    "For restrictions concerning the concurrent running of a security mode control procedure with other security related procedures in the AS or inside the core network see 3GPP TS 33.501 [24], subclause 6.9.5. If the security mode control procedure is initiated after successful 5G AKA based primary authentication and key agreement procedure and the security mode control procedure intends to bring into use the partial native 5G NAS security context created by the 5G AKA based primary authentication and key agreement procedure and the UE accepts received security mode command (see subclause 5.4.2.3), the ME shall: a) delete the valid KAUSF and the valid KSEAF, if any; and b) consider the new KAUSF to be the valid KAUSF, and the new KSEAF to be the valid KSEAF, reset the SOR counter and the UE parameter update counter to zero, and store the valid KAUSF, the valid KSEAF, the SOR counter and the UE parameter update counter as specified in annex C and use the valid KAUSF in the verification of SOR transparent container and UE parameters update transparent container, if any are received.",
    "NOTE: The AMF does not perform a security mode control procedure when the 5G AKA based primary authentication procedure successfully authenticates a 5G ProSe layer-3 remote UE accessing the network via a 5G ProSe layer-3 UE-to-network relay UE served by the AMF. The AMF shall, upon receipt of the SECURITY MODE COMPLETE message, stop timer T3560. From this time onward the AMF shall integrity protect and encipher all signalling messages with the selected 5GS integrity and ciphering algorithms. If the SECURITY MODE COMPLETE message contains a NAS message container IE with a REGISTRATION REQUEST message, the AMF shall complete the ongoing registration procedure by considering the REGISTRATION REQUEST message contained in the NAS message container IE as the message that triggered the procedure.",
    "If the SECURITY MODE COMPLETE message contains a NAS message container IE with a DEREGISTRATION REQUEST message, the AMF shall complete the ongoing deregistration procedure by considering the DEREGISTRATION REQUEST message contained in the NAS message container IE as the message that triggered the procedure. If the SECURITY MODE COMPLETE message contains a NAS message container IE with a REGISTRATION REQUEST message, the 5GMM capability IE included in the REGISTRATION REQUEST message indicates \"S1 mode supported\" and the AMF supports N26 interface, the AMF shall initiate another NAS security mode control procedure in order to provide the selected EPS NAS security algorithms to the UE as described in subclause 5.4.2.2. This second NAS security mode control procedure should be initiated as part of 5GMM common procedures of the ongoing registration procedure.",
    "If the SECURITY MODE COMPLETE message contains a NAS message container IE with a SERVICE REQUEST message, the AMF shall complete the ongoing service request procedure by considering the SERVICE REQUEST message contained in the NAS message container IE as the message that triggered the procedure. If the SECURITY MODE COMPLETE message contains a NAS message container IE with a CONTROL PLANE SERVICE REQUEST message, the AMF shall complete the ongoing service request procedure by considering the CONTROL PLANE SERVICE REQUEST message contained in the NAS message container IE as the message that triggered the procedure. The following abnormal cases can be identified: a) Lower layer failure before the SECURITY MODE COMPLETE or SECURITY MODE REJECT message is received. The network shall abort the security mode control procedure. b) Expiry of timer T3560.",
    "The network shall, on the first expiry of the timer T3560, retransmit the SECURITY MODE COMMAND message and shall reset and start timer T3560. This retransmission is repeated four times, i.e. on the fifth expiry of timer T3560, the procedure shall be aborted. c) Collision between security mode control procedure and registration, service request or de-registration procedure not indicating switch off. The network shall abort the security mode control procedure and proceed with the UE initiated procedure. d) Collision between security mode control procedure and other 5GMM procedures than in item c. The network shall progress both procedures. e) Lower layers indication of non-delivered NAS PDU due to handover: If the SECURITY MODE COMMAND message could not be delivered due to an intra AMF handover and the target TA is included in the TAI list, then upon successful completion of the intra AMF handover the AMF shall retransmit the SECURITY MODE COMMAND message.",
    "If a failure of the handover procedure is reported by the lower layer and the N1 signalling connection exists, the AMF shall retransmit the SECURITY MODE COMMAND message. The AMF initiates the identification procedure by sending an IDENTITY REQUEST message to the UE and starting timer T3570 (see example in figure 5.4.3.2.1). The IDENTITY REQUEST message specifies the requested identification parameters in the Identity type information element. Figure 5.4.3.2.1: Identification procedure The following abnormal cases can be identified: a) Transmission failure of the IDENTITY RESPONSE message (if the identification procedure is triggered by a registration procedure). The UE shall re-initiate the registration procedure. b) Requested identity is not available If the UE cannot encode the requested identity in the IDENTITY RESPONSE message, e.g. because no valid USIM is available, then it shall encode the identity type as \"No identity\".",
    "The purpose of this procedure is to: a) allow the AMF to update the UE configuration for access and mobility management-related parameters decided and provided by the AMF by providing new parameter information within the command; b) request the UE to perform a registration procedure for mobility and periodic registration update towards the network to update access and mobility management-related parameters decided and provided by the AMF (see subclause 5.5.1.3); c) deliver the UAV authorization information to the UE, as described in 3GPP TS 23.256 [6AB]; or d) update the PEIPS assistance information in the UE (see subclause 5.3.25). This procedure is initiated by the network and can only be used when the UE has an established 5GMM context, and the UE is in 5GMM-CONNECTED mode. When the UE is in 5GMM-IDLE mode, the AMF may use the paging or notification procedure to initiate the generic UE configuration update procedure.",
    "The AMF can request a confirmation response in order to ensure that the parameter has been updated by the UE.",
    "This procedure shall be initiated by the network to assign a new 5G-GUTI to the UE after: a) a successful service request procedure invoked as a response to a paging request from the network and before the: 1) release of the N1 NAS signalling connection; or 2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend indication; or b) the AMF receives an indication from the lower layers that it has received the NGAP UE context resume request message as specified in 3GPP TS 38.413 [31] for a UE in 5GMM-IDLE mode with suspend indication and this resumption is a response to a paging request from the network, and before the: 1) release of the N1 NAS signalling connection; or 2) suspension of the N1 NAS signalling connection due to user plane CIoT 5GS optimization i.e. before the UE and the AMF enter 5GMM-IDLE mode with suspend indication.",
    "If the service request procedure was triggered due to 5GSM downlink signalling pending, the procedure for assigning a new 5G-GUTI can be initiated by the network after the transport of the 5GSM downlink signalling. The following parameters are supported by the generic UE configuration update procedure without the need to request the UE to perform the registration procedure for mobility and periodic registration update: a) 5G-GUTI; b) TAI list; c) Service area list; d) NITZ information; e) LADN information; e1) Extended LADN information; f) Rejected NSSAI; NOTE: A cause value associated with a rejected S-NSSAI can be included in the Rejected NSSAI IE or in the Extended rejected NSSAI IE and a back-off timer value associated with rejected S-NSSAI(s) can be included in the Extended rejected NSSAI IE.",
    "g) void; h) Operator-defined access category definitions; i) SMS indication; j) \"CAG information list\"; k) UE radio capability ID; l) 5GS registration result; m) Truncated 5G-S-TMSI configuration; n) T3447 value; o) \"list of PLMN(s) to be used in disaster condition\"; p) disaster roaming wait range; q) disaster return wait range; r) PEIPS assistance information; s) Priority indicator; t) NSAG information; u) RAN timing synchronization; v) Alternative NSSAI; w) Discontinuous coverage maximum time offset x) void; y) Partially rejected NSSAI; and z) On-demand NSSAI. The following parameters can be sent to the UE with or without a request to perform the registration procedure for mobility and periodic registration update: a) Allowed NSSAI; b) Configured NSSAI; c) Network slicing subscription change indication; d) NSSRG information; e) S-NSSAI location validity information; e1) S-NSSAI time validity information; f) feature authorization indication; and g) Partially allowed NSSAI.",
    "The following parameters are sent to the UE with a request to perform the registration procedure for mobility and periodic registration update: a) MICO indication; b) UE radio capability ID deletion indication; and c) Additional configuration indication. The following parameters can be included in the Service-level-AA container IE to be sent to the UE without a request to perform the registration procedure for mobility and periodic registration update: a) Service-level device ID; b) Service-level-AA payload type; c) Service-level-AA payload; d) Service-level-AA response; or e) Service-level-AA service status indication.",
    "The following parameters are sent over 3GPP access only: a) LADN information; a1) Extended LADN information; b) MICO indication; c) TAI list; d) Service area list; e) \"CAG information list\"; f) UE radio capability ID; g) UE radio capability ID deletion indication; h) Truncated 5G-S-TMSI configuration; i) Additional configuration indication; j) T3447 value; k) Service-level-AA container; l) NSAG information; and m) RAN timing synchronization. o) S-NSSAI location validity information.",
    "The following parameters are managed and sent per access type i.e., independently over 3GPP access or non-3GPP access: a) Allowed NSSAI; b) Rejected NSSAI (when the NSSAI is rejected for the current registration area or is rejected for the maximum number of UEs reached); and c) If the UE is not registered to the same PLMN or SNPN over 3GPP and non-3GPP access: - 5G-GUTI; - NITZ information; - Rejected NSSAI (when the NSSAI is rejected for the current PLMN or SNPN or rejected for the failed or revoked NSSAA); - Configured NSSAI; - NSSRG information; - SMS indication; - 5GS registration result; - PEIPS assistance information; - MPS indicator; - S-NSSAI time validity information; - Alternative NSSAI; and - MCS indicator.",
    "If the UE is registered to the same PLMN or SNPN over 3GPP and non-3GPP access, the following parameters are managed commonly and sent over 3GPP access or non-3GPP access: a) 5G-GUTI; b) NITZ information; c) Rejected NSSAI (when the NSSAI is rejected for the current PLMN or SNPN or rejected for the failed or revoked NSSAA); d) Configured NSSAI; e) SMS indication; and f) 5GS registration result; g) \"list of PLMN(s) to be used in disaster condition\"; h) disaster roaming wait range; i) disaster return wait range; j) PEIPS assistance information; k) NSSRG information; l) MPS indicator; m) S-NSSAI time validity information; and n) MCS indicator.",
    "UE AMF CONFIGURATION UPDATE COMMAND CONFIGURATION UPDATE COMPLETE Start T3555 Stop T3555 OR CONFIGURATION UPDATE COMMAND Figure 5.4.4.1.1: Generic UE configuration update procedure B) the UE has an emergency PDU session, then the UE shall perform a local release of all PDU sessions associated with 3GPP access except for the emergency PDU session and enter the state 5GMM- REGISTERED.LIMITED-SERVICE; or b) If the UE receives the CONFIGURATION UPDATE COMMAND message via a non-CAG cell and the entry for the current PLMN in the received \"CAG information list\" includes an \"indication that the UE is only allowed to access 5GS via CAG cells\" and: 1) if one or more CAG-ID(s) are authorized based on the \"allowed CAG list\" for the current PLMN in the received \"CAG information list\", the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28] with the updated \"CAG information list\"; or 2) if no CAG-ID is authorized based on the \"Allowed CAG list\" of the entry for the current PLMN in the received \"CAG information list\"and: i) the UE does not have an emergency PDU session, then the UE shall enter the state 5GMM- REGISTERED.PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP TS The following abnormal cases can be identified: a) Transmission failure of the CONFIGURATION UPDATE COMPLETE message with TAI change from lower layers If the current TAI is not in the TAI list, the generic UE configuration update procedure shall be aborted and a registration procedure for mobility and periodic registration update shall be initiated.",
    "If the current TAI is still part of the TAI list, it is up to the UE implementation how to re-run the ongoing procedure that triggered the generic UE configuration update procedure. b) Transmission failure of CONFIGURATION UPDATE COMPLETE message indication without TAI change from lower layers It is up to the UE implementation how to re-run the ongoing procedure that triggered the generic UE configuration update procedure. c) Generic UE configuration update and de-registration procedure collision If the UE receives CONFIGURATION UPDATE COMMAND message after sending a DEREGISTRATION REQUEST message and the access type included in the DEREGISTRATION REQEUST message is same as the access in which the CONFIGURATION UPDATE COMMAND message is received, then the UE shall ignore the CONFIGURATION UPDATE COMMAND message and proceed with the de-registration procedure. Otherwise, the UE shall proceed with both the procedures.",
    "d) Void e) Generic UE configuration update and service request procedure collision If the SERVICE REQUEST message does not include UE request type IE with Request type value set to \"NAS signalling connection release\" and the UE receives a CONFIGURATION UPDATE COMMAND message before the ongoing service request procedure has been completed, the UE shall proceed with both the procedures. If the SERVICE REQUEST message includes UE request type IE with Request type value set to \"NAS signalling connection release\" and the UE receives a CONFIGURATION UPDATE COMMAND message before the ongoing service request procedure has been completed, the UE shall ignore the CONFIGURATION UPDATE COMMAND message and proceed with the service request procedure.",
    "f) \"CAG information list\" is received and the UE is operating in SNPN access operation mode If the UE receives the CAG information list IE in the CONFIGURATION UPDATE COMMAND message and the UE is operating in SNPN access operation mode, the UE shall ignore the content of CAG information list IE. The purpose of the NAS transport procedures is to provide a transport of payload between the UE and the AMF. The type of the payload is identified by the Payload container type IE and includes one of the following: a) a single 5GSM message; b) SMS; c) an LPP message (see 3GPP TS 37.355 [26]); c1) an SLPP message (see 3GPP TS 38.355 [26A]); d) an SOR transparent container; e) a UE policy container; f) a UE parameters update transparent container; g) a location services message (see 3GPP TS 24.080 [13A]); h) a CIoT user data container; i) a Service-level-AA container; j) a UPP-CMI container; or k) Multiple payloads.",
    "For payload type a) to e), g) and h), along with the payload, the NAS transport procedure may transport the associated information (e.g. PDU session information for 5GSM message payload). For payload type k), the Payload container IE consists a list of payload container entries, where each of payload container entry contains the payload and optional associated information (e.g. PDU session information for 5GSM message payload). NOTE: Payload type can be set to \"Multiple payloads\" if there are more than one payloads to be transported using the NAS transport procedures.",
    "In the connected mode, the UE initiates the NAS transport procedure by sending the UL NAS TRANSPORT message to the AMF, as shown in figure 5.4.5.2.2.1. In case a) in subclause 5.4.5.2.1, the UE shall: - include the PDU session information (PDU session ID, old PDU session ID, S-NSSAI, mapped S-NSSAI (if available in roaming scenarios), DNN, request type, alternative S-NSSAI, MA PDU session information, non- 3GPP access path switching indication), if available; - set the Payload container type IE to \"N1 SM information\"; and - set the Payload container IE to the 5GSM message. The UE shall set the PDU session ID IE to the PDU session ID. If an old PDU session ID is to be included, the UE shall set the Old PDU session ID IE to the old PDU session ID. If an alternative S-NSSAI is to be included, the UE shall set the Alternative S-NSSAI IE to the alternative S-NSSAI and shall set the S-NSSAI IE to the S-NSSAI to be replaced.",
    "If an S-NSSAI is to be included, the UE shall set the S-NSSAI IE to the S-NSSAI selected for the PDU session from the allowed NSSAI for the current PLMN or SNPN, associated with the mapped S-NSSAI (if available in roaming scenarios). If a DNN is to be included, the UE shall set the DNN IE to the DNN. 5GSM procedures specified in clause 6 describe conditions for inclusion of the S-NSSAI, mapped S-NSSAI (if available in roaming scenarios), and the DNN. If a request type is to be included, the UE shall set the Request type IE to the request type. The request type is not provided along 5GSM messages other than the PDU SESSION ESTABLISHMENT REQUEST message and the PDU SESSION MODIFICATION REQUEST message. If an MA PDU session information is to be included, the UE shall set the MA PDU session information IE to the MA PDU session information.",
    "The MA PDU session information is not provided along 5GSM messages other than the PDU SESSION ESTABLISHMENT REQUEST message and the PDU SESSION MODIFICATION REQUEST message as specified in 3GPP TS 24.193 [13B]. If the UE supports the non-3GPP access path switching for the PDU session and the AMF has indicated its support for the non-3GPP access path switching, the UE shall include the Non-3GPP access path switching indication information element and set the NAPS bit to \"non-3GPP access path switching supported\". The non-3GPP access path switching indication is not provided along 5GSM messages other than the PDU SESSION ESTABLISHMENT REQUEST message. In case b) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"SMS\"; and - set the Payload container IE to the SMS payload.",
    "Based on the UE preferences regarding access selection for mobile originated (MO) transmission of SMS over NAS as described in 3GPP TS 23.501 [8]: - when SMS over NAS is preferred to be sent over 3GPP access: the UE attempts to deliver MO SMS over NAS via the 3GPP access if the UE is registered over both 3GPP access and non-3GPP access. If the delivery of SMS over NAS via the 3GPP access is not available, the UE attempts to deliver MO SMS over NAS via the non- 3GPP access; and - when SMS over NAS is preferred to be sent over non-3GPP access: the UE attempts to deliver MO SMS over NAS via the non-3GPP access if the UE is registered over both 3GPP access and non-3GPP access. If the delivery of SMS over NAS via the non-3GPP access is not available, the UE attempts to deliver MO SMS over NAS via the 3GPP access.",
    "In case c) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"LTE Positioning Protocol (LPP) message container\"; - set the Payload container IE to the LPP message payload; and - set the Additional information IE to the routing information provided by the upper layer location services application. In case c1) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"SLPP message container\"; - set the Payload container IE to the SLPP message payload; and - set the Additional information IE to the routing information provided by the upper layer location services application.",
    "In case d) in subclause 5.4.5.2.1, the UE: - shall set the Payload container type IE to \"SOR transparent container\"; and - shall set the Payload container IE to the UE acknowledgement due to successful reception of steering of roaming information, and; i) shall set the ME support of SOR-CMCI indicator to \"SOR-CMCI supported by the ME\" ; ii) shall set the ME support of SOR-SNPN-SI indicator to \"SOR-SNPN-SI supported by the ME\" if the UE supports access to an SNPN using credentials from a credentials holder and the UE is operating in SNPN access operation mode or may set the ME support of SOR-SNPN-SI indicator to \"SOR-SNPN-SI supported by the ME\" if the UE supports access to an SNPN using credentials from a credentials holder and the UE is not operating in SNPN access operation mode; and iii) shall set the ME support of SOR-SNPN-SI-LS indicator to \"SOR-SNPN-SI-LS supported by the ME\" if the UE supports access to an SNPN providing access for localized services in SNPN, in the Payload container IE carrying the acknowledgement (see 3GPP TS 23.122 [5]).",
    "In case e) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"UE policy container\"; and - set the contents of the Payload container IE as specified in Annex D. In case f) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"UE parameters update transparent container\"; and - set the contents of the Payload container IE to the UE acknowledgement due to successful reception of UE parameters update data (see 3GPP TS 23.502 [9]).",
    "In case g) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"Location services message container\"; - set the Payload container IE to the Location services message payload; - set the Additional information IE to the routing information, if preconfigured or provided by AMF in a previous procedure or provided by the upper layer location services application; and - include the Payload container information IE with the PRU bit set to \"Payload container related to PRU\" if the location services message payload is related to PRU (see 3GPP TS 24.080 [13A]). NOTE: The AMF may configure the routing information to the UE during the PRU association procedure or the PRU disassociation procedure as specified in 3GPP TS 23.273 [6B].",
    "In case h) in subclause 5.4.5.2.1: - if the UE is not located outside the LADN service area, the UE shall: - include the PDU session ID, and Release assistance indication (if available); - set the Payload container type IE to \"CIoT user data container\"; and - set the Payload container IE to the user data container; or - if the UE is located outside the LADN service area, the UE shall not perform the UE-initiated NAS transport procedure to send CIoT user data via the control plane for a PDU session for LADN. In case i) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"Service-level-AA container\"; and - set the Payload container IE to the Service-level-AA container.",
    "In case j) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"UPP-CMI container\"; - set the Payload container IE to the UPP-CMI container; and - set the Additional information IE to the routing information, if provided by AMF in a previous procedure or provided by the upper layer location services application.",
    "In case k) in subclause 5.4.5.2.1, the UE shall: - set the Payload container type IE to \"Multiple payloads\"; and - set each payload container entry of the Payload container IE (see subclause 9.11.3.39), as follows: i) set the payload container type field of the payload container entry to a payload container type value set in the Payload container type IE as specified in cases a) to j) above; ii) set the payload container entry contents field of the payload container entry to the payload container contents set in the Payload container IE as specified in cases a) to j) above, and iii) set the optional IE fields, if any, to the optional associated payload routing information as specified in cases a) to j) above.",
    "Figure 5.4.5.2.2.1: UE-initiated NAS transport procedure The following abnormal cases in AMF are identified: a) If the Payload container type IE is set to \"N1 SM information\" and: 1) if the Old PDU session ID IE is not included in the UL NAS TRANSPORT message, the AMF does not have a PDU session routing context for the PDU session ID and the UE, the Request type IE is set to \"initial request\" or \"MA PDU request\", and the SMF selection fails, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 2) if the Old PDU session ID IE is included in the UL NAS TRANSPORT message, the AMF has a PDU session routing context for the old PDU session ID and the UE and does not have a PDU session routing context for the PDU session ID and the UE, the Request type IE is set to \"initial request\", the AMF received a reallocation requested indication from the SMF indicating that the SMF is to be reallocated, and the SMF selection fails, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 3) if the AMF does not have a PDU session routing context for the PDU session ID and the UE, the Request type IE is set to \"existing PDU session\" or \"MA PDU request\", and the user's subscription context obtained from the UDM does not contain an SMF ID for the PDU session ID matching the PDU session ID received from the UE or for the DNN matching the DNN received from the UE such that the SMF ID includes a PLMN identity corresponding to the UE's HPLMN or the current PLMN or the PLMN ID part of the current SNPN, then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f).",
    "4) if the Old PDU session ID IE is included in the UL NAS TRANSPORT message, and the AMF has a PDU session routing context for the old PDU session ID and the UE and does not have a PDU session routing context for the PDU session ID and the UE, the Request type IE is set to \"initial request\" and the AMF has not received a reallocation requested indication, the AMF should select an SMF with following handlings: i) if the S-NSSAI IE is not included and the allowed NSSAI contains: A) one S-NSSAI, the AMF shall use the S-NSSAI in the allowed NSSAI as the S-NSSAI; B) two or more S-NSSAIs and the user's subscription context obtained from UDM contains only one default S-NSSAI that is included in the allowed NSSAI, the AMF shall use the S-NSSAI in the allowed NSSAI as the S-NSSAI; or C) two or more S-NSSAIs and the user's subscription context obtained from UDM contains two or more default S-NSSAI(s) included in the allowed NSSAI, the AMF shall use an S-NSSAI in the allowed NSSAI selected based on operator policy as the S-NSSAI; ii) if the DNN IE is not included, and the user's subscription context obtained from UDM: A) contains the default DNN for the S-NSSAI, the AMF shall use the default DNN as the DNN; and B) does not contain the default DNN for the S-NSSAI, the AMF shall use a locally configured DNN as the DNN; iii) if the DNN selected by the network is a LADN DNN, the AMF shall determine the UE presence in LADN service area (see subclause 6.2.6); iv) if the SMF selection is successful, the AMF should store a PDU session routing context for the PDU session ID and the UE, set the SMF ID in the stored PDU session routing context to the selected SMF ID, and forward the 5GSM message, the PDU session ID, the old PDU session ID, the S-NSSAI, the mapped S-NSSAI (in roaming scenarios), the DNN determined by the AMF, DNN selected by the network (if different from DNN determined by the AMF), the request type and UE presence in LADN service area (if DNN selected by the network corresponds to an LADN DNN) towards the SMF ID of the PDU session routing context; and v) if the SMF selection fails, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 5) if the AMF has a PDU session routing context for the PDU session ID and the UE, the PDU session routing context indicates that the PDU session is an emergency PDU session, the Request type IE is set to \"initial emergency request\", the AMF should forward the 5GSM message, the PDU session ID, the S-NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data) and the request type towards the SMF ID of the PDU session routing context; 6) if the Request type IE is set to \"initial emergency request\" and the S-NSSAI or the DNN is received, the AMF ignores the received S-NSSAI or the DNN and uses the emergency DNN from the AMF emergency configuration data, if any; 7) if the AMF does not have a PDU session routing context for the PDU session ID and the UE, and the Request type IE of the UL NAS TRANSPORT message is either not provided or is provided but set to other value than \"initial request\", \"existing PDU session\", \"initial emergency request\", \"existing emergency PDU session\" and \"MA PDU request\", then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 8) if the AMF unsuccessfully attempted to forward the 5GSM message, the PDU session ID, the S-NSSAI, the mapped S-NSSAI (in roaming scenarios), the DNN and the request type (if received) towards a SMF ID, then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f).",
    "9) if the Old PDU session ID IE is included in the UL NAS TRANSPORT message, the AMF does not have a PDU session routing context for the old PDU session ID and the UE, the AMF does not have a PDU session routing context for the PDU session ID and the UE, the Request type IE is set to \"initial request\", the AMF should select an SMF with following handlings: i) if the S-NSSAI IE is not included and the allowed NSSAI contains: A) one S-NSSAI, the AMF shall use the S-NSSAI in the allowed NSSAI as the S-NSSAI; B) two or more S-NSSAIs and the user's subscription context obtained from UDM contains only one default S-NSSAI that is included in the allowed NSSAI, the AMF shall use the default S-NSSAI in the allowed NSSAI as the S-NSSAI; or C) two or more S-NSSAIs and the user's subscription context obtained from UDM contains two or more default S-NSSAI(s) included in the allowed NSSAI, the AMF shall use an S-NSSAI in the allowed NSSAI selected based on operator policy as the S-NSSAI.",
    "ii) if the DNN IE is not included, and the user's subscription context obtained from UDM: A) contains the default DNN for the S-NSSAI, the AMF shall use the default DNN as the DNN; and B) does not contain the default DNN for the S-NSSAI, the AMF shall use a locally configured DNN as the DNN; iii) if the DNN selected by the network is a LADN DNN, the AMF shall determine the UE presence in LADN service area (see subclause 6.2.6); iv) if the SMF selection is successful, the AMF should store a PDU session routing context for the PDU session ID and the UE, set the SMF ID in the stored PDU session routing context to the selected SMF ID, and forward the 5GSM message, the PDU session ID, the old PDU session ID, the S-NSSAI, the mapped S-NSSAI (in roaming scenarios), the DNN determined by the AMF, DNN selected by the network (if different from DNN determined by the AMF), the request type and UE presence in LADN service area (if DNN selected by the network corresponds to an LADN DNN) towards the SMF ID of the PDU session routing context; and v) if the SMF selection fails, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 10) if the AMF has a PDU session routing context for the PDU session ID and the UE, the PDU session routing context indicates that the PDU session is not an emergency PDU session, and the Request type IE is included and is set to \"existing emergency PDU session\", the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 11) if the AMF has a PDU session routing context for the PDU session ID and the UE, the PDU session routing context indicates that the PDU session is an emergency PDU session, and the Request type IE is included and is set to \"existing PDU session\", the AMF may forward the 5GSM message, the PDU session ID, the S- NSSAI (if configured in the AMF emergency configuration data), the DNN (if configured in the AMF emergency configuration data), and the request type towards the SMF identified by the SMF ID of the PDU session routing context; 12) if the AMF has a PDU session routing context for the PDU session ID and the UE, the Request type IE is set to \"initial request\", then the AMF shall perform a local release of the PDU session identified by the PDU session ID and shall request the SMF to perform a local release of the PDU session, and proceed as specified in subclause 5.4.5.2.3; 13) if the Request type IE is set to \"initial request\" or \"modification request\", and the S-NSSAI IE contains an S- NSSAI that is not allowed by the network, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e), case f) or h4); 14) if the Request type IE is set to \"existing PDU session\", the AMF has a PDU session routing context for the PDU session ID and the UE, the PDU session routing context indicates that the PDU session is not an emergency PDU session, and the S-NSSAI associated with the PDU session identified by the PDU session ID is not allowed for the target access type, the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e), case f) or h4); 15) if the Request type IE is set to \"initial request\", \"existing PDU session\", \"modification request\" or \"MA PDU request\", the UE is not configured for high priority access in selected PLMN or SNPN, and the UE is in non- allowed area or is not in allowed area, the AMF shall send back to the UE the 5GSM message which was not forwarded, and 5GMM cause #28 \"Restricted service area\" as specified in subclause 5.4.5.3.1 case i); 15a) if the Request type IE is set to \"initial request\" or \"initial emergency request\" and the AMF determines that the UE has registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location, then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case i1); and 16) if the Request type IE is set to \"initial request\" or \"MA PDU request\", the AMF is pending the receipt of a REGISTRATION REQUEST message indicating \"mobility registration updating\" in the 5GS registration type IE, and an emergency PDU session exists for the UE (see subclause 5.4.4.3), the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 17) if the timer T3447 is running and the UE supports service gap control and: i) the Request type IE: A) is set to \"initial request\"; B) is set to \"existing PDU session\"; or C is set to \"modification request\" and the PDU session being modified is a non-emergency PDU session; ii) the UE is not configured for high priority access in selected PLMN; iii) the current NAS signalling connection was not triggered by paging; and iv) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection, then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 18) if the AMF has a PDU session routing context for the PDU session ID and the UE, the Request type IE is not included, the UE is not configured for high priority access in selected PLMN or SNPN, and the PDU session is not an emergency PDU session, then the AMF shall forward the 5GSM message, and the PDU session ID IE towards the SMF identified by the SMF ID of the PDU session routing context with: i) an exemptionInd attribute indicating \"message was exempted from the DNN based congestion activated in the AMF\" as specified in 3GPP TS 29.502 [20A], if DNN based congestion control is activated for the selected DNN; ii) an exemptionInd attribute indicating \"message was exempted from the S-NSSAI and DNN based congestion activated in the AMF\" as specified in 3GPP TS 29.502 [20A], if S-NSSAI and DNN based congestion control is activated for the selected S-NSSAI and the selected DNN; or iii) an exemptionInd attribute indicating \"message was exempted from the S-NSSAI only based congestion activated in the AMF\" as specified in 3GPP TS 29.502 [20A], if S-NSSAI only based congestion control is activated for the selected S-NSSAI; 19) if the Request type IE is set to \"MA PDU request\" and the S-NSSAI IE contains an S-NSSAI that is not allowed by the network on neither access, then the AMF shall send to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); 20) if the Request type IE is set to \"initial request\" and the UE is registered for emergency services over the current access, then the AMF may send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e) or case f); and 21) if the Request type IE is set to \"existing PDU session\", the UE is attempting to transfer a PDU session from 3GPP access to non-3GPP access, and the PDU session is associated with control plane only indication then the AMF shall send back to the UE the 5GSM message which was not forwarded as specified in subclause 5.4.5.3.1 case e).",
    "22) if the Request type IE is set to \"MA PDU request\" and the UE requested DNN corresponds to an LADN DNN, the AMF shall send back to the UE the 5GSM message which was not forwarded and 5GMM cause #90 \"payload was not forwarded\" as specified in subclause 5.4.5.3.1 case hx). 23) if the Request type IE is set to \"initial request\", the UE requested DNN corresponds to an LADN DNN, and the MA PDU session information IE is included, the AMF shall not forward the MA PDU session information towards the SMF. 24) if the Request type IE is set to \"modification request\", the DNN associated with the PDU session corresponds to an LADN DNN, and MA PDU session information IE is included, the AMF shall not forward the MA PDU session information towards the SMF.",
    "b) If the Payload container type IE is set to \"SMS\" and: 1) the AMF does not have an SMSF address associated with the UE; 2) the AMF cannot forward the content of the Payload container IE to the SMSF associated with the SMSF address available in the AMF; or 3) the AMF determines that the UE has registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location; then the AMF shall abort the procedure.",
    "c) If the Payload container type IE is set to \"LTE Positioning Protocol (LPP) message container\" or \"SLPP message container\" and: 1) if the Additional information IE is not included in the UL NAS TRANSPORT message; 2) the AMF cannot forward the content of the Payload container IE to the LMF associated with the routing information included in the Additional information IE; or 3) the AMF determines that the UE has registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location; then the AMF shall abort the procedure.",
    "d) If the Payload container type IE is set to \"UE policy container\" and: 1) the AMF does not have a PCF address associated with the UE; 2) the AMF cannot forward the content of the Payload container IE to the PCF associated with the PCF address available in the AMF; or 3) the AMF determines that the UE has registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location; then the AMF shall abort the procedure.",
    "e) If the Payload container type IE is set to \"Location services message container\" and: 1) if the Additional information IE is included in the UL NAS TRANSPORT message and the AMF cannot forward the content of the Payload container IE to an LMF associated with the routing information included in the Additional information IE; 2) the AMF determines that the UE has registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location; 3) the AMF determines that the payload container content is related to PRU and the UE has not a valid PRU subscription information; or 4) any combination of bullets 1 to 3, then the AMF shall abort the procedure.",
    "f) If the Payload container type IE is set to \"SMS\" or \"LTE Positioning Protocol (LPP) message container\" or \"SLPP message container\": 1) the timer T3447 is running and the UE supports service gap control; 2) the UE is not configured for high priority access in selected PLMN; 3) the current NAS signalling connection was not triggered by paging; and 4) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection, the AMF shall abort the procedure. NOTE: In this state the N1 NAS signalling connection can be released by the network.",
    "g) If the Payload container type IE is set to \"CIoT user data container\" and: 1) if the AMF does not have a PDU session routing context for the PDU session ID and the UE; or 2) if the AMF unsuccessfully attempted to forward the user data container and the PDU session ID, then the AMF may send back to the UE the CIoT user data container which was not forwarded as specified in subclause 5.4.5.3.1 case l1).",
    "h) If the Payload container type IE is set to \"CIoT user data container\": 1) if the timer T3447 is running and the UE supports service gap control; 2) the UE is not configured for high priority access in selected PLMN; 3) the current N1 NAS signalling connection was not triggered by paging; and 4) mobile terminated signalling has not been sent or no user-plane resources have been established for any PDU session after the establishment of the current NAS signalling connection, then the AMF shall send back to the UE the CIoT user data container which was not forwarded as specified in subclause 5.4.5.3.1 case l1). i) If the Payload container type IE is set to \"SOR transparent container\", \"UE parameters update transparent container\", or \"Service-level-AA container\", and the AMF determines that the UE has registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location, then the AMF shall abort the procedure.",
    "j) If the Payload container type IE is set to \"UPP-CMI container\" and: 1) if the Additional information IE is not included in the UL NAS TRANSPORT message; 2) the AMF cannot forward the content of the Payload container IE to the LMF associated with the routing information included in the Additional information IE; or 3) the AMF determines that the UE has registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location; then the AMF shall abort the procedure.",
    "The purpose of the network-initiated NAS transport procedure is to provide a transport of: a) a single 5GSM message; b) SMS; c) an LPP message; c1) an SLPP message; d) an SOR transparent container; e) a single uplink 5GSM message which was not forwarded due to routing failure; f) a single uplink 5GSM message which was not forwarded due to congestion control; g) a UE policy container; h) a single uplink 5GSM message which was not forwarded, because the PLMN's maximum number of PDU sessions has been reached; h1) a single uplink 5GSM message which was not forwarded, because the maximum number of PDU sessions with active user-plane resources has been reached; h2) a single uplink 5GSM message which was not forwarded, because of ongoing network slice-specific authentication and authorization procedure for the S-NSSAI that is requested; h3) a single uplink 5GSM message which was not forwarded, because the UE requested to establish an MA PDU session for LADN DNN; h4) a single uplink 5GSM message which was not forwarded, because the maximum number of UEs for a network slice has been reached; h5) a single uplink 5GSM message which was not forwarded because the UE is marked in the UE's 5GMM context that it is not allowed to request UAS services; h6) a single uplink 5GSM message was not forwarded, because the UE not supporting S-NSSAI location validity information requested forwarding of an 5GSM message with Request type IE is set to \"initial request\" when not in the NS-AoS of the related S-NSSAI; i) a single uplink 5GSM message which was not forwarded due to service area restrictions; i1) a single uplink 5GSM message which was not forwarded because the UE is registered to a PLMN via a satellite NG-RAN cell that is not allowed to operate at the present UE location; j) a UE parameters update transparent container; k) a location services message; l) a CIoT user data container; l1) a single uplink CIoT user data container or control plane user data which was not forwarded due to routing failure; l2) a single uplink CIoT user data container which was not forwarded due to congestion control; m) a service-level-AA container; m1) an event notification for upper layers; m2) a UPP-CMI container; m3) a single UPP-CMI container which was not forwarded due to user plane positioning not authorized; or n) multiple of the above types.",
    "from the AMF to the UE in a 5GMM message. The purpose of the 5GMM status procedure is to report at any time in the 5GMM STATUS message certain error conditions detected upon receipt of 5GMM protocol data in the AMF or in the UE. The 5GMM STATUS message can be sent by both the AMF and the UE (see example in figure 5.4.6.1). UE AMF OR 5GMM STATUS 5GMM STATUS Figure 5.4.6.1: 5GMM status procedure The purpose of the network slice-specific authentication and authorization procedure is to enable the authentication, authorization and accounting server (AAA-S) via the Network Slice Specific and SNPN Authentication and Authorization Function (NSSAAF) to (re-)authenticate or (re-)authorize the upper layers of the UE.",
    "The network slice-specific authentication and authorization procedure can be invoked for a UE supporting network slice-specific authentication and authorization procedure and for a HPLMN S-NSSAI or an SNPN S-NSSAI (see subclauses 5.15.10 and 5.30.2.9 in 3GPP TS 23.501 [8] and subclause 4.2.9.2 of 3GPP TS 23.502 [9]). The network (re-)authenticates the UE using the EAP as specified in IETF RFC 3748 [34]. EAP has defined four types of EAP messages: a) an EAP-request message; b) an EAP-response message; c) an EAP-success message; and d) an EAP-failure message. The EAP-request message is transported from the network to the UE using the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message of the network slice-specific EAP message reliable transport procedure. The EAP-response message to the EAP-request message is transported from the UE to the network using the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message of the network slice-specific EAP message reliable transport procedure.",
    "If the (re-)authentication of the UE completes successfully or unsuccessfully, the EAP-success message or the EAP- failure message, respectively, is transported from the network to the UE using the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message of the network slice-specific result message transport procedure. There can be several rounds of exchange of an EAP-request message and a related EAP-response message for the AAA-S via the NSSAAF to complete the (re-)authentication and (re-)authorization of the request for an S-NSSAI (see example in figure 5.4.7.1.1). The AMF shall set the authenticator retransmission timer specified in subclause 4.3 of IETF RFC 3748 [34] to infinite value. NOTE: The network slice-specific authentication and authorization procedure provides a reliable transport of EAP messages and therefore retransmissions at the EAP layer of the AMF do not occur.",
    "Figure 5.4.7.1.1: Network slice-specific authentication and authorization procedure UE When the upper layers provide an EAP-response message associated with the HPLMN S-NSSAI or the SNPN S- NSSAI, the UE shall create a NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message. The UE shall set the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message to the EAP-response message. The UE shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message to the HPLMN S-NSSAI or the SNPN S-NSSAI associated with the EAP-response message. The UE shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message. Apart from this action, the network slice-specific authentication and authorization procedure is transparent to the 5GMM layer of the UE.",
    "Upon receipt of a NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message, the AMF shall stop timer T3575 and: a) pass the EAP-response message received in the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message associated with the HPLMN S-NSSAI or the SNPN S-NSSAI in the S-NSSAI IE to the upper layers; or b) provide the EAP-response message received in the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message associated with the HPLMN S-NSSAI or the SNPN S-NSSAI in the S-NSSAI IE to the AAA-S via the NSSAAF. In order to initiate the network slice-specific EAP result message transport procedure, the AMF shall create a NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message. The AMF shall set the EAP message IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message to the EAP-success or EAP-failure message provided by the AAA-S via the NSSAAF.",
    "The AMF shall set the S-NSSAI IE of the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message to the HPLMN S-NSSAI or the SNPN S-NSSAI to which the EAP-success or EAP-failure message is related. The AMF shall send the NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message. The AMF shall retain the authentication result for the UE and the HPLMN S-NSSAI or the SNPN S-NSSAI while the UE is registered to the PLMN (see subclause 5.15.10 in 3GPP TS 23.501 [8]). Upon receipt of a NETWORK SLICE-SPECIFIC AUTHENTICATION RESULT message, the UE shall pass: a) the EAP-success or EAP-failure message received in the EAP message IE; and b) the HPLMN S-NSSAI or the SNPN S-NSSAI in the S-NSSAI IE; to the upper layers. Apart from this action, the network slice-specific authentication and authorization procedure is transparent to the 5GMM layer of the UE.",
    "The registration procedure is always initiated by the UE and used for initial registration as specified in subclause 5.5.1.2.2 or mobility and periodic registration update as specified in subclause 5.5.1.3.2. When the UE needs to initiate registration over both 3GPP access and non-3GPP access in the same PLMN (e.g. the 3GPP access and the selected N3IWF are located in the same PLMN), the UE: a) in 5GMM-REGISTERED-INITIATED over 3GPP access shall not initiate registration over non-3GPP access; or b) in 5GMM-REGISTERED-INITIATED over non-3GPP access shall not initiate registration over 3GPP access. NOTE 1: To which access (i.e. 3GPP access or non-3GPP access) the UE initiates registration first is up to UE implementation.",
    "When the UE is registered with a PLMN over a non-3GPP access, the AMF and the UE maintain: a) registration state and state machine over non-3GPP access; b) 5G NAS security context; c) 5G-GUTI; d) registration area for non-3GPP access, which is associated with a single TAI; and e) non-3GPP de-registration timer in the UE and non-3GPP implicit de-registration timer in the AMF. A registration attempt counter is used to limit the number of subsequently rejected registration attempts. The registration attempt counter shall be incremented as specified in subclause 5.5.1.2.7 or subclause 5.5.1.3.7. Depending on the value of the registration attempt counter, specific actions shall be performed.",
    "The registration attempt counter shall be reset when: - the UE is powered on; - a USIM is inserted; - a registration procedure is successfully completed; - an EPS attach, combined EPS attach procedure, a normal or periodic tracking area updating or a combined tracking area updating procedure is successfully completed in S1 mode and the UE is operating in single- registration mode. In this case, the UE shall reset the registration attempt counter for 3GPP access; NOTE 2: The registration attempt counter for non-3GPP access is not impacted by the EPS attach and the combined EPS attach procedure. - a registration procedure is rejected with cause #11, #12, #13, #15, #27, #31, #62, #72, #73, #74, #75, #76, #77 or #78; - a registration procedure is rejected with cause #3, #6 or #7, the REGISTRATION REJECT message is received without integrity protection and the counter for \"SIM/USIM considered invalid for GPRS services\" events has a value less than a UE implementation-specific maximum value.",
    "- a network initiated de-registration procedure is completed with cause #11, #12, #13, #15, #27; #62, #72, #74, #75, #76, #77 or #78; or - a new PLMN or SNPN is selected. Additionally, the registration attempt counter shall be reset when the UE is in substate 5GMM- DEREGISTERED.ATTEMPTING-REGISTRATION or 5GMM-REGISTERED.ATTEMPTING-REGISTRATION- UPDATE, and: - the current TAI is changed; - timer T3502 expires; or - timer T3346 is started. When the registration attempt counter is reset, the UE shall stop timer T3519 if running, and delete any stored SUCI. The lower layers indicate to NAS whether the network supports emergency services for the UE in limited service state (see 3GPP TS 38.331 [30]). This information is taken into account when deciding whether to initiate an initial registration for emergency services.",
    "The UE in state 5GMM-DEREGISTERED shall initiate the registration procedure for initial registration by sending a REGISTRATION REQUEST message to the AMF, a) when the UE performs initial registration for 5GS services; b) when the UE performs initial registration for emergency services; c) when the UE performs initial registration for SMS over NAS; d) when the UE moves from GERAN to NG-RAN coverage or the UE moves from a UTRAN to NG-RAN coverage and the following applies: 1) the UE initiated a GPRS attach or routing area updating procedure while in A/Gb mode or Iu mode; or 2) the UE has performed 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP TS 23.216 [6A], and since then the UE did not perform a successful EPS attach or tracking area updating procedure in S1 mode or registration procedure in N1 mode; e) when the UE performs initial registration for onboarding services in SNPN; f) when the UE performs initial registration for disaster roaming services; and g) when the UE performs initial registration to come out of unavailability period and resume normal services; with the following clarifications to initial registration for emergency services: a) the UE shall not initiate an initial registration for emergency services over the current access, if the UE is already registered for emergency services over the non-current access, unless the initial registration has to be initiated to perform handover of an existing emergency PDU session from the non-current access to the current access; and NOTE 1: Transfer of an existing emergency PDU session between 3GPP access and non-3GPP access is needed e.g. if the UE determines that the current access is no longer available.",
    "b) the UE can only initiate an initial registration for emergency services over non-3GPP access if it cannot register for emergency services over 3GPP access. The UE initiates the registration procedure for initial registration by sending a REGISTRATION REQUEST message to the AMF, starting timer T3510. If timer T3502 is currently running, the UE shall stop timer T3502. If timer T3511 is currently running, the UE shall stop timer T3511. During initial registration the UE handles the 5GS mobile identity IE in the following order: a) if: 1) the UE: i) was previously registered in S1 mode before entering state EMM-DEREGISTERED; and ii) has received an \"interworking without N26 interface not supported\" indication from the network; and 2) EPS security context and a valid native 4G-GUTI are available; then the UE shall create a 5G-GUTI mapped from the valid native 4G-GUTI as specified in 3GPP TS 23.003 [4] and indicate the mapped 5G-GUTI in the 5GS mobile identity IE.",
    "The UE shall include the UE status IE with the EMM registration status set to \"UE is not in EMM-REGISTERED state\" and shall include an ATTACH REQUEST message as specified in 3GPP TS 24.301 [15] in the EPS NAS message container IE.",
    "Additionally, if the UE holds a valid 5G-GUTI, the UE shall include the 5G-GUTI in the Additional GUTI IE in the REGISTRATION REQUEST message in the following order: 1) a valid 5G-GUTI that was previously assigned by the same PLMN with which the UE is performing the registration, if available; 2) a valid 5G-GUTI that was previously assigned by an equivalent PLMN, if available; and 3) a valid 5G-GUTI that was previously assigned by any other PLMN, if available; b) if: 1) the UE is registering with a PLMN and the UE holds a valid 5G-GUTI that was previously assigned, over 3GPP access or non-3GPP access, by the same PLMN with which the UE is performing the registration, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE; or 2) the UE is registering with a SNPN, the UE holds a valid 5G-GUTI that was previously assigned, over 3GPP access or non-3GPP access, by the same SNPN with which the UE is performing the registration, and the UE is not initiating the initial registration for onboarding services in SNPN, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE; c) if: 1) the UE is registering with a PLMN and the UE holds a valid 5G-GUTI that was previously assigned, over 3GPP access or non-3GPP access, by an equivalent PLMN, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE; or 2) the UE is registering with an SNPN, the UE holds a valid 5G-GUTI that was previously assigned, over 3GPP access or non-3GPP access, by an equivalent SNPN identified by a globally unique SNPN identity, and the UE is not initiating the initial registration for onboarding services in SNPN, the UE shall indicate the 5G- GUTI in the 5GS mobile identity IE and shall additionally include the NID of the equivalent SNPN in the NID IE; d) if: 1) the UE is registering with a PLMN and the UE holds a valid 5G-GUTI that was previously assigned, over 3GPP access or non-3GPP access, by any other PLMN, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE; or 2) the UE is registering with an SNPN, the UE holds a valid 5G-GUTI that was previously assigned, over 3GPP access or non-3GPP access, by any other SNPN identified by a globally unique SNPN identity, and the UE is not initiating the initial registration for onboarding services in SNPN, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE and shall additionally include the NID of the other SNPN in the NID IE; e) if a SUCI other than an onboarding SUCI is available, and the UE is not initiating the initial registration for onboarding services in SNPN, the UE shall include the SUCI other than an onboarding SUCI in the 5GS mobile identity IE; f) if the UE does not hold a valid 5G-GUTI or SUCI other than an onboarding SUCI, and is initiating the initial registration for emergency services, the PEI shall be included in the 5GS mobile identity IE; and g) if the UE is initiating the initial registration for onboarding services in SNPN, an onboarding SUCI shall be included in the 5GS mobile identity IE.",
    "NOTE 2: The AMF in ON-SNPN uses the onboarding SUCI as specified in 3GPP TS 23.501 [8]. If the SUCI is included in the 5GS mobile identity IE and the timer T3519 is not running, the UE shall start timer T3519 and store the value of the SUCI sent in the REGISTRATION REQUEST message. The UE shall include the stored SUCI in the REGISTRATION REQUEST message while timer T3519 is running. If the UE is operating in the dual-registration mode and it is in EMM state EMM-REGISTERED, the UE shall include the UE status IE with the EMM registration status set to \"UE is in EMM-REGISTERED state\". NOTE 3: Inclusion of the UE status IE with this setting corresponds to the indication that the UE is \"moving from EPC\" as specified in 3GPP TS 23.502 [9]. NOTE 4: The value of the 5GMM registration status included by the UE in the UE status IE is not used by the AMF. If the last visited registered TAI is available, the UE shall include the last visited registered TAI in the REGISTRATION REQUEST message.",
    "NOTE 5: The AMF can use the last visited registered TAI included in the REGISTRATION REQUEST message, if available, in the procedure of slice-based N3IWF selection as specified in 3GPP TS 23.502 [9] when the registration procedure is performed over non-3gpp access. If the UE requests the use of SMS over NAS, the UE shall include the 5GS update type IE in the REGISTRATION REQUEST message with the SMS requested bit set to \"SMS over NAS supported\". When the 5GS update type IE is included in the REGISTRATION REQUEST for reasons other than requesting the use of SMS over NAS, and the UE does not need to register for SMS over NAS, the UE shall set the SMS requested bit of the 5GS update type IE to \"SMS over NAS not supported\" in the REGISTRATION REQUEST message. If the UE supports MICO mode and requests the use of MICO mode, then the UE shall include the MICO indication IE in the REGISTRATION REQUEST message.",
    "If the UE requests to use an active time value, it shall include the active time value in the T3324 IE in the REGISTRATION REQUEST message. If the UE includes the T3324 IE, it may also request a particular T3512 value by including the Requested T3512 IE in the REGISTRATION REQUEST message. Additionally, if the UE supports strictly periodic registration timer, the UE shall set the Strictly Periodic Registration Timer Indication bit of the MICO indication IE in the REGISTRATION REQUEST message to \"strictly periodic registration timer supported\". If the UE needs to use the UE specific DRX parameters, the UE shall include the Requested DRX parameters IE in the REGISTRATION REQUEST message. If the UE is in NB-N1 mode and if the UE needs to use the UE specific DRX parameters for NB-N1 mode, the UE shall include the Requested NB-N1 mode DRX parameters IE in the REGISTRATION REQUEST message.",
    "If the UE supports eDRX and requests the use of eDRX, the UE shall include the Requested extended DRX parameters IE in the REGISTRATION REQUEST message. If the UE needs to request LADN information for specific LADN DNN(s) or indicates a request for LADN information as specified in 3GPP TS 23.501 [8], the UE shall include the LADN indication IE in the REGISTRATION REQUEST message and: - request specific LADN DNNs by including a LADN DNN value in the LADN indication IE for each LADN DNN for which the UE requests LADN information; or - to indicate a request for LADN information by not including any LADN DNN value in the LADN indication IE. The UE shall include the requested NSSAI containing the S-NSSAI(s) corresponding to the slice(s) to which the UE intends to register with and shall include the mapped S-NSSAI(s) for the requested NSSAI, if available, in the REGISTRATION REQUEST message.",
    "If the UE has allowed NSSAI or configured NSSAI or both for the current PLMN or SNPN, the requested NSSAI shall be either: a) the configured NSSAI for the current PLMN or SNPN, or a subset thereof as described below; b) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as described below; or c) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as described below, plus the configured NSSAI for the current PLMN or SNPN, or a subset thereof as described below. If both the S-NSSAI to be replaced and the alternative S-NSSAI are included in the configured NSSAI, and the UE needs to request the S-NSSAI to be replaced, the UE shall include the S-NSSAI to be replaced in the requested NSSAI.",
    "If the UE supports the S-NSSAI time validity information, S-NSSAI time validity information is available for an S- NSSAI, and the S-NSSAI time validity information indicates that the S-NSSAI is not available, the UE shall not include the S-NSSAI in the Requested NSSAI IE of the REGISTRATION REQUEST message. If the UE has S-NSSAI time validity information over the other access in the same PLMN and the S-NSSAI time validity information indicates that the S-NSSAI is not available, the UE shall not include the S-NSSAI in the Requested NSSAI IE of the REGISTRATION REQUEST message for the current access type.",
    "If the UE has neither allowed NSSAI for the current PLMN or SNPN nor configured NSSAI for the current PLMN or SNPN and has a default configured NSSAI, the UE shall: a) include the S-NSSAI(s) in the Requested NSSAI IE of the REGISTRATION REQUEST message using the default configured NSSAI; and b) include the Network slicing indication IE with the Default configured NSSAI indication bit set to \"Requested NSSAI created from default configured NSSAI\" in the REGISTRATION REQUEST message. If the UE has no allowed NSSAI for the current PLMN or SNPN, no configured NSSAI for the current PLMN or SNPN, and no default configured NSSAI, the UE shall not include a requested NSSAI in the REGISTRATION REQUEST message. If all the S-NSSAI(s) corresponding to the slice(s) to which the UE intends to register are included in the pending NSSAI, the UE shall not include a requested NSSAI in the REGISTRATION REQUEST message.",
    "The subset of configured NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the configured NSSAI applicable to the current PLMN or SNPN, where any included S-NSSAI is: a) neither in the rejected NSSAI nor associated to an S-NSSAI in the rejected NSSAI. If the UE is inside the NS- AoS of an S-NSSAI in the rejected NSSAI with a rejection cause value set to \"S-NSSAI not available in the current registration area\", the S-NSSAI may be included in the requested NSSAI; or b) in the partially rejected NSSAI and the current TAI is not in the list of TAs for which the S-NSSAI is rejected. If the UE is inside the NS-AoS of an S-NSSAI in the partially rejected NSSAI and the current TAI is in the list of TAs for which the S-NSSAI is rejected, the S-NSSAI may be included in the requested NSSAI. In addition, if the NSSRG information is available, the subset of configured NSSAI provided in the requested NSSAI shall be associated with at least one common NSSRG value.",
    "The UE may also include in the requested NSSAI, the S- NSSAI(s) which were added to configured NSSAI in S1 mode and for which the associated NSSRG information is not available. If the UE is in 5GMM-REGISTERED state over the other access and has already an allowed NSSAI for the other access in the same PLMN or in different PLMNs, all the S-NSSAI(s) in the requested NSSAI for the current access shall share at least an NSSRG value common to all the S-NSSAI(s) of the allowed NSSAI for the other access. If the UE is simultaneously performing the registration procedure on the other access in different PLMNs, the UE shall include S-NSSAIs that share at least a common NSSRG value across all access types. If the UE has pending NSSAI which the UE is still interested in using, then S-NSSAIs in the pending NSSAI and requested NSSAI shall be associated with at least one common NSSRG value.",
    "NOTE 6: If the UE has stored mapped S-NSSAI(s) for the rejected NSSAI, and one or more S-NSSAIs in the stored mapped S-NSSAI(s) for the configured NSSAI are not included in the stored mapped S-NSSAI(s) for the rejected NSSAI, then a S-NSSAI in the configured NSSAI associated to one or more of these mapped S-NSSAI(s) for the configured NSSAI are available to be included in the requested NSSAI together with their mapped S-NSSAI. NOTE 7: If one or more mapped S-NSSAIs in the stored mapped S-NSSAI(s) for the configured NSSAI are not included in the stored rejected NSSAI for the failed or revoked NSSAA, a S-NSSAI in the configured NSSAI associated to one or more of these mapped S-NSSAI(s) for the configured NSSAI are available to be included in the registration request together with their mapped S-NSSAI.",
    "NOTE 8: There is no need to consider the case that the UE is simultaneously performing the registration procedure on the other access in the same PLMN, due to that the UE is not allowed to initiate the registration procedure over one access when the registration over the other access to the same PLMN is going on. The subset of allowed NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the allowed NSSAI for the current PLMN. NOTE 9: How the UE selects the subset of configured NSSAI or allowed NSSAI to be provided in the requested NSSAI is implementation specific. The UE can take preferences indicated by the upper layers (e.g. policies like URSP, applications) and UE local configuration into account. NOTE 10: The number of S-NSSAI(s) included in the requested NSSAI cannot exceed eight. If the UE initiates an initial registration for onboarding services in SNPN, the UE shall not include the Requested NSSAI IE in the REGISTRATION REQUEST message.",
    "If the UE supports NSAG, the UE shall set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports sending of REGISTRATION COMPLETE message for acknowledging the reception of NSAG information IE in the REGISTRATION ACCEPT message, the UE shall set the RCMAN bit to \"Sending of REGISTRATION COMPLETE message for NSAG information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE initiates an initial registration for emergency services or needs to prolong the established NAS signalling connection after the completion of the initial registration procedure (e.g. due to uplink signalling pending), the UE shall set the Follow-on request indicator to \"Follow-on request pending\".",
    "NOTE 11: The UE does not have to set the Follow-on request indicator to 1, even if the UE has to request resources for V2X communication over PC5 reference point, 5G ProSe direct discovery over PC5, 5G ProSe direct communication over PC5 or A2X communication over PC5 reference point.",
    "If the UE supports S1 mode and the UE has not disabled its E-UTRA capability and the 5GS registration type IE in the REGISTRATION REQUEST message is not set to \"disaster roaming initial registration\", the UE shall: - set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; - include the S1 UE network capability IE in the REGISTRATION REQUEST message; additionally, if the UE supports EPS-UPIP, the UE shall set the EPS-UPIP bit to \"EPS-UPIP supported\" in the S1 UE network capability IE in the REGISTRATION REQUEST message; and - if the UE supports sending an ATTACH REQUEST message containing a PDN CONNECTIVITY REQUEST message with request type set to \"handover\" to transfer a PDU session from N1 mode to S1 mode, set the HO attach bit to \"attach request message containing PDN connectivity request with request type set to handover to transfer PDU session from N1 mode to S1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the LTE positioning protocol (LPP) in N1 mode as specified in 3GPP TS 37.355 [26], the UE shall set the LPP bit to \"LPP in N1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the Location Services (LCS) notification mechanisms in N1 mode as specified in 3GPP TS 23.273 [6B], the UE shall set the 5G-LCS bit to \"LCS notification mechanisms supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the user plane positioning using LCS-UPP as specified in 3GPP TS 23.273 [6B], the UE shall set the LCS-UPP bit to \"LCS-UPP user plane positioning supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the user plane positioning using SUPL as described in 3GPP TS 38.305 [67] and 3GPP TS 23.271 [68], the UE shall set the SUPL bit to \"SUPL user plane positioning supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports network verified UE location over satellite NG-RAN as specified in 3GPP TS 23.501 [8], the UE shall set the NVL-SATNR bit to \"Network verified UE location over satellite NG-RAN supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE is in NB-N1 mode, then the UE shall set the Control plane CIoT 5GS optimization bit to \"Control plane CIoT 5GS optimization supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE is capable of NB-S1 mode, then the UE shall set the Control plane CIoT EPS optimization bit to \"Control plane CIoT EPS optimization supported\" in the S1 UE network capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports N3 data transfer and multiple user-plane resources in NB-N1 mode (see 3GPP TS 36.306 [25D], 3GPP TS 36.331 [25A]), then the UE shall set the Multiple user-plane resources support bit to \"Multiple user-plane resources supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP TS 23.216 [6A], the UE shall: - set the 5G-SRVCC from NG-RAN to UTRAN capability bit to \"5G-SRVCC from NG-RAN to UTRAN supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and - include the Mobile station classmark 2 IE and the Supported codecs IE in the REGISTRATION REQUEST message. If the UE supports service gap control, then the UE shall set the SGC bit to \"service gap control supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the restriction on use of enhanced coverage, the UE shall set the RestrictEC bit to \"Restriction on use of enhanced coverage supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports network slice-specific authentication and authorization, the UE shall set the NSSAA bit to \"network slice-specific authentication and authorization supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports CAG feature, the UE shall set the CAG bit to \"CAG Supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports extended CAG information list, the UE shall set the Ex-CAG bit to \"Extended CAG information list supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports enhanced CAG information, the UE shall set the ECI bit to \"enhanced CAG information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports network slice replacement, the UE shall set the NSR bit to \"network slice replacement supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports sending of REGISTRATION COMPLETE message for acknowledging the reception of Negotiated PEIPS assistance information IE in the REGISTRATION ACCEPT message, the UE shall set the RCMP bit to \"Sending of REGISTRATION COMPLETE message for negotiated PEIPS assistance information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "When the UE is not in NB-N1 mode, if the UE supports RACS, the UE shall: a) set the RACS bit to \"RACS supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; b) if the UE has an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN, include the applicable network-assigned UE radio capability ID in the UE radio capability ID IE of the REGISTRATION REQUEST message; and c) if the UE: 1) does not have an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN; and 2) has an applicable manufacturer-assigned UE radio capability ID for the current UE radio configuration, include the applicable manufacturer-assigned UE radio capability ID in the UE radio capability ID IE of the REGISTRATION REQUEST message.",
    "If the UE has one or more stored UE policy sections: - identified by a UPSI with the PLMN ID part indicating the HPLMN or the selected PLMN; or - identified by a UPSI with the PLMN ID part indicating the PLMN ID part of the SNPN identity of the selected SNPN and associated with the NID of the selected SNPN; then the UE shall set the Payload container type IE to \"UE policy container\" and include the UE STATE INDICATION message (see annex D) in the Payload container IE of the REGISTRATION REQUEST message.",
    "If the UE does not have any stored UE policy section: - identified by a UPSI with the PLMN ID part indicating the HPLMN or the selected PLMN; or - identified by a UPSI with the PLMN ID part indicating the PLMN ID part of the SNPN identity of the selected SNPN and associated with the NID of the selected SNPN; and the UE needs to send a UE policy container to the network, then the UE shall set the Payload container type IE to \"UE policy container\" and include the UE STATE INDICATION message (see annex D) in the Payload container IE of the REGISTRATION REQUEST message. NOTE 12: In this version of the protocol, the UE can only include the Payload container IE in the REGISTRATION REQUEST message to carry a payload of type \"UE policy container\". If the UE does not have a valid 5G NAS security context, the UE shall send the REGISTRATION REQUEST message without including the NAS message container IE.",
    "The UE shall include the entire REGISTRATION REQUEST message (i.e. containing cleartext IEs and non-cleartext IEs, if any) in the NAS message container IE that is sent as part of the SECURITY MODE COMPLETE message as described in subclauses 4.4.6 and 5.4.2.3. If the UE has a valid 5G NAS security context and the UE needs to send non-cleartext IEs, the UE shall send a REGISTRATION REQUEST message including the NAS message container IE as described in subclause 4.4.6. If the UE does not need to send non-cleartext IEs, the UE shall send a REGISTRATION REQUEST message without including the NAS message container IE. If the UE supports ciphered broadcast assistance data and needs to obtain new ciphering keys, the UE shall include the Additional information requested IE with the CipherKey bit set to \"ciphering keys for ciphered broadcast assistance data requested\" in the REGISTRATION REQUEST message.",
    "The UE shall set the WUSA bit to \"WUS assistance information reception supported\" in the 5GMM capability IE if the UE supports WUS assistance information. The UE may include its UE paging probability information in the Requested WUS assistance information IE if the UE has set the WUSA bit to \"WUS assistance information reception supported\" in the 5GMM capability IE and the UE is not performing the initial registration for emergency services. The UE shall set the NR-PSSI bit to \"NR paging subgrouping supported\" in the 5GMM capability IE if the UE supports PEIPS assistance information and the 5GS registration type IE in the REGISTRATION REQUEST message is not set to \"emergency registration\". The UE may include its UE paging probability information in the Requested PEIPS assistance information IE if the UE has set the NR-PSSI bit to \"NR paging subgrouping supported\" in the 5GMM capability IE.",
    "If the REGISTRATION REQUEST message includes a NAS message container IE, the AMF shall process the REGISTRATION REQUEST message that is obtained from the NAS message container IE as described in subclause 4.4.6. If the UE supports V2X as specified in 3GPP TS 24.587 [19B], the UE shall set the V2X bit to \"V2X supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports V2X communication over E- UTRA-PC5 as specified in 3GPP TS 24.587 [19B], the UE shall set the V2XCEPC5 bit to \"V2X communication over E-UTRA-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports V2X communication over NR-PC5 as specified in 3GPP TS 24.587 [19B], the UE shall set the V2XCNPC5 bit to \"V2X communication over NR-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. The UE shall set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the NSSRG, then the UE shall set the NSSRG bit to \"NSSRG supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the W-AGF acting on behalf of an N5GC device initiates an initial registration as specified in 3GPP TS 23.316 [6D], the W-AGF acting on behalf of the N5GC device shall include the N5GC indication IE with the N5GC device indication bit set to \"N5GC device registration is requested\" in the REGISTRATION REQUEST message. If the 5G-RG acting on behalf of an AUN3 device initiates an initial registration as specified in 3GPP TS 23.316 [6D], the 5G-RG acting on behalf of an AUN3 device shall include the AUN3 indication IE with the AUN3 device indication bit set to \"AUN3 device registration is requested\" in the REGISTRATION REQUEST message. If the UE supports UAS services, the UE shall set the UAS bit to \"UAS services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports A2X over E-UTRA-PC5 as specified in 3GPP TS 24.577 [60], the UE shall set the A2XEPC5 bit to \"A2X over E-UTRA-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports A2X over NR-PC5 as specified in 3GPP TS 24.577 [60], the UE shall set the A2XNPC5 bit to \"A2X over NR-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports A2X over Uu as specified in 3GPP TS 24.577 [60], the UE shall set the A2X-Uu bit to \"A2X over Uu supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. When the UE supporting UAS services initiates an initial registration for UAS services, the UE shall include the service-level device ID in the Service-level-AA container IE of the REGISTRATION REQUEST message and set the value to the CAA-level UAV ID.",
    "The UE shall include the service-level-AA server address in the Service-level-AA container IE of the REGISTRATION REQUEST message and set the value to the USS address, if it is provided by the upper layers. The UE shall include the service-level-AA payload in the Service-level-AA container IE of the REGISTRATION REQUEST message and shall set the service-level-AA payload type, if the service-level-AA payload is provided by upper layers. NOTE 13: The service-level-AA payload can be of type \"C2 authorization payload\". The C2 authorization payload can include one or both of an indication of the request for direct C2 communication and pairing information for direct C2 communication. If the UE supports 5G ProSe direct discovery as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-dd bit to \"5G ProSe direct discovery supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports 5G ProSe direct communication as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-dc bit to \"5G ProSe direct communication supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-2 UE-to-network relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2relay bit to \"Acting as a 5G ProSe layer-2 UE-to-network relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-3 UE-to-network relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3relay bit to \"Acting as a 5G ProSe layer-3 UE-to-network relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports acting as 5G ProSe layer-2 UE-to-network remote UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2rmt bit to \"Acting as a 5G ProSe layer-2 UE-to- network remote UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-3 UE-to-network remote UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3rmt bit to \"Acting as a 5G ProSe layer-3 UE-to-network remote UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-2 UE-to-UE relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2U2U relay bit to \"Acting as a 5G ProSe layer-2 UE-to-UE relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports acting as 5G ProSe layer-3 UE-to-UE relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3U2U relay bit to \"Acting as a 5G ProSe layer-3 UE-to-UE relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-2 end UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2end bit to \"Acting as a 5G ProSe layer-2 end UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-3 end UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3end bit to \"Acting as a 5G ProSe layer-3 end UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the MUSIM UE supports the N1 NAS signalling connection release, then the UE shall set the N1 NAS signalling connection release bit to \"N1 NAS signalling connection release supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the N1 NAS signalling connection release bit to \"N1 NAS signalling connection release supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the MUSIM UE supports the paging indication for voice services, then the UE shall set the paging indication for voice services bit to \"paging indication for voice services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the paging indication for voice services bit to \"paging indication for voice services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the MUSIM UE supports the reject paging request, then the UE shall set the reject paging request bit to \"reject paging request supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the reject paging request bit to \"reject paging request supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the MUSIM UE sets: - the reject paging request bit to \"reject paging request supported\"; - the N1 NAS signalling connection release bit to \"N1 NAS signalling connection release supported\"; or - both of them; and supports the paging restriction, then the UE shall set the paging restriction bit to \"paging restriction supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the paging restriction bit to \"paging restriction supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports MINT, the UE shall set the MINT bit to \"MINT supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports slice-based N3IWF selection, the UE shall set the SBNS bit to \"Slice-based N3IWF selection supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports slice-based TNGF selection, the UE shall set the SBTS bit to \"Slice-based TNGF selection supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE initiates the registration procedure for disaster roaming services, the UE has determined the UE determined PLMN with disaster condition as specified in 3GPP TS 23.122 [5] and: a) the UE determined PLMN with disaster condition is the HPLMN and: 1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and does not contain a valid 5G-GUTI that was previously assigned by the HPLMN; or 2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message and the 5GS mobile identity IE contains neither the SUCI nor a valid 5G-GUTI that was previously assigned by the HPLMN; or b) the UE determined PLMN with disaster condition is not the HPLMN and: 1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and does not contain a valid 5G-GUTI that was previously assigned by the UE determined PLMN with disaster condition; or 2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message and the 5GS mobile identity IE does not contain a valid 5G-GUTI that was previously assigned by the UE determined PLMN with disaster condition; the UE shall include in the REGISTRATION REQUEST message the UE determined PLMN with disaster condition IE indicating the UE determined PLMN with disaster condition.",
    "NOTE 14: If the UE initiates the registration procedure for disaster roaming services, and the UE determined PLMN with disaster condition cannot be determined when an NG-RAN cell of the PLMN broadcasts the disaster related indication as specified in 3GPP TS 23.122 [5], the UE does not include in the REGISTRATION REQUEST message the UE determined PLMN with disaster condition IE but includes the Additional GUTI IE or the 5GS mobile identity IE or both as specified in subclauses 5.5.1.2.2. If the UE supports event notification, the UE shall set the EventNotification bit to \"Event notification supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports access to an SNPN using credentials from a credentials holder and: a) the UE is in its HPLMN or EHPLMN or the subscribed SNPN; or b) the UE is in a non-subscribed SNPN and supports equivalent SNPNs; the UE shall set the SSNPNSI bit to \"SOR-SNPN-SI supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports equivalent SNPNs, the UE shall set the ESI bit to \"equivalent SNPNs supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the unavailability period, the UE shall set the UN-PER bit to \"unavailability period supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the reconnection to the network due to RAN timing synchronization status change, the UE shall set the Reconnection to the network due to RAN timing synchronization status change (RANtiming) bit to \"Reconnection to the network due to RAN timing synchronization status change supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports LADN per DNN and S-NSSAI, the UE shall set the LADN-DS bit to \"LADN per DNN and S- NSSAI supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports MPS indicator update via the UE configuration update procedure, the UE shall set the MPSIU bit to \"MPS indicator update supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports MCS indicator update via the UE configuration update procedure, the UE shall set the MCSIU bit to \"MCS indicator update supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports ranging and sidelink positioning as specified in 3GPP TS 24.514 [62] and supports: a) V2X communication over PC5 as specified in 3GPP TS 24.587 [19B]; b) 5G ProSe direct discovery and 5G ProSe direct communication as specified in 3GPP TS 24.554 [19E]; or c) both a) and b), the UE shall set a) the RSLP bit to \"Ranging and sidelink positioning supported\"; b) the RSLPL bit to \"Ranging and sidelink positioning for located UE supported\"; c) the RSLPS bit to \"Ranging and sidelink positioning for SL positioning server UE supported\"; or d) any combination of a), b) and c), in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the partial network slice, the UE shall set the PNS bit to \"Partial network slice supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports network slice usage control, the UE shall set the NSUC bit to \"Network slice usage control supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the S-NSSAI time validity information, the UE shall set the TempNS bit to \"S-NSSAI time validity information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the S-NSSAI location validity information, the UE shall set the SLVI bit to \"S-NSSAI location validity information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "Stop T3510 OR REGISTRATION REQUEST Start T3510 Stop T3550 REGISTRATION ACCEPT Start T3550 REGISTRATION COMPLETE Stop T3510 REGISTRATION REQUEST Start T3510 REGISTRATION REJECT UE AMF Stop T3510 REGISTRATION REQUEST Start T3510 REGISTRATION ACCEPT OR Figure 5.5.1.2.2.1: Registration procedure for initial registration If the initial registration request cannot be accepted by the network, the AMF shall send a REGISTRATION REJECT message to the UE including an appropriate 5GMM cause value. If the initial registration request is rejected due to general NAS level mobility management congestion control, the network shall set the 5GMM cause value to #22 \"congestion\" and assign a value for back-off timer T3346.",
    "If the initial registration request is rejected due to general NAS level mobility management congestion control for the SNPN selected for localized services in SNPN (see 3GPP TS 23.122 [5]), the network may set an appropriate cause value other than 5GMM cause value to #22 \"congestion\" and does not assign a value for back-off timer T3346. In NB-N1 mode, if the registration request is rejected due to operator determined barring (see 3GPP TS 29.503 [20AB]), the network shall set the 5GMM cause value to #22 \"congestion\" and assign a value for back-off timer T3346. If the REGISTRATION REJECT message with 5GMM cause #76 or #78 was received without integrity protection, then the UE shall discard the message.",
    "If the REGISTRATION REJECT message with 5GMM cause #62 was received without integrity protected, the behaviour of the UE is specified in subclause 5.3.20.2. Based on operator policy, if the initial registration request is rejected due to core network redirection for CIoT optimizations, the network shall set the 5GMM cause value to #31 \"Redirection to EPC required\". NOTE 1: The network can take into account the UE's S1 mode capability, the EPS CIoT network behaviour supported by the UE or the EPS CIoT network behaviour supported by the EPC to determine the rejection with the 5GMM cause value #31 \"Redirection to EPC required\".",
    "If the initial registration request is rejected because: a) all the S-NSSAI(s) included in the requested NSSAI are rejected; and b) the UE set the NSSAA bit in the 5GMM capability IE to: 1) \"Network slice-specific authentication and authorization supported\" and: i) void; ii) all default S-NSSAIs are not allowed; or iii) network slice-specific authentication and authorization has failed or been revoked for all default S- NSSAIs and based on network local policy, the network decides not to initiate the network slice-specific re-authentication and re-authorization procedures for any default S-NSSAI requested by the UE; or 2) \"Network slice-specific authentication and authorization not supported\" and all default S-NSSAIs are either not allowed or are subject to network slice-specific authentication and authorization; i) void ii) void the network shall set the 5GMM cause value of the REGISTRATION REJECT message to #62 \"No network slices available\".",
    "If the 5GMM cause value is set to #62 \"No network slices available\", the network shall include, in the rejected NSSAI of the REGISTRATION REJECT message, all the S-NSSAI(s) which were included in the requested NSSAI. If the UE has set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message, the rejected S-NSSAI(s) shall be included in the Extended rejected NSSAI IE of the REGISTRATION REJECT message. Otherwise, the rejected S-NSSAI(s) shall be included in the Rejected NSSAI IE of the REGISTRATION REJECT message. In roaming scenarios, if the Extended rejected NSSAI IE is included in the REGISTRATION REJECT message, the AMF shall provide mapped S-NSSAI(s) for the rejected NSSAI.",
    "If the UE supports extended rejected NSSAI and the AMF determines that maximum number of UEs reached for one or more S-NSSAIs in the requested NSSAI as specified in subclause 4.6.2.5, the AMF shall include the rejected NSSAI containing one or more S-NSSAIs with the rejection cause \"S-NSSAI not available due to maximum number of UEs reached\" in the Extended rejected NSSAI IE in the REGISTRATION REJECT message. In addition, the AMF may include a back-off timer value for each S-NSSAI with the rejection cause \"S-NSSAI not available due to maximum number of UEs reached\" in the Extended rejected NSSAI IE of the REGISTRATION REJECT message.",
    "If the AMF receives the initial registration request along with the authenticated indication over N2 reference point on non-3GPP access and does not receive the indication that authentication by the home network is not required over N12 reference point, or the 5G-RG acting on behalf of an AUN3 device is not allowed to access 5GS as specified in 3GPP TS 23.316 [6D], the network shall set the 5GMM cause value to #72 \"Non-3GPP access to 5GCN not allowed\". If the initial registration request from a UE supporting CAG is rejected due to CAG restrictions, the network shall set the 5GMM cause value to #76 \"Not authorized for this CAG or authorized for CAG cells only\" and should include the \"CAG information list\" in the CAG information list IE or the Extended CAG information list IE in the REGISTRATION REJECT message.",
    "NOTE 2: The network cannot be certain that \"CAG information list\" stored in the UE is updated as result of sending of the REGISTRATION REJECT message with the CAG information list IE or the Extended CAG information list IE, as the REGISTRATION REJECT message is not necessarily delivered to the UE (e.g. due to abnormal radio conditions). NOTE 3: The \"CAG information list\" can be provided by the AMF and include no entry if no \"CAG information list\" exists in the subscription. NOTE 4: If the UE supports extended CAG information list, the CAG information list can be included either in the CAG information list IE or Extended CAG information list IE. NOTE 4A: It is unexpected for network to send REGISTRATION REJECT message to the UE with 5GMM cause value #76 in non-CAG cell and not indicate \"Indication that the UE is only allowed to access 5GS via CAG cells\" for the serving PLMN in the Extended CAG information list or the CAG information list.",
    "If the UE does not support extended CAG information list, the CAG information list shall not be included in the Extended CAG information list IE. If the initial registration request from a UE not supporting CAG is rejected due to CAG restrictions, the network shall operate as described in bullet j) of subclause 5.5.1.2.8. If the UE's initial registration request is via a satellite NG-RAN cell and the network using the User Location Information provided by the NG-RAN, see 3GPP TS 38.413 [31], is able to determine that the UE is in a location where the network is not allowed to operate, the network shall set the 5GMM cause value in the REGISTRATION REJECT message to #78 \"PLMN not allowed to operate at the present UE location\". NOTE 5: When the UE is accessing network for emergency services, it is up to operator and regulatory policies whether the network needs to determine if the UE is in a location where network is not allowed to operate.",
    "NOTE 5A: While location determination is ongoing to ensure that operator and regulatory policies are met, the AMF can perform DNN-based or S-NSSAI based congestion control as specified in subclauses 5.3.10 and 5.3.11 to prevent the UE from accessing network. If the AMF receives the initial registration request including the service-level device ID set to the CAA-level UAV ID in the Service-level-AA container IE and the AMF determines that the UE is not allowed to use UAS services via 5GS based on the user's subscription data and the operator policy, the AMF shall return a REGISTRATION REJECT message with 5GMM cause #79 “UAS services not allowed”.",
    "If the UE initiates the registration procedure for disaster roaming services and the AMF determines that it does not support providing disaster roaming services for the determined PLMN with disaster condition to the UE, then the AMF shall send a REGISTRATION REJECT message with 5GMM cause #80 “Disaster roaming for the determined PLMN with disaster condition not allowed”. If the AMF receives the initial registration request over non-3GPP access and detects that the N3IWF used by the UE is not compatible with the allowed NSSAI and the UE has indicated its support for slice-based N3IWF selection in the REGISTRATION REQUEST message, the AMF may send a REGISTRATION REJECT message with 5GMM cause #81 “Selected N3IWF is not compatible with the allowed NSSAI” and may provide information for a suitable N3IWF in the REGISTRATION REJECT message indicating the suitable N3IWF that is compatible with the requested NSSAI.",
    "If the AMF receives the initial registration request over non-3GPP access and detects that the TNGF used by the UE is not compatible with the allowed NSSAI and the UE has indicated its support for slice-based TNGF selection in the REGISTRATION REQUEST message, the AMF may send a REGISTRATION REJECT message with 5GMM cause #82 “Selected TNGF is not compatible with the allowed NSSAI” and may provide information for a suitable TNAN in the TNAN information IE in the REGISTRATION REJECT message indicating the suitable TNGF that is compatible with the requested NSSAI.",
    "If the AMF received multiple TAIs from the satellite NG-RAN as described in 3GPP TS 23.501 [8], and determines that, by UE subscription and operator's preferences, all of the received TAIs are forbidden for roaming or for regional provision of service, the AMF shall include the TAI(s) in: a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE; or b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE; or c) both; in the REGISTRATION REJECT message.",
    "Regardless of the 5GMM cause value received in the REGISTRATION REJECT message via satellite NG-RAN, - if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE in the REGISTRATION REJECT message, the UE shall store the TAI(s) belonging to the serving PLMN or equivalent PLMN(s) and ignore the TAI(s) which do not belong to the serving PLMN or equivalent PLMN(s) included in the IE, if not already stored, into the list of \"5GS forbidden tracking areas for roaming\"; and - if the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE in the REGISTRATION REJECT message, the UE shall store the TAI(s) belonging to the serving PLMN or equivalent PLMN(s) and ignore the TAI(s) which do not belong to the serving PLMN or equivalent PLMN(s) included in the IE, if not already stored, into the list of \"5GS forbidden tracking areas for regional provision of service\".",
    "Furthermore, the UE shall take the following actions depending on the 5GMM cause value received in the REGISTRATION REJECT message. #3 (Illegal UE); or #6 (Illegal ME). The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.",
    "In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off, the UICC containing the USIM is removed or the timer T3245 expires as described in subclause 5.3.19A.1; In case of SNPN, if the UE is not performing initial registration for onboarding services in SNPN and the UE does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the UE shall consider the selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN as invalid until the UE is switched off, the entry is updated or the timer T3245 expires as described in subclause 5.3.19A.2. In case of SNPN, if the UE is not performing initial registration for onboarding services in SNPN and the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs, or both, the UE shall consider the selected entry of the \"list of subscriber data\" as invalid for 3GPP access until the UE is switched off, the entry is updated or the timer T3245 expires as described in subclause 5.3.19A.2. Additionally, if EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off, the UICC containing the USIM is removed or the timer T3245 expires as described in subclause 5.3.19A.2. If the UE is not performing initial registration for onboarding services in SNPN, the UE shall delete the list of equivalent PLMNs (if any) or the list of equivalent SNPNs (if any), and enter the state 5GMM- DEREGISTERED.NO-SUPI.",
    "If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for \"SIM/USIM considered invalid for GPRS services\" events and the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events in case of PLMN if the UE maintains these counters; or 2) set the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events and the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events in case of SNPN if the UE maintains these counters; to a UE implementation-specific maximum value. If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value.",
    "The USIM shall be considered as invalid also for non-EPS services until switching off, the UICC containing the USIM is removed or the timer T3245 expires as described in subclause 5.3.7a in 3GPP TS 24.301 [15]. If the message has been successfully integrity checked by the NAS and the UE maintains a counter for \"SIM/USIM considered invalid for non-GPRS services\", then the UE shall set this counter to a UE implementation-specific maximum value. If the UE is performing initial registration for onboarding services in SNPN, the UE shall reset the registration attempt counter, store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5].",
    "If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for the current SNPN to the UE implementation-specific maximum value. If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value. #7 (5GS services not allowed). The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.",
    "In case of PLMN, the UE shall consider the USIM as invalid for 5GS services until switching off, the UICC containing the USIM is removed or the timer T3245 expires as described in subclause 5.3.19A.1; In case of SNPN, if the UE is not performing initial registration for onboarding services in SNPN and the UE does not support access to an SNPN using credentials from a credentials holder and does not support equivalent SNPNs, the UE shall consider the selected entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN as invalid for 5GS services until the UE is switched off, the entry is updated or the timer T3245 expires as described in subclause 5.3.19A.2. In case of SNPN, if the UE is not performing initial registration for onboarding services in SNPN and the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs, or both, the UE shall consider the selected entry of the \"list of subscriber data\" as invalid for 3GPP access until the UE is switched off, the entry is updated or the timer T3245 expires as described in subclause 5.3.19A.2. Additionally, if EAP based primary authentication and key agreement procedure using EAP-AKA' or 5G AKA based primary authentication and key agreement procedure was performed in the current SNPN, the UE shall consider the USIM as invalid for the current SNPN until switching off, the UICC containing the USIM is removed or the timer T3245 expires as described in subclause 5.3.19A.2. If the UE is not performing initial registration for onboarding services in SNPN, the UE shall enter the state 5GMM-DEREGISTERED.NO-SUPI.",
    "If the message has been successfully integrity checked by the NAS, then the UE shall: 1) set the counter for \"SIM/USIM considered invalid for GPRS services\" events and the counter for \"USIM considered invalid for 5GS services over non-3GPP access\" events in case of PLMN if the UE maintains these counters; or 2) set the counter for \"the entry for the current SNPN considered invalid for 3GPP access\" events and the counter for \"the entry for the current SNPN considered invalid for non-3GPP access\" events in case of SNPN if the UE maintains these counters; to a UE implementation-specific maximum value. If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list and eKSI as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value.",
    "If the UE is performing initial registration for onboarding services in SNPN, the UE shall reset the registration attempt counter, store the SNPN identity in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, enter state 5GMM-DEREGISTERED.PLMN-SEARCH, and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5]. If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for the current SNPN to the UE implementation-specific maximum value. If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value. #10 (Implicitly de-registered).",
    "5GMM cause #10 is only applicable when received from a wireline access network by the 5G-RG acting on behalf of the AUN3 device and indicates that there is no 5G-RG connected to the same wireline. 5GMM cause #10 received when the 5G-RG is not acting on behalf of the AUN3 or received from a 5G access network other than a wireline access network is considered as abnormal cases and the behaviour of the UE is specified in subclause 5.5.1.2.7. When received over wireline access network, the 5G-RG acting on behalf of the AUN3 device shall abort the initial registration procedure that was initiated on behalf of the AUN3 device. The 5G-RG shall set its 5GS update status to 5U2 NOT UPDATED (and shall store it according to subclause 5.1.3.2.2), shall delete its 5G- GUTI, last visited registered TAI, TAI list, ngKSI, and shall reset its registration attempt counter, and shall enter the state 5GMM-DEREGISTERED. #11 (PLMN not allowed).",
    "This cause value received from a cell belonging to an SNPN and the UE is operating in SNPN access operation mode is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.",
    "The UE shall delete the list of equivalent PLMNs and reset the registration attempt counter and store the PLMN identity in the forbidden PLMN list as specified in subclause 5.3.13A and if the UE is configured to use timer T3245 then the UE shall start timer T3245 and proceed as described in subclause 5.3.19A.1. For 3GPP access the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP TS 23.122 [5], and for non-3GPP access the UE shall enter state 5GMM-DEREGISTERED.LIMITED- SERVICE and perform network selection as defined in 3GPP TS 24.502 [18]. If the message has been successfully integrity checked by the NAS and the UE maintains the PLMN-specific attempt counter and the PLMN-specific attempt counter for non-3GPP access for that PLMN, the UE shall set the PLMN-specific attempt counter and the PLMN-specific attempt counter for non-3GPP access for that PLMN to the UE implementation-specific maximum value.",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value. If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same PLMN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value. #12 (Tracking area not allowed). The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete last visited registered TAI and TAI list.",
    "If the UE is not registering or has not registered to the same PLMN over both 3GPP access and non-3GPP access, the UE shall additionally delete 5G-GUTI and ngKSI. Additionally, the UE shall reset the registration attempt counter. If: 1) the UE is not operating in SNPN access operation mode and the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE is not included in the REGISTRATION REJECT message, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for regional provision of service\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.",
    "If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for regional provision of service\" for non-integrity protected NAS reject message; or 2) the UE is operating in SNPN access operation mode, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for regional provision of service\" for the current SNPN and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, and enter the state 5GMM- DEREGISTERED.LIMITED-SERVICE. If the REGISTRATION REJECT is not integrity protected, the UE shall memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for regional provision of service\" for the current SNPN and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, for non-integrity protected NAS reject message.",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value. #13 (Roaming not allowed in this tracking area). The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete last visited registered TAI and TAI list. If the UE is not registering or has not registered to the same PLMN over both 3GPP access and non-3GPP access, the UE shall additionally delete 5G-GUTI, ngKSI and the list of equivalent PLMNs (if available) or the list of equivalent SNPNs (if available). Additionally, the UE shall reset the registration attempt counter.",
    "If: 1) the UE is not operating in SNPN access operation mode and the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE is not included in the REGISTRATION REJECT message, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE or optionally 5GMM-DEREGISTERED.PLMN-SEARCH. If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for non-integrity protected NAS reject message; or 2) the UE is operating in SNPN access operation mode, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE or optionally 5GMM-DEREGISTERED.PLMN-SEARCH.",
    "If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, for non-integrity protected NAS reject message. For 3GPP access, if the UE is registered in S1 mode and operating in dual-registration mode, the PLMN that the UE chooses to register in is specified in subclause 4.8.3. Otherwise the UE shall perform a PLMN selection or SNPN selection according to 3GPP TS 23.122 [5]. For non-3GPP access, the UE shall perform network selection as defined in 3GPP TS 24.502 [18].",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value. #15 (No suitable cells in tracking area). The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any last visited registered TAI and TAI list. If the UE is not registering or has not registered to the same PLMN over both 3GPP access and non-3GPP access, the UE shall additionally delete 5G-GUTI and ngKSI. Additionally, the UE shall reset the registration attempt counter.",
    "If: 1) the UE is not operating in SNPN access operation mode and the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE is not included in the REGISTRATION REJECT message, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE. If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for non-integrity protected NAS reject message; or 2) the UE is operating in SNPN access operation mode, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, and enter the state 5GMM-DEREGISTERED.LIMITED- SERVICE.",
    "If the REGISTRATION REJECT message is not integrity protected, the UE shall memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, for non-integrity protected NAS reject message. Additionally, the UE shall: 1) if the Extended 5GMM cause IE with value \"Satellite NG-RAN not allowed in PLMN\" is included in the REGISTRATION REJECT message, i) the message has been successfully integrity checked by the NAS; and the UE is configured for \"Satellite Disabling Allowed for 5GMM cause #15\" as specified in 3GPP TS 24.368 [17] or 3GPP TS 31.102 [22], then the UE shall disable satellite NG-RAN capability (see subclause 4.9.4); or ii) otherwise, the UE shall ignore the Extended 5GMM cause IE; and 2) search for a suitable cell in another tracking area according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C].",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value. If received over non-3GPP access the cause shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause 5.5.1.2.7. #22 (Congestion).",
    "If the T3346 value IE is present in the REGISTRATION REJECT message and the value indicates that this timer is neither zero nor deactivated, the UE shall proceed as described below; otherwise it shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause 5.5.1.2.7. The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED, reset the registration attempt counter and enter state 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION. The UE shall stop timer T3346 if it is running. If the REGISTRATION REJECT message is integrity protected, the UE shall start timer T3346 with the value provided in the T3346 value IE. If the REGISTRATION REJECT message is not integrity protected, the UE shall start timer T3346 with a random value from the default range specified in 3GPP TS 24.008 [12]. The UE stays in the current serving cell and applies the normal cell reselection process.",
    "The initial registration procedure is started if still needed when timer T3346 expires or is stopped. If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value. If the UE is registering for onboarding services in SNPN, the UE may enter the state 5GMM- DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5]. #27 (N1 mode not allowed). The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.",
    "Additionally, the UE shall reset the registration attempt counter and shall enter the state 5GMM-DEREGISTERED.LIMITED- SERVICE. If the message has been successfully integrity checked by the NAS, the UE shall set: 1) the PLMN-specific N1 mode attempt counter for 3GPP access and the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN in case of PLMN; or 2) the SNPN-specific attempt counter for 3GPP access for the current SNPN in case of SNPN and the SNPN- specific attempt counter for non-3GPP access for the current SNPN; to the UE implementation-specific maximum value. The UE shall disable the N1 mode capability for the specific access type for which the message was received (see subclause 4.9). If the message has been successfully integrity checked by the NAS, the UE shall disable the N1 mode capability also for the other access type (see subclause 4.9).",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI, TAI list and eKSI. Additionally, the UE shall reset the attach attempt counter and enter the state EMM-DEREGISTERED. #31 (Redirection to EPC required).",
    "5GMM cause #31 received by a UE that has not indicated support for CIoT optimizations or not indicated support for S1 mode or received by a UE over non-3GPP access is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. This cause value received from a cell belonging to an SNPN and the UE is operating in SNPN access operation mode is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset the registration attempt counter. The UE shall enable the E-UTRA capability if it was disabled, disable the N1 mode capability for 3GPP access (see subclause 4.9.2) and enter the 5GMM-DEREGISTERED.NO-CELL-AVAILABLE.",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, TAI list, eKSI and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach procedure is rejected with the EMM cause with the same value. #36 (IAB-node operation not authorized). This cause value is only applicable when received over 3GPP access by a UE operating as an IAB-node. This cause value received from a 5G access network other than 3GPP access or received by a UE not operating as an IAB-node is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI.",
    "If: 1) the UE is not operating in SNPN access operation mode, i) the UE shall delete the list of equivalent PLMNs and reset the registration attempt counter and store the PLMN identity in the forbidden PLMN list as specified in subclause 5.3.13A and if the UE is configured to use timer T3245 then the UE shall start timer T3245 and proceed as described in subclause 5.3.19a.1. The UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP TS 23.122 [5].",
    "If the message has been successfully integrity checked by the NAS and the UE maintains the PLMN-specific attempt counter for 3GPP access for that PLMN, the UE shall set the PLMN-specific attempt counter for 3GPP access for that PLMN to the UE implementation-specific maximum value; and ii) If the UE is operating in single-registration mode, the UE shall in addition handle the EMM parameters EMM state, EPS update status, 4G-GUTI, last visited registered TAI, TAI list, eKSI and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach request procedure is rejected with the EMM cause with the same value; or 2) the UE is operating in SNPN access operation mode, i) the UE shall delete the list of equivalent SNPNs (if available).",
    "The UE shall reset the registration attempt counter and store the SNPN identity in the \"temporarily forbidden SNPNs\" list for 3GPP access and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. The UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to 3GPP TS 23.122 [5]. If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN attempt counter for 3GPP access for the current SNPN to the UE implementation-specific maximum value. #62 (No network slices available). The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-DEREGISTERED. ATTEMPTING-REGISTRATION or 5GMM-DEREGISTERED.PLMN- SEARCH. Additionally, the UE shall reset the registration attempt counter.",
    "The UE receiving the rejected NSSAI in the REGISTRATION REJECT message takes the following actions based on the rejection cause in the rejected S-NSSAI(s): \"S-NSSAI not available in the current PLMN or SNPN\" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the current PLMN or SNPN as specified in subclause 4.6.2.2 and shall not attempt to use this S-NSSAI(s) in the current PLMN or SNPN over any access until switching off the UE, the UICC containing the USIM is removed, an entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN is updated, or the rejected S- NSSAI(s) are removed as described in subclause 4.6.2.2. \"S-NSSAI not available in the current registration area\" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the current registration area as described in subclause 4.6.2.2 and shall not attempt to use this S-NSSAI(s) in the current registration area over the current access until switching off the UE, the UE moving out of the current registration area, the UICC containing the USIM is removed, the entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed as described in subclause 4.6.2.2. \"S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization\" The UE shall store the rejected S-NSSAI(s) in the rejected NSSAI for the failed or revoked NSSAA as specified in subclause 4.6.2.2 and shall not attempt to use this S-NSSAI in the current PLMN or SNPN over any access until switching off the UE, the UICC containing the USIM is removed, the entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN is updated, or the rejected S- NSSAI(s) are removed as described in subclause 4.6.1 and 4.6.2.2. \"S-NSSAI not available due to maximum number of UEs reached\" Unless the back-off timer value received along with the S-NSSAI is zero, the UE shall add the rejected S- NSSAI(s) in the rejected NSSAI for the maximum number of UEs reached as specified in subclause 4.6.2.2 and shall not attempt to use this S-NSSAI in the current PLMN or SNPN over the current access until switching off the UE, the UICC containing the USIM is removed, the entry of the \"list of subscriber data\" with the SNPN identity of the current SNPN is updated, or the rejected S-NSSAI(s) are removed as described in subclauses 4.6.1 and 4.6.2.2. NOTE 6: If the back-off timer value received along with the S-NSSAI in the rejected NSSAI for the maximum number of UEs reached is zero as specified in subclause 10.5.7.4a of 3GPP TS 24.008 [12], the UE does not consider the S-NSSAI as the rejected S-NSSAI.",
    "If there is one or more S-NSSAIs in the rejected NSSAI with the rejection cause \"S-NSSAI not available due to maximum number of UEs reached\", then for each S-NSSAI, the UE shall behave as follows: a) stop the timer T3526 associated with the S-NSSAI, if running; b) start the timer T3526 with: 1) the back-off timer value received along with the S-NSSAI, if a back-off timer value is received along with the S-NSSAI that is neither zero nor deactivated; or 2) an implementation specific back-off timer value, if no back-off timer value is received along with the S- NSSAI; and c) remove the S-NSSAI from the rejected NSSAI for the maximum number of UEs reached when the timer T3526 associated with the S-NSSAI expires.",
    "If the UE has an allowed NSSAI or configured NSSAI and: 1) at least one S-NSSAI of the allowed NSSAI or configured NSSAI is not included in the rejected NSSAI the UE may stay in the current serving cell, apply the normal cell reselection process and start an initial registration with a requested NSSAI that includes any S-NSSAI from the allowed NSSAI or the configured NSSAI that is not in the rejected NSSAI.",
    "2) all the S-NSSAI(s) in the allowed NSSAI and configured NSSAI are rejected and at least one S-NSSAI is rejected due to \"S-NSSAI not available in the current registration area\" and: i) the REGISTRATION REJECT message is integrity protected, the UE is not operating in SNPN access operation mode and the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE is not included in the REGISTRATION REJECT message, then the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\", memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for S-NSSAI is rejected due to \"S-NSSAI not available in the current registration area\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.",
    "The UE shall search for a suitable cell in another tracking area according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C]; or ii) the REGISTRATION REJECT message is integrity protected and the UE is operating in SNPN access operation mode, then the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\", memorize the current TAI was stored in the list of \"5GS forbidden tracking areas for roaming\" for S-NSSAI is rejected due to \"S-NSSAI not available in the current registration area\" for the current SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE. The UE shall search for a suitable cell in another tracking area according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C].",
    "3) otherwise, the UE may perform a PLMN selection or SNPN selection according to 3GPP TS 23.122 [5] and additionally, the UE may disable the N1 mode capability for the current PLMN or SNPN if the UE does not have an allowed NSSAI and each S-NSSAI in the configured NSSAI, if available, was rejected with cause \"S-NSSAI not available in the current PLMN or SNPN\" or \"S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization\" as described in subclause 4.9. If the UE has neither allowed NSSAI for the current PLMN or SNPN nor configured NSSAI for the current PLMN or SNPN and, 1) if at least one S-NSSAI in the default configured NSSAI is not rejected, the UE may stay in the current serving cell, apply the normal cell reselection process, and start an initial registration with a requested NSSAI with that default configured NSSAI; or 2) if all the S-NSSAI(s) in the default configured NSSAI are rejected and at least one S-NSSAI is rejected due to \"S-NSSAI not available in the current registration area\", i) if the REGISTRATION REJECT message is integrity protected and the UE is not operating in SNPN access operation mode, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE.",
    "The UE shall search for a suitable cell in another tracking area according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C]; or ii) if the REGISTRATION REJECT message is integrity protected and the UE is operating in SNPN access operation mode, the UE shall store the current TAI in the list of \"5GS forbidden tracking areas for roaming\" for the current SNPN and, if the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, and enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE. The UE shall search for a suitable cell in another tracking area according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C].",
    "3) otherwise, the UE may perform a PLMN selection or SNPN selection according to 3GPP TS 23.122 [5] and additionally, the UE may disable the N1 mode capability for the current PLMN or SNPN if each S-NSSAI in the default configured NSSAI was rejected with cause \"S-NSSAI not available in the current PLMN or SNPN\" or \"S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization\" as described in subclause 4.9. If 1) the UE has allowed NSSAI for the current PLMN or SNPN or configured NSSAI for the current PLMN or SNPN or both and all the S-NSSAIs included in the allowed NSSAI or the configured NSSAI or both are rejected; or 2) the UE has neither allowed NSSAI for the current PLMN or SNPN nor configured NSSAI for the current PLMN or SNPN and all the S-NSSAIs included in the default configured NSSAI are rejected, and the UE has rejected NSSAI for the maximum number of UEs reached, and the UE wants to obtain services in the current serving cell without performing a PLMN selection or SNPN selection, the UE may stay in the current serving cell and attempt to use the rejected S-NSSAI(s) for the maximum number of UEs reached in the current serving cell after the rejected S-NSSAI(s) are removed as described in subclause 4.6.2.2. If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU2 NOT UPDATED, reset the attach attempt counter and enter the state EMM-DEREGISTERED.",
    "#72 (Non-3GPP access to 5GCN not allowed). When received over non-3GPP access the UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete last visited registered TAI and TAI list. If the UE is not registering or has not registered to the same PLMN over 3GPP access, the UE shall additionally delete 5G-GUTI and ngKSI. Additionally, the UE shall reset the registration attempt counter and enter the state 5GMM-DEREGISTERED. If the message has been successfully integrity checked by the NAS, the UE shall set: 1) the PLMN-specific N1 mode attempt counter for non-3GPP access for that PLMN in case of PLMN: or 2) the SNPN-specific attempt counter for non-3GPP access for that SNPN in case of SNPN; to the UE implementation-specific maximum value.",
    "NOTE 7: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.e. 3GPP access or non-3GPP access (see subclauses 4.7.2 and 5.1.3). The UE shall disable the N1 mode capability for non-3GPP access (see subclause 4.9.3). As an implementation option, the UE may enter the state 5GMM-DEREGISTERED.PLMN-SEARCH in order to perform a PLMN selection according to 3GPP TS 23.122 [5]. If received over 3GPP access the cause shall be considered as an abnormal case and the behaviour of the UE for this case is specified in subclause 5.5.1.2.7. #73 (Serving network not authorized).",
    "This cause value received from a cell belonging to an SNPN and the UE is operating in SNPN access operation mode is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI. The UE shall delete the list of equivalent PLMNs, reset the registration attempt counter, store the PLMN identity in the forbidden PLMN list as specified in subclause 5.3.13A. For 3GPP access the UE shall enter state 5GMM- DEREGISTERED.PLMN-SEARCH in order to perform a PLMN selection according to 3GPP TS 23.122 [5], and for non-3GPP access the UE shall enter state 5GMM-DEREGISTERED.LIMITED-SERVICE and perform network selection as defined in 3GPP TS 24.502 [18].",
    "If the message has been successfully integrity checked by the NAS, the UE shall set the PLMN-specific attempt counter and the PLMN-specific attempt counter for non- 3GPP access for that PLMN to the UE implementation-specific maximum value. If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED and shall delete any 4G-GUTI, last visited registered TAI, TAI list and eKSI. Additionally, the UE shall reset the attach attempt counter and enter the state EMM-DEREGISTERED. #74 (Temporarily not authorized for this SNPN). 5GMM cause #74 is only applicable when received from a cell belonging to an SNPN and the UE is operating in SNPN access operation mode.",
    "5GMM cause #74 received from a cell not belonging to an SNPN is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list, ngKSI and the list of equivalent SNPNs (if available).",
    "The UE shall reset the registration attempt counter and store the SNPN identity in the \"temporarily forbidden SNPNs\" list or \"temporarily forbidden SNPNs for access for localized services in SNPN\" list if the SNPN is an SNPN selected for localized services in SNPN (see 3GPP TS 23.122 [5]) for the specific access type for which the message was received and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription or in the \"temporarily forbidden SNPNs for onboarding services in SNPN\" list, if the UE is performing initial registration for onboarding services in SNPN, for the specific access type for which the message was received. If the UE supports access to an SNPN using credentials from a credentials holder, the UE shall store the SNPN identity in the \"temporarily forbidden SNPNs\" list along with the GIN(s) broadcasted by the SNPN if any, for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription.",
    "If the UE supports access to an SNPN providing access for localized services in SNPN and the access for localized services in SNPN has been enabled, the UE shall store the SNPN identity in the list of \"temporarily forbidden SNPNs for access for localized services in SNPN\" (if the SNPN is an SNPN selected for localized services in SNPN (see 3GPP TS 23.122 [5]) along with the GIN(s) broadcasted by the SNPN if any, for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. If the registration request is not for onboarding services in SNPN, for 3GPP access the UE shall enter state 5GMM- DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to 3GPP TS 23.122 [5] and for non-3GPP access the UE shall enter state 5GMM-DEREGISTERED.LIMITED-SERVICE and perform network selection as defined in 3GPP TS 24.502 [18].",
    "If the registration request is for onboarding services in SNPN, the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5]. If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum value. If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value. #75 (Permanently not authorized for this SNPN). 5GMM cause #75 is only applicable when received from a cell belonging to an SNPN with a globally-unique SNPN identity and the UE is operating in SNPN access operation mode.",
    "5GMM cause #75 received from a cell not belonging to an SNPN or a cell belonging to an SNPN with a non-globally-unique SNPN identity is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete any 5G-GUTI, last visited registered TAI, TAI list ngKSI and the list of equivalent SNPNs (if available).",
    "The UE shall reset the registration attempt counter and store the SNPN identity in the \"permanently forbidden SNPNs\" list or \"permanently forbidden SNPNs for access for localized services in SNPN\" list if the SNPN is an SNPN selected for localized services in SNPN (see 3GPP TS 23.122 [5]) for the specific access type for which the message was received and the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, or in the \"permanently forbidden SNPNs for onboarding services in SNPN\" list, if the UE is performing initial registration for onboarding services in SNPN, for the specific access type for which the message was received. If the UE supports access to an SNPN using credentials from a credentials holder, the UE shall store the SNPN identity in the \"permanently forbidden SNPNs\" list along with the GIN(s) broadcasted by the SNPN if any, for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription.",
    "If the UE supports access to an SNPN providing access for localized services in SNPN and the access for localized services in SNPN has been enabled, the UE shall store the SNPN identity in the list of \"permanently forbidden SNPNs for access for localized services in SNPN\" (if the SNPN is an SNPN selected for localized services in SNPN (see 3GPP TS 23.122 [5]) along with the GIN(s) broadcasted by the SNPN if any, for the selected entry of the \"list of subscriber data\" or the selected PLMN subscription. If the registration request is not for onboarding services in SNPN, for 3GPP access the UE shall enter state 5GMM- DEREGISTERED.PLMN-SEARCH and perform an SNPN selection according to 3GPP TS 23.122 [5] and for non-3GPP access the UE shall enter state 5GMM-DEREGISTERED.LIMITED-SERVICE and perform network selection as defined in 3GPP TS 24.502 [18].",
    "If the registration request is for onboarding services in SNPN, the UE shall enter state 5GMM-DEREGISTERED.PLMN-SEARCH and perform an SNPN selection or an SNPN selection for onboarding services according to 3GPP TS 23.122 [5]. If the message has been successfully integrity checked by the NAS, the UE shall set the SNPN-specific attempt counter for 3GPP access and the SNPN-specific attempt counter for non-3GPP access for the current SNPN to the UE implementation-specific maximum val If the message has been successfully integrity checked by the NAS and the UE also supports the registration procedure over the other access to the same SNPN, the UE shall in addition handle 5GMM parameters and 5GMM state for this access, as described for this 5GMM cause value. #76 (Not authorized for this CAG or authorized for CAG cells only).",
    "This cause value received via non-3GPP access or from a cell belonging to an SNPN and the UE is operating in SNPN access operation mode is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED, store the 5GS update status according to subclause 5.1.3.2.2, and reset the registration attempt counter.",
    "If 5GMM cause #76 is received from: 1) a CAG cell, and if the UE receives a \"CAG information list\" in the CAG information list IE or the Extended CAG information list IE included in the REGISTRATION REJECT message, the UE shall: i) replace the \"CAG information list\" stored in the UE with the received CAG information list IE or the Extended CAG information list IE when received in the HPLMN or EHPLMN; ii) replace the serving VPLMN's entry of the \"CAG information list\" stored in the UE with the serving VPLMN's entry of the received CAG information list IE or the Extended CAG information list IE when the UE receives the CAG information list IE or the Extended CAG information list IE in a serving PLMN other than the HPLMN or EHPLMN; or NOTE 8: When the UE receives the CAG information list IE or the Extended CAG information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries of a PLMN other than the serving VPLMN, if any, in the received CAG information list IE or the Extended CAG information list IE are ignored.",
    "iii) remove the serving VPLMN's entry of the \"CAG information list\" stored in the UE when the UE receives the CAG information list IE or the Extended CAG information list IE in a serving PLMN other than the HPLMN or EHPLMN and the CAG information list IE or the Extended CAG information list IE does not contain the serving VPLMN's entry. Otherwise, then the UE shall delete the CAG-ID(s) of the cell from the \"allowed CAG list\" for the current PLMN, if the CAG-ID(s) are authorized based on the \"allowed CAG list\". In the case the \"allowed CAG list\" for the current PLMN only contains a range of CAG-IDs, how the UE deletes the CAG-ID(s) of the cell from the \"allowed CAG list\" for the current PLMN is up to UE implementation.",
    "In addition: i) if the entry in the \"CAG information list\" for the current PLMN does not include an \"indication that the UE is only allowed to access 5GS via CAG cells\" or if the entry in the \"CAG information list\" for the current PLMN includes an \"indication that the UE is only allowed to access 5GS via CAG cells\" and one or more CAG-ID(s) are authorized based on the updated \"allowed CAG list\" for the current PLMN, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C] with the updated \"CAG information list\"; ii) if the entry in the \"CAG information list\" for the current PLMN includes an \"indication that the UE is only allowed to access 5GS via CAG cells\" and no CAG-ID is authorized based on the updated \"allowed CAG list\" for the current PLMN, then the UE shall enter the state 5GMM-DEREGISTERED.PLMN- SEARCH and shall apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the updated \"CAG information list\"; or iii) if the \"CAG information list\" does not include an entry for the current PLMN, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28] or 3GPP TS 36.304 [25C] with the updated \"CAG information list\".",
    "2) a non-CAG cell, and if the UE receives a \"CAG information list\" in the CAG information list IE or the Extended CAG information list IE included in the REGISTRATION REJECT message, the UE shall: i) replace the \"CAG information list\" stored in the UE with the received CAG information list IE or the Extended CAG information list IE when received in the HPLMN or EHPLMN; ii) replace the serving VPLMN's entry of the \"CAG information list\" stored in the UE with the serving VPLMN's entry of the received CAG information list IE or the Extended CAG information list IE when the UE receives the CAG information list IE or the Extended CAG information list IE in a serving PLMN other than the HPLMN or EHPLMN; or NOTE 9: When the UE receives the CAG information list IE or the Extended CAG information list IE in a serving PLMN other than the HPLMN or EHPLMN, entries of a PLMN other than the serving VPLMN, if any, in the received CAG information list IE or the Extended CAG information list IE are ignored.",
    "iii) remove the serving VPLMN's entry of the \"CAG information list\" stored in the UE when the UE receives the CAG information list IE or the Extended CAG information list IE in a serving PLMN other than the HPLMN or EHPLMN and the CAG information list IE or the Extended CAG information list IE does not contain the serving VPLMN's entry. Otherwise, the UE shall store an \"indication that the UE is only allowed to access 5GS via CAG cells\" in the entry of the \"CAG information list\" for the current PLMN, if any. If the \"CAG information list\" stored in the UE does not include the current PLMN's entry, the UE shall add an entry for the current PLMN to the \"CAG information list\" and store an \"indication that the UE is only allowed to access 5GS via CAG cells\" in the entry of the \"CAG information list\" for the current PLMN.",
    "If the UE does not have a stored \"CAG information list\", the UE shall create a new \"CAG information list\" and add an entry with an \"indication that the UE is only allowed to access 5GS via CAG cells\" for the current PLMN. In addition: i) if one or more CAG-ID(s) are authorized based on the \"allowed CAG list\" for the current PLMN, then the UE shall enter the state 5GMM-DEREGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28] with the updated CAG information; or ii) if no CAG-ID is authorized based on the \"allowed CAG list\" for the current PLMN, then the UE shall enter the state 5GMM-DEREGISTERED.PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP TS 23.122 [5] with the updated \"CAG information list\".",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU3 ROAMING NOT ALLOWED, reset the attach attempt counter and enter the state EMM-DEREGISTERED. #77 (Wireline access area not allowed). 5GMM cause #77 is only applicable when received from a wireline access network by the 5G-RG or the W-AGF acting on behalf of the FN-CRG.",
    "5GMM cause #77 received from a 5G access network other than a wireline access network and 5GMM cause #77 received by the W-AGF acting on behalf of the FN-BRG are considered as abnormal cases and the behaviour of the UE is specified in subclause 5.5.1.2.7. When received over wireline access network, the 5G-RG and the W-AGF acting on behalf of the FN-CRG shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2), shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI, shall reset the registration attempt counter, shall enter the state 5GMM-DEREGISTERED and shall act as specified in subclause 5.3.23. NOTE 10: The 5GMM sublayer states, the 5GMM parameters and the registration status are managed per access type independently, i.e. 3GPP access or non-3GPP access (see subclauses 4.7.2 and 5.1.3). #78 (PLMN not allowed to operate at the present UE location).",
    "This cause value received from a non-satellite NG-RAN cell is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according to subclause 5.1.3.2.2) and shall delete last visited registered TAI and TAI list. If the UE is not registering or has not registered to the same PLMN over non-3GPP access, the UE shall additionally delete 5G-GUTI and ngKSI. Additionally, the UE shall reset the registration attempt counter. The UE shall store the PLMN identity and, if it is known, the current geographical location in the list of \"PLMNs not allowed to operate at the present UE location\" and shall start a corresponding timer instance (see subclause 4.23.2). The UE shall enter state 5GMM- DEREGISTERED.PLMN-SEARCH and perform a PLMN selection according to 3GPP TS 23.122 [5].",
    "If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall handle the EMM parameters EMM state, EPS update status, 4G-GUTI, TAI list, eKSI and attach attempt counter as specified in 3GPP TS 24.301 [15] for the case when the EPS attach procedure is rejected with the EMM cause with the same value. #79 (UAS services not allowed). This cause value received when the UE did not include the service-level device ID set to the CAA-level UAV ID in the Service-level-AA container IE of REGISTRATION REQUEST message is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-DEREGISTERED. ATTEMPTING-REGISTRATION or 5GMM-DEREGISTERED.PLMN- SEARCH. Additionally, the UE shall reset the registration attempt counter.",
    "If the UE re-attempt the registration procedure to the current PLMN, the UE shall not include the service-level device ID set to the CAA-level UAV ID in the Service-level-AA container IE of REGISTRATION REQUEST message unless the UE receives a CONFIGURATION UPDATE COMMAND message including the service-level-AA service status indication in the Service-level-AA container IE with the UAS field set to \"UAS services enabled\". If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU2 NOT UPDATED, reset the attach attempt counter and enter the state EMM-DEREGISTERED. #80 (Disaster roaming for the determined PLMN with disaster condition not allowed).",
    "This cause value received via non-3GPP access or from a cell belonging to an SNPN and the UE is operating in SNPN access operation mode or when the UE did not indicate \"disaster roaming initial registration\" in the 5GS registration type IE in the REGISTRATION REQUEST message is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED, enter state 5GMM-DEREGISTERED. PLMN-SEARCH and shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI. Additionally, the UE shall reset the registration attempt counter. The UE shall not attempt to register for disaster roaming services on this PLMN for the UE determined PLMN with disaster condition for a period in the range of 12 to 24 hours. The UE shall not attempt to register for disaster roaming services on this PLMN for a period in the range of 3 to 10 minutes.",
    "The UE shall perform PLMN selection as described in 3GPP TS 23.122 [6]. If the message has been successfully integrity checked by the NAS and the UE maintains the PLMN-specific attempt counter of the PLMN which sent the reject message for the UE determined PLMN with disaster condition, the UE shall set the PLMN-specific attempt counter of the PLMN which sent the reject message for the UE determined PLMN with disaster condition to the UE implementation-specific maximum value. If the message was received via 3GPP access and the UE is operating in single-registration mode, the UE shall in addition set the EPS update status to EU2 NOT UPDATED, reset the attach attempt counter and enter the state EMM-DEREGISTERED. #81 (Selected N3IWF is not compatible with the allowed NSSAI).",
    "This cause value received when the UE does not access 5GCN over non-3GPP access using the N3IWF or has not indicated support for slice-based N3IWF selection in the REGISTRATION REQUEST message is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-DEREGISTERED. ATTEMPTING-REGISTRATION or 5GMM-DEREGISTERED.PLMN- SEARCH. Additionally, the UE shall reset the registration attempt counter. If the N3IWF identifier IE is included in the REGISTRATION REJECT message and the UE supports slice-based N3IWF selection, the UE may use the provided N3IWF identifier IE in N3IWF selection as specified in 3GPP TS 24.502 [18] prior to an immediate consecutive initial registration attempt to the network, otherwise the UE shall ignore the N3IWF identifier IE.",
    "Additionally, if the UE selects a new N3IWF and a new initial registration attempt is performed, the UE shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI. #82 (Selected TNGF is not compatible with the allowed NSSAI). This cause value received when the UE does not access 5GCN over non-3GPP access using the TNGF or has not indicated support for slice-based TNGF selection in the REGISTRATION REQUEST message is considered as an abnormal case and the behaviour of the UE is specified in subclause 5.5.1.2.7. The UE shall abort the initial registration procedure, set the 5GS update status to 5U2 NOT UPDATED and enter state 5GMM-DEREGISTERED. ATTEMPTING-REGISTRATION or 5GMM-DEREGISTERED.PLMN- SEARCH. Additionally, the UE shall reset the registration attempt counter.",
    "If the TNAN information IE is included in the REGISTRATION REJECT message and the UE supports slice-based TNGF selection, the UE may use the provided TNAN information IE in TNAN selection as specified in 3GPP TS 24.502 [18] prior to an immediate consecutive registration attempt to the network, otherwise the UE shall ignore the TNAN information IE. Additionally, if the UE selects a new TNAN and a new initial registration attempt is performed, the UE shall delete any 5G-GUTI, last visited registered TAI, TAI list and ngKSI. Other values are considered as abnormal cases.",
    "The behaviour of the UE in those cases is specified in subclause 5.5.1.2.7. The following abnormal cases can be identified: a) Lower layer failure If a lower layer failure occurs before the REGISTRATION COMPLETE message has been received from the UE and timer T3550 is running, the AMF shall locally abort the registration procedure for initial registration, enter state 5GMM-REGISTERED and shall not resend the REGISTRATION ACCEPT message. If a new 5G- GUTI was assigned to the UE in the registration procedure for initial registration, the AMF shall consider both the old and the new 5G-GUTI as valid until the old 5G-GUTI can be considered as invalid by the AMF or the 5GMM context which has been marked as deregistered in the AMF is released. If the old 5G-GUTI was allocated by an AMF other than the current AMF, the current AMF does not need to retain the old 5G-GUTI.",
    "During this period the network may use the identification procedure followed by a generic UE configuration update procedure if the old 5G-GUTI is used by the UE in a subsequent message. b) Protocol error If the REGISTRATION REQUEST message is received with a protocol error, the AMF shall return a REGISTRATION REJECT message with one of the following 5GMM cause values: #96 invalid mandatory information; #99 information element non-existent or not implemented; #100 conditional IE error; or #111 protocol error, unspecified. c) T3550 time-out On the first expiry of the timer, the AMF shall retransmit the REGISTRATION ACCEPT message and shall reset and restart timer T3550. This retransmission is repeated four times, i.e. on the fifth expiry of timer T3550, the registration procedure for initial registration shall be aborted and the AMF enters state 5GMM-REGISTERED.",
    "If a new 5G-GUTI was allocated in the REGISTRATION ACCEPT message, the AMF shall consider both the old and the new 5G- GUTIs as valid until the old 5G-GUTI can be considered as invalid by the AMF or the 5GMM context which has been marked as de-registered in the AMF is released. If the old 5G-GUTI was allocated by an AMF other than the current AMF, the current AMF does not need to retain the old 5G-GUTI. During this period, if the old 5G- GUTI is used by the UE in a subsequent message, the AMF acts as specified for case a) above. d) REGISTRATION REQUEST message received after the REGISTRATION ACCEPT message has been sent and before the REGISTRATION COMPLETE message is received, if the REGISTRATION COMPLETE message is expected.",
    "1) If one or more of the information elements in the REGISTRATION REQUEST message differ from the ones received within the previous REGISTRATION REQUEST message, the previously initiated the registration procedure for initial registration shall be aborted if the REGISTRATION COMPLETE message has not been received and the new registration procedure for initial registration shall be progressed; or 2) if the information elements do not differ, then the REGISTRATION ACCEPT message shall be resent and the timer T3550 shall be restarted. In that case, the retransmission counter related to T3550 is not incremented. e) More than one REGISTRATION REQUEST message with 5GS registration type IE set to \"initial registration\" received and no REGISTRATION ACCEPT message or REGISTRATION REJECT message has been sent.",
    "1) If one or more of the information elements in the REGISTRATION REQUEST message with 5GS registration type IE set to \"initial registration\" differs from the ones received within the previous REGISTRATION REQUEST message with 5GS registration type IE set to \"initial registration\", the previously initiated the registration procedure for initial registration shall be aborted and the new the registration procedure for initial registration shall be executed; 2) if the information elements do not differ, then the network shall continue with the previous the registration procedure for initial registration and shall ignore the second REGISTRATION REQUEST message. f) REGISTRATION REQUEST message with 5GS registration type IE set to \"initial registration\" received in state 5GMM-REGISTERED.",
    "If a REGISTRATION REQUEST message with 5GS registration type IE set to \"initial registration\" is received in state 5GMM-REGISTERED the network may initiate the 5GMM common procedures; if it turned out that the REGISTRATION REQUEST message was sent by a genuine UE that has already been registered, the 5GMM context, if any, are deleted and the new REGISTRATION REQUEST is progressed, otherwise if network considers REGISTRATION REQUEST message was not sent by a genuine UE based on authentication procedure the network shall maintain the 5GMM-context, if any, unchanged. NOTE 1: The network can determine that the UE is genuine by executing the authentication procedure as described in subclause 5.4.1. g) REGISTRATION REQUEST message with 5GS registration type IE set to \"mobility registration updating\" or \"periodic registration updating\" received before REGISTRATION COMPLETE message, if the REGISTRATION COMPLETE message is expected. Timer T3550 shall be stopped.",
    "The allocated 5G-GUTI in the registration procedure for initial registration shall be considered as valid and the registration procedure for mobility and periodic registration update shall be progressed as described in subclause 5.5.1.3. h) DEREGISTRATION REQUEST message received before REGISTRATION COMPLETE message, if the REGISTRATION COMPLETE message is expected. The AMF shall abort the registration procedure for initial registration and shall progress the de-registration procedure as described in subclause 5.5.2.2. i) UE security capabilities invalid or unacceptable If the REGISTRATION REQUEST message is received with invalid or unacceptable UE security capabilities (e.g. no 5GS encryption algorithms (all bits zero), no 5GS integrity algorithms (all bits zero), mandatory 5GS encryption algorithms not supported or mandatory 5GS integrity algorithms not supported, etc.), the AMF shall return a REGISTRATION REJECT message.",
    "NOTE 2: 5GMM cause value to be used in REGISTRATION REJECT message is up to the network implementation. j) Based on operator policy, if the initial registration request from a UE not supporting CAG is rejected due to CAG restrictions, the network shall reject the initial registration with a 5GMM cause value other than the 5GMM cause #76 (Not authorized for this CAG or authorized for CAG cells only). NOTE 3: 5GMM cause #7 (5GS services not allowed), 5GMM cause #11 (PLMN not allowed), 5GMM cause #27 (N1 mode not allowed), 5GMM cause #73 (Serving network not authorized) can be used depending on the subscription of the UE and whether the UE roams or not.",
    "The UE in state 5GMM-REGISTERED shall initiate the registration procedure for mobility and periodic registration update by sending a REGISTRATION REQUEST message to the AMF, a) when the UE detects that the current TAI is not in the list of tracking areas that the UE previously registered in the AMF; b) when the periodic registration updating timer T3512 expires in 5GMM-IDLE mode and the UE is not registered for emergency services (see subclause 5.3.7); c) when the UE receives a CONFIGURATION UPDATE COMMAND message indicating \"registration requested\" in the Registration requested bit of the Configuration update indication IE as specified in subclauses 5.4.4.3; d) when the UE in state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE either receives a paging or the UE receives a NOTIFICATION message with access type indicating 3GPP access over the non- 3GPP access for PDU sessions associated with 3GPP access; NOTE 1: As an implementation option, MUSIM UE is allowed to not respond to paging based on the information available in the paging message, e.g. voice service indication.",
    "e) upon inter-system change from S1 mode to N1 mode and if the UE previously had initiated an attach procedure or a tracking area updating procedure when in S1 mode; f) when the UE receives an indication of \"RRC Connection failure\" from the lower layers and does not have signalling pending (i.e. when the lower layer requests NAS signalling connection recovery) except for the case specified in subclause 5.3.1.4; g) when the UE changes the 5GMM capability or the S1 UE network capability or both; h) when the UE's usage setting changes; i) when the UE needs to change the slice(s) it is currently registered to; NOTE 1A: The UE can after the completion of the ongoing registration procedure, initiate another registration procedure for mobility registration update to request more slices.",
    "j) when the UE changes the UE specific DRX parameters; k) when the UE in state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE receives a request from the upper layers to establish an emergency PDU session or perform emergency services fallback; l) when the UE needs to register for SMS over NAS, indicate a change in the requirements to use SMS over NAS, or de-register from SMS over NAS; m) when the UE needs to indicate PDU session status to the network after performing a local release of PDU session(s) as specified in subclauses 6.4.1.5 and 6.4.3.5; n) when the UE in 5GMM-IDLE mode changes the radio capability for NG-RAN or E-UTRAN; o) when the UE receives a fallback indication from the lower layers and does not have signalling pending, see subclauses 5.3.1.4 and 5.3.1.2); p) void; q) when the UE needs to request new LADN information; r) when the UE needs to request the use of MICO mode or needs to stop the use of MICO mode or to request the use of new T3324 value or new T3512 value; s) when the UE in 5GMM-CONNECTED mode with RRC inactive indication enters a cell in the current registration area belonging to an equivalent PLMN of the registered PLMN and not belonging to the registered PLMN; t) when the UE receives over 3GPP access a SERVICE REJECT message or a DL NAS TRANSPORT message, with the 5GMM cause value set to #28 \"Restricted service area\"; u) when the UE needs to request the use of eDRX, when a change in the eDRX usage conditions at the UE requires different extended DRX parameters, or needs to stop the use of eDRX; NOTE 2: A change in the eDRX usage conditions at the UE can include e.g. a change in the UE configuration, a change in requirements from upper layers or the battery running low at the UE.",
    "v) when the UE supporting 5G-SRVCC from NG-RAN to UTRAN changes the mobile station classmark 2 or the supported codecs; w) when the UE in state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE decides to request new network slices after being rejected due to no allowed network slices requested, or request S-NSSAI(s) which have been removed from the rejected NSSAI for the maximum number of UEs reached; x) when the UE is not in NB-N1 mode and the UE has received a UE radio capability ID deletion indication IE set to \"Network-assigned UE radio capability IDs deletion requested”; y) when the UE receives a REGISTRATION REJECT message with 5GMM cause values #3, #6 or #7 without integrity protection over another access; z) when the UE needs to request new ciphering keys for ciphered broadcast assistance data; za) when due to manual CAG selection the UE has selected a CAG-ID which is not a CAG-ID authorized based on the \"allowed CAG list\" for the selected PLMN or a CAG-ID in a PLMN for which the entry in the \"CAG information list\" does not exist or when the UE has selected, without selecting a CAG-ID, a PLMN for which the entry in the \"CAG information list\" includes an \"indication that the UE is only allowed to access 5GS via CAG cells\"; zb) when the UE needs to start, stop or change the conditions for using the WUS assistance information or PEIPS assistance information; zc) when the UE changes the UE specific DRX parameters in NB-N1 mode; zd) when the UE in 5GMM-CONNECTED mode with RRC inactive indication enters a new cell with different RAT in current TAI list or not in current TAI list; ze) when the UE enters state 5GMM-REGISTERED.NORMAL-SERVICE or 5GMM-REGISTERED.NON- ALLOWED-SERVICE (as described in subclause 5.3.5.2) over 3GPP access after the UE has sent a NOTIFICATION RESPONSE message over non-3GPP access in response to reception of a NOTIFICATION message over non-3GPP access as specified in subclause 5.6.3.1; zf) when the UE supporting UAS services is not registered for UAS services and needs to register to the 5GS for UAS services; zg) when the UE supporting MINT needs to perform the registration procedure for mobility and periodic registration update to register to the PLMN offering disaster roaming; zh) when the MUSIM UE supporting the paging timing collision control needs to request a new 5G-GUTI assignment and the UE is not registered for emergency services; NOTE 3: Based on implementation, the MUSIM UE can request a new 5G-GUTI assignment (e.g. when the lower layers request to modify the timing of the paging occasions).",
    "zi) when the network supports the paging restriction and the MUSIM UE in state 5GMM-REGISTERED.NON- ALLOWED-SERVICE needs to requests the network to remove the paging restriction; zj) when the UE changes the 5GS Preferred CIoT network behaviour or the EPS Preferred CIoT network behaviour; zk) when the UE that has entered 5GMM-REGISTERED.NO-CELL-AVAILABLE and it has one or more S- NSSAI(s) in pending NSSAI, finds a suitable cell according to 3GPP TS 38.304 [28]; zl) when the UE is registered for disaster roaming services and receives a request from the upper layers to establish an emergency PDU session or perform emergency services fallback; zm1) when the UE needs to provide the unavailability information or to update the unavailability information; zm2) void; NOTE 3A: How UE determines that it is about to lose satellite coverage is an implementation option.",
    "zn) when the UE needs to come out of unavailability period and resume normal services; zo) when the UE in state 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE, the UE supports the reconnection to the network due to RAN timing synchronization status change has been requested to reconnect to the network upon receiving an indication of a change in the RAN timing synchronization status (see subclauses 5.4.4.2, 5.5.1.2.4, and 5.5.1.3.4), and the UE receives an indication of a change in the RAN timing synchronization status; or zp) when the UE that supports non-3GPP access path switching needs to trigger non-3GPP access path switching from the old non-3GPP access to the new non-3GPP access that is in the same PLMN. NOTE 4: Non-3GPP access path switching from a non-3GPP access to a wireline access, or from a wireline access to a non-3GPP access, is not specified in this release of the specification.",
    "zq) if the UE moves from a tracking area for which the TAI is configured for partially rejected NSSAI to another tracking area within the registration area with aTAI for which the S-NSSAI(s) is supported and the UE still needs to request that S-NSSAI(s). NOTE 4A: The UEs that do not initiate the registration procedure for mobility and periodic registration update in the case above will not receive service for the S-NSSAI(s) that are configured to support the S-NSSAI(s) in the tracking areas supporting the S-NSSAI(s). Operators are recomended to consider the impact of such a configuration, of having partially rejected NSSAI applicable in some tracking areas within a registration area, as it requires the UE to perform mobility and periodic registration update procedure upon mobility within the same registration area.",
    "If case b is the only reason for initiating the registration procedure for mobility and periodic registration update, the UE shall indicate \"periodic registration updating\" in the 5GS registration type IE; otherwise, if the UE initiates the registration procedure for mobility and periodic registration update due to case zg, the UE shall indicate \"disaster roaming mobility registration updating\" in the 5GS registration type IE; otherwise the UE shall indicate \"mobility registration updating\".",
    "If case zl is the reason for initiating the registration procedure for mobility and periodic registration update and if the UE supports S1 mode and the UE has not disabled its E-UTRA capability, the UE shall: - set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and - include the S1 UE network capability IE in the REGISTRATION REQUEST message; If the UE which is not registered for disaster roaming services indicates \"mobility registration updating\" in the 5GS registration type IE and the UE supports S1 mode and the UE has not disabled its E-UTRA capability, the UE shall: - set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; - include the S1 UE network capability IE in the REGISTRATION REQUEST message additionally, if the UE supports EPS-UPIP, the UE shall set the EPS-UPIP bit to \"EPS-UPIP supported\" in the S1 UE network capability IE in the REGISTRATION REQUEST message; and - if the UE supports sending an ATTACH REQUEST message containing a PDN CONNECTIVITY REQUEST message with request type set to \"handover\" to transfer a PDU session from N1 mode to S1 mode, set the HO attach bit to \"attach request message containing PDN connectivity request with request type set to handover to transfer PDU session from N1 mode to S1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the LTE positioning protocol (LPP) in N1 mode as specified in 3GPP TS 37.355 [26], the UE shall set the LPP bit to \"LPP in N1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the Location Services (LCS) notification mechanisms in N1 mode as specified in 3GPP TS 23.273 [6B], the UE shall set the 5G-LCS bit to \"LCS notification mechanisms supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the user plane positioning using LCS-UPP as specified in 3GPP TS 23.273 [6B], the UE shall set the LCS-UPP bit to \"LCS-UPP user plane positioning supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the user plane positioning using SUPL as specified in 3GPP TS 38.305 [67] and 3GPP TS 23.271 [68], the UE shall set the SUPL bit to \"SUPL user plane positioning supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports network verified UE location over satellite NG-RAN as specified in 3GPP TS 23.501 [8], the UE shall set the NVL-SATNR bit to \"Network verified UE location over satellite NG-RAN supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. For all cases except case b, when the UE is not in NB-N1 mode and the UE supports RACS, the UE shall set the RACS bit to \"RACS supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports 5G-SRVCC from NG-RAN to UTRAN as specified in 3GPP TS 23.216 [6A], the UE shall set: - the 5G-SRVCC from NG-RAN to UTRAN capability bit to \"5G-SRVCC from NG-RAN to UTRAN supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message for all cases except case b; and - include the Mobile station classmark 2 IE and the Supported codecs IE in the REGISTRATION REQUEST message for all cases except case b.",
    "If the UE supports the restriction on use of enhanced coverage, the UE shall set the RestrictEC bit to \"Restriction on use of enhanced coverage supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports network slice-specific authentication and authorization, the UE shall set the NSSAA bit to \"network slice-specific authentication and authorization supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message for all cases except case b. If the UE supports CAG feature, the UE shall set the CAG bit to \"CAG Supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports extended CAG information list, the UE shall set the Ex-CAG bit to \"Extended CAG information list supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports enhanced CAG information, the UE shall set the ECI bit to \"enhanced CAG information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports sending of REGISTRATION COMPLETE message for acknowledging the reception of Negotiated PEIPS assistance inforation IE, the UE shall set the RCMAP bit to \"Sending of REGISTRATION COMPLETE message for negotiated PEIPS assistance information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE operating in the single-registration mode performs inter-system change from S1 mode to N1 mode and: a) has one or more stored UE policy sections identified by a UPSI with the PLMN ID part indicating the HPLMN or the selected PLMN, the UE shall set the Payload container type IE to \"UE policy container\" and include the UE STATE INDICATION message (see annex D) in the Payload container IE of the REGISTRATION REQUEST message; or b) does not have any stored UE policy section identified by a UPSI with the PLMN ID part indicating the HPLMN or the selected PLMN, and the UE needs to send a UE policy container to the network, the UE shall set the Payload container type IE to \"UE policy container\" and include the UE STATE INDICATION message (see annex D) in the Payload container IE of the REGISTRATION REQUEST message.",
    "NOTE 5: In this version of the protocol, the UE can only include the Payload container IE in the REGISTRATION REQUEST message to carry a payload of type \"UE policy container\". The UE in state 5GMM-REGISTERED shall initiate the registration procedure for mobility and periodic registration update by sending a REGISTRATION REQUEST message to the AMF when the UE needs to request the use of SMS over NAS transport or the current requirements to use SMS over NAS transport change in the UE.",
    "The UE shall set the SMS requested bit of the 5GS update type IE in the REGISTRATION REQUEST message as specified in subclause 5.5.1.2.2. When initiating a registration procedure for mobility and periodic registration update and the UE needs to send the 5GS update type IE for a reason different than indicating a change in requirement to use SMS over NAS, the UE shall set the SMS requested bit of the 5GS update type IE in the REGISTRATION REQUEST message to the same value as indicated by the UE in the last REGISTRATION REQUEST message. If the UE no longer requires the use of SMS over NAS, then the UE shall include the 5GS update type IE in the REGISTRATION REQUEST message with the SMS requested bit set to \"SMS over NAS not supported\". After sending the REGISTRATION REQUEST message to the AMF the UE shall start timer T3510. If timer T3502 is currently running, the UE shall stop timer T3502. If timer T3511 is currently running, the UE shall stop timer T3511.",
    "If the last visited registered TAI is available, the UE shall include the last visited registered TAI in the REGISTRATION REQUEST message. The UE shall handle the 5GS mobile identity IE in the REGISTRATION REQUEST message as follows: a) if the UE is operating in the single-registration mode, performs inter-system change from S1 mode to N1 mode, and the UE holds a valid native 4G-GUTI, the UE shall create a 5G-GUTI mapped from the valid native 4G- GUTI as specified in 3GPP TS 23.003 [4] and indicate the mapped 5G-GUTI in the 5GS mobile identity IE.",
    "Additionally, if the UE holds a valid 5G-GUTI, the UE shall include the 5G-GUTI in the Additional GUTI IE in the REGISTRATION REQUEST message in the following order: 1) a valid 5G-GUTI that was previously assigned by the same PLMN with which the UE is performing the registration, if available; 2) a valid 5G-GUTI that was previously assigned by an equivalent PLMN, if available; and 3) a valid 5G-GUTI that was previously assigned by any other PLMN, if available; and NOTE 6: The 5G-GUTI included in the Additional GUTI IE is a native 5G-GUTI. b) for all other cases, if the UE holds a valid 5G-GUTI, the UE shall indicate the 5G-GUTI in the 5GS mobile identity IE. If the UE is registering with an SNPN and the valid 5G-GUTI was previously assigned by another SNPN, the UE shall additionally include the NID of the other SNPN in the NID IE.",
    "If the UE does not operate in SNPN access operation mode, holds two valid native 5G-GUTIs assigned by PLMNs and: 1) one of the valid native 5G-GUTI was assigned by the PLMN with which the UE is performing the registration, then the UE shall indicate the valid native 5G-GUTI assigned by the PLMN with which the UE is performing the registration. In addition, the UE shall include the other valid native 5G-GUTI in the Additional GUTI IE; or 2) none of the valid native 5G-GUTI was assigned by the PLMN with which the UE is performing the registration, then the UE shall indicate the valid native 5G-GUTI assigned over the same access via which the UE is performing the registration. If the UE supports MICO mode and requests the use of MICO mode, then the UE shall include the MICO indication IE in the REGISTRATION REQUEST message. If the UE requests to use an active time value, it shall include the active time value in the T3324 IE in the REGISTRATION REQUEST message.",
    "If the UE includes the T3324 IE, it may also request a particular T3512 value by including the Requested T3512 IE in the REGISTRATION REQUEST message. Additionally, if the UE supports strictly periodic registration timer, the UE shall set the Strictly Periodic Registration Timer Indication bit of the MICO indication IE in the REGISTRATION REQUEST message to \"strictly periodic registration timer supported\". If the UE needs to stop the use of MICO mode, then the UE shall not include the MICO indication IE in the REGISTRATION REQUEST message. If the UE needs to use or change the UE specific DRX parameters, the UE shall include the Requested DRX parameters IE in the REGISTRATION REQUEST message for all cases except case b). If the UE is in NB-N1 mode and if the UE needs to use or change the UE specific DRX parameters for NB-N1 mode, the UE shall include the Requested NB-N1 mode DRX parameters IE in the REGISTRATION REQUEST message for all cases except case b).",
    "If the UE supports eDRX and requests the use of eDRX, the UE shall include the Requested extended DRX parameters IE in the REGISTRATION REQUEST message. If the UE needs to request LADN information for specific LADN DNN(s) or indicates a request for LADN information as specified in 3GPP TS 23.501 [8], the UE shall include the LADN indication IE in the REGISTRATION REQUEST message and: - request specific LADN DNNs by including a LADN DNN value in the LADN indication IE for each LADN DNN for which the UE requests LADN information; or - to indicate a request for LADN information by not including any LADN DNN value in the LADN indication IE.",
    "If the UE is initiating the registration procedure for mobility and periodic registration update, the UE may include the Uplink data status IE to indicate which PDU session(s) is: - not associated with control plane only indication; - associated with the access type the REGISTRATION REQUEST message is sent over; and - have pending user data to be sent over user plane or are associated with active multicast MBS session(s). If the UE has one or more active always-on PDU sessions associated with the access type over which the REGISTRATION REQUEST message is sent and the user-plane resources for these PDU sessions are not established, and for cases triggering the REGISTRATION REQUEST message except b), the UE shall include the Uplink data status IE and indicate that the UE has pending user data to be sent for those PDU sessions.",
    "If the UE is located outside the LADN service area and inside the registration area assigned by the network, the UE shall not include the PDU session for LADN in the Uplink data status IE. If the UE is in a non-allowed area or is not in an allowed area as specified in subclause 5.3.5, and the UE is in the registration area assigned by the network, the UE shall not include the Uplink data status IE except for emergency services or for high priority access. If the MUSIM UE requests the network to release the NAS signalling connection, the UE shall not include the Uplink data status IE in the REGISTRATION REQUEST message. If the UE has one or more active PDU sessions which are not accepted by the network as always-on PDU sessions and no uplink user data pending to be sent for those PDU sessions, the UE shall not include those PDU sessions in the Uplink data status IE in the REGISTRATION REQUEST message.",
    "When the registration procedure for mobility and periodic registration update is initiated in 5GMM-IDLE mode, the UE may include a PDU session status IE in the REGISTRATION REQUEST message, indicating: a) which single access PDU sessions associated with the access type the REGISTRATION REQUEST message is sent over are not inactive in the UE; and b) which MA PDU sessions are not inactive and having the corresponding user plane resources being established or established in the UE on the access the REGISTRATION REQUEST message is sent over. If the UE received a paging message with the access type indicating non-3GPP access, the UE shall include the Allowed PDU session status IE in the REGISTRATION REQUEST message.",
    "If the UE has PDU session(s) over non- 3GPP access, where a) the associated S-NSSAI(s) are included in the allowed NSSAI for 3GPP access or the partially allowed NSSAI for 3GPP access and the TAI where the UE is currently camped is in the list of TAs for which the S-NSSAI is allowed; and b) the UE is currently camped inside the NS-AoS of the S-NSSAI, if the S-NSSAI location validity information is available, the UE shall indicate the PDU session(s) for which the UE allows to re-establish the user-plane resources over 3GPP access in the Allowed PDU session status IE; otherwise, the UE shall not indicate any PDU session(s) in the Allowed PDU session status IE.",
    "If the UE is in a non-allowed area or the UE is not in an allowed area, the UE shall set the Allowed PDU session status IE as specified in subclause 5.3.5.2. When the Allowed PDU session status IE is included in the REGISTRATION REQUEST message, the UE shall indicate that a PDU session is not allowed to be transferred to the 3GPP access if the 3GPP PS data off UE status is \"activated\" for the corresponding PDU session and the UE is not using the PDU session to send uplink IP packets for any of the 3GPP PS data off exempt services (see subclause 6.2.10).",
    "If the UE operating in the single-registration mode performs inter-system change from S1 mode to N1 mode, the UE: a) shall include the UE status IE with the EMM registration status set to \"UE is in EMM-REGISTERED state\" in the REGISTRATION REQUEST message; NOTE 7: Inclusion of the UE status IE with this setting corresponds to the indication that the UE is \"moving from EPC\" as specified in 3GPP TS 23.502 [9], subclause 4.11.1.3.3 and 4.11.2.3. NOTE 8: The value of the 5GMM registration status included by the UE in the UE status IE is not used by the AMF.",
    "b) may include the PDU session status IE in the REGISTRATION REQUEST message indicating the status of the PDU session(s) mapped during the inter-system change from S1 mode to N1 mode from the PDN connection(s) for which the EPS indicated that interworking to 5GS is supported, if any (see subclause 6.1.4.1); c) shall include a TRACKING AREA UPDATE REQUEST message as specified in 3GPP TS 24.301 [15] in the EPS NAS message container IE in the REGISTRATION REQUEST message if the registration procedure is initiated in 5GMM-IDLE mode and the UE has received an \"interworking without N26 interface not supported\" indication from the network; c1) may include a TRACKING AREA UPDATE REQUEST message as specified in 3GPP TS 24.301 [15] in the EPS NAS message container IE in the REGISTRATION REQUEST message if the registration procedure is initiated in 5GMM-IDLE mode and the UE has received an \"interworking without N26 interface supported\" indication from the network; and d) shall include an EPS bearer context status IE in the REGISTRATION REQUEST message indicating which EPS bearer contexts are active in the UE, if the UE has locally deactivated EPS bearer context(s) for which interworking to 5GS is supported while the UE was in S1 mode without notifying the network.",
    "For a REGISTRATION REQUEST message with a 5GS registration type IE indicating \"mobility registration updating\", if the UE: a) is in NB-N1 mode and: 1) the UE needs to change the slice(s) it is currently registered to within the same registration area; or 2) the UE has entered a new registration area; or b) is not in NB-N1 mode and is not registered for onboarding services in SNPN; the UE shall include the Requested NSSAI IE containing the S-NSSAI(s) corresponding to the network slices to which the UE intends to register and associated mapped S-NSSAI(s), if available, in the REGISTRATION REQUEST message as described in this subclause. When the UE is entering a visited PLMN and intends to register to the slices for which the UE has only HPLMN S-NSSAI(s) available, the UE shall include these HPLMN S-NSSAI(s) in the Requested mapped NSSAI IE.",
    "When the UE is entering an EHPLMN whose PLMN code is not derived from the IMSI and intends to register to the slices for which the UE has only HPLMN S-NSSAI(s) available, the UE shall include HPLMN S-NSSAI(s) in the Requested mapped NSSAI IE. The sum of number of S-NSSAI values in the Requested NSSAI IE and number of S-NSSAI values in the Requested mapped NSSAI IE shall not exceed eight. NOTE 9: The REGISTRATION REQUEST message can include both the Requested NSSAI IE and the Requested mapped NSSAI IE as described below. If the UE is registered for onboarding services in SNPN, the UE shall not include the Requested NSSAI IE in the REGISTRATION REQUEST message.",
    "If the UE has allowed NSSAI or configured NSSAI or both for the current PLMN, the Requested NSSAI IE shall include either: a) the configured NSSAI for the current PLMN or SNPN, or a subset thereof as described below; b) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as described below; or c) the allowed NSSAI for the current PLMN or SNPN, or a subset thereof as described below, plus the configured NSSAI for the current PLMN or SNPN, or a subset thereof as described below; In addition, the Requested NSSAI IE shall include S-NSSAI(s) applicable in the current PLMN or SNPN, and if available the associated mapped S-NSSAI(s) for: a) each PDN connection that is established in S1 mode when the UE is operating in the single-registration mode and the UE is performing an inter-system change from S1 mode to N1 mode; or b) each active PDU session.",
    "If the UE does not have S-NSSAI(s) applicable in the current PLMN or SNPN, then the Requested mapped NSSAI IE shall include HPLMN S-NSSAI(s) (e.g. mapped S-NSSAI(s), if available) for: a) each PDN connection established in S1 mode when the UE is operating in the single-registration mode and the UE is performing an inter-system change from S1 mode to N1 mode to a visited PLMN; or b) each active PDU session when the UE is performing mobility from N1 mode to N1 mode to a visited PLMN. NOTE 10: The Requested NSSAI IE is used instead of Requested mapped NSSAI IE in REGISTRATION REQUEST message when the UE enters HPLMN and the EHPLMN list is not present or is empty; or when the UE enters a PLMN whose PLMN code is derived from the IMSI and the EHPLMN list is not empty. The Requested mapped NSSAI IE is used when the UE enters an EHPLMN whose PLMN code is not derived from the IMSI.",
    "If both the S-NSSAI to be replaced and the alternative S-NSSAI are included in the configured NSSAI, and the UE needs to request the S-NSSAI to be replaced, the UE shall include the S-NSSAI to be replaced in the Requested NSSAI IE or the Requested mapped NSSAI IE. For a REGISTRATION REQUEST message with a 5GS registration type IE indicating \"mobility registration updating\", if the UE is in NB-N1 mode and the procedure is initiated for all cases except case a), c), e), i), s), t), w), and x), the REGISTRATION REQUEST message shall not include the Requested NSSAI IE.",
    "If the UE has: - no allowed NSSAI for the current PLMN or SNPN; - no configured NSSAI for the current PLMN or SNPN; - neither active PDU session(s) nor PDN connection(s) to transfer associated with an S-NSSAI applicable in the current PLMN or SNPN; and - neither active PDU session(s) nor PDN connection(s) to transfer associated with mapped S-NSSAI(s); and has a default configured NSSAI, then the UE shall: a) include the S-NSSAI(s) in the Requested NSSAI IE of the REGISTRATION REQUEST message using the default configured NSSAI; and b) include the Network slicing indication IE with the Default configured NSSAI indication bit set to \"Requested NSSAI created from default configured NSSAI\" in the REGISTRATION REQUEST message.",
    "If the UE has: - no allowed NSSAI for the current PLMN or SNPN; - no configured NSSAI for the current PLMN or SNPN; - neither active PDU session(s) nor PDN connection(s) to transfer associated with an S-NSSAI applicable in the current PLMN or SNPN - neither active PDU session(s) nor PDN connection(s) to transfer associated with mapped S-NSSAI(s); and - no default configured NSSAI, the UE shall include neither Requested NSSAI IE nor Requested mapped NSSAI IE in the REGISTRATION REQUEST message. If all the S-NSSAI(s) corresponding to the slice(s) to which the UE intends to register are included in the pending NSSAI, the UE shall not include a requested NSSAI in the REGISTRATION REQUEST message. When the UE storing a pending NSSAI intends to register to additional S-NSSAI(s) over the same access type, the UE shall send the requested NSSAI containing the additional S-NSSAI(s) that the UE intends to register to in the REGISTRATION REQUEST message.",
    "The requested NSSAI shall not include any S-NSSAI from the pending NSSAI. The subset of configured NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the configured NSSAI applicable to the current PLMN or SNPN, where any included S-NSSAI is neither in the rejected NSSAI nor associated to an S-NSSAI in the rejected NSSAI. If the UE is inside the NS-AoS of an S-NSSAI in the rejected NSSAI with a rejection cause value set to \"S-NSSAI not available in the current registration area\", the S-NSSAI may be included in the requested NSSAI. For case zq, the subset of configured NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the configured NSSAI applicable to the current PLMN or SNPN, where any included S-NSSAI is in the partially rejected NSSAI and the current TAI is in the list of TAs for which the S-NSSAI is not rejected.",
    "If the UE is inside the NS-AoS of an S-NSSAI in the partially rejected NSSAI and the current TAI is in the list of TAs for which the S-NSSAI is rejected, the S-NSSAI may be included in the requested NSSAI. In addition, if the NSSRG information is available, the subset of configured NSSAI provided in the requested NSSAI shall be associated with at least one common NSSRG value. The UE may also include in the requested NSSAI included in the Requested NSSAI IE or the Requested mapped NSSAI IE or both, the S-NSSAI(s) which were added to configured NSSAI in S1 mode and for which the associated NSSRG information is not available.",
    "If the UE is in 5GMM-REGISTERED state over the other access and has already an allowed NSSAI for the other access in the same PLMN or in different PLMNs, all the S-NSSAI(s) in the requested NSSAI included in the Requested NSSAI IE or the Requested mapped NSSAI IE or both for the current access shall share at least an NSSRG value common to all the S- NSSAI(s) of the allowed NSSAI for the other access. If the UE is simultaneously performing the registration procedure on the other access in different PLMNs, the UE shall include S-NSSAIs that share at least a common NSSRG value across all access types. If the UE has pending NSSAI which the UE is still interested in using, then S-NSSAIs in the pending NSSAI and requested NSSAI shall be associated with at least one common NSSRG value.",
    "NOTE 11: If the UE has stored mapped S-NSSAI(s) for the rejected NSSAI, and one or more S-NSSAIs in the stored mapped S-NSSAI(s) for the configured NSSAI are not included in the stored mapped S-NSSAI(s) for the rejected NSSAI, then a S-NSSAI in the configured NSSAI associated to one or more of these mapped S-NSSAI(s) for the configured NSSAI are available to be included in the requested NSSAI together with their mapped S-NSSAI. NOTE 12: If one or more mapped S-NSSAIs in the stored mapped S-NSSAI(s) for the configured NSSAI are not included in the stored rejected NSSAI for the failed or revoked NSSAA, a S-NSSAI in the configured NSSAI associated to one or more of these mapped S-NSSAI(s) for the configured NSSAI are available to be included in the registration request together with their mapped S-NSSAI.",
    "NOTE 13: There is no need to consider the case that the UE is simultaneously performing the registration procedure on the other access in the same PLMN, due to that the UE is not allowed to initiate the registration procedure over one access when the registration over the other access to the same PLMN is going on. If: a) the UE is registered to current PLMN over the other access and has NSSRG information available; b) the UE is attempting mobility registration to the same current PLMN from other PLMN in the current access; and c) the UE has PDU session(s) or PDN connection(s) associated with NSSAI not sharing part of NSSRG available of the current PLMN; then the UE locally releases these PDU session(s) or PDN connection(s), as the NSSAI for these PDU session(s) or PDN connection(s) will not be included in the requested or the requested mapped NSSAI in the current PLMN due to its lack of association to the common NSSRG of the current PLMN.",
    "The subset of allowed NSSAI provided in the requested NSSAI consists of one or more S-NSSAIs in the allowed NSSAI for this PLMN. If the UE supports the S-NSSAI time validity information, S-NSSAI time validity information is available for an S- NSSAI, and the S-NSSAI time validity information indicates that the S-NSSAI is not available, the UE shall not include the S-NSSAI in the Requested NSSAI IE of the REGISTRATION REQUEST message. If the UE has S-NSSAI time validity information over the other access in the same PLMN and the S-NSSAI time validity information indicates that the S-NSSAI is not available, the UE shall not include the S-NSSAI in the Requested NSSAI IE of the REGISTRATION REQUEST message for the current access type. NOTE 14: How the UE selects the subset of configured NSSAI or allowed NSSAI to be provided in the requested NSSAI is implementation specific.",
    "The UE can take preferences indicated by the upper layers (e.g. policies like URSP, applications) and UE local configuration into account. NOTE 14A: If the UE determines the on-demand S-NSSAI for a PDU session establishment as specified in subclause 4.2.2 of 3GPP TS 24.526 [19], the UE includes the on-demand S-NSSAI in the requested NSSAI during the registration procedure. NOTE 15: The number of S-NSSAI(s) included in the requested NSSAI cannot exceed eight. If the UE supports NSAG, the UE shall set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports sending of REGISTRATION COMPLETE message for acknowledging the reception of NSAG information IE in the REGISTRATION ACCEPT message, the UE shall set the RCMAN bit to \"Sending of REGISTRATION COMPLETE message for NSAG information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the unavailability period, the UE shall set the UN-PER bit to \"unavailability period supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports network slice replacement, the UE shall set the NSR bit to \"network slice replacement supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. For case zm1, if the network indicated support for the unavailability period in the last registration procedure, the UE shall include the Unavailability information IE in the REGISTRATION REQUEST message. If the UE did not include a start of the unavailability period in the Unavailability information IE, the UE shall set the Follow-on request indicator to \"No follow-on request pending\" in the REGISTRATION REQUEST message and shall not include the Uplink data status IE or the Allowed PDU session status IE in the REGISTRATION REQUEST message even if the UE has one or more active always-on PDU sessions associated with the 3GPP access.",
    "If the UE includes the Unavailability information IE to indicate the type of the unavailability and the UE will be unavailable due to NR satellite access discontinuous coverage, the UE shall set the Unavailability type bit to \"unavailability due to discontinuous coverage\" in the Unavailability information IE. For case zm1, the UE should initiate the registration procedure for mobility and periodic registration update only if the UE can determine, based on its implementation, that there is enough time to complete the procedure before the start of the unavailability period. NOTE 15A: If the UE is unable to store its 5GMM and 5GSM contexts, the UE triggers the de-registration procedure. Ability to store the 5GMM information for UEs not operating in SNPN access operation mode as described in Annex C.1 does not imply the ability to store the 5GMM and 5GSM contexts.",
    "NOTE 15B: If the UE is able to store its 5GMM and 5GSM contexts, the UE can store the 5GMM and 5GSM contexts even if the registration procedure for mobility and periodic registration update is not completed successfully. The UE shall set the Follow-on request indicator to \"Follow-on request pending\", if the UE: a) initiates the registration procedure for mobility and periodic registration update upon request of the upper layers to establish an emergency PDU session; b) initiates the registration procedure for mobility and periodic registration update upon receiving a request from the upper layers to perform emergency services fallback; or c) needs to prolong the established NAS signalling connection after the completion of the registration procedure for mobility and periodic registration update (e.g. due to uplink signalling pending but no user data pending).",
    "NOTE 16: The UE does not have to set the Follow-on request indicator to 1 even if the UE has to request resources for V2X communication over PC5 reference point, 5G ProSe direct discovery over PC5, 5G ProSe direct communication over PC5 or ranging and sidelink positioning or A2X communication over PC5 reference point. For case n, the UE shall include the 5GS update type IE in the REGISTRATION REQUEST message with the NG- RAN-RCU bit set to \"UE radio capability update needed\". Additionally, if the UE is not in NB-N1 mode, the UE supports RACS and the UE has an applicable UE radio capability ID for the new UE radio configuration in the serving PLMN or SNPN, the UE shall include the applicable UE radio capability ID in the UE radio capability ID of the REGISTRATION REQUEST message.",
    "NOTE 16A: For cases n, if the UE supports RACS irrespective whether the UE has an applicable UE radio capability ID for the new UE radio configuration in the selected PLMN the 5GS update type IE in the REGISTRATION REQUEST message with the NG-RAN-RCU bit is set to \"UE radio capability update needed\". If the UE is in the 5GMM-CONNECTED mode and the UE changes the radio capability for NG-RAN or E-UTRAN, the UE may locally release the established N1 NAS signalling connection and enter the 5GMM-IDLE mode. Then, the UE shall initiate the registration procedure for mobility and periodic registration update including the 5GS update type IE in the REGISTRATION REQUEST message with the NG-RAN-RCU bit set to \" UE radio capability update needed\".",
    "For case o, the UE shall include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) without active user-plane resources for which the UE has pending user data to be sent, if any, and the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any. If the UE has joined one or more multicast MBS session and was in 5GMM-CONNECTED mode with RRC inactive indication before receiving the fallback indication from the lower layers, the UE shall include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) that are associated to the one or more multicast MBS session.",
    "If the UE is in a non-allowed area or if the UE is not in allowed area, the UE shall not include the Uplink data status IE in REGISTRATION REQUEST message, except if the PDU session for which user-plane resources were active prior to receiving the fallback indication is an emergency PDU session, or if the UE is configured for high priority access in the selected PLMN or SNPN as specified in subclause 5.3.5. For case f-, the UE shall include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) for which the UE has uplink user data pending and the PDU session(s) for which user-plane resources were active prior to receiving \"RRC Connection failure\" indication from the lower layers, if any.",
    "If the UE has joined one or more multicast MBS session and was in 5GMM-CONNECTED mode with RRC inactive indication before receiving the indication of \"RRC Connection failure\" from the lower layers or before receiving the indication that the resumption of the RRC connection has failed from the lower layers, the UE shall include the Uplink data status IE in the REGISTRATION REQUEST message indicating the PDU session(s) that are associated to the one or more multicast MBS session.",
    "If the UE is in non-allowed area or not in allowed area, the UE shall not include the Uplink data status IE in REGISTRATION REQUEST message, except that the PDU session for which user-plane resources were active prior to receiving the \"RRC Connection failure\"indication is emergency PDU session, or that the UE is configured for high priority access in selected PLMN or SNPN, as specified in subclause 5.3.5. If the UE supports service gap control, then the UE shall set the SGC bit to \"service gap control supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "For cases a, x or if the UE operating in the single-registration mode performs inter-system change from S1 mode to N1 mode, the UE shall: a) if the UE has an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN, include the applicable network-assigned UE radio capability ID in the UE radio capability ID IE of the REGISTRATION REQUEST message; and b) if the UE: 1) does not have an applicable network-assigned UE radio capability ID for the current UE radio configuration in the selected PLMN or SNPN; and 2) has an applicable manufacturer-assigned UE radio capability ID for the current UE radio configuration, include the applicable manufacturer-assigned UE radio capability ID in the UE radio capability ID IE of the REGISTRATION REQUEST message.",
    "For all cases except cases b and z, if the UE supports ciphered broadcast assistance data and the UE needs to obtain new ciphering keys, the UE shall include the Additional information requested IE with the CipherKey bit set to \"ciphering keys for ciphered broadcast assistance data requested\" in the REGISTRATION REQUEST message. For case z, the UE shall include the Additional information requested IE with the CipherKey bit set to \"ciphering keys for ciphered broadcast assistance data requested\" in the REGISTRATION REQUEST message. For case a, if the UE supports ciphered broadcast assistance data and the UE detects that one or more ciphering keys stored at the UE is not applicable in the current TAI, the UE should include the Additional information requested IE with the CipherKey bit set to \"ciphering keys for ciphered broadcast assistance data requested\" in the REGISTRATION REQUEST message.",
    "For case b, if the UE supports ciphered broadcast assistance data and the remaining validity time for one or more ciphering keys stored at the UE is less than timer T3512, the UE should include the Additional information requested IE with the CipherKey bit set to \"ciphering keys for ciphered broadcast assistance data requested\" in the REGISTRATION REQUEST message. The UE shall set the WUSA bit to \"WUS assistance information reception supported\" in the 5GMM capability IE if the UE supports WUS assistance information. The UE may include its UE paging probability information in the Requested WUS assistance information IE if the UE has set the WUSA bit to \"WUS assistance information reception supported\" in the 5GMM capability IE and does not have an active emergency PDU session.",
    "The UE shall set the NR-PSSI bit to \"NR paging subgrouping supported\" in the 5GMM capability IE if the UE supports PEIPS assistance information, is not registered for emergency services and does not have an active emergency PDU session. The UE may include its UE paging probability information in the Requested PEIPS assistance information IE if the UE has set the NR-PSSI bit to \"NR paging subgrouping supported\" in the 5GMM capability IE. If the network supports the N1 NAS signalling connection release, and the MUSIM UE requests the network to release the NAS signalling connection, the UE shall set Request type to \"NAS signalling connection release\" in the UE request type IE, set the Follow-on request indicator to \"No follow-on request pending\" and, if the network supports the paging restriction, may set the paging restriction preference in the Paging restriction IE in the REGISTRATION REQUEST message.",
    "In addition, the UE shall not include the Uplink data status IE or the Allowed PDU session status IE in the REGISTRATION REQUEST message even if the UE has one or more active always-on PDU sessions associated with the 3GPP access. NOTE 17: If the network has already indicated support for N1 NAS signalling connection release in the current stored registration area and the UE doesn't have an emergency PDU session established, the MUSIM UE is allowed to request the network to release the NAS signalling connection during registration procedure for mobility and periodic registration update that is due to mobility outside the registration area even before detecting whether the network supports the N1 NAS signalling connection release in the current TAI.",
    "NOTE 18: If the network has already indicated support for paging restriction in the current stored registration area and the UE doesn't have an emergency PDU session established, the MUSIM UE is allowed to include paging restriction together with the request to the network to release the NAS signalling connection during registration procedure for mobility and periodic registration update that is due to mobility outside the registration area even before detecting whether the network supports the paging restriction in the current TAI. For case zi, the UE shall not include the Paging restriction IE in the REGISTRATION REQUEST message. If the UE is in 5GMM-IDLE mode and the network supports the N1 NAS signalling connection release, the UE may include the UE request type IE and set Request type to \"NAS signalling connection release\" to remove the paging restriction and request the release of the NAS signalling connection at the same time.",
    "In addition, the UE shall not include the Uplink data status IE in the REGISTRATION REQUEST message. If the UE does not have a valid 5G NAS security context and the UE is sending the REGISTRATION REQUEST message after an inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode, the UE shall send the REGISTRATION REQUEST message without including the NAS message container IE. The UE shall include the entire REGISTRATION REQUEST message (i.e. containing cleartext IEs and non-cleartext IEs, if any) in the NAS message container IE that is sent as part of the SECURITY MODE COMPLETE message as described in subclauses 4.4.6 and 5.4.2.3. If the UE indicates \"mobility registration updating\" in the 5GS registration type IE and supports V2X as specified in 3GPP TS 24.587 [19B], the UE shall set the V2X bit to \"V2X supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE indicates \"mobility registration updating\" in the 5GS registration type IE and supports V2X communication over E-UTRA-PC5 as specified in 3GPP TS 24.587 [19B], the UE shall set the V2XCEPC5 bit to \"V2X communication over E-UTRA-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE indicates \"mobility registration updating\" in the 5GS registration type IE and supports V2X communication over NR-PC5 as specified in 3GPP TS 24.587 [19B], the UE shall set the V2XCNPC5 bit to \"V2X communication over NR-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "The UE shall send the REGISTRATION REQUEST message including the NAS message container IE as described in subclause 4.4.6: a) when the UE is sending the message from 5GMM-IDLE mode, the UE has a valid 5G NAS security context, and needs to send non-cleartext IEs; or b) when the UE is sending the message after an inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode and the UE has a valid 5G NAS security context and needs to send non-cleartext IEs. The UE with a valid 5G NAS security context shall send the REGISTRATION REQUEST message without including the NAS message container IE when the UE does not need to send non-cleartext IEs and the UE is sending the message: a) from 5GMM-IDLE mode; or b) after an inter-system change from S1 mode to N1 mode in 5GMM-IDLE mode.",
    "If the UE is sending the REGISTRATION REQUEST message after an inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode and the UE needs to send non-cleartext IEs, the UE shall cipher the NAS message container IE using the mapped 5G NAS security context and send the REGISTRATION REQUEST message including the NAS message container IE as described in subclause 4.4.6. If the UE does not need to send non-cleartext IEs, the UE shall send the REGISTRATION REQUEST message without including the NAS message container IE. If the REGISTRATION REQUEST message includes a NAS message container IE, the AMF shall process the REGISTRATION REQUEST message that is obtained from the NAS message container IE as described in subclause 4.4.6. If the UE is in NB-N1 mode, then the UE shall set the Control plane CIoT 5GS optimization bit to \"Control plane CIoT 5GS optimization supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "For all cases except case b, if the UE is capable of NB-S1 mode, then the UE shall set the Control plane CIoT EPS optimization bit to \"Control plane CIoT EPS optimization supported\" in the S1 UE network capability IE of the REGISTRATION REQUEST message. If the registration procedure for mobility and periodic registration update is initiated and there is request from the upper layers to perform \"emergency services fallback\" pending, the UE shall send a REGISTRATION REQUEST message without an Uplink data status IE. If the UE supports N3 data transfer and multiple user-plane resources in NB-N1 mode (see 3GPP TS 36.306 [25D], 3GPP TS 36.331 [25A]), then the UE shall set the Multiple user-plane resources support bit to \"Multiple user-plane resources supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. The UE shall set the ER-NSSAI bit to \"Extended rejected NSSAI supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the NSSRG, then the UE shall set the NSSRG bit to \"NSSRG supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. For case zf, the UE shall include the service-level device ID in the Service-level-AA container IE of the REGISTRATION REQUEST message and set the value to the CAA-level UAV ID. The UE shall include the service- level-AA server address in the Service-level-AA container IE of the REGISTRATION REQUEST message and set the value to the USS address, if it is provided by the upper layers. The UE shall include the service-level-AA payload in the Service-level-AA container IE of the REGISTRATION REQUEST message and shall set the service-level-AA payload type, if the service-level-AA payload is provided by upper layers. NOTE 18: The service-level-AA payload can be of type \"C2 authorization payload\".",
    "The C2 authorization payload can include one or both of an indication of the request for direct C2 communication and pairing information for direct C2 communication. If the UE supports 5G ProSe direct discovery as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-dd bit to \"5G ProSe direct discovery supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports 5G ProSe direct communication as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-dc bit to \"5G ProSe discovery communication supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-2 UE-to-network relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2relay bit to \"Acting as a 5G ProSe layer-2 UE-to-network relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports acting as 5G ProSe layer-3 UE-to-network relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3relay bit to \"Acting as a 5G ProSe layer-3 UE-to-network relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-2 UE-to-network remote UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2rmt bit to \"Acting as a 5G ProSe layer-2 UE-to- network remote UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-3 UE-to-network remote UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3rmt bit to \"Acting as a 5G ProSe layer-3 UE-to-network remote UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports acting as 5G ProSe layer-2 UE-to-UE relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2U2U relay bit to \"Acting as a 5G ProSe layer-2 UE-to-UE relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-3 UE-to-UE relay UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3U2U relay bit to \"Acting as a 5G ProSe layer-3 UE-to-UE relay UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports acting as 5G ProSe layer-2 end UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l2end bit to \"Acting as a 5G ProSe layer-2 end UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports acting as 5G ProSe layer-3 end UE as specified in 3GPP TS 24.554 [19E], the UE shall set the 5G ProSe-l3end bit to \"Acting as a 5G ProSe layer-3 end UE supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. For all cases except case b, if the MUSIM UE supports the N1 NAS signalling connection release, then the UE shall set the N1 NAS signalling connection release bit to \"N1 NAS signalling connection release supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the N1 NAS signalling connection release bit to \"N1 NAS signalling connection release supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "For all cases except case b, if the MUSIM UE supports the paging indication for voice services, then the UE shall set the paging indication for voice services bit to \"paging indication for voice services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the paging indication for voice services bit to \"paging indication for voice services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. For all cases except case b, if the MUSIM UE supports the reject paging request, then the UE shall set the reject paging request bit to \"reject paging request supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the reject paging request bit to \"reject paging request supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "For all cases except case b, if the MUSIM UE sets: - the reject paging request bit to \"reject paging request supported\"; - the N1 NAS signalling connection release bit to \"N1 NAS signalling connection release supported\"; or - both of them; and supports the paging restriction, then the UE shall set the paging restriction bit to \"paging restriction supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message otherwise the UE shall not set the paging restriction bit to \"paging restriction supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports MINT, the UE shall set the MINT bit to \"MINT supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports slice-based N3IWF selection, the UE shall set the SBNS bit to \"Slice-based N3IWF selection supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports slice-based TNGF selection, the UE shall set the SBTS bit to \"Slice-based TNGF selection supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports UAS services, the UE shall set the UAS bit to \"UAS services supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports A2X over E-UTRA-PC5 as specified in 3GPP TS 24.577 [60], the UE shall set the A2XEPC5 bit to \"A2X over E-UTRA-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports A2X over NR-PC5 as specified in 3GPP TS 24.577 [60], the UE shall set the A2XNPC5 bit to \"A2X over NR-PC5 supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports A2X over Uu as specified in 3GPP TS 24.577 [60], the UE shall set the A2X-Uu bit to \"A2X over Uu supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "For case zg, if the UE has determined the UE determined PLMN with disaster condition as specified in 3GPP TS 23.122 [5], and: a) the UE determined PLMN with disaster condition is the HPLMN and: 1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and does not contain a valid 5G-GUTI that was previously assigned by the HPLMN; or 2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message and the 5GS mobile identity IE contains neither the SUCI nor a valid 5G-GUTI that was previously assigned by the HPLMN; or b) the UE determined PLMN with disaster condition is not the HPLMN and: 1) the Additional GUTI IE is included in the REGISTRATION REQUEST message and does not contain a valid 5G-GUTI that was previously assigned by the UE determined PLMN with disaster condition; or 2) the Additional GUTI IE is not included in the REGISTRATION REQUEST message and the 5GS mobile identity IE does not contain a valid 5G-GUTI that was previously assigned by the UE determined PLMN with disaster condition; the UE shall include in the REGISTRATION REQUEST message the UE determined PLMN with disaster condition IE indicating the UE determined PLMN with disaster condition.",
    "NOTE 19: If the UE initiates the registration procedure for disaster roaming services, and the UE determined PLMN with disaster condition cannot be determined when an NG-RAN cell of the PLMN broadcasts the disaster related indication as specified in 3GPP TS 23.122 [5], the UE does not include in the REGISTRATION REQUEST message the UE determined PLMN with disaster condition IE but includes the Additional GUTI IE or the 5GS mobile identity IE or both as specified in subclauses 5.5.1.2.2. For case zh the UE shall indicate \"mobility registration updating\" in the 5GS registration type IE of the REGISTRATION REQUEST message. For case zp, the UE shall send the REGISTRATION REQUEST message over the new non-3GPP access.",
    "The UE shall include the Uplink data status IE in the REGISTRATION REQUEST message indicating the MA PDU session ID(s) or the single access PDU session ID(s) whose user plan resources are to be switched from the old non-3GPP access to the new non-3GPP access or to be established over the new non-3GPP access, if any. If the UE requests the network to keep using the user plane resources of the old non-3GPP access during path switching to the new non-3GPP access, the UE shall include the Non-3GPP path switching information IE in the REGISTRATION REQUEST message and set the NSONR bit to \"non-3GPP path switching while using old non-3GPP resources requested\". If the UE supports event notification, the UE shall set the EventNotification bit to \"Event notification supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports access to an SNPN using credentials from a credentials holder and: a) the UE is in its HPLMN or EHPLMN or the subscribed SNPN; or b) the UE is in a non-subscribed SNPN and supports equivalent SNPNs; the UE shall set the SSNPNSI bit to \"SOR-SNPN-SI supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports equivalent SNPNs, the UE shall set the ESI bit to \"equivalent SNPNs supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports LADN per DNN and S-NSSAI, the UE shall set the LADN-DS bit to \"LADN per DNN and S-NSSAI supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports the reconnection to the network due to RAN timing synchronization status change, the UE shall set the Reconnection to the network due to RAN timing synchronization status change (RANtiming) bit to \"Reconnection to the network due to RAN timing synchronization status change supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports MPS indicator update via the UE configuration update procedure, the UE shall set the MPSIU bit to \"MPS indicator update supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports MCS indicator update via the UE configuration update procedure, the UE shall set the MCSIU bit to \"MCS indicator update supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports ranging and sidelink positioning as specified in 3GPP TS 24.514 [62] and supports: a) V2X communication over PC5 as specified in 3GPP TS 24.587 [19B]; b) 5G ProSe direct discovery and 5G ProSe direct communication as specified in 3GPP TS 24.554 [19E]; or c) both a) and b), the UE shall set a) the RSLP bit to \"Ranging and sidelink positioning supported\"; b) the RSLPL bit to \"Ranging and sidelink positioning for located UE supported\"; c) the RSLPS bit to \"Ranging and sidelink positioning for SL positioning server UE supported\"; or d) any combination of a), b) and c), in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the partial network slice, the UE shall set the PNS bit to \"Partial network slice supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "If the UE supports network slice usage control, the UE shall set the NSUC bit to \"Network slice usage control supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the S-NSSAI time validity information, the UE shall set the TempNS bit to \"S-NSSAI time validity information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports the S-NSSAI location validity information, the UE shall set the SLVI bit to \"S-NSSAI location validity information supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message.",
    "Stop T3510 OR REGISTRATION REQUEST Start T3510 Stop T3550 REGISTRATION ACCEPT Start T3550 REGISTRATION COMPLETE Stop T3510 REGISTRATION REQUEST Start T3510 REGISTRATION REJECT UE AMF Stop T3510 REGISTRATION REQUEST Start T3510 REGISTRATION ACCEPT OR Figure 5.5.1.3.2.1: Registration procedure for mobility and periodic registration update B) the UE has an emergency PDU session, then the UE shall perform a local release of all PDU sessions associated with 3GPP access except for the emergency PDU session and enter the state 5GMM- REGISTERED.LIMITED-SERVICE; or b) if the UE receives the REGISTRATION ACCEPT message via a non-CAG cell and the entry for the registered PLMN in the received \"CAG information list\" includes an \"indication that the UE is only allowed to access 5GS via CAG cells\" and: 1) if one or more CAG-ID(s) are authorized based on the \"allowed CAG list\" for the registered PLMN in the received \"CAG information list\", the UE shall enter the state 5GMM-REGISTERED.LIMITED-SERVICE and shall search for a suitable cell according to 3GPP TS 38.304 [28] with the updated \"CAG information list\"; or 2) if no CAG-ID is authorized based on the \"Allowed CAG list\" of the entry for the registered PLMN in the received \"CAG information list\" and: i) the UE does not have an emergency PDU session, then the UE shall enter the state 5GMM- REGISTERED.PLMN-SEARCH and shall apply the PLMN selection process defined in 3GPP TS not accepted by the network If the mobility and periodic registration update request for initiating an emergency PDU session cannot be accepted by the network, the UE shall perform the procedures as described in subclause 5.5.1.3.5. If the mobility and periodic registration update request for initiating an emergency PDU session fails due to receiving the AUTHENTICATION REJECT message, the UE shall perform the procedures as described in subclauses 5.4.1.2.2.11, 5.4.1.2.3.1, 5.4.1.2.3A.1 or 5.4.1.3.5. Then if the UE is in the same selected PLMN where the last mobility and periodic registration update request was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 1: This can result in the upper layers requesting implementation specific mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the emergency call being attempted to another IP-CAN.",
    "b) perform de-registration locally, if not de-registered already, and attempt initial registration for emergency services. If the mobility and periodic registration update request for initiating an emergency PDU session fails due to abnormal case b) in subclause 5.5.1.3.7, the UE shall perform the actions as described in subclause 5.5.1.3.7 and inform the upper layers of the failure to access the network. NOTE 2: This can result in the upper layers requesting implementation specific mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the emergency call being attempted to another IP-CAN.",
    "If the mobility and periodic registration update request for initiating an emergency PDU session fails due to abnormal cases c), d), e) or g) in subclause 5.5.1.3.7, the UE shall perform the procedures as described in subclause 5.5.1.3.7. Then if the UE is in the same selected PLMN where the last mobility and periodic registration update request was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 3: This can result in the upper layers requesting implementation specific mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the emergency call being attempted to another IP-CAN. b) perform de-registration locally, if not de-registered already, and attempt initial registration for emergency services.",
    "5.5.1.3.6A Mobility and periodic registration update for an emergency services fallback not accepted by the network If the mobility and periodic registration update request triggered upon receiving a request from the upper layers to perform an emergency services fallback: - fails due to an abnormal case described in subclause 5.5.1.3.7, the UE shall perform the procedures as described in subclause 5.5.1.3.7; - cannot be accepted by the network as described in subclause 5.5.1.3.5, the UE shall perform the procedures as described in subclause 5.5.1.3.5; or - fails due to receiving the AUTHENTICATION REJECT message, the UE shall perform the procedures as described in subclauses 5.4.1.2.2.11, 5.4.1.2.3.1, 5.4.1.2.3A.1 or 5.4.1.3.5. If the mobility and periodic registration update request triggered upon receiving a request from the upper layers to perform an emergency services fallback fails due to abnormal case b) in subclause 5.5.1.3.7, the UE shall inform the upper layers of the failure to access the network.",
    "NOTE 1: This can result in the upper layers requesting implementation specific mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the emergency call being attempted to another IP-CAN. If the mobility and periodic registration update request triggered upon receiving a request from the upper layers to perform an emergency services fallback fails due to abnormal cases c), d), e) or g), cannot be accepted or fails due to receiving the AUTHENTICATION REJECT message and the UE does not attempt to select an E-UTRA cell connected to EPC or 5GCN as described in subclause 5.5.1.3.5 and the UE is camped on NR or E-UTRA cell connected to 5GCN in the same PLMN where the last mobility and periodic registration update request was attempted, the UE shall inform the upper layers of the failure of the procedure.",
    "NOTE 2: This can result in the upper layers requesting implementation specific mechanisms, e.g. procedures specified in 3GPP TS 24.229 [14] can result in the emergency call being attempted to another IP-CAN.",
    "The de-registration procedure is used: a) by the UE to de-register for 5GS services over 3GPP access when the UE is registered over 3GPP access; b) by the UE to de-register for 5GS services over non-3GPP access when the UE is registered over non-3GPP access; c) by the UE to de-register for 5GS services over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses; d) by the network to inform the UE that it is deregistered for 5GS services over 3GPP access when the UE is registered over 3GPP access; e) by the network to inform the UE that it is deregistered for 5GS services over non-3GPP access when the UE is registered over non-3GPP access; f) by the network to inform the UE that it is deregistered for 5GS services over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses; g) by the network to inform the UE to re-register to the network; h) by the network to inform the UE supporting UAS service that it is deregistered for UAS services in 5GS; and i) by the network to inform the UE operating as MBSR that it is deregistered for MBSR in 5GS.",
    "The de-registration procedure with appropriate de-registration type shall be invoked by the UE: a) if the UE is switched off; b) as part of the eCall inactivity procedure defined in subclause 5.5.3; and c) as part of USIM removal. The de-registration procedure with appropriate de-registration type shall be invoked by the network: a) if the network informs whether the UE should re-register to the network.",
    "The de-registration procedure with appropriate access type shall be invoked by the UE: a) to de-register for 5GS services over 3GPP access when the UE is registered over 3GPP access; b) to de-register for 5GS services over non-3GPP access when the UE is registered over non-3GPP access; c) to de-register for 5GS services over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses; d) to de-register for 5GS services over 3GPP access, if the UE is registered for disaster roaming over 3GPP access and has successfully registered over non-3GPP access on another PLMN; or e) to de-register for 5GS services if an event is triggered in the UE that would make the UE unavailable for a certain period of time and the UE is not able to store its 5GMM and 5GSM context. NOTE 1: If the UE is able to store its 5GMM and 5GSM contexts, the UE triggers the registration procedure for mobility and periodic registration update.",
    "The de-registration procedure with appropriate access type shall be invoked by the network: a) if the network needs to inform the UE that it is deregistered over 3GPP access when the UE is registered over 3GPP access; b) if the network needs to inform the UE that it is deregistered over non-3GPP access when the UE is registered over non-3GPP access; or c) if the network needs to inform the UE that it is deregistered over 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN over both accesses. If the de-registration procedure is triggered due to USIM removal, the UE shall indicate \"switch off\" in the de- registration type IE. If the de-registration procedure is requested by the network for a UE that has an emergency PDU session, the AMF shall not send a DEREGISTRATION REQUEST message to the UE and indicate to the SMF to release all non- emergency PDU sessions as specified in 3GPP TS 23.502 [9].",
    "If the de-registration procedure for 5GS services is performed, a local release of the PDU sessions over the indicated access(es), if any, for this particular UE is performed. If a PDU session that will be released is associated with one or more multicast MBS sessions, the UE is considered as removed from the associated multicast MBS sessions. The UE is allowed to initiate the de-registration procedure even if the timer T3346 is running. NOTE 2: When the UE has no PDU sessions over non-3GPP access, or the UE moves all the PDU sessions over a non-3GPP access to a 3GPP access, the UE and the AMF need not initiate de-registration over the non- 3GPP access. The AMF shall provide the UE with a non-3GPP de-registration timer. When the AMF enters the state 5GMM-DEREGISTERED for 3GPP access, the AMF shall delete the stored UE radio capability information or the UE radio capability ID, if any.",
    "When upper layers indicate that emergency services are no longer required, the UE if still registered for emergency services, may perform UE-initiated de-registration procedure followed by a re-registration to regain normal services, if the UE is in or moves to a suitable cell. If the UE is registered for onboarding services in SNPN, after completing the configuration of one or more entries of the \"list of subscriber data\", the UE should perform UE-initiated de-registration procedure.",
    "To prevent the UE registered for onboarding services in SNPN from staying on the ON-SNPN or to prevent a UE whose subscription only allows for configuration of SNPN subscription parameters in PLMN via the user plane, from staying registered indefinitely, when an implementation specific timer expires: - if the AMF considers that the UE is in 5GMM-IDLE, the AMF shall locally de-registers the UE; or - if the UE is in 5GMM-CONNECTED, the AMF shall initiate the network-initiated de-registration procedure (see subclause 5.5.2.3). NOTE 3: The value of the implementation specific timer for onboarding services needs to be large enough to allow a UE to complete the configuration of one or more entries of the \"list of subscriber data\" taking into consideration that configuration of SNPN subscription parameters in PLMN via the user plane or onboarding services in SNPN involves third party entities outside of the operator's network.",
    "NOTE 4: How to determine the completion of the configuration of one or more entries of the \"list of subscriber data\" is UE implementation specific. If the de-registration procedure is not due to switch off and upper layers request establishing an emergency PDU session before the de-registration procedure has been completed, the UE shall abort the de-registration procedure, perform local de-registration and initiate a registration procedure. If the UE in 5GMM-CONNECTED mode determines to obtain service on a higher priority PLMN due to SOR, then based on the conditions as specified in 3GPP TS 23.122 [5] annex C, where applicable, the UE shall perform UE- initiated de-registration procedure. If the UE is registered for disaster roaming services, and the UE receives an indication of whether disaster roaming is enabled in the UE set to \"Disaster roaming is disabled in the UE\" in a UE parameters update transparent container, the UE shall perform UE-initiated de-registration procedure.",
    "When the DEREGISTRATION REQUEST message is received by the AMF, the AMF shall send a DEREGISTRATION ACCEPT message to the UE, if the De-registration type IE does not indicate \"switch off\". Otherwise, the procedure is completed when the AMF receives the DEREGISTRATION REQUEST message. The UE, when receiving the DEREGISTRATION ACCEPT message, shall stop timer T3521, stop timer T3519 if running, and delete any stored SUCI. 3GPP access and non-3GPP access If the access type in the DEREGISTRATION REQUEST indicates that the de-registration procedure is for both 3GPP access and non-3GPP access when the UE is registered in the same PLMN over both accesses, the descriptions for UE- initiated de-registration procedure completion for 5GS services over 3GPP access and over non-3GPP access, as specified in subclauses 5.5.2.2.3 and 5.5.2.2.4, shall be followed.",
    "The network initiates the de-registration procedure by sending a DEREGISTRATION REQUEST message to the UE (see example in figure 5.5.2.3.1.1). NOTE 1: If the AMF performs a local de-registration, it will inform the UE with a 5GMM messages (e.g. SERVICE REJECT message or REGISTRATION REJECT message) with 5GMM cause #10 \"implicitly de-registered\" only when the UE initiates a 5GMM procedure. The network may include a 5GMM cause IE to specify the reason for the DEREGISTRATION REQUEST message. The network shall start timer T3522. The network shall indicate whether re-registration is needed or not in the De- registration type IE. The network shall also indicate via the access type whether the de-registration procedure is: a) for 3GPP access only; b) for non-3GPP access only; or c) for 3GPP access, non-3GPP access or both when the UE is registered in the same PLMN for both accesses.",
    "If the network de-registration is triggered due to network slice-specific authentication and authorization failure or revocation as specified in subclause 4.6.2.4, then the network shall set the 5GMM cause value to #62 \"No network slices available\" in the DEREGISTRATION REQUEST message. In addition, if the UE supports extended rejected NSSAI, the AMF shall include the Extended rejected NSSAI IE in the DEREGISTRATION REQUEST message; otherwise, the AMF shall include the Rejected NSSAI IE in the DEREGISTRATION REQUEST message. In roaming scenarios, if the Extended rejected NSSAI IE is included in the DEREGISTRATION REQUEST message, the AMF shall provide mapped S-NSSAI(s) for the rejected NSSAI.",
    "If the UE supports extended rejected NSSAI and the network de-registration is triggered due to mobility management based network slice admission control as specified in subclause 4.6.2.5, then the network shall set the 5GMM cause value to #62 \"No network slices available\" in the DEREGISTRATION REQUEST message. In addition, the network may include a back-off timer value for each S-NSSAI with the rejection cause \"S-NSSAI not available due to maximum number of UEs reached\" in the Extended rejected NSSAI IE of the DEREGISTRATION REQUEST message. If the network de-registration is triggered for a UE supporting CAG due to CAG restrictions, the network shall set the 5GMM cause value to #76 \"Not authorized for this CAG or authorized for CAG cells only\" and should include the \"CAG information list\" in the CAG information list IE or the Extended CAG information list IE in the DEREGISTRATION REQUEST message.",
    "NOTE 2: If the UE supports extended CAG information list, the CAG information list can be included either in the CAG information list IE or Extended CAG information list IE. NOTE 3: It is unexpected for network to send REGISTRATION REJECT message to the UE with 5GMM cause value #76 in non-CAG cell and not indicate \"Indication that the UE is only allowed to access 5GS via CAG cells\" for the serving PLMN in the Extended CAG information list or the CAG information list. If the network de-registration is triggered for a UE not supporting CAG due to CAG restrictions, the network shall operate as described in bullet g) of subclause 5.5.2.3.5. If the network de-registration is triggered because the network determines that the UE is in a location where the network is not allowed to operate, see 3GPP TS 23.502 [9], the network shall set the 5GMM cause value in the DEREGISTRATION REQUEST message to #78 \"PLMN not allowed to operate at the present UE location\".",
    "If the network de-registration is triggered due to: a) an unsuccessful outcome of an ongoing UUAA-MM procedure; b) an UUAA revocation notification received from the UAS-NF for a UE supporting UAS service requesting UAS services; or c) the UE not allowed to use UAS services via 5GS due to a change of the aerial UE subscription information, then the network shall set the 5GMM cause value in the DEREGISTRATION REQUEST message to #79 \"UAS services not allowed\". NOTE 4: If the UE supporting UAS service has requested other services than UAS services, or if there are other ongoing network slice-specific authentication and authorization on pending NSSAIs, it is then an operator policy or configuration decision whether to keep the UE supporting UAS service registered to the network, but that UE supporting UAS services is not allowed to access UAS services via 5GS as specified in 3GPP TS 23.256 [6AB].",
    "If the network de-registration is triggered for a UE supporting MINT due to a disaster condition no longer being applicable in the current location of the UE, the network shall set the 5GMM cause value to #11 \"PLMN not allowed\" and may include a disaster return wait range in the Disaster return wait range IE in the DEREGISTRATION REQUEST message. If the network de-registration is triggered because the AMF determines that, by UE subscription and operator's preferences, all of the TAIs received from the satellite NG-RAN are forbidden for roaming or for regional provision of service, the AMF shall include the TAI(s) in: a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE; or b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE; or c) both; in the DEREGISTRATION REQUEST message.",
    "If the network de-registration is triggered because the AMF determines that the UE operating as an IAB-node by subscription is not authorized for IAB-node operation, the AMF shall set the 5GMM cause value to #36 \"IAB-node operation not authorized\" in the DEREGISTRATION REQUEST message. If the network de-registration is triggered for a UE operating as MBSR due to the UE no longer being allowed to operate as MBSR based on the UE subscription and the local policy, and: a) if the UE is allowed to operate as a UE, then the network shall indicate \"re-registration required\" in the De- registration type IE of the DEREGISTRATION REQUEST message; or b) if the UE is not allowed to operate as a UE, then the network shall indicate \"re-registration not required\" in the De-registration type IE of the DEREGISTRATION REQUEST message based on the local policy.",
    "If the network de-registration is triggered due to the UE that was not allowed for MBSR operation becoming allowed to operate as MBSR based on the UE subscription and the local policy, then the network shall indicate \"re-registration required\" in the De-registration type IE of the DEREGISTRATION REQUEST message. The AMF shall trigger the SMF to release locally the PDU session(s) over the indicated access(es), if any, for the UE and enter state 5GMM-DEREGISTERED-INITIATED. If a PDU session is associated with one or more multicast MBS sessions, the SMF shall consider the UE as removed from the associated multicast MBS sessions. UE AMF DEREGISTRATION REQUEST Start T3522 DEREGISTRATION ACCEPT Stop T3522 Figure 5.5.2.3.1.1: Network-initiated de-registration procedure The following abnormal cases can be identified: a) Transmission failure of DEREGISTRATION ACCEPT message indication from lower layers.",
    "The de-registration procedure shall be progressed and the UE shall send the DEREGISTRATION ACCEPT message. b) DEREGISTRATION REQUEST, other 5GMM cause values than those treated in subclause 5.5.2.3.2, cases of 5GMM cause value#11, #15, #22, #72, #74, #75, #76, #77, #78, #79 and #93 that are considered as abnormal cases according to subclause 5.5.2.3.2 or no 5GMM cause IE is included, and the De-registration type IE indicates \"re-registration not required\". The UE shall delete TAI list, last visited registered TAI and list of equivalent PLMNs (if any) or list of equivalent SNPNs (if any), shall set the 5GS update status to 5U2 NOT UPDATED and shall start timer T3502. If the UE is not registering or has not registered to the same PLMN over both 3GPP access and non-3GPP access, the UE shall additionally delete 5G-GUTI and ngKSI.",
    "A UE not supporting S1 mode may enter the state 5GMM-DEREGISTERED.PLMN-SEARCH in order to perform a PLMN selection or SNPN selection according to 3GPP TS 23.122 [5]; otherwise the UE shall enter the state 5GMM-DEREGISTERED.ATTEMPTING-REGISTRATION. If the de-registration request is for 3GPP access only or for both 3GPP access and non-3GPP access and the UE is operating in the single-registration mode, the UE shall: - enter the state 5GMM-DEREGISTERED and attempt to select E-UTRAN radio access technology and proceed with the appropriate EMM specific procedures. In this case, the UE may disable the N1 mode capability (see subclause 4.9); or - enter the state 5GMM-DEREGISTERED.PLMN-SEARCH in order to perform a PLMN selection according to 3GPP TS 23.122 [5].",
    "If the message was received via 3GPP access and the UE is operating in the single-registration mode, the UE shall set the EPS update status to EU2 NOT UPDATED, enter the state EMM-DEREGISTERED and shall delete the EMM parameters 4G-GUTI, last visited registered TAI, TAI list and eKSI.",
    "network relay and 5G ProSe UE-to-UE relay Upon receiving a ProSe direct link establishment request from the 5G ProSe remote UE or the 5G ProSe end UE including the SUCI or the CP-PRUK ID of the 5G ProSe remote UE or the 5G ProSe end UE, for establishing a secure PC5 unicast link as specified in 3GPP TS 24.554 [19E] when the security for 5G ProSe communication via 5G ProSe UE-to-network relay or 5G ProSe UE-to-UE relay is performed over control plane as specified in 3GPP TS 33.503 [56], the UE shall: a) allocate a PRTI value as specified in subclause 5.5.4.2; b) create a RELAY KEY REQUEST message; c) set the PRTI IE of the RELAY KEY REQUEST message to the allocated PRTI value; d) set the relay key request parameters IE of the RELAY KEY REQUEST message with SUCI or the CP-PRUK ID, relay service code, and nonce_1 received from the of the 5G ProSe remote UE or the 5G ProSe end UE; e) send the RELAY KEY REQUEST message; and f) start the timer T3527 upon sending the RELAY KEY REQUEST message.",
    "The following abnormal cases in the UE can be identified: a) Transmission failure of RELAY KEY REQUEST message or RELAY KEY AUTHENTICATION RESPONSE message indication from lower layers. The UE shall abort the authentication and key agreement procedure for 5G ProSe UE-to-network relay and perform the PC5 signalling protocol procedure as specified in subclause 7.2.2.5 of 3GPP 24.554 [19E]. b) Expiry of timer T3527. The UE shall, on the first expiry of the timer T3527, retransmit the RELAY KEY REQUEST message or the RELAY KEY AUTHENTICATION RESPONSE message and shall reset and start timer T3527. This retransmission is repeated four times, i.e. on the fifth expiry of timer T3527, the procedure shall be aborted. c) Collision between the authentication and key agreement procedure for 5G ProSe UE-to-network relay or 5G ProSe UE-to-UE relay and de-registration procedure.",
    "The UE shall abort the authentication and key agreement procedure for 5G ProSe UE-to-network relay or 5G ProSe UE-to-UE relay, proceed with the network initiated de-registration procedure, and perform the PC5 signalling protocol procedure as specified in subclause 7.2.2.5 of 3GPP 24.554 [19E]. The purpose of the service request procedure is to: a) change the 5GMM mode from 5GMM-IDLE to 5GMM-CONNECTED mode; b) request the establishment of user-plane resources for PDU sessions which are established without user-plane resources if the UE is not using 5GS services with control plane CIoT 5GS optimization and the 5GMM mode is the 5GMM-IDLE mode or the 5GMM-CONNECTED mode; or c) initiate transfer of user data via the control plane if the UE is using 5GS services with control plane CIoT 5GS optimization and the 5GMM mode is 5GMM-IDLE mode. NOTE 1: The lower layer indicates when the user-plane resources for PDU sessions are successfully established or released.",
    "This procedure is used when: - the network has downlink signalling pending over 3GPP access and the UE is in 5GMM-IDLE mode over 3GPP access; - the network has downlink signalling pending over non-3GPP access, the UE is in 5GMM-IDLE mode over non- 3GPP access and in 5GMM-IDLE or 5GMM-CONNECTED mode over 3GPP access; - the UE has uplink signalling pending over 3GPP access and the UE is in 5GMM-IDLE mode over 3GPP access; - the network has downlink user data pending over 3GPP access and the UE is in 5GMM-IDLE mode over 3GPP access; - the network has downlink user data pending over non-3GPP access, the UE is in 5GMM-IDLE mode over non- 3GPP access and in 5GMM-IDLE or 5GMM-CONNECTED mode over 3GPP access; - the UE has user data pending over 3GPP access and the UE is in 5GMM-IDLE or 5GMM-CONNECTED mode over 3GPP access; - the UE has user data pending over non-3GPP access and the UE is in 5GMM-CONNECTED mode over non- 3GPP access; - the UE in 5GMM-IDLE mode over non-3GPP access, receives an indication from the lower layers of non-3GPP access, that the access stratum connection is established between the UE and the network, if T3346 is not running; - the UE in 5GMM-IDLE or 5GMM-CONNECTED mode over 3GPP access receives a request from the upper layers to perform emergency services fallback and performs emergency services fallback as specified in subclause 4.13.4.2 of 3GPP TS 23.502 [9]; - the UE has to request resources for V2X communication over PC5; - the UE has to request resources for 5G ProSe direct discovery over PC5 or 5G ProSe direct communication over PC5; - the UE has to request resources for A2X communication over PC5; NOTE 2: The purpose for the UE to request resources for V2X communication over PC5, 5G ProSe direct discovery over PC5 and 5G ProSe direct communication over PC5 can be to perform the ranging and sidelink positioning service over PC5.",
    "- the MUSIM UE in 5GMM-IDLE mode requests the network to remove the paging restriction; - the MUSIM UE requests the release of the NAS signalling connection or rejects the paging request from the network; or - the UE supporting the reconnection to the network due to RAN timing synchronization status change receives an indication of a change in the RAN timing synchronization status. This procedure shall not be used for: a) initiating user data transfer or CIoT user data via the control plane; or b) PDU session management related signalling other than for performing UE-requested PDU session release procedure related to a PDU session for LADN or for performing the UE-requested PDU session modification procedure to indicate a change of 3GPP PS data off UE status; when the UE is located outside the LADN service area.",
    "In NB-N1 mode, this procedure shall not be used to request the establishment of user-plane resources: a) for a number of PDU sessions that exceeds the UE' s maximum number of supported user-plane resources if there is currently: 1) no user-plane resources established for the UE; 2) user-plane resources established for: i) one PDU session and the Multiple user-plane resources support bit was set to \"Multiple user-plane resources not supported\" in the 5GMM capability IE; or ii) two PDU sessions and the Multiple user-plane resources support bit was set to \"Multiple user-plane resources supported\" in the 5GMM capability IE; or b) for additional PDU sessions, if the number of PDU sessions for which user-plane resources are currently established is equal to the UE's maximum number of supported user-plane resources.",
    "The service request procedure is initiated by the UE, however, it can be triggered by the network by means of: - the paging procedure (see subclause 5.6.2) for the transfer of downlink signalling or user data pending over 3GPP access to a UE in 5GMM-IDLE mode over 3GPP access; - the paging procedure (see subclause 5.6.2) for the transfer of downlink signalling or user data pending over non- 3GPP access to a UE in 5GMM-IDLE mode over 3GPP access and in 5GMM-IDLE mode over non-3GPP access; - the notification procedure (see subclause 5.6.3) for the transfer of downlink signalling or user data pending over non-3GPP access to a UE in 5GMM-CONNECTED mode over 3GPP access and in 5GMM-IDLE mode over non-3GPP access; or - the notification procedure (see subclause 5.6.3) for the transfer of downlink signalling or user data pending over 3GPP access to a UE in 5GMM-IDLE mode over 3GPP access and in 5GMM-CONNECTED mode over non- 3GPP access.",
    "NOTE 3: In case the UE is in 5GMM-IDLE mode over 3GPP access and in 5GMM-CONNECTED mode over non- 3GPP access and downlink signalling or user data pending over 3GPP access needs to be transferred, the AMF can trigger either the notification procedure or the paging procedure based on implementation. The UE shall invoke the service request procedure when: a) the UE, in 5GMM-IDLE mode over 3GPP access, receives a paging request from the network; NOTE 4: As an implementation option, the MUSIM UE is allowed to not invoke service request to respond to paging based on the information available in the paging message, e.g. voice service indication.",
    "b) the UE, in 5GMM-CONNECTED mode over 3GPP access, receives a notification from the network with access type indicating non-3GPP access; c) the UE, in 5GMM-IDLE mode over 3GPP access, has uplink signalling pending (except in case i); d) the UE, in 5GMM-IDLE mode over 3GPP access, has uplink user data pending (except in case j); e) the UE, in 5GMM-CONNECTED mode or in 5GMM-CONNECTED mode with RRC inactive indication, has user data pending due to no user-plane resources established for PDU session(s) used for user data transport; f) the UE in 5GMM-IDLE mode over non-3GPP access, with T3346 not active or upon expiry of T3346, receives or has already received an indication from the lower layers of non-3GPP access, that the access stratum connection is established between the UE and the network; g) the UE, in 5GMM-IDLE mode over 3GPP access, receives a notification from the network with access type indicating 3GPP access when the UE is in 5GMM-CONNECTED mode over non-3GPP access; h) the UE, in 5GMM-IDLE, 5GMM-CONNECTED mode over 3GPP access, or 5GMM-CONNECTED mode with RRC inactive indication, receives a request from the upper layers to perform emergency services fallback and performs emergency services fallback as specified in subclause 4.13.4.2 of 3GPP TS 23.502 [9]; i) the UE, in 5GMM-CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode with RRC inactive indication, receives a fallback indication from the lower layers (see subclauses 5.3.1.2 and 5.3.1.4) and the UE has a pending NAS procedure other than a registration, service request, or de-registration procedure; the UE, in 5GMM-CONNECTED mode over 3GPP access, receives a \"RRC Connection failure\" from the lower layers and the UE has a pending NAS procedure other than a registration, service request, or de-registration procedure; j) the UE, in 5GMM-CONNECTED mode over 3GPP access or in 5GMM-CONNECTED mode with RRC inactive indication, receives a fallback indication from the lower layers (see subclauses 5.3.1.2 and 5.3.1.4) and the UE has pending uplink user data for PDU session(s) with user-plane resources already established but no pending NAS procedure; the UE, in 5GMM-CONNECTED mode over 3GPP access, receives a \"RRC Connection failure\" indication from the lower layers and the UE has pending uplink user data for PDU session(s) with user-plane resources already established but no pending NAS procedure; k) the UE, in 5GMM-CONNECTED mode and has a NAS signalling connection only, is using 5GS services with control plane CIoT 5GS optimization and has pending user data to be sent via user-plane resources; l) the UE in 5GMM-IDLE mode over 3GPP access has to request resources for V2X communication over PC5 (see 3GPP TS 23.287 [6C]); la) the UE in 5GMM-IDLE mode over 3GPP access has to request resources for A2X communication over PC5 (see 3GPP TS 23.256 [6AB]); m) the network supports the paging restriction, and the MUSIM UE in 5GMM-IDLE mode is requesting the network to remove the paging restriction; n) the UE in 5GMM-IDLE mode over 3GPP access - has to request resources for 5G ProSe direct discovery over PC5 or 5G ProSe direct communication over PC5 (see 3GPP TS 23.304 [6E]); or - acts as a 5G ProSe layer-2 UE-to-network relay UE and receives a trigger from lower layers to establish the NAS signalling connection (see 3GPP TS 23.304 [6E]); o) the network supports the N1 NAS signalling connection release, the MUSIM UE, - is in 5GMM-CONNECTED mode, requests the network to release the NAS signalling connection and, if the network supports the paging restriction, optionally includes paging restriction; - is in 5GMM-CONNECTED mode with RRC inactive indication, requests the network to release the NAS signalling connection and, if the network supports the paging restriction, optionally includes paging restriction; or - is in 5GMM-CONNECTED mode with RRC inactive indication, rejects the RAN paging, requests the network to release the NAS signalling connection and, if the network supports the paging restriction, optionally includes paging restriction; p) the network supports the reject paging request, the MUSIM UE in 5GMM-IDLE mode when responding to paging rejects the paging request from the network, requests the network to release the NAS signalling connection and, if the network supports the paging restriction, optionally includes paging restriction; or q) the UE supporting the reconnection to the network due to RAN timing synchronization status change has been requested to reconnect to the network upon receiving an indication of a change in the RAN timing synchronization status (see subclauses 5.4.4.2, 5.5.1.2.4, and 5.5.1.3.4) and the UE in 5GMM-IDLE mode receives an indication of a change in the RAN timing synchronization status; If one of the above criteria to invoke the service request procedure is fulfilled, then the service request procedure shall only be initiated by the UE when the following conditions are fulfilled: - its 5GS update status is 5U1 UPDATED, and the TAI of the current serving cell is included in the TAI list; and - no 5GMM specific procedure is ongoing.",
    "The UE shall not invoke the service request procedure when the UE is in the state 5GMM-SERVICE-REQUEST- INITIATED. The MUSIM UE shall not initiate service request procedure for requesting the network to release the N1 NAS signalling connection if the UE is registered for emergency services or if the UE has an emergency PDU session established. To enable the emergency call back, the UE shall not initiate service request procedure for requesting the network to release the NAS signalling connection for a UE implementation-specific duration of time after the completion of the emergency services. The UE supporting S-NSSAI location validity information shall not invoke the service request procedure to establish user-plane resources for PDU sessions associated to an S-NSSAI when the UE is not in the NS-AoS of the S-NSSAI.",
    "UE AMF SERVICE REQUEST SERVICE REQUEST (for emergency services fallback) AS indication OR SERVICE ACCEPT Start T3517 Stop T3517 Start T3517 Stop T3517 AS SERVICE REQUEST SERVICE REJECT OR Start T3517 Stop T3517 Figure 5.6.1.1.1: Service Request procedure (Part 1) UE AMF CONTROL PLANE SERVICE REQUEST OR SERVICE ACCEPT Start T3517 Stop T3517 AS CONTROL PLANE SERVICE REQUEST AS indication about release of RRC connection Start T3517 Stop T3517 CONTROL PLANE SERVICE REQUEST SERVICE REJECT Start T3517 Stop T3517 OR Figure 5.6.1.1.2: Service Request procedure (Part 2) A service request attempt counter is used to limit the number of service request attempts and no response from the network.",
    "The service request attempt counter shall be incremented as specified in subclause 5.6.1.7. The service request attempt counter shall be reset when: - a registration procedure for mobility and periodic registration update is successfully completed; - a service request procedure is successfully completed; - a service request procedure is rejected as specified in subclause 5.6.1.5 or subclause 5.3.20; or - the UE moves to 5GMM-DEREGISTERED state. The UE shall send a CONTROL PLANE SERVICE REQUEST message, start T3517 and enter the state 5GMM- SERVICE-REQUEST-INITIATED. For case a), and case b) in subclause 5.6.1.1, the Control plane service type of the CONTROL PLANE SERVICE REQUEST message shall indicate \"mobile terminating request\".",
    "If: a) the UE only has uplink CIoT user data or SMS to be sent, the UE shall: 1) if the data size is not more than 254 octets and there is no other optional IE to be included in the message: i) for sending CIoT user data, set the Data type field to \"control plane user data\", include the PDU session ID, data, and Downlink data expected (DDX) (if available), in the CIoT small data container IE; and ii) for sending SMS, set the Data type field to \"SMS\", include SMS in the CIoT small data container IE; and 2) otherwise if the data size is more than 254 octets or there are other optional IEs to be included in the message: i) for sending CIoT user data, set the Payload container type IE to \"CIoT user data container\", include the PDU session ID in the PDU session ID IE and include data in the Payload container IE as described in subclause 5.4.5.2.2; and ii) for sending SMS, set the Payload container type IE to \"SMS\" and include data in the Payload container IE as described in subclause 5.4.5.2.2; and b) the paging request or the notification includes an indication for non-3GPP access type, the UE has at least one PDU session that is not associated with control plane only indication, the Allowed PDU session status IE shall be included in the CONTROL PLANE SERVICE REQUEST message.",
    "If the UE is in a non-allowed area or the UE is not in an allowed area, the UE shall set the Allowed PDU session status IE as specified in subclause 5.3.5.2. If the UE has PDU session(s) over non-3GPP access where: 1) the associated S-NSSAI(s) are included in the allowed NSSAI for 3GPP access or the partially allowed NSSAI for 3GPP access and the TAI where the UE is currently camped is in the list of TAs for which the S- NSSAI is allowed; and 2) the UE is currently camped inside the NS-AoS of the S-NSSAI, if the S-NSSAI location validity information is available, the UE shall indicate the PDU session(s) for which the UE allows the user-plane resources to be re-established over 3GPP access in the Allowed PDU session status IE; otherwise, the UE shall not indicate any PDU session(s) in the Allowed PDU session status IE. NOTE 1: The term DDX used in the present document corresponds to the term NAS RAI used in 3GPP TS 23.502 [9].",
    "For case c), and case d), when the UE is located outside the LADN service area, the UE shall not perform the service request procedure to send CIoT user data via the control plane for a PDU session for LADN. For case c), and case d) if the UE has pending CIoT user data that is to be sent via the control plane in subclause 5.6.1.1, the UE shall set the Control plane service type of the CONTROL PLANE SERVICE REQUEST message to \"mobile originating request\".",
    "If the UE has only uplink CIoT user data, SMS or location services message to be sent, the UE shall: a) if the data size is not more than 254 octets, there is no other optional IE to be included in the CONTROL PLANE SERVICE REQUEST message, and the data being sent is: 1) CIoT user data, set the Data type field to \"control plane user data\", include the PDU session ID, data, and Downlink data expected (DDX) (if available), in the CIoT small data container IE; 2) location services message, set the Data type field to \"Location services message container\" and Downlink data expected (DDX), if available, in the CIoT small data container IE, and: i) if routing information is provided by upper layers: A) set the length of additional information field in the CIoT small data container IE to the length of routing information provided by upper layer location services application (see subclause 9.11.3.67), and set the additional information field in the CIoT small data container IE to the routing information provided by upper layer location services application (see subclause 9.11.3.67); or B) otherwise set the length of additional information field in the CIoT small data container IE to zero.",
    "In this case the Additional information field of the CIoT small data container IE shall not be included; and ii) set the Data contents field of the CIoT small data container IE to the location services message payload; or 3) SMS, set the Data type field to \"SMS\", include SMS in the CIoT small data container IE; or b) otherwise if the data size is more than 254 octets or there are other optional IEs to be included in the CONTROL PLANE SERVICE REQUEST message, and the data being sent is: 1) CIoT user data, set the Payload container type IE to \"CIoT user data container\", include the PDU session ID in the PDU session ID IE and include data in the Payload container IE as described in subclause 5.4.5.2.2; 2) location services message, set the Payload container type IE to \"Location services message container\", include data in the Payload container IE as described in subclause 5.4.5.2.2. If the upper layer location services application provides the routing information set the Additional information IE to the routing information as described in subclause 5.4.5.2.2; or 3) SMS, set the Payload container type IE to \"SMS\" and include data in the Payload container IE as described in subclause 5.4.5.2.2. For case a), and case b) in subclause 5.6.1.1, if the UE has pending user data that is to be sent via the user plane, the UE shall set the Control plane service type of the CONTROL PLANE SERVICE REQUEST message to \"mobile terminating request\".",
    "The UE shall include the Uplink data status IE in the CONTROL PLANE SERVICE REQUEST message to indicate which PDU session(s) have pending user data to be sent via user-plane resources. For case c) in subclause 5.6.1.1, if the UE is in WB-N1 mode and the CONTROL PLANE SERVICE REQUEST message is triggered by a request for emergency services from the upper layer, the UE shall set the Control plane service type of the CONTROL PLANE SERVICE REQUEST message to \"emergency services\". For cases d) and k), if the UE has pending user data that is to be sent via the user plane in subclause 5.6.1.1: a) and if there exists an emergency PDU session which is indicated in the Uplink data status IE, the UE shall set the Control plane service type of the CONTROL PLANE SERVICE REQUEST message to \"emergency services\"; or b) otherwise, the UE shall set the Control plane service type to \"mobile originating request\".",
    "The UE shall include the Uplink data status IE in the CONTROL PLANE SERVICE REQUEST message to indicate which PDU session(s) have pending user data to be sent via user-plane resources or are associated with active multicast MBS session(s). NOTE 2: For a UE in NB-N1 mode, the Uplink data status IE cannot be used to request the establishment of user- plane resources such that there will be user-plane resources established for a number of PDU sessions that exceeds the UE's maximum number of supported user-plane resources. For case h) in subclause 5.6.1.1, if the UE is in WB-N1 mode and the UE does not have any PDU session that is associated with control plane only indication, the UE shall send a CONTROL PLANE SERVICE REQUEST message with the Control plane service type set to \"emergency services fallback\" and without an Uplink data status IE.",
    "For case i) in subclause 5.6.1.1, the Control plane service type of the CONTROL PLANE SERVICE REQUEST message shall indicate \"mobile originating request\". If the pending message is an UL NAS TRANSPORT message with the Payload container type IE set to: a) \"SMS\", \"Location services message container\", or \"CIoT user data container\", the UE shall send the CONTROL PLANE SERVICE REQUEST and include the SMS, location services message, or CIoT user data as described in this subclause; or b) otherwise, the UE shall send the CONTROL PLANE SERVICE REQUEST: 1) without including the CIoT small data container IE and without including the NAS message container IE if the UE has no other optional IE to be sent; or 2) with the NAS message container IE if the UE has an optional IE to be sent as described in this subclause. For case j) in subclause 5.6.1.1, the Control plane service type of the CONTROL PLANE SERVICE REQUEST message shall indicate \"mobile originating request\".",
    "The UE shall include the Uplink data status IE in the CONTROL PLANE SERVICE REQUEST message indicating the PDU session(s) for which user-plane resources were active prior to receiving the fallback indication, if any. For cases o) and p) in subclause 5.6.1.1, the UE shall not include the Uplink data status IE and the Allowed PDU session status IE in the CONTROL PLANE SERVICE REQUEST message. Further, - for case o) in subclause 5.6.1.1, the UE shall set Request type to \"NAS signalling connection release\" in the UE request type IE and Control plane service type to \"mobile originating request\"; - for case p) in subclause 5.6.1.1, the UE shall set Request type to \"Rejection of paging\" in the UE request type IE and Control plane service type to \"mobile terminating request\"; and may include its paging restriction preferences in the Paging restriction IE in the CONTROL PLANE SERVICE REQUEST message.",
    "For case m) in subclause 5.6.1.1, the Control plane service type of the CONTROL PLANE SERVICE REQUEST message shall indicate \"mobile originating request\". The UE shall not include the Paging restriction IE in the CONTROL PLANE SERVICE REQUEST message. The UE may include the UE request type IE and set Request type to \"NAS signalling connection release\" to remove the paging restriction and request the release of the NAS signalling connection at the same time. If the UE requests the release of the NAS signalling connection, the UE shall not include the Uplink data status IE in the SERVICE REQUEST message. For all cases, if the UE includes the Uplink data status IE and the UE is located outside the LADN service area of a PDU session, the UE shall not include the PDU session for LADN in the Uplink data status IE.",
    "If the UE is in a non-allowed area or the UE is not in an allowed area, the UE shall apply the restrictions for the inclusion of the Uplink data status IE specified in subclause 5.3.5.2. The UE may include the PDU session status IE in the CONTROL PLANE SERVICE REQUEST message to indicate which PDU session(s) associated with the access type the CONTROL PLANE SERVICE REQUEST message is sent over are active in the UE. For cases other than h) in subclause 5.6.1.1, the UE shall treat the reception of the SERVICE ACCEPT message as successful completion of the procedure. The UE shall reset the service request attempt counter, stop timer T3517 and enter the state 5GMM-REGISTERED.",
    "For case h) in subclause 5.6.1.1, a) the UE shall treat the indication from the lower layers when the UE has changed to S1 mode or E-UTRA connected to 5GCN (see 3GPP TS 23.502 [9]) as successful completion of the procedure and stop timer T3517; b) if a UE operating in single-registration mode has changed to S1 mode, it shall disable the N1 mode capability for 3GPP access (see subclause 4.9.2); and c) the AMF shall not check for CAG restrictions. If the PDU session status information element is included in the SERVICE REQUEST message, then: a) for single access PDU sessions, the AMF shall: 1) perform a local release of all those PDU sessions which are not in 5GSM state PDU SESSION INACTIVE on the AMF side associated with the access type the SERVICE REQUEST message is sent over, but are indicated by the UE as being in 5GSM state PDU SESSION INACTIVE; and 2) request the SMF to perform a local release of all those PDU sessions.",
    "If any of those PDU sessions is associated with one or more multicast MBS sessions, the SMF shall consider the UE as removed from the associated multicast MBS sessions; and b) for MA PDU sessions, the AMF shall: 1) for MA PDU sessions having user plane resources established in the AMF only on the access the SERVICE REQUEST message is sent over, but are indicated by the UE as no user plane resources established: i) for all those MA PDU sessions without a PDN connection established as a user-plane resource, perform a local release of all those MA PDU sessions and request the SMF to perform a local release of all those MA PDU sessions.",
    "If the MA PDU session is associated with one or more multicast MBS sessions, the SMF shall consider the UE as removed from the associated multicast MBS sessions; and ii) for all those MA PDU sessions with a PDN connection established as a user-plane resource, perform a local release of user plane resources of all those PDU sessions on the access the SERVICE REQUEST message is sent over and request the SMF to perform a local release of user plane resources of all those PDU sessions on the access type the SERVICE REQUEST message is sent over; and 2) for MA PDU sessions having user plane resources established on both accesses in the AMF, but are indicated by the UE as no user plane resources established: i) perform a local release of user plane resources of all those PDU sessions on the access the SERVICE REQUEST message is sent over; and ii) request the SMF to perform a local release of user plane resources of all those PDU sessions on the access type the SERVICE REQUEST message is sent over.",
    "If the SERVICE REQUEST message is sent over 3GPP access and the MA PDU session is associated with one or more multicast MBS sessions, the SMF shall consider the UE as removed from the associated multicast MBS sessions. If the AMF needs to initiate PDU session status synchronization or a PDU session status IE was included in the SERVICE REQUEST message, the AMF shall include a PDU session status IE in the SERVICE ACCEPT message to indicate: - which single access PDU sessions associated with the access type the SERVICE ACCEPT message is sent over are not in 5GSM state PDU SESSION INACTIVE in the AMF; and - which MA PDU sessions are not in 5GSM state PDU SESSION INACTIVE and having user plane resources established in the AMF on the access the SERVICE ACCEPT message is sent over.",
    "If the PDU session status information element is included in the SERVICE ACCEPT message, then: a) for single access PDU sessions, the UE shall perform a local release of all those PDU sessions which are not in 5GSM state PDU SESSION INACTIVE or PDU SESSION ACTIVE PENDING on the UE side associated with the access type the SERVICE ACCEPT message is sent over, but are indicated by the AMF as in 5GSM state PDU SESSION INACTIVE.",
    "If a locally released PDU session is associated with one or more multicast MBS sessions, the UE shall locally leave the associated multicast MBS sessions; and b) for MA PDU sessions, for all those PDU sessions which are not in 5GSM state PDU SESSION INACTIVE or PDU SESSION ACTIVE PENDING and have user plane resources established on the UE side associated with the access the SERVICE ACCEPT message is sent over, but are indicated by the AMF as no user plane resources established: 1) for MA PDU sessions having user plane resources established only on the access type the SERVICE ACCEPT message is sent over, the UE shall perform a local release of those MA PDU sessions.",
    "If a locally released MA PDU session is associated with one or more multicast MBS sessions, the UE shall locally leave the associated multicast MBS sessions; and 2) for MA PDU sessions having user plane resources established on both accesses, the UE shall perform a local release on the user plane resources on the access type the SERVICE ACCEPT message is sent over. If the user plane resources over 3GPP access are released and the MA PDU session is associated with one or more multicast MBS sessions, the UE shall locally leave the associated multicast MBS sessions.",
    "If the Uplink data status IE is included in the SERVICE REQUEST message and the UE is: a) not in NB-N1 mode; or b) in NB-N1 mode and the UE does not indicate a request to have user-plane resources established for a number of PDU sessions that exceeds the UE's maximum number of supported user-plane resources; the AMF shall: a) indicate the SMF to re-establish the user-plane resources for the corresponding PDU sessions; b) include the PDU session reactivation result IE in the SERVICE ACCEPT message to indicate the user-plane resources re-establishment result of the PDU sessions for which the UE requested to re-establish the user-plane resources; and c) determine the UE presence in LADN service area (see subclause 6.2.6) and forward the UE presence in LADN service area towards the SMF, if the corresponding PDU session is a PDU session for LADN.",
    "If the Allowed PDU session status IE is included in the SERVICE REQUEST message, the AMF shall: a) for a 5GSM message from each SMF that has indicated pending downlink signalling only, forward the received 5GSM message via 3GPP access to the UE after the SERVICE ACCEPT message is sent; b) for each SMF that has indicated pending downlink data only: 1) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access cannot be performed if the corresponding PDU session ID(s) are not indicated in the Allowed PDU session status IE; and 2) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access can be performed if: i) for a UE not in NB-N1 mode, the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE; or ii) for a UE in NB-N1 mode, the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE, and the resulting number of PDU sessions with established user-plane resources does not exceed the UE's maximum number of supported user-plane resources; c) for each SMF that have indicated pending downlink signalling and data: 1) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access cannot be performed if the corresponding PDU session ID(s) are not indicated in the Allowed PDU session status IE; 2) notify the SMF that reactivation of the user-plane resources for the corresponding PDU session(s) associated with non-3GPP access can be performed if: i) for a UE not in NB-N1 mode, the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE; or ii) for a UE in NB-N1 mode, the corresponding PDU session ID(s) are indicated in the Allowed PDU session status IE, and the resulting number of PDU sessions with established user-plane resources does not exceed the UE's maximum number of supported user-plane resources; and 3) discard the received 5GSM message for PDU session(s) associated with non-3GPP access; and d) include the PDU session reactivation result IE in the SERVICE ACCEPT message to indicate the successfully re-established user-plane resources for the corresponding PDU sessions, if any.",
    "If due to regional subscription restrictions or access restrictions the UE is not allowed to access the TA or due to CAG restrictions the UE is not allowed to access the cell, but the UE has an emergency PDU session established, the AMF may accept the SERVICE REQUEST message and indicate to the SMF to perform a local release of all non-emergency PDU sessions (associated with 3GPP access if it is due to CAG restrictions) and informs the UE via the PDU session status IE in the SERVICE ACCEPT message. The AMF shall not indicate to the SMF to release the emergency PDU session. If the AMF indicated to the SMF to perform a local release of all non-emergency PDU sessions (associated with 3GPP access if it is due to CAG restrictions), the network shall behave as if the UE is registered for emergency services.",
    "If the PDU session reactivation result IE is included in the SERVICE ACCEPT message indicating that the user-plane resources have been successfully reactivated for a PDU session that was indicated by the UE in the Allowed PDU session status IE as allowed to be re-established over 3GPP access, the UE considers the corresponding PDU session to be associated with the 3GPP access. If the user-plane resources of a PDU session have been successfully reactivated over the 3GPP access, the AMF and SMF update the associated access type of the corresponding PDU session.",
    "If the user-plane resources cannot be established for a PDU session, the AMF shall include the PDU session reactivation result IE in the SERVICE ACCEPT message indicating that user-plane resources for the corresponding PDU session cannot be re-established, and: a) if the user-plane resources cannot be established because the SMF indicated to the AMF that the UE is located out of the LADN service area (see 3GPP TS 29.502 [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #43 \"LADN not available\"; b) if the user-plane resources cannot be established because the SMF indicated to the AMF that only prioritized services are allowed (see 3GPP TS 29.502 [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #28 \"restricted service area\"; c) if the user-plane resources cannot be established because the SMF indicated to the AMF that the resource is not available in the UPF (see 3GPP TS 29.502 [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #92 \"insufficient user-plane resources for the PDU session\"; d) if the user-plane resources cannot be established because the SMF indicated to the AMF that the S-NSSAI associated with the PDU session is unavailable due to NSAC (see 3GPP TS 29.502 [20A]), the AMF shall include the PDU session reactivation result error cause IE with the 5GMM cause set to #69 \"insufficient resources for specific slice\"; e) if the user-plane resources cannot be established because the AMF determines that the UE is outside the NS-AoS of an S-NSSAI, the AMF may include the PDU session reactivation result error cause IE with the 5GMM cause set to #69 \"insufficient resources for specific slice\" to indicate the cause of failure to re-establish the user-plane resources; or f) otherwise, the AMF may include the PDU session reactivation result error cause IE to indicate the cause of failure to re-establish the user-plane resources.",
    "NOTE 1: It is up to UE implementation when to re-send a request for user-plane re-establishment for the associated PDU session after receiving a PDU session reactivation result error cause IE with a 5GMM cause set to #92 \"insufficient user-plane resources for the PDU session\". NOTE 2: The UE can locally start a back-off timer after receiving a PDU session reactivation result error cause IE with a 5GMM cause set to #69 \"insufficient resources for specific slice\". The value of the back-off timer is up to UE implementation. Upon expiry of the back-off timer, the UE can re-send a request for user- plane re-establishment for the associated PDU session. NOTE 3: If the UE that does not support S-NSSAI location validity information is outside the NS-AoS of an S- NSSAI, the AMF may perform congestion control and indicate PDU session reactivation result error cause IE with the 5GMM cause set to #69 \"insufficient resources for specific slice\".",
    "For case a, b and e, - if the AMF has a service area list or LADN information which is applicable to the current TAI of the UE and was not yet provided to the UE, before sending the SERVICE ACCEPT message the AMF shall initiate the generic UE configuration update procedure and include the service area list or LADN information or both in the CONFIGURATION UPDATE COMMAND message; - if timer T3540 is not started (see subclause 5.3.1.3, item f), and the UE did not receive a CONFIGURATION UPDATE COMMAND message during the service request procedure, the UE may initiate a registration procedure for mobility or periodic registration update.",
    "If timer T3540 is started and the UE does not receive a CONFIGURATION UPDATE COMMAND message before the established N1 NAS signalling connection is released by the network or timer T3540 expires or is stopped as specified in subclause 5.3.1.3, the UE may initiate the registration procedure for mobility or periodic registration update upon release of the N1 NAS signalling connection; and - if the AMF has S-NSSAI location validity information that is applicable to the current cell of the UE and was not yet provided to the UE, before sending the SERVICE ACCEPT message the AMF shall initiate the generic UE configuration update procedure and include the S-NSSAI location validity information in the CONFIGURATION UPDATE COMMAND message.",
    "If the PDU session reactivation result IE is included in the SERVICE ACCEPT message indicating that the user-plane resources cannot be established for a PDU session that was indicated by the UE in the Allowed PDU session status IE as allowed to be re-established over 3GPP access, the UE considers the corresponding PDU session to be associated with the non-3GPP access. If the MUSIM UE does not include the Paging restriction IE in the SERVICE REQUEST message, the AMF shall delete any stored paging restriction for the UE and stop restricting paging. For case m in subclause 5.6.1.1 when the MUSIM UE sets the Request type to \"NAS signalling connection release\" in the SERVICE REQUEST message, the AMF shall initiate the release of the N1 NAS signalling connection after the completion of the service request procedure.",
    "For cases o and p in subclause 5.6.1.1 when the MUSIM UE sets the Request type to \"NAS signalling connection release\" or to \"Rejection of paging\" in the UE request type IE in the SERVICE REQUEST message and if the UE requests restriction of paging by including the Paging restriction IE, the AMF: - if accepts the paging restriction, shall include the 5GS additional request result IE in the SERVICE ACCEPT message and set the Paging restriction decision to \"paging restriction is accepted\". The AMF shall store the paging restriction of the UE and enforce these restrictions in the paging procedure as described in subclause 5.6.2; or - if rejects the paging restriction, shall include the 5GS additional request result IE in the SERVICE ACCEPT message and set the Paging restriction decision to \"paging restriction is rejected\", and shall discard the received paging restriction.",
    "The AMF shall delete any stored paging restriction for the UE and stop restricting paging; and the AMF shall initiate the release of the N1 NAS signalling connection as follows: - for case o in subclause 5.6.1.1, after the completion of the service request procedure; - for case p in subclause 5.6.1.1, after the completion of the generic UE configuration update procedure that is triggered after the completion of the service request procedure. If the SERVICE REQUEST message is for emergency services fallback, the AMF triggers the emergency services fallback procedure as specified in subclause 4.13.4.2 of 3GPP TS 23.502 [9].",
    "If the UE having an emergency PDU session associated with 3GPP access sent the SERVICE REQUEST message via: a) a CAG cell and none of the CAG-ID(s) of the CAG cell are authorized based on the \"Allowed CAG list\" for the current PLMN in the UE's subscription; or b) a non-CAG cell in a PLMN for which the UE's subscription contains an \"indication that the UE is only allowed to access 5GS via CAG cells\"; the network shall accept the SERVICE REQUEST message and release all non-emergency PDU sessions associated with 3GPP access locally. The emergency PDU session associated with 3GPP access and PDU sessions associated with non-3GPP access shall not be released.",
    "If the AMF received the list of TAIs from the satellite NG-RAN as described in 3GPP TS 23.501 [8], and determines that, by UE subscription and operator's preferences, any but not all TAIs in the received list of TAIs is forbidden for roaming or for regional provision of service, the AMF shall include the TAI(s) in: a) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE; or b) the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE; or c) both; in the SERVICE ACCEPT message. NOTE 9: Void.",
    "If the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE in the SERVICE ACCEPT message and the TAI(s) included in the IE is not part of the list of \"5GS forbidden tracking areas for roaming\", the UE shall store the TAI(s) belonging to the serving PLMN or equivalent PLMN(s) and ignore the TAI(s) which do not belong to the serving PLMN or equivalent PLMN(s) included in the IE into the list of \"5GS forbidden tracking areas for roaming\" and remove the TAI(s) from the stored TAI list if present.",
    "If the UE receives the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE in the SERVICE ACCEPT message and the TAI(s) included in the IE is not part of the list of \"5GS forbidden tracking areas for regional provision of service\", the UE shall store the TAI(s) belonging to the serving PLMN or equivalent PLMN(s) and ignore the TAI(s) which do not belong to the serving PLMN or equivalent PLMN(s) included in the IE into the list of \"5GS forbidden tracking areas for regional provision of service\" and remove the TAI(s) from the stored TAI list if present.",
    "accepted by the network If the service request for initiating an emergency PDU session cannot be accepted by the network, the UE shall perform the procedures as described in subclause 5.6.1.5. If the service request for initiating an emergency PDU session fails due to receiving the AUTHENTICATION REJECT message, the UE shall perform the procedures as described in subclauses 5.4.1.2.2.11, 5.4.1.2.3.1, 5.4.1.2.3A.1 or 5.4.1.3.5. Then if the UE is in the same selected PLMN where the last service request was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 1: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP TS 23.167 [6]. b) de-register locally, if not de-registered already, attempt initial registration for emergency services.",
    "If the service request for initiating an emergency PDU session fails due to abnormal cases a), f) or l) in subclause 5.6.1.7, the UE shall perform the procedures as described in subclause 5.6.1.7. Then if the UE is in the same selected PLMN where the last SERVICE REQUEST message was attempted, the UE shall: a) inform the upper layers of the failure of the procedure; or NOTE 2: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP TS 23.167 [6] and 3GPP TS 24.229 [14]. b) de-register locally, if not de-registered already, attempt initial registration for emergency services. If the service request for initiating a PDU session for emergency services fails due to abnormal case b) in subclause 5.6.1.7, the UE shall perform the actions as described in subclause 5.6.1.7 and inform the upper layers of the failure to access the network.",
    "NOTE 3: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP TS 23.167 [6]. 5.6.1.6A Service request procedure for an emergency services fallback not accepted by the network If the service request for initiating an emergency services fallback cannot be accepted by the network, the UE shall perform the procedures as described in subclause 5.6.1.5, if the service request for initiating an emergency services fallback fails due to receiving the AUTHENTICATION REJECT message, the UE shall perform the procedures as described in subclauses 5.4.1.2.2.11, 5.4.1.2.3.1, 5.4.1.2.3A.1 or 5.4.1.3.5, and if the UE does not attempt to select an E- UTRA cell connected to EPC or 5GCN as described in subclause 5.6.1.5 and is camped on NR or E-UTRA cell connected to 5GCN in the same PLMN where the last service request was attempted, the UE shall inform the upper layers of the failure of the procedure.",
    "NOTE 1: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP TS 23.167 [6]. If the service request for initiating an emergency services fallback fails due to abnormal cases a) in subclause 5.6.1.7, the UE shall inform the upper layers of the failure of the emergency services fallback. NOTE 2: This can result in the upper layers requesting another emergency call attempt using domain selection as specified in 3GPP TS 23.167 [6]. If the service request procedure for initiating an emergency services fallback fails due to abnormal cases other than a) in subclause 5.6.1.7, the UE may abort the service request procedure, if not aborted already and attempt to select an E- UTRA cell connected to EPC or 5GCN according to the domain priority and selection rules specified in 3GPP TS The following abnormal cases can be identified: a) Lower layer failure.",
    "If a lower layer failure occurs before a SERVICE REJECT message has been sent to the UE or the service request procedure has been completed by the AMF, the AMF enters/stays in 5GMM-IDLE. b) Protocol error. If the SERVICE REQUEST message or the CONTROL PLANE SERVICE REQUEST message is received with a protocol error, the AMF shall return a SERVICE REJECT message with one of the following 5GMM cause values: #96 invalid mandatory information; #99 information element non-existent or not implemented; #100 conditional IE error; or #111 protocol error, unspecified. The AMF stays in the current 5GMM mode. c) More than one SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message received before the procedure has been completed (i.e., before SERVICE REJECT message has been sent or service request procedure has been completed).",
    "- If one or more of the information elements in the SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message differs from the ones received within the previous SERVICE REQUEST message or CONTROL PLANE SERVICE REQUEST message, the previously initiated service request procedure shall be aborted, and the new service request procedure shall be progressed; - If the information elements do not differ, then the AMF shall continue with the previous service request procedure and shall not treat any further this SERVICE REQUEST message or this CONTROL PLANE SERVICE REQUEST message. d) REGISTRATION REQUEST message received with \"initial registration\" or \"emergency registration\" in the 5GS registration type IE before a SERVICE REJECT message has been sent or the service request procedure has been completed.",
    "If a REGISTRATION REQUEST message with \"initial registration\" or \"emergency registration\" in the 5GS registration type IE is received and the service request procedure has not been completed or a SERVICE REJECT message has not been sent, the AMF may initiate the 5GMM common procedures, e.g. the primary authentication and key agreement procedure. The AMF may e.g. after a successful primary authentication and key agreement procedure execution, abort the service request procedure, delete the 5GMM context, indicate towards the SMF that the 5GMM context has been deleted and progress the new REGISTRATION REQUEST message. e) REGISTRATION REQUEST message received with \"mobility registration updating\" or \"periodic registration updating\" in the 5GS registration type IE received before the service request procedure has been completed or a SERVICE REJECT message has been sent.",
    "If a REGISTRATION REQUEST message with \"mobility registration updating\" or \"periodic registration updating\" in the 5GS registration type IE is received and the service request procedure has not been completed or a SERVICE REJECT message has not been sent, the AMF may initiate the 5GMM common procedures, e.g. the primary authentication and key agreement procedure. The AMF may e.g. after a successful primary authentication and key agreement procedure execution, abort the service request procedure and progress the new REGISTRATION REQUEST message.",
    "f) If a CONTROL PLANE SERVICE REQUEST message with Control plane service type indicating \"mobile originating request\" is received after the AMF initiated a paging procedure, the AMF shall treat this CONTROL PLANE SERVICE REQUEST as a paging response and handle the message according to subclauses 5.6.1.4 and The paging procedure is performed only in 3GPP access and used by the network to request the establishment of a NAS signalling connection to the UE. The paging procedure is also used by the network to request the UE to re-establish the user-plane resources of PDU sessions for downlink user data transport. Another purpose of the paging procedure is to request the UE to re-establish the user-plane resources of PDU session(s) associated with non-3GPP access over 3GPP access. Additionally, the network can use the paging procedure to initiate the mobile terminating SMS.",
    "For the UE using eDRX, the network initiates the paging procedure when NAS signalling messages or user data is pending to be sent to the UE within the paging time window and requests the lower layers to include the eDRX cycle length and paging time window length in the paging message. If NAS signalling messages or user data is pending to be sent to the UE outside the paging time window and the eDRX value that the network provides to the UE in the Negotiated extended DRX parameters IE during the last registration procedure indicates: a) the eDRX cycle length duration of the E-UTRA cell connected to 5GCN, is higher than 5.12 seconds; or b) the eDRX cycle length duration of the NR cell connected to 5GCN, is higher than 10.24 seconds, the network initiates the paging procedure at T time ahead of the beginning of the next paging time window. NOTE: T time is a short time period based on implementation.",
    "The operator can take possible imperfections in the synchronization between the 5GCN and the UE into account when choosing T time. If the network detects that the pending user data to be sent to the UE is related to the voice service as specified in 3GPP TS 23.502 [9] and the network decides to initiate the paging procedure based on the stored paging restriction information, if any, the AMF should request the lower layer to include the Voice Service Indication in the paging message when the UE and the network support the paging indication for voice services. The following abnormal case can be identified: a) Void.",
    "The notification procedure is used by the network: a) to request the UE, by sending the NOTIFICATION message over 3GPP access, to re-establish the user-plane resources of PDU session(s) associated with non-3GPP access over 3GPP access or to deliver 5GSM downlink signalling messages associated with non-3GPP access over 3GPP access when the UE is in 5GMM-IDLE mode over non-3GPP access and in 5GMM-CONNECTED mode over 3GPP access; or b) to request the UE, by sending the NOTIFICATION message over non-3GPP access, to re-establish user-plane resources of the PDU session(s) or to deliver downlink signalling associated with 3GPP access over 3GPP access when the UE is in 5GMM-CONNECTED mode over non-3GPP access and: 1) in 5GMM-IDLE mode over 3GPP access when the UE is not in MICO mode or when the network determines the unavailability period is not activated for the UE; or 2) in 5GMM-IDLE mode with suspend indication over 3GPP access when the UE is not in MICO mode or when the network determines the unavailability period is not activated for the UE.",
    "The network shall not use the NOTIFICATION message to re-establish user-plane resources of PDU session(s) associated with non-3GPP access over 3GPP access if all the PDU sessions of the UE that are established over the 3GPP access are associated with control plane only indication. . The network shall not use the NOTIFICATION message over non-3GPP access, if: a) the MUSIM UE supports the paging indication for voice services; b) the network has indicated \"paging indication for voice services supported\" to the UE; and c) the AMF detects that the downlink data is related to voice service (see 3GPP TS 23.501 [8]). The following abnormal cases can be identified: a) Expiry of timer T3565. The network shall, on the first expiry of the timer T3565, retransmit the NOTIFICATION message and shall reset and start timer T3565. This retransmission is repeated four times, i.e. on the fifth expiry of timer T3565, the procedure shall be aborted.",
    "In addition, upon the fifth expiry of timer T3565: For case a) in subclause 5.6.3.1, the AMF should notify the SMF that the UE is unreachable. The AMF may enter 5GMM-IDLE mode over 3GPP access. For case b) in subclause 5.6.3.1, the AMF may either: 1) perform the paging procedure over the 3GPP access; or 2) notify the SMF that the UE is unreachable. NOTE: Whether the AMF performs the paging procedure or notifies the SMF is up to operator's policies. b) De-registration procedure collision If the network receives a DEREGISTRATION REQUEST message before it receives a SERVICE REQUEST message or REGISTRATION REQUEST message, the AMF shall stop timer T3565 and proceed de-registration procedure as specified in subclause 5.5.2. This clause describes the procedures used for 5GS session management (5GSM) performed over an N1 NAS signalling connection. The main function of the 5GSM sublayer is to support the PDU session handling in the UE and in the SMF (transferred via the AMF).",
    "The 5GSM comprises procedures for: - the authentication and authorization, establishment, modification and release of PDU sessions; and - request for performing handover of an existing PDU session between 3GPP access and non-3GPP access, or to transfer an existing PDN connection in the EPS to the 5GS. Each PDU session represents a PDU session established between the UE and an SMF. PDU sessions can remain established even if the radio and network resources constituting the corresponding PDU session between the UE and the SMF are temporarily released. 5GSM procedures can be performed only if a 5GMM context has been established between the UE and the AMF, and the secure exchange of NAS messages has been initiated by the AMF by use of the 5GMM procedures described in clause 5. Once the UE is successfully registered to a PLMN, a PDU session can be established.",
    "If no 5GMM context has been established, the 5GMM sublayer has to initiate the establishment of a 5GMM context by use of the 5GMM procedures as described in clause 5. The UE can request the network to modify or release PDU sessions. The network can fulfil such a request from the UE by modifying a PDU session or releasing a PDU session using network-requested procedures (see subclause 6.3). In the following subclauses, the possible states of a PDU session in the UE and the network side are described. No PDU session exists. The UE has initiated a PDU session release procedure towards the network and is waiting for a response from the network. The UE has initiated a procedure transaction towards the network. UE initiated 5GSM procedure reject by network Or Network initiated 5GSM procedure PROCEDURE TRANSACTION INACTIVE PROCEDURE TRANSACTION PENDING UE initiated 5GSM procedure request Figure 6.1.3.2.8.1: The procedure transaction states in the UE (overview) No PDU session exists.",
    "The network has initiated a PDU session modification procedure towards the UE and is waiting for a response from the UE. Interworking with EPS is supported for a PDU session, if the PDU session includes the mapped EPS bearer context(s) or has association(s) between QoS flow and mapped EPS bearer after inter-system change from S1 mode to N1 mode. The SMF shall not include any mapped EPS bearer contexts associated with a PDU session for LADN, with a PDU session which is a multi-homed IPv6 PDU session, and with a PDU session with the selected SSC mode set to \"SSC mode 2\" or \"SSC mode 3\". If the UE receives any mapped EPS bearer context for a PDU session for LADN, for a multi-homed IPv6 PDU session, or for a PDU session with the selected SSC mode set to \"SSC mode 2\" or \"SSC mode 3\", the UE may locally delete the mapped EPS bearer context. See coding of the Mapped EPS bearer contexts IE in subclause 9.11.4.8. In an MA PDU session, the UE shall have one set of the mapped EPS bearer contexts.",
    "The network can provide the set of the mapped EPS bearer contexts of the MA PDU session via either access of the MA PDU session. In an MA PDU session, the UE shall support modification or deletion via an access of a mapped EPS bearer context of the MA PDU session created via the same or the other access. Upon inter-system change from N1 mode to S1 mode, the UE shall create the default EPS bearer context and the dedicated EPS bearer context(s) based on the parameters of the mapped EPS bearer contexts or the associations between QoS flow and mapped EPS bearer in the PDU session, if available. The EPS bearer identity assigned for the QoS flow of the default QoS rule becomes the EPS bearer identity of the default bearer in the corresponding PDN connection.",
    "If there is no EPS bearer identity assigned to the QoS flow of the default QoS rule of a PDU session associated with 3GPP access, or if there is no corresponding mapped EPS bearer contexts associated with the EPS bearer identity assigned to the QoS flow of the default QoS rule of a PDU session associated with 3GPP access: a) the PDU session is not an MA PDU session established over both 3GPP access and non-3GPP access, the UE shall perform a local release of the PDU session; or b) the PDU session is an MA PDU session established over both 3GPP access and non-3GPP access, the UE shall perform a local release of the PDU session over 3GPP access and consider that the MA PDU session is established over non-3GPP access only.",
    "If there is no EPS bearer identity assigned to the QoS flow(s) of a PDU session associated with 3GPP access which is not associated with the default QoS rule, or if there is no corresponding mapped EPS bearer contexts associated with the EPS bearer identity assigned to the QoS flow of the non-default QoS rule of a PDU session associated with 3GPP access, unless the PDU session is an MA PDU session established over 3GPP access and over non-3GPP access, the UE shall locally delete the QoS rules and the QoS flow description(s).",
    "The UE uses the parameters from each PDU session for which interworking with EPS is supported to create corresponding default EPS bearer context and optionally dedicated EPS bearer context(s) as follows: a) the PDU session type of the PDU session shall be mapped to the PDN type of the default EPS bearer context as follows: 1) the PDN type shall be set to \"non-IP\" if the PDU session type is \"Unstructured\"; 2) the PDN type shall be set to \"IPv4\" if the PDU session type is \"IPv4\"; 3) the PDN type shall be set to \"IPv6\" if the PDU session type is \"IPv6\"; 4) the PDN type shall be set to \"IPv4v6\" if the PDU session type is \"IPv4v6\"; 5) the PDN type shall be set to \"non-IP\" if the PDU session type is \"Ethernet\", and the UE, the network or both of them do not support Ethernet PDN type in S1 mode; and 6) the PDN type shall be set to \"Ethernet\" if the PDU session type is \"Ethernet\" and the UE and the network support Ethernet PDN type in S1 mode; b) the PDU address of the PDU session shall be mapped to the PDN address of the default EPS bearer context as follows: 1) the PDN address of the default EPS bearer context is set to the PDU address of the PDU session, if the PDU session type is \"IPv4\", \"IPv6\" or \"IPv4v6\"; and 2) the PDN address of the default EPS bearer context is set to zero, if the PDU session type is \"Ethernet\" or \"Unstructured\"; c) the DNN of the PDU session shall be mapped to the APN of the default EPS bearer context, unless the PDU session is an emergency PDU session; d) the APN-AMBR and extended APN-AMBR received in the parameters of the default EPS bearer context of the mapped EPS bearer contexts shall be mapped to the APN-AMBR and extended APN-AMBR of the default EPS bearer context; e) for each PDU session in state PDU SESSION ACTIVE, PDU SESSION MODIFICATION PENDING or PDU SESSION INACTIVE PENDING: 1) if the UE is performing an inter-system change from N1 mode to WB-S1 mode, the UE shall set the state of the mapped EPS bearer context(s) to BEARER CONTEXT ACTIVE; or 2) if the UE is performing an inter-system change from N1 mode to NB-S1 mode, for the mapped EPS bearer context corresponding to the default EPS bearer, the UE shall set the state of the mapped EPS bearer context to BEARER CONTEXT ACTIVE.",
    "Additionally, if the UE is performing an inter-system change from WB- N1 mode to NB-S1 mode, for the mapped EPS bearer context corresponding to a dedicated EPS bearer, if any, the UE shall set the state of the mapped EPS bearer context to BEARER CONTEXT INACTIVE; and f) for any other PDU session the UE shall set the state of the mapped EPS bearer context(s) to BEARER CONTEXT INACTIVE.",
    "Additionally, for each mapped EPS bearer context or the association between QoS flow and mapped EPS bearer in the PDU session: a) the EPS bearer identity shall be set to the EPS bearer identity received in the mapped EPS bearer context, or the EPS bearer identity associated with the QoS flow; b) the EPS QoS parameters shall be set to the mapped EPS QoS parameters of the EPS bearer received in the mapped EPS bearer context, or the EPS QoS parameters associated with the QoS flow; c) the extended EPS QoS parameters shall be set to the mapped extended EPS QoS parameters of the EPS bearer received in the mapped EPS bearer context, or the extended EPS QoS parameters associated with the QoS flow; and d) the traffic flow template shall be set to the mapped traffic flow template of the EPS bearer received in the mapped EPS bearer context, or the stored traffic flow template associated with the QoS flow, if available.",
    "After inter-system change from N1 mode to S1 mode, the UE shall associate the PDU session identity, the S-NSSAI, and the session-AMBR with the default EPS bearer context, and for each EPS bearer context mapped from one or more QoS flows, associate the QoS rule(s) for the QoS flow(s) and the QoS flow description(s) for the QoS flow(s) with the EPS bearer context. If the PDU session is associated with the control plane only indication and supports interworking with EPS, after inter- system change from N1 mode to S1 mode, the UE shall associate the EPS bearer context(s) of the PDN connection corresponding to the PDU session with the control plane only indication. If the PDU session is associated with a PDU session pair ID, after inter-system change from N1 mode to S1 mode, the UE shall associate the default EPS bearer context of the PDN connection corresponding to the PDU session with the PDU session pair ID.",
    "If the PDU session is associated with an RSN, after inter-system change from N1 mode to S1 mode, the UE shall associate the default EPS bearer context of the PDN connection corresponding to the PDU session with the RSN. After inter-system change from N1 mode to S1 mode, if: a) the UE sent the URSP provisioning in EPS support indicator and received the URSP provisioning in EPS support indicator in the PDU session; or b) the PDU session is associated with the URSP provisioning in EPS support indicators; the UE shall associate the default EPS bearer context of the PDN connection corresponding to the PDU session with the URSP provisioning in EPS support indicators. After inter-system change from N1 mode to S1 mode, the UE and the SMF shall maintain the PDU session type of the PDU session until the PDN connection corresponding to the PDU session is released if the UE supports non-IP PDN type and the PDU session type is \"Ethernet\" or \"Unstructured\".",
    "After inter-system change from N1 mode to S1 mode, the UE and the SMF shall maintain the following 5GSM attributions and capabilities associated with the PDU session until the PDN connection corresponding to the PDU session is released: a) the always-on PDU session indication; b) the maximum number of supported packet filters; c) the support of reflective QoS; d) the maximum data rate per UE for user-plane integrity protection supported by the UE for uplink and the maximum data rate per UE for user-plane integrity protection supported by the UE for downlink; e) the support of multi-homed IPv6 PDU session; and f) if the PDU session is an MA PDU session established over 3GPP access, the PDN connection of the default EPS bearer corresponding to the MA PDU session shall be considered as a user-plane resource of the MA PDU session.",
    "After inter-system change from N1 mode to S1 mode, the UE operating in single-registration mode in a network supporting N26 interface shall deem that the following features are supported by the network on the PDN connection corresponding to the PDU session: a) PS data off; and b) Local address in TFT. If there is a QoS flow used for IMS signalling, after inter-system change from N1 mode to S1 mode, the EPS bearer associated with the QoS flow for IMS signalling becomes the EPS bearer for IMS signalling. When the UE is provided with a new session-AMBR in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE shall discard the corresponding association and associate the new valuewith the default EPS bearer context.",
    "The network may provide the UE with one or more QoS rules by including either one QoS rules parameter, or one QoS rules with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message. The network may provide the UE with one or more QoS flow descriptions corresponding to the EPS bearer context being modified, by including either one QoS flow descriptions parameter, or one QoS flow descriptions with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message.",
    "When the UE is provided with one or more QoS flow descriptions or the EPS bearer identity of an existing QoS flow description is modified in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE shall check the EPS bearer identity included in the QoS flow description; and: a) if the EPS bearer identity corresponds to the EPS bearer context being modified or the EPS bearer identity is not included, the UE shall store the QoS flow description and all the associated QoS rules, if any, for the EPS bearer context being modified for use during inter-system change from S1 mode to N1 mode; and b) otherwise the UE shall locally delete the QoS flow description and all the associated QoS rules, if any, and include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #84 \"syntactical error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT ACCEPT message.",
    "When the UE is provided with one or more QoS rules, or one or more QoS flow descriptions in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE shall process the QoS rules sequentially starting with the first QoS rule and shall process the QoS flow descriptions sequentially starting with the first QoS flow description.",
    "The UE shall check the QoS rules and QoS flow descriptions for different types of errors as follows: NOTE 1: If an error is detected in a QoS rule or a QoS flow description which requires sending a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause value, then the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message are discarded, if any.",
    "NOTE 2: If the EPS bearer context modification procedure is rejected, then the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the MODIFY EPS BEARER CONTEXT REQUEST message are discarded, if any. a) Semantic errors in QoS operations: 1) When the rule operation is \"Modify existing QoS rule and add packet filters\", \"Modify existing QoS rule and replace all packet filters\", \"Modify existing QoS rule and delete packet filters\" or \"Modify existing QoS rule without modifying packet filters\" on the default QoS rule and the DQR bit is set to \"the QoS rule is not the default QoS rule\".",
    "2) When the rule operation is \"Modify existing QoS rule and add packet filters\", \"Modify existing QoS rule and replace all packet filters\", \"Modify existing QoS rule and delete packet filters\" or \"Modify existing QoS rule without modifying packet filters\" on a QoS rule which is not the default QoS rule and the DQR bit is set to \"the QoS rule is the default QoS rule\". 3) When the rule operation is \"Create new QoS rule\" and the DQR bit is set to \"the QoS rule is the default QoS rule\" when there's already a default QoS rule with different QoS rule identifier. 4) When the rule operation is \"Delete existing QoS rule\" on the default QoS rule.",
    "5) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS rule and add packet filters\", \"Modify existing QoS rule and replace all packet filters\", \"Modify existing QoS rule and delete packet filters\", or \"Modify existing QoS rule without modifying packet filters\" and two or more QoS rules associated with this PDU session would have identical precedence values. 6) When the rule operation is \"Modify existing QoS rule and delete packet filters\", the QoS rule is a QoS rule of a PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type, and the packet filter list in the resultant QoS rule is empty. 7) When the rule operation is \"Create new QoS rule\", and there is already an existing QoS rule with the same QoS rule identifier and the existing QoS rule is associated with a QoS flow description stored for the EPS bearer context being modified or the existing QoS rule is not associated with any QoS flow description.",
    "8) When the rule operation is \"Modify existing QoS rule and add packet filters\", \"Modify existing QoS rule and replace all packet filters\", \"Modify existing QoS rule and delete packet filters\", or \"Modify existing QoS rule without modifying packet filters\" and there is no existing QoS rule with the same QoS rule identifier associated with a QoS flow description stored for the EPS bearer context being modified. 9) When the rule operation is \"Delete existing QoS rule\" and there is no existing QoS rule with the same QoS rule identifier associated with a QoS flow description stored for the EPS bearer context being modified. 10) When the flow description operation is \"Create new QoS flow description\" and there is already an existing QoS flow description with the same QoS flow identifier stored for the EPS bearer context being modified.",
    "11) When the flow description operation is \"Modify existing QoS flow description\" and there is no existing QoS flow description with the same QoS flow identifier stored for the EPS bearer context being modified. 12) When the flow description operation is \"Delete existing QoS flow description\" and there is no existing QoS flow description with the same QoS flow identifier stored for the EPS bearer context being modified. 13) When the UE determines that: i) the default EPS bearer context is associated with one or more QoS flows but the default EPS bearer context is not associated with the default QoS rule. ii) a dedicated EPS bearer context is associated with one or more QoS flows but the dedicated EPS bearer context is associated with the default QoS rule.",
    "14) When the rule operation is \"Create new QoS rule\" and there is already an existing QoS rule with the same QoS rule identifier associated with a QoS flow description stored for an EPS bearer context different from the EPS bearer context being modified and belonging to the same PDN connection as the EPS bearer context being modified. 15) When the flow description operation is \"Create new QoS flow description\", and there is already an existing QoS flow description with the same QoS flow identifier stored for an EPS bearer context different from the EPS bearer context being modified and belonging to the same PDN connection as the EPS bearer context being modified.",
    "16) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS rule and add packet filters\", \"Modify existing QoS rule and replace all packet filters\", \"Modify existing QoS rule and delete packet filters\", or \"Modify existing QoS rule without modifying packet filters\" and the resultant QoS rule is associated with a QoS flow description stored for an EPS bearer context different from the EPS bearer context being modified. 17) When the rule operation is \"Create new QoS rule\", the DQR bit is set to \"the QoS rule is not the default QoS rule\", the QoS rule is provided for a PDN connection of PDN type \"non-IP\" and there is locally available information associated with the PDN connection that is set to \"Unstructured\".",
    "18) When the flow description operation is \"Create new QoS flow description\" or \"Modify existing QoS flow description\", the QFI associated with the QoS flow description is not the same as the QFI of the default QoS rule, the QoS flow description is provided for a PDN connection of PDN type \"non-IP\" and there is locally available information associated with the PDN connection that is set to \"Unstructured\". 19) When the rule operation is \"Modify existing QoS rule and add packet filters\", the \"packet filter list\" field contains a match-all packet filter, the resultant QoS rule is the default QoS rule and there is already an existing match-all packet filter associated with the default QoS rule.",
    "20) When the rule operation is \"Create new QoS rule\" and the DQR bit is set to \"the QoS rule is not the default QoS rule\", or the rule operation is \"Modify existing QoS rule and add packet filters\" on a QoS rule which is not the default QoS rule or \"Modify existing QoS rule and replace all packet filters\" on a QoS rule which is not the default QoS rule, and one match-all packet filter is to be associated with the resultant QoS rule. In case 5, if the old QoS rule (i.e. the QoS rule that existed before the MODIFY EPS BEARER CONTEXT REQUEST message was received) is not the default QoS rule and the old QoS rule is associated with a QoS flow description stored for the EPS bearer context being modified, the UE shall not diagnose an error, shall further process the new request and, if it was processed successfully, shall delete the old QoS rule which has identical precedence value.",
    "Otherwise, the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. In case 6, if the QoS rule is not the default QoS rule, the UE shall delete the QoS rule. If the QoS rule is the default QoS rule, the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. In case 7, if the existing QoS rule is not the default QoS rule and the DQR bit of the new QoS rule is set to \"the QoS rule is not the default QoS rule\", the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS rule (i.e. the QoS rule that existed when case 7 was detected).",
    "If the existing QoS rule is the default QoS rule or the DQR bit of the new QoS rule is set to \"the QoS rule is the default QoS rule\", the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. In case 9, the UE shall not diagnose an error, further process the delete request and, if it was processed successfully, consider the respective QoS rule as successfully deleted. In case 10, the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS flow description (i.e. the QoS flow description that existed when case 10 was detected. In case 12, the UE shall not diagnose an error, further process the delete request and, if it was processed successfully, consider the respective QoS flow description as successfully deleted.",
    "Otherwise, the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. b) Syntactical errors in QoS operations: 1) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS rule and add packet filters\", \"Modify existing QoS rule and replace all packet filters\" or \"Modify existing QoS rule and delete packet filters\", the packet filter list in the QoS rule is empty, and the QoS rule is provided for a PDN connection of PDN type IPv4, IPv6, IPv4v6 or Ethernet, or for a PDN connection of PDN type \"non-IP\" and there is locally available information associated with the PDN connection that is set to \"Ethernet\". 2) When the rule operation is \"Delete existing QoS rule\" or \"Modify existing QoS rule without modifying packet filters\" with a non-empty packet filter list in the QoS rule.",
    "3) When the rule operation is \"Modify existing QoS rule and delete packet filters\" and the packet filter to be deleted does not exist in the original QoS rule. 4) Void.",
    "5) When there are other types of syntactical errors in the coding of the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter or the QoS flow descriptions with the length of two octets parameter, such as a mismatch between the number of packet filters subfield, and the number of packet filters in the packet filter list when the rule operation is \"delete existing QoS rule\" or \"create new QoS rule\", or the number of packet filters subfield is larger than the maximum possible number of packet filters in the packet filter list (i.e., there is no QoS rule precedence subfield included in the QoS rule IE), the QoS Rule Identifier is set to \"no QoS rule identifier assigned\" when the rule operation is not \"delete existing QoS rule\", or the QoS flow identifier is set to \"no QoS flow identifier assigned\" when the flow description operation is not \"Delete existing QoS flow description\".",
    "6) When, the A) rule operation is \"Create new QoS rule\", \"Modify existing QoS rule and add packet filters\", \"Modify existing QoS rule and replace all packet filters\", \"Modify existing QoS rule and delete packet filters\" or \"Modify existing QoS rule without modifying packet filters\", the UE determines, by using the QoS rule’s QFI as the 5QI, that there is a resulting QoS rule for a GBR QoS flow (as described in 3GPP TS 23.501 [8] table 5.7.4-1), and there is no QoS flow description with a QFI corresponding to the QFI of the resulting QoS rule. B) flow description operation is \"Delete existing QoS flow description\", and the UE determines, by using the QoS rule’s QFI as the 5QI, that there is a resulting QoS rule for a GBR QoS flow (as described in 3GPP TS 23.501 [8] table 5.7.4-1) with a QFI corresponding to the QFI of the QoS flow description that is deleted (i.e. there is no associated QoS flow description with the same QFI).",
    "7) When the flow description operation is \"Create new QoS flow description\" or \"Modify existing QoS flow description\", and the UE determines that there is a QoS flow description of a GBR QoS flow (as described in 3GPP TS 23.501 [8] table 5.7.4-1) which lacks at least one of the mandatory parameters (i.e., GFBR uplink, GFBR downlink, MFBR uplink and MFBR downlink). If the QoS flow description does not include a 5QI, the UE determines this by using the QFI as the 5QI. 8) When the rule operation is \"Create new QoS rule\", \"Modify existing QoS rule and add packet filters\" or \"Modify existing QoS rule and replace all packet filters\" with a non-empty packet filter list in the QoS rule, and the DQR bit is set to \"the QoS rule is the default QoS rule\", the QoS rule is provided for a PDN connection of PDN type \"non-IP\" and there is locally available information associated with the PDN connection that is set to \"Unstructured\".",
    "In case 3 the UE shall not diagnose an error, further process the deletion request and, if no error according to items c and d was detected, consider the respective packet filter as successfully deleted. Otherwise the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #84 \"syntactical error in the QoS operation\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. NOTE 3: It is not considered an error if the UE determines that after processing all QoS operations on QoS rules and QoS flow descriptions there is a QoS flow description that is not associated with any QoS rule and the UE is not in NB-N1 mode. NOTE 3a: An implementation that strictly follows QoS rule operation as defined in subclause 9.11.4.13 might not detect case 2).",
    "c) Semantic errors in packet filters: 1) When a packet filter consists of conflicting packet filter components which would render the packet filter ineffective, i.e. no IP packet will ever fit this packet filter. How the UE determines a semantic error in a packet filter is outside the scope of the present document. The UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #44 \"semantic errors in packet filter(s)\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. d) Syntactical errors in packet filters: 1) When the rule operation is \"Modify existing QoS rule and add packet filters\" or \"Modify existing QoS rule and replace all packet filters\", and two or more packet filters in the resultant QoS rule would have identical packet filter identifiers.",
    "2) When the rule operation is \"Create new QoS rule\", and two or more packet filters in the resultant QoS rule would have identical packet filter identifiers. 3) When there are other types of syntactical errors in the coding of packet filters, such as the use of a reserved value for a packet filter component identifier. 4) Void. In case 1, if two or more packet filters with identical packet filter identifiers are contained in the MODIFY EPS BEARER CONTEXT REQUEST message, the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #45 \"syntactical error in packet filter(s)\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. Otherwise, the UE shall not diagnose an error, further process the MODIFY EPS BEARER CONTEXT REQUEST message and, if it was processed successfully, delete the old packet filters which have the identical packet filter identifiers.",
    "Otherwise the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #45 \"syntactical error in packet filter(s)\" in the MODIFY EPS BEARER CONTEXT ACCEPT message. If the UE detects different errors in the QoS rules and QoS flow descriptions as described in this subclause which requires sending a 5GSM cause parameter in the MODIFY EPS BEARER CONTEXT ACCEPT message, the UE shall include a single 5GSM cause parameter in the MODIFY EPS BEARER CONTEXT ACCEPT message. NOTE 4: The 5GSM cause to use cannot be different from #44 \"semantic error in packet filter(s)\", #45 \"syntactical errors in packet filter(s)\", #83 \"semantic error in the QoS operation\" or #84 \"syntactical error in the QoS operation\". The selection of a 5GSM cause is up to UE implementation.",
    "Upon successful completion of an EPS attach procedure or tracking area updating procedure after inter-system change from N1 mode to S1 mode (see 3GPP TS 24.301 [15]), unless the PDU session is an MA PDU session established over 3GPP access and over non-3GPP access both connected to 5GCN, a) the UE shall delete any UE derived QoS rules of each PDU session which has been transferred to EPS; b) the UE and the SMF shall perform a local release of the PDU session(s) associated with 3GPP access which have not been transferred to EPS; and c) the UE and the SMF shall perform a local release of QoS flow(s) which have not been transferred to EPS, of the PDU session(s) which have been transferred to EPS. The UE and the SMF shall also perform a local release of any QoS flow description not associated with any QoS rule and not associated with any mapped EPS bearer context.",
    "If there is a QoS flow description not associated with any QoS rule, but associated with a mapped EPS bearer context, and after the inter-system change from N1 mode to S1 mode the respective EPS bearer context is active, then the UE shall associate the QoS flow description with the EPS bearer context. For PDU session(s) associated with non-3GPP access in 5GS, if present, the UE may: a) keep some or all of these PDU sessions still associated with non-3GPP access in 5GS, if supported; b) release some or all of these PDU sessions explicitly by initiating the UE requested PDU session release procedure(s); or c) attempt to transfer some or all of these PDU sessions from N1 mode to S1 mode by initiating the UE requested PDN connectivity procedure(s) with the PDN CONNECTIVITY REQUEST message created as follows: 1) if the PDU session is an emergency PDU session, the request type shall be set to \"handover of emergency bearer services\".",
    "Otherwise the request type shall be set to \"handover\"; 2) the PDU session type of the PDU session shall be mapped to the PDN type of the default EPS bearer context as follows: i) the PDN type shall be set to \"non-IP\" if the PDU session type is \"Unstructured\"; ii) the PDN type shall be set to \"IPv4\" if the PDU session type is \"IPv4\"; iii) the PDN type shall be set to \"IPv6\" if the PDU session type is \"IPv6\"; iv) the PDN type shall be set to \"IPv4v6\" if the PDU session type is \"IPv4v6\"; v) the PDN type shall be set to \"non-IP\" if the PDU session type is \"Ethernet\" and the UE, the network or both of them do not support Ethernet PDN type in S1 mode; and vi) the PDN type shall be set to \"Ethernet\" if the PDU session type is \"Ethernet\" and the UE and the network support Ethernet PDN type in S1 mode; 3) the DNN of the PDU session shall be mapped to the APN of the default EPS bearer context, unless the PDN connection is an emergency PDN connection; and 4) the PDU session ID parameter in the Protocol configuration options IE or the Extended protocol configuration options IE shall be set to the PDU session identity of the PDU session.",
    "If a PDU session associated with non-3GPP access is transferred to EPS, the UE shall associate the PDU session identity with the default EPS bearer context and shall delete any UE derived QoS rules of such PDU session. Interworking to 5GS is supported for a PDN connection, if the corresponding default EPS bearer context includes a PDU session identity, an S-NSSAI, if the PDN connection is a non-emergency PDN connection, session AMBR and one or more QoS flow descriptions received in the Protocol configuration options IE or Extended protocol configuration options IE (see 3GPP TS 24.301 [15]), or the default EPS bearer context has association with the PDU session identity, the S-NSSAI, if the PDU session is a non-emergency PDU session, the session-AMBR and one or more QoS flow descriptions after inter-system change from N1 mode to S1 mode.",
    "For a PDN connection established in S1 mode, to enable the UE to attempt to transfer the PDN connection from S1 mode to N1 mode in case of inter-system change, the UE shall allocate a PDU session identity, indicate the allocated PDU session identity in the PDU session ID parameter in the Protocol configuration options IE of the PDN CONNECTIVITY REQUEST message and associate the allocated PDU session identity with the default EPS bearer context of the PDN connection. If an N5CW device supporting 3GPP access establishes a new PDN connection in S1 mode, the N5CW device supporting 3GPP access shall refrain from allocating \"PDU session identity value 15\". For a PDN connection established in S1 mode, the SMF assigning the QoS rules shall consider that the UE supports 16 packet filters for the corresponding PDU session until the UE indicates a higher number (as specified in subclause 6.4.2.2).",
    "The network may provide the UE with one or more QoS rules by including either one QoS rules parameter, or one QoS rules with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message. The network may provide the UE with one or more QoS flow descriptions corresponding to the EPS bearer context being activated, by including either one QoS flow descriptions parameter, or one QoS flow descriptions with the length of two octets parameter, but not both, in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message.",
    "When the UE is provided with one or more QoS flow descriptions in the Protocol configuration options IE or Extended protocol configuration options IE of the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the UE shall check the EPS bearer identity included in the QoS flow description; and: a) if the EPS bearer identity corresponds to the EPS bearer context being activated or the EPS bearer identity is not included, the UE shall store the QoS flow description and all the associated QoS rules, if any, for the EPS bearer context being activated for use during inter-system change from S1 mode to N1 mode; and b) otherwise the UE shall locally delete the QoS flow description and all the associated QoS rules, if any, and include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #84 \"syntactical error in the QoS operation\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.",
    "When the UE is provided with one or more QoS rules, or one or more QoS flow descriptions in the Protocol configuration options IE or Extended protocol configuration options IE of the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the UE shall process the QoS rules sequentially starting with the first QoS rule and shall process the QoS flow descriptions sequentially starting with the first QoS flow description.",
    "The UE shall check QoS rules and QoS flow descriptions for different types of errors as follows: NOTE 5: If an error is detected in a QoS rule or a QoS flow description which requires sending a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause value, then the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message are discarded, if any.",
    "NOTE 6: If the default EPS bearer context activation procedure or the dedicated EPS bearer context activation procedure is rejected, then the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter and the QoS flow descriptions with the length of two octets parameter included in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST or ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message are discarded, if any. a) Semantic errors in QoS operations: 1) When the rule operation is \"Create new QoS rule\" and the DQR bit is set to \"the QoS rule is the default QoS rule\" when there's already a default QoS rule. 2) When the rule operation is received in an ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST message, the rule operation is \"Create new QoS rule\", and there is no rule with the DQR bit set to \"the QoS rule is the default QoS rule\".",
    "3) When the rule operation is \"Create new QoS rule\" and two or more QoS rules associated with this PDU session would have identical precedence values. 4) When the rule operation is an operation other than \"Create new QoS rule\". 5) When the flow description operation is an operation other than \"Create new QoS flow description\". 6) When the UE determines that: i) the default EPS bearer context is associated with one or more QoS flows but the default EPS bearer context is not associated with the default QoS rules. ii) a dedicated EPS bearer context is associated with one or more QoS flows but the dedicated EPS bearer context is associated with the default QoS rule.",
    "7) When the flow description operation is received in an ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the flow description operation is \"Create new QoS flow description\" and there is already an existing QoS flow description with the same QoS flow identifier stored for an EPS bearer context different from the EPS bearer context being activated and belonging to the same PDN connection as the EPS bearer context being activated. 8) When the rule operation is received in an ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the rule operation is \"Create new QoS rule\" and there is already an existing QoS rule with the same QoS rule identifier stored for an EPS bearer context different from the EPS bearer context being activated and belonging to the same PDN connection as the EPS bearer context being activated.",
    "9) When the rule operation is received in an ACTIVATE DEDICATED EPS BEARER CONTEXT REQUEST message, the rule operation is \"Create new QoS rule\" and the resultant QoS rule is associated with a QoS flow description stored for an EPS bearer context different from the EPS bearer context being activated and belonging to the same PDN connection as the EPS bearer context being activated. 10) When the rule operation is \"Create new QoS rule\" and the DQR bit is set to \"the QoS rule is not the default QoS rule\" and one match-all packet filter is to be associated with the QoS rule. 11) When the flow description operation is \"Create new QoS flow description\" and there is already an existing QoS flow description with the same QoS flow identifier stored for the EPS bearer context being activated.",
    "12) When the rule operation is \"Create new QoS rule\", and there is already an existing QoS rule with the same QoS rule identifier and the existing QoS rule is associated with a QoS flow description stored for the EPS bearer context being activated or the existing QoS rule is not associated with any QoS flow description. In case 4, if the rule operation is for a non-default QoS rule, the UE shall delete the QoS rule. If the QoS rule is the default QoS rule, the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS operation\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message. In case 11, the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS flow description (i.e. the QoS flow description that existed when case 11 was detected).",
    "In case 12, if the existing QoS rule is not the default QoS rule and the DQR bit of the new QoS rule is set to \"the QoS rule is not the default QoS rule\", the UE shall not diagnose an error, further process the create request and, if it was processed successfully, delete the old QoS rule (i.e. the QoS rule that existed when case 12 was detected). If the existing QoS rule is the default QoS rule or the DQR bit of the new QoS rule is set to \"the QoS rule is the default QoS rule\", the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS operation\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.",
    "Otherwise for all the cases above, the UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #83 \"semantic error in the QoS operation\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message. b) Syntactical errors in QoS operations: 1) When the rule operation is \"Create new QoS rule\", the packet filter list in the QoS rule is empty, and the QoS rule is provided for a PDN connection of PDN type IPv4, IPv6, IPv4v6 or Ethernet, or for a PDN connection of PDN type \"non-IP\" and there is locally available information associated with the PDN connection that is set to \"Ethernet\". 2) Void.",
    "3) When there are other types of syntactical errors in the coding of the QoS rules parameter, the QoS rules with the length of two octets parameter, the QoS flow descriptions parameter or the QoS flow descriptions with the length of two octets parameter, such as a mismatch between the number of packet filters subfield, and the number of packet filters in the packet filter list when the rule operation is \"delete existing QoS rule\" or \"create new QoS rule\", or the number of packet filters subfield is larger than the maximum possible number of packet filters in the packet filter list (i.e., there is no QoS rule precedence subfield included in the QoS rule IE), the QoS Rule Identifier is set to \"no QoS rule identifier assigned\", or the QoS flow identifier is set to \"no QoS flow identifier assigned.",
    "4) When, the A) rule operation is \"Create new QoS rule\", the UE determines, by using the QoS rule’s QFI as the 5QI, that there is a resulting QoS rule for a GBR QoS flow (as described in 3GPP TS 23.501 [8] table 5.7.4-1), and there is no QoS flow description with a QFI corresponding to the QFI of the resulting QoS rule. 5) When the flow description operation is \"Create new QoS flow description\", and the UE determines that there is a QoS flow description of a GBR QoS flow (as described in 3GPP TS 23.501 [8] table 5.7.4-1) which lacks at least one of the mandatory parameters (i.e., GFBR uplink, GFBR downlink, MFBR uplink and MFBR downlink). If the QoS flow description does not include a 5QI, the UE determines this by using the QFI as the 5QI.",
    "The UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #84 \"syntactical error in the QoS operation\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message. NOTE 7: It is not considered an error if the UE determines that after processing all QoS operations on QoS rules and QoS flow descriptions there is a QoS flow description that is not associated with any QoS rule and the UE is not in NB-N1 mode. c) Semantic errors in packet filters: 1) When a packet filter consists of conflicting packet filter components which would render the packet filter ineffective, i.e. no IP packet will ever fit this packet filter. How the UE determines a semantic error in a packet filter is outside the scope of the present document.",
    "The UE shall include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #44 \"semantic errors in packet filter(s)\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message. d) Syntactical errors in packet filters: 1) When the rule operation is \"Create new QoS rule\" and two or more packet filters in the resultant QoS rule would have identical packet filter identifiers. 2) When there are other types of syntactical errors in the coding of packet filters, such as the use of a reserved value for a packet filter component identifier. The UE shall delete the QoS rule and include a Protocol configuration options IE or Extended protocol configuration options IE with a 5GSM cause parameter set to 5GSM cause #45 \"syntactical error in packet filter(s)\" in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message.",
    "If the UE detects different errors in the QoS rules and QoS flow descriptions as described in this subclause which requires sending a 5GSM cause parameter in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message, the UE shall include a single 5GSM cause parameter in the ACTIVATE DEFAULT EPS BEARER CONTEXT ACCEPT or ACTIVATE DEDICATED EPS BEARER CONTEXT ACCEPT message. NOTE 8: The 5GSM cause to use cannot be different from #44 \"semantic error in packet filter(s)\", #45 \"syntactical errors in packet filter(s)\", #83 \"semantic error in the QoS operation\" or #84 \"syntactical error in the QoS operation\". The selection of a 5GSM cause is up to UE implementation.",
    "Upon inter-system change from S1 mode to N1 mode, the UE uses the parameters from the default EPS bearer context of each PDN connection for which interworking to 5GS is supported to create a corresponding PDU session associated with 3GPP access as follows, unless the PDN connection is a user-plane resource of an MA PDU session: a) the PDN type of the default EPS bearer context shall be mapped to the PDU session type of the PDU session as follows: 1) if the PDN type is \"non-IP\": - the PDU session type is set to the locally available information associated with the PDN connection (either \"Ethernet\" or \"Unstructured\"), if available; or - otherwise, the PDU session type is set to \"Unstructured\"; 2) if the PDN type is \"IPv4\" the PDU session type is set to \"IPv4\"; 3) if the PDN type is \"IPv6\", the PDU session type is set to \"IPv6\"; 4) if the PDN type is \"IPv4v6\", the PDU session type is set to \"IPv4v6\"; and 5) if the PDN type is \"Ethernet\", the PDU session type is \"Ethernet\"; b) the PDN address of the default EPS bearer context shall be mapped to PDU address of the PDU session, if the PDN type is \"IPv4\", \"IPv6\" or \"IPv4v6\"; c) the APN of the default EPS bearer context shall be mapped to the DNN of the PDU session, unless the PDN connection is an emergency PDN connection; d) for each default EPS bearer context in state BEARER CONTEXT ACTIVE the UE shall set the state of the mapped PDU session to PDU SESSION ACTIVE; and e) for any other default EPS bearer context the UE shall set the state of the mapped PDU session to PDU SESSION INACTIVE.",
    "Additionally, the UE shall set: a) the PDU session identity of the PDU session to the PDU session identity included by the UE in the Protocol configuration options IE or Extended protocol configuration options IE in the PDN CONNECTIVITY REQUEST message, or the PDU session identity associated with the default EPS bearer context; b) the S-NSSAI of the PDU session to the S-NSSAI included by the network in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, or the S-NSSAI associated with the default EPS bearer context, if the PDN connection is a non- emergency PDN connection; c) the session-AMBR of the PDU session to the session-AMBR included by the network in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message or the MODIFY EPS BEARER CONTEXT REQUEST message, or the session- AMBR associated with the default EPS bearer context; d) the SSC mode of the PDU session to \"SSC mode 1\"; and e) the always-on PDU session indication to the always-on PDU session indication maintained in the UE, if any.",
    "Upon inter-system change from S1 mode to N1 mode, the UE shall locally release the PDN connection(s) for which interworking to 5GS is not supported. Upon inter-system change from S1 mode to N1 mode, for each PDN connection which is a user-plane resource of MA PDU session and for which interworking to 5GS is supported, the UE shall consider that the MA PDU session is established over 3GPP access and, unless the MA PDU session is established over non-3GPP access too, the UE shall set the session-AMBR of the PDU session to the session-AMBR included by the network in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message or the MODIFY EPS BEARER CONTEXT REQUEST message, or the session-AMBR associated with the default EPS bearer context of the PDN connection.",
    "Upon inter-system change from S1 mode to N1 mode, if: a) the UE sent the URSP provisioning in EPS support indicator and received the URSP provisioning in EPS support indicator in the PDN connection corresponding to the PDU session; or b) the default EPS bearer context of the PDN connection corresponding to the PDU session is associated with the URSP provisioning in EPS support indicators; then the UE shall associate the PDU session with the URSP provisioning in EPS support indicators.",
    "Additionally, for each EPS bearer context of the PDN connection, the UE shall create QoS flow(s) each of which is associated with the QoS flow description received in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, ACTIVATE DEDICATED EPS BEARER REQUEST message, or MODIFY EPS BEARER REQUEST message (see 3GPP TS 24.301 [15]), or the QoS flow description associated with EPS bearer context, unless: a) the PDU session is an MA PDU session which: 1) is established over non-3GPP access; and 2) has a PDN connection as a user-plane resource; and b) the QoS flow already exists over the non-3GPP access.",
    "Additionally, for each EPS bearer context of the PDN connection, the UE shall create QoS rules(s), if any, each of which is associated with the QoS rule received in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, ACTIVATE DEDICATED EPS BEARER REQUEST message, or MODIFY EPS BEARER CONTEXT REQUEST message (see 3GPP TS 24.301 [15]), or the QoS rules associated with EPS bearer context, unless: a) the PDU session is an MA PDU session which: 1) is established over non-3GPP access; and 2) has a PDN connection as a user-plane resource; and b) the QoS rule already exists over the non-3GPP access. NOTE 9: For a QoS rule which does not exist over non-3GPP access, the UE does not create the QoS rule if the QoS rule is the default QoS rule, or the precedence value of the QoS rule equals to the precedence value of a QoS rule exists over the non-3GPP access.",
    "Additionally, for each PDU session which was created at inter-system change from S1 mode to N1 mode from a corresponding PDN connection of the \"Ethernet\" PDN type, the UE shall consider that Ethernet PDN type in S1 mode is supported by the network and the SMF shall consider that Ethernet PDN type in S1 mode is supported by the UE. The UE and the network shall locally release the PDN connection(s) and EPS bearer context(s) associated with the 3GPP access which have not been transferred to 5GS. After inter-system change from S1 mode to N1 mode, for each QoS flow mapped from an EPS bearer context the UE shall associate the EPS bearer identity, the EPS QoS parameters, the extended EPS QoS parameters, and the traffic flow template, if available, of the EPS bearer context with the QoS flow.",
    "After inter-system change from S1 mode to N1 mode, for each QoS flow of an MA PDU session which: a) is established over non-3GPP access; and b) has a PDN connection as a user-plane resource; such that the QoS flow was received in the Protocol configuration options IE or Extended protocol configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message, ACTIVATE DEDICATED EPS BEARER REQUEST message, MODIFY EPS BEARER CONTEXT REQUEST message, (see 3GPP TS 24.301 [15]), or associated with EPS bearer context, the UE shall associate the EPS bearer identity, the EPS QoS parameters, the extended EPS QoS parameters, and the traffic flow template, if available, of the EPS bearer context with the QoS flow.",
    "If the EPS bearer context(s) of the PDN connection are associated with the control plane only indication, and the PDN connection supports interworking to 5GS, after inter-system change from S1 mode to N1 mode, the UE shall associate the PDU session corresponding to the PDN connection with the control plane only indication. If the default EPS bearer context of the PDN connection is associated with the PDU session pair ID, and the PDN connection supports interworking to 5GS, after inter-system change from S1 mode to N1 mode, the UE shall associate the PDU session corresponding to the PDN connection with the PDU session pair ID. If the default EPS bearer context of the PDN connection is associated with the RSN, and the PDN connection supports interworking to 5GS, after inter- system change from S1 mode to N1 mode, the UE shall associate the PDU session corresponding to the PDN connection with the RSN.",
    "If there is an EPS bearer used for IMS signalling, after inter-system change from S1 mode to N1 mode, the QoS flow of the default QoS rule in the corresponding PDU session is used for IMS signalling. For a PDN connection established when in S1 mode, upon an inter-system change from S1 mode to N1 mode, if a UE- requested PDU session modification procedure has not been successfully performed yet,the SMF shall determine the always-on PDU session indication as specified in subclause 6.3.2.2. When the UE is provided with one or more mapped EPS bearer contexts in the Mapped EPS bearer contexts IE of the PDU SESSION MODIFICATION COMMAND message, the UE shall process the mapped EPS bearer contexts sequentially starting with the first mapped EPS bearer context.",
    "When the UE is provided with a new EPS bearer identity, a new EPS QoS parameters, a new extended EPS QoS parameters, a new APN-AMBR or a new extended APN-AMBR in the Mapped EPS bearer context IE of the PDU SESSION MODIFICATION COMMAND message for a QoS flow, the UE shall discard the corresponding association(s) and associate the new value(s) with the QoS flow. When the UE is provided with a new traffic flow template in the Mapped EPS bearer contexts IE of the PDU SESSION MODIFICATION COMMAND message for a QoS flow, the UE shall check the traffic flow template for different types of TFT IE errors as specified in subclause 6.3.2.3. When a QoS flow is deleted, the associated EPS bearer context information that are mapped from the deleted QoS flow shall be deleted from the UE and the network if there is no other existing QoS flow associated with this EPS bearer context.",
    "When the EPS bearer identity of a QoS flow is deleted, the associated EPS bearer context information that are mapped from the deleted EPS bearer identity shall be deleted from the UE and the network if there is no other existing QoS flow associated with this EPS bearer context. When an EPS bearer is released, all the associated QoS flow descriptions and QoS rules that are mapped from the released EPS bearer shall be deleted from the UE and the network. NOTE 10: If T3584 is running or deactivated for the S-NSSAI and optionally the DNN combination, the UE is allowed to initate ESM procedures in EPS with or without APN corresponding to that DNN, and if the APN is congested in EPS, the MME can send a back-off timer for the APN to the UE as specified in 3GPP TS 24.301 [15].",
    "Upon inter-system change from N1 mode to S1 mode, if the UE has any PDU sessions associated with one or more multicast MBS sessions, the UE shall locally leave the associated multicast MBS sessions and the network shall consider the UE as removed from the associated MBS sessions. For the case of handover of an existing PDU session from 3GPP access to non-3GPP access, - upon receipt of the PDU SESSION ESTABLISHMENT ACCEPT message, the UE locally deletes the EPS bearer identities for the PDU session, if any (see subclause 6.4.1.3); and - after successful handover, the network shall locally delete the EPS bearer identities for the PDU session, if any. When the UE or the network initiates a transaction related procedure (i.e. a procedure consisting of more than one message and the messages are related), it shall include a valid PTI value in the message header of the request message or of the command message.",
    "If a response message is sent as result of a received request message or a received command message, the sending entity shall include in the response message the PTI value received within the request message or within the command message (see examples in figure 6.2.1.1, figure 6.2.1.2, and figure 6.2.1.3). If a command message is sent as result of a received request message, the sending entity shall include in the command message the PTI value received with the request message (see examples in figure 6.2.1.3). If a command message is not sent as result of a received request message, the sending entity shall include in the command message the PTI value set to \"no procedure transaction identity assigned\" (see examples in figure 6.2.1.4).",
    "UE SMF transaction related request (PTI = a) transaction related accept (PTI = a) Figure 6.2.1.1: UE-requested transaction related procedure accepted by the network UE SMF transaction related request (PTI = a) transaction related reject (PTI = a) Figure 6.2.1.2: UE-requested transaction related procedure rejected by the network UE SMF transaction related request (PTI = a) transaction related command (PTI = a) transaction related response (PTI = a) Figure 6.2.1.3: UE-requested transaction related procedure triggering a network-requested transaction related procedure UE SMF transaction related command (PTI = unassigned) transaction related response (PTI = unassigned) Figure 6.2.1.4: network-requested transaction related procedure not triggered by a UE-requested transaction related procedure This clause specifies IP address allocation for the PDU session.",
    "In this release of specification, PDU session can be initiated with one IP version, i.e. IPv4 PDU session type or IPv6 PDU session type, or with both IP versions, i.e. IPv4v6 PDU session type. IP address allocation to the UE shall be performed by SMF based on one or both the selected IP versions and operator policies. If IPv4 PDU session type is selected, an IPv4 address is allocated to the UE. If IPv6 PDU session type is selected, an IPv6 prefix except when the SMF acts according to subclause 6.2.4.3, and an interface identifier for the IPv6 link local address are allocated to the UE. If IPv4v6 PDU session type is selected, an IPv4 address, an IPv6 prefix except when the SMF acts according to subclause 6.2.4.3 or 6.2.4.4, and an interface identifier for the IPv6 link local address are allocated to the UE.",
    "If IPv6 or IPv4v6 PDU session type is selected in a PDU session established by the W- AGF acting on behalf of the FN-RG and the PDU SESSION ESTABLISHMENT REQUEST message contains the Suggested interface identifier IE, the SMF shall allocate to the UE the interface identifier for the IPv6 link local address indicated in the Suggested interface identifier IE.",
    "For IPv4 PDU session type and for IPv4v6 PDU session type, the UE: a) shall obtain an IPv4 address via: 1) NAS signalling as specified in subclause 6.2.4.2; or 2) DHCPv4 as specified in IETF RFC 2131 [33E]; and b) may obtain IPv4 configuration parameters (e.g. DNS server address) via DHCPv4 as specified in IETF RFC 2132 [33F] or may receive IPv4 configuration parameters (e.g. DNS server address) as specified in subclause 6.4.1 and subclause 6.3.2. For IPv6 PDU session type and for IPv4v6 PDU session type, the UE: a) shall build an IPv6 link local address based on the allocated interface identifier for the IPv6 link local address; b) shall obtain /64 IPv6 prefix via IPv6 stateless address autoconfiguration as specified in 3GPP TS 23.501 [8] and IETF RFC 4862 [39], except when the 5G-RG or the W-AGF act according to subclause 6.2.4.3; c) may obtain IPv6 configuration parameters via stateless DHCPv6 as specified in IETF RFC 8415 [33D], except when the 5G-RG or the W-AGF act according to subclause 6.2.4.3, may receive IPv6 configuration parameters (e.g. DNS server address) as specified in subclause 6.4.1 and subclause 6.3.2, or may receive DNS server IPv6 addresses in a Router Advertisement Message as specified in IETF RFC 4861 [38B] with recursive DNS server option as specified in IETF RFC 8106 [52];and d) may obtain an additional IPv6 prefix for a PDU session by IPv6 prefix delegation via DHCPv6 as specified in subclause 6.2.4.2a.",
    "relay UE for IP address allocation If a UE acting as 5G ProSe layer-3 UE-to-network relay needs to indicate \"IPv6 Router\" or \"DHCPv4 Server & IPv6 Router\" in the IP address configuration IE as specified in 3GPP 24.554 [19E], the UE shall support acting as a \"Requesting Router\" as described in IETF RFC 8415 [33D] to request additional IPv6 prefixes (i.e. prefixes in addition to the /64 default prefix which was allocated via stateless IPv6 address autoconfiguration as specified in subclause 6.2.4.1) from the SMF as specified in subclause 5.5.2 of 3GPP TS 23.304 [6E]. When the UE acting as 5G ProSe layer-3 UE-to-network relay UE requests additional prefixes using DHCPv6, the UE shall perform procedures described in subclause 6.2.4.2a. In a PDU session of IPv4, IPv6, IPv4v6 and Ethernet PDU session type, the NAS protocol enables different forwarding treatments of UL user data packets in one or more QoS flows based on signalled QoS rules, derived QoS rules or any combination of them.",
    "In a PDU session of Unstructured PDU session type, all UL user data packets are associated with the same QoS flow. The network can also provide the UE with one or more QoS flow descriptions associated with a PDU session at the PDU session establishment or at the PDU session modification. Each QoS flow description contains: a) a QoS flow identifier (QFI); b) if the flow is a GBR QoS flow: 1) Guaranteed flow bit rate (GFBR) for UL; 2) Guaranteed flow bit rate (GFBR) for DL; 3) Maximum flow bit rate (MFBR) for UL; 4) Maximum flow bit rate (MFBR) for DL; and 5) optionally averaging window, applicable for both UL and DL; c) 5QI, if the QFI is not the same as the 5QI of the QoS flow identified by the QFI; and d) optionally, an EPS bearer identity (EBI) if the QoS flow can be mapped to an EPS bearer as specified in subclause 4.11.1 of 3GPP TS 23.502 [9].",
    "If the averaging window is not included in a QoS flow description for a GBR QoS flow with a 5QI indicated in 3GPP TS 23.501 [8] table 5.7.4-1, the averaging window associated with the 5QI in 3GPP TS 23.501 [8] table 5.7.4-1 applies for the averaging window. If the averaging window is not included in a QoS flow description for a GBR QoS flow with a 5QI not indicated in 3GPP TS 23.501 [8] table 5.7.4-1, the standardized value of two seconds is used as the averaging window. The UE may support reflective QoS. If the UE supports the reflective QoS, the UE shall support the procedures in the following subclauses. The reflective QoS is applicable in a PDU session of IPv4, IPv6, IPv4v6 and Ethernet PDU session type. The reflective QoS is not applicable in a PDU session of Unstructured PDU session type. Reflective QoS is not applicable for a PDU session with control plane only indication.",
    "The UE may request to revoke the usage of reflective QoS for an existing PDU session for which the UE had previously indicated support for reflective QoS. If the UE receives a DL user data packet associated with a QFI and an RQI, the DL user data packet belongs to a PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type, and the UE has a derived QoS rule with the same packet filter for UL direction as the packet filter for UL direction derived from the DL user data packet as specified in subclause 6.2.5.1.4.2: a) the UE shall re-start the timer T3583 associated with the derived QoS rule with the RQ timer value last received during the UE-requested PDU session establishment procedure of the PDU session (see subclause 6.4.1) or the network-requested PDU session modification procedure of the PDU session (see subclause 6.4.2).",
    "If the RQ timer value was received neither in the UE-requested PDU session establishment procedure of the PDU session nor in any network-requested PDU session modification procedure of the PDU session, the default standardized RQ timer value is used; and b) if the QFI value associated with the DL user data packet is different from the QFI value stored for the derived QoS rule, the UE shall replace the QFI value stored for the derived QoS rule with the new QFI value for the derived QoS rule. In an MA PDU session, unless it : a) is established over non-3GPP access; and b) has a PDN connection as a user-plane resource; the UE shall have one set of QoS rules, one set of QoS flow descriptions and one session-AMBR. The network can provide the set of QoS rules, the set of QoS flow descriptions and the session-AMBR of the MA PDU session via either access of the MA PDU session.",
    "In an MA PDU session, the UE shall support:- - modification or deletion via an access of a QoS rule or a QoS flow description; and - modification via an access of the session-AMBR; of the MA PDU session created via the same or the other access. In an MA PDU session: a) established over non-3GPP access; and b) with a PDN connection as a user-plane resource; the UE shall have two sets of QoS rules, two sets of QoS flow descriptions and two session-AMBR values - one is maintained via non-3GPP access and the other is associated with EPS bearer contexts of the PDN connection and maintained via Extended protocol configuration options IE parameters received via the PDN connection. The network may detect and start performing S-NSSAI based congestion control when one or more S-NSSAI congestion criteria as specified in 3GPP TS 23.501 [8] are met. If the UE does not provide a DNN for a non-emergency PDU session, then the network uses the selected DNN.",
    "If the UE does not provide an S-NSSAI for a non-emergency PDU session, then the network uses the selected S-NSSAI. In case of PLMN or SNPN, in the UE, 5GS session management timers T3584 for the S-NSSAI based congestion control are started and stopped on a per S-NSSAI, DNN and PLMN or SNPN basis. If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The back-off timer is applied in all PLMNs or equivalent SNPNs \" is included in the 5GSM message with the 5GSM cause value #67 \"insufficient resources for specific slice and DNN\", then the UE applies the timer T3584 for all the PLMNs or all the equivalent SNPNs. Otherwise, the UE applies the timer T3584 for the registered PLMN or the registered SNPN.",
    "If the timer T3584 applies for all the PLMNs or all the equivalent SNPNs, the timer T3584 starts when the UE is registered in a VPLMN or an unsubscribed SNPN and the S-NSSAI is provided by the UE during the PDU session establishment, the timer T3584 is associated with the [mapped S-NSSAI, DNN] combination of the PDU session. In case of PLMN or SNPN, in the UE, 5GS session management timers T3585 for the S-NSSAI based congestion control are started and stopped on a per S-NSSAI and PLMN or SNPN basis. If the 5GSM congestion re-attempt indicator IE with the ABO bit set to \"The back-off timer is applied in all PLMNs or all equivalent SNPNs \" is included in the 5GSM message with the 5GSM cause value #69 \"insufficient resources for specific slice\", then the UE applies the timer T3585 for all the PLMNs or all the equivalent SNPNs. Otherwise, the UE applies the timer T3585 for the registered PLMN or registered SNPN.",
    "If the timer T3585 applies for all the PLMNs or all the equivalent SNPNs, the timer T3585 starts when the UE is registered in a VPLMN or an unsubscribed SNPN and the S-NSSAI is provided by the UE during the PDU session establishment, the timer T3585 is associated with the mapped S-NSSAI of the PDU session. Additionally, if the 5GSM congestion re-attempt indicator IE with the CATBO bit set to \"The back-off timer is applied in the current access type\" is included in the 5GSM message with the 5GSM cause value #69 \"insufficient resources for specific slice\", then the UE applies the timer T3585 for the current access type. Otherwise, the UE applies the timer T3585 for both 3GPP access type and non-3GPP access type and the UE shall stop any running timer T3585 for the applied PLMN or SNPN and for the access different from the access from which the message is received.",
    "In case of SNPN, if the UE does not support access to an SNPN using credentials from a credentials holder and equivalent SNPNs, in the UE 5GS session management timers T3584 for the S-NSSAI based congestion control are started and stopped on a per S-NSSAI, DNN and SNPN basis. If the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, in the UE 5GS session management timers T3584 for the S- NSSAI based congestion control are started and stopped on a per S-NSSAI, DNN, SNPN and selected entry of the \"list of subscriber data\" or selected PLMN subscription basis. In case of SNPN, if the UE does not support access to an SNPN using credentials from a credentials holder and equivalent SNPNs, in the UE 5GS session management timers T3585 for the S-NSSAI based congestion control are started and stopped on a per S-NSSAI and SNPN basis.",
    "If the UE supports access to an SNPN using credentials from a credentials holder, equivalent SNPNs or both, in the UE 5GS session management timers T3585 for the S-NSSAI based congestion control are started and stopped on a per S-NSSAI, SNPN and selected entry of the \"list of subscriber data\" or selected PLMN subscription basis. If the timer T3584 or timer T3585 was provided during the PDU session establishment procedure, the S-NSSAI associated with T3584 or T3585, respectively is the S-NSSAI, including no S-NSSAI, provided by the UE during the PDU session establishment. If the timer T3584 is provided during the PDU session modification or PDU session release procedure, the UE behaves as follows: The DNN associated with T3584 is the DNN provided by the UE during the PDU session establishment.",
    "If no S-NSSAI but DNN is provided by the UE along the PDU SESSION ESTABLISHMENT REQUEST message, then T3584 is associated with no S-NSSAI and the DNN provided to the network during the PDU session establishment. If the PDN connection was established when in the S1 mode, then T3584 is associated with no S-NSSAI. If no DNN but S-NSSAI is provided by the UE along the PDU SESSION ESTABLISHMENT REQUEST message, then T3584 is associated with no DNN and the S-NSSAI of the PDU session. If no DNN and no S-NSSAI is provided by the UE along the PDU SESSION ESTABLISHMENT REQUEST message, then T3584 is associated with no DNN and no S- NSSAI. For this purpose, the UE shall memorize the DNN and the S-NSSAI provided to the network during the PDU session establishment. The timer T3584 associated with no DNN and an S-NSSAI will never be started due to any 5GSM procedure related to an emergency PDU session.",
    "If the timer T3584 associated with no DNN and an S-NSSAI is running, it does not affect the ability of the UE to request an emergency PDU session. If the timer T3585 was provided during the PDU session modification or PDU session release procedure, the UE behaves as follows: if an S-NSSAI was provided by the UE during the PDU session establishment, then T3585 is associated with the S-NSSAI of the PDU session. If no S-NSSAI is provided by the UE along the PDU SESSION ESTABLISHMENT REQUEST message, then T3585 is associated with no S-NSSAI. If the PDN connection was established when in the S1 mode, then T3585 is associated with no S-NSSAI.",
    "If T3584 is running or is deactivated, then the UE is not allowed to initiate the: a) PDU session establishment procedure; b) PDU session modification procedure; or c) NAS transport procedure for sending CIoT user data; for the respective [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination unless the UE is a UE configured for high priority access in selected PLMN or SNPN or to report a change of 3GPP PS data off UE status.",
    "In a PLMN, if the timer T3584 is running or is deactivated for all the PLMNs and is associated with an S-NSSAI other than no S-NSSAI, then a) the UE registered in the HPLMN is not allowed to initiate the: 1) PDU session establishment procedure; 2) PDU session modification procedure; or 3) NAS transport procedure for sending CIoT user data; when the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination provided by the UE during the PDU session establishment is the same as the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination associated with the timer T3584 unless the UE is a UE configured for high priority access in selected PLMN or to report a change of 3GPP PS data off UE status; and b) the UE registered in a VPLMN is not allowed to initiate the: 1) PDU session establishment procedure; 2) PDU session modification procedure; or 3) NAS transport procedure for sending CIoT user data; when the [mapped S-NSSAI, no DNN] or [mapped S-NSSAI, DNN] combination provided by the UE during the PDU session establishment is the same as the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination associated with the timer T3584 unless the UE is a UE configured for high priority access in selected PLMN or to report a change of 3GPP PS data off UE status.",
    "In a PLMN, if the timer T3584 is running or is deactivated for all the PLMNs and is associated with [no S-NSSAI, no DNN] or [no S-NSSAI, DNN] combination, then the UE is not allowed to initiate the: a) PDU session establishment procedure; b) PDU session modification procedure; or c) NAS transport procedure for sending CIoT user data; for [no S-NSSAI, no DNN] or [no S-NSSAI, DNN] combination in any PLMN unless the UE is a UE configured for high priority access in selected PLMN or to report a change of 3GPP PS data off UE status.",
    "In an SNPN, if the UE supports equivalent SNPNs, the timer T3584 is running or is deactivated for all the equivalent SNPNs, is associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, with an S-NSSAI other than no S-NSSAI, and with the RSNPN or an equivalent SNPN: a) the UE registered in the subscribed SNPN is not allowed to initiate the: 1) PDU session establishment procedure; or 2) PDU session modification procedure; when the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination provided by the UE during the PDU session establishment is the same as the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination associated with the timer T3584 unless the UE is a UE configured for high priority access in the RSNPN or to report a change of 3GPP PS data off UE status; and b) the UE registered in a non-subscribed is not allowed to initiate the: 1) PDU session establishment procedure; or 2) PDU session modification procedure; when the [mapped S-NSSAI, no DNN] or [mapped S-NSSAI, DNN] combination provided by the UE during the PDU session establishment is the same as the [S-NSSAI, no DNN] or [S-NSSAI, DNN] combination associated with the timer T3584 unless the UE is a UE configured for high priority access in RSNPN or to report a change of 3GPP PS data off UE status.",
    "In an SNPN, if the UE supports equivalent SNPNs, the timer T3584 is running or is deactivated for all the equivalent SNPNs, is associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, with [no S-NSSAI, no DNN] or [no S-NSSAI, DNN] combination, and with the RSNPN or an equivalent SNPN, then the UE is not allowed to initiate the: a) PDU session establishment procedure; or b) PDU session modification procedure; for [no S-NSSAI, no DNN] or [no S-NSSAI, DNN] combination unless the UE is a UE configured for high priority access in the RSPN or to report a change of 3GPP PS data off UE status. If T3585 is running or is deactivated, then the UE is neither allowed to initiate the PDU session establishment procedure nor the PDU session modification procedure for the respective S-NSSAI unless the UE is a UE configured for high priority access in selected PLMN or SNPN or to report a change of 3GPP PS data off UE status.",
    "In a PLMN, if the timer T3585 is running or is deactivated for all the PLMNs and is associated with an S-NSSAI other than no S-NSSAI, then a) the UE registered in the HPLMN is not allowed to initiate the: 1) PDU session establishment procedure; 2) PDU session modification procedure; or 3) NAS transport procedure for sending CIoT user data; when the S-NSSAI provided by the UE during the PDU session establishment is the same as the S-NSSAI associated with timer T3585 unless the UE is a UE configured for high priority access in selected PLMNs or to report a change of 3GPP PS data off UE status; and b) the UE registered in a VPLMN is not allowed to initiate the: 1) PDU session establishment procedure; 2) PDU session modification procedure; or 3) NAS transport procedure for sending CIoT user data; when the mapped S-NSSAI provided by the UE during the PDU session establishment is the same as the S-NSSAI associated the timer T3585 unless the UE is a UE configured for high priority access in selected PLMN or to report a change of 3GPP PS data off UE status.",
    "In a PLMN, if the timer T3585 is running or is deactivated for all the PLMNs and is associated with no S-NSSAI, then the UE is not allowed to initiate the: a) PDU session establishment procedure; b) PDU session modification procedure; c) NAS transport procedure for sending CIoT user data; for no S-NSSAI in any PLMN unless the UE is a UE configured for high priority access in selected PLMN or to report a change of 3GPP PS data off UE status.In an SNPN, if the UE supports equivalent SNPNs, the timer T3585 is running or is deactivated for all the equivalent SNPNs, is associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, with an S-NSSAI other than no S-NSSAI, and with the RSNPN or an equivalent SNPN: a) the UE registered in the subscribed SNPN is not allowed to initiate the: 1) PDU session establishment procedure; or 2) PDU session modification procedure; when the S-NSSAI provided by the UE during the PDU session establishment is the same as the S-NSSAI associated with timer T3585 unless the UE is a UE configured for high priority access in the RSNPN or to report a change of 3GPP PS data off UE status; and b) the UE registered in a non-subscribed SNPN is not allowed to initiate the: 1) PDU session establishment procedure; or 2) PDU session modification procedure; when the mapped S-NSSAI provided by the UE during the PDU session establishment is the same as the S- NSSAI associated the timer T3585 unless the UE is a UE configured for high priority access in the RSNPN or to report a change of 3GPP PS data off UE status.",
    "In an SNPN, if the UE supports equivalent SNPNs, the timer T3585 is running or is deactivated for all the equivalent SNPNs, is associated with the selected entry of the \"list of subscriber data\" or the selected PLMN subscription, with no S-NSSAI, and with the RSNPN or an equivalent SNPN, then the UE is not allowed to initiate the: a) PDU session establishment procedure; or b) PDU session modification procedure; for no S-NSSAI unless the UE is a UE configured for high priority access in RSNPN or to report a change of 3GPP PS data off UE status. If the network does not include timer T3584 with 5GSM cause #67 \"insufficient resources for specific slice and DNN\", the UE may use a local back-off timer that has exponential value or a default value, which is provisioned using implementation specific means, to:a) prevent sending any 5GSM procedure for the respective DNN and S-NSSAI till its expiry; andb) allow sending any 5GSM procedure for the respective DNN and S-NSSAI after its expiry.",
    "If the network does not include timer T3585 with 5GSM cause #69 \"insufficient resources for specific slice\", the UE may use a local back-off timer that has exponential value or a default value, which is provisioned using implementation specific means, to:a) prevent sending any 5GSM procedure for the respective S-NSSAI till its expiry; and b) allow sending any 5GSM procedure for the respective S-NSSAI after its expiry. The URSP requires interaction between upper layers and the 5GSM entities in the UE (see 3GPP TS 24.526 [19] for further details). Each of the 5GSM entities in the UE shall indicate attributes (e.g. PDU session identity, SSC mode, S- NSSAI, DNN, PDU session type, access type, PDU address) of a newly established PDU session to the upper layers. If a PDU session is released, the 5GSM entity handling the PDU session shall inform the PDU session identity of the released PDU session to the upper layers.",
    "The upper layers may request a 5GSM entity: a) to establish a PDU session indicating one or more PDU session attributes; b) to release an existing PDU session; or c) to establish a PDU session indicating one or more PDU session attributes, and to release an existing PDU session. The UE supporting IPv6 may support multi-homed IPv6 PDU session.",
    "If the UE supports the multi-homed IPv6 PDU session: a) the UE shall support acting as a type C host as specified in IETF RFC 4191 [36]; and b) the UE indicates support of the multi-homed IPv6 PDU session: 1) during the UE-requested PDU session establishment of a PDU session of \"IPv6\" or \"IPv4v6\" PDU session type; and 2) during the UE-requested PDU session modification performed after an inter-system change from S1 mode to N1 mode, for a PDU session associated with a PDN connection established when in S1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the PDU session is of \"IPv6\" or \"IPv4v6\" PDU session type, and the UE has not previously successfully performed the UE- requested PDU session modification to provide this indication. Small data rate control is applicable only to NB-N1 mode and WB-N1 mode.",
    "Small data rate control controls the maximum number of uplink user data messages including uplink exception data reporting sent by the UE in a time interval for the PDU session in accordance with 3GPP TS 23.501 [8]. The UE shall limit the rate at which it generates uplink user data messages to comply with the small data rate control policy. The NAS shall provide the indicated rates to upper layers for enforcement. The indicated rates in a NAS procedure applies to the PDU session the NAS procedure corresponds to, and the indicated rates are valid until a new value is indicated or the PDU session is released. If the UE indicates support for CIoT 5GS optimizations, the network may provide the small data rate control parameters to the UE and may provide the small data rate control parameters for exception data to the UE if and only if the small data rate control parameters is provided to the UE.",
    "Small data rate control parameters and small data rate control parameters for exception data can also be provided to the UE in S1 mode as specified in 3GPP TS 24.301 [15]. If an allowed indication of additional exception reports is provided with the small data rate control parameters and: - the additional small data rate control parameters for exception data is provided and the limit for additional rate for exception data reporting is not reached; or - the additional small data rate control parameters for exception data is not provided, the UE is allowed to send uplink exception reports even if the limit for the small data rate control has been reached. During a PDU session release procedure, if the small data rate control was applied to the PDU session that is being released, the network may store the small data rate control status for the released PDU session as specified in 3GPP TS 23.501 [8].",
    "If: a) the UE indicates support for CIoT 5GS optimizations; and b) the small data rate control status was stored for the PDU session and is still valid, the network may provide the remaining small data rate control status as initial small data rate control parameters to the UE and initial small data rate control parameters for exception data to the UE during a subsequent PDU session establishment procedure. If received during the establishment of a PDU session, the UE shall apply the initial small data rate control parameters and the initial small data rate control parameters for exception data for the duration of the validity period. When the validity period expires the small data rate control parameters and the small data rate control parameters for exception data shall be applied (see 3GPP TS 23.501 [8]). NOTE 1: The HPLMN can discard or delay user data that exceeds the limit provided for small data rate control.",
    "Upon inter-system change from N1 mode to S1 mode, the UE shall store the current small data rate control status for PDU sessions to be transferred from N1 mode to S1 mode as specified in 3GPP TS 23.501 [8]. NOTE 2: How long the UE stores the current small data rate control status is implementation specific. Upon inter-system change from S1 mode to N1 mode, the UE shall use the stored small data rate control status, if any, to comply with the small data rate control policy for PDU sessions transferred from S1 mode to N1 mode as specified in 3GPP TS 23.501 [8], if the validity period of the stored small data rate control status has not expired. optimizations The UE and the SMF may use: - IP header compression for PDU sessions of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDU session type; and - Ethernet header compression for PDU sessions of \"Ethernet\" PDU session type.",
    "Both the UE and the AMF indicate whether header compression for control plane CIoT 5GS optimization is supported during registration procedures (see subclause 5.5.1). If both the UE and the network support header compression, the header compression configuration for each PDU session is negotiated during the PDU session establishment procedure and PDU session modification procedure as specified in subclauses 6.3.2, 6.4.1 and 6.4.2. For IP header compression, ROHC protocol specified in IETF RFC 5795 [39B] is used. The IP header compression configuration used for IP header compression is (re-)negotiated between the UE and the SMF using the IP header compression configuration IE as specified in subclauses 6.3.2.2, 6.4.1.2, 6.4.1.3 and 6.4.2.2, respectively. For Ethernet header compression, Ethernet Header Compression (EHC) protocol specified in 3GPP TS 38.323 [29] is used.",
    "The Ethernet header compression configuration used for Ethernet header compression is (re-)negotiated between the UE and the SMF using the Ethernet header compression configuration IE as specified in subclauses 6.3.2.2, 6.4.1.2, The 5GSM sublayer may support establishment of redundant PDU sessions (see subclause 5.33.2 of 3GPP TS 23.501 [8]). In order to establish a set of two redundant PDU sessions, a UE can include a PDU session pair ID, an RSN, or both in a PDU SESSION ESTABLISHMENT REQUEST message for each of the two redundant PDU sessions (see subclause 6.4.1.2). The UE can set the PDU session pair ID, the RSN, or both according to URSP or UE local configuration (see 3GPP TS 24.526 [19]). An SMF receiving a PDU session pair ID, an RSN, or both via a PDU SESSION ESTABLISHMENT REQUEST message operates as specified in subclause 5.33.2 of 3GPP TS 23.501 [8].",
    "In addition, an SMF can handle two PDU sessions as redundant even if the UE provides neither a PDU session pair ID nor an RSN in a PDU SESSION ESTABLISHMENT REQUEST message for each of the PDU sessions (see subclause 5.33.2 of 3GPP TS 23.501 [8]). The purpose of the PDU session authentication and authorization procedure is to enable the DN: a) to authenticate the upper layers of the UE, when establishing the PDU session; b) to authorize the upper layers of the UE, when establishing the PDU session; c) both of the above; or d) to re-authenticate the upper layers of the UE after establishment of the PDU session. The PDU session authentication and authorization procedure can be performed only during or after the UE-requested PDU session procedure establishing a non-emergency PDU session. The PDU session authentication and authorization procedure shall not be performed during or after the UE-requested PDU session establishment procedure establishing an emergency PDU session.",
    "The upper layers store the association between a DNN and corresponding credentials, if any, for the PDU session authentication and authorization. If the UE is registered for onboarding services in SNPN the SMF may initiate the PDU session authentication and authorization procedure based on local policy with a DCS as specified in 3GPP TS 33.501 [24] subclause I.9.2.4.1 or a DN-AAA server as specified in 3GPP TS 33.501 [24] subclause I.9.2.4.2. If the UE is registered for onboarding services in SNPN and the network initiates the PDU session authentication and authorization procedure, the UE shall use the default UE credentials for secondary authentication for the PDU session authentication and authorization procedure. The network authenticates the UE using the Extensible Authentication Protocol (EAP) as specified in IETF RFC 3748 [34].",
    "EAP has defined four types of EAP messages: a) an EAP-request message; b) an EAP-response message; c) an EAP-success message; and d) an EAP-failure message. The EAP-request message is transported from the network to the UE using the PDU SESSION AUTHENTICATION COMMAND message of the PDU EAP message reliable transport procedure. The EAP-response message to the EAP-request message is transported from the UE to the network using the PDU SESSION AUTHENTICATION COMPLETE message of the PDU EAP message reliable transport procedure. If the PDU session authentication and authorization procedure is performed during the UE-requested PDU session establishment procedure: a) and the DN authentication of the UE completes successfully, the EAP-success message is transported from the network to the UE as part of the UE-requested PDU session establishment procedure in the PDU SESSION ESTABLISHMENT ACCEPT message.",
    "b) and the DN authentication of the UE completes unsuccessfully, the EAP-failure message is transported from the network to the UE as part of the UE-requested PDU session establishment procedure in the PDU SESSION ESTABLISHMENT REJECT message. If the PDU session authentication and authorization procedure is performed after the UE-requested PDU session establishment procedure: a) and the DN authentication of the UE completes successfully, the EAP-success message is transported from the network to the UE using the PDU SESSION AUTHENTICATION RESULT message of the PDU EAP result message transport procedure. b) and the DN authentication of the UE completes unsuccessfully, the EAP-failure message is transported from the network to the UE using the PDU SESSION RELEASE COMMAND message of the network-requested PDU session release procedure.",
    "There can be several rounds of exchange of an EAP-request message and a related EAP-response message for the DN to complete the authentication and authorization of the request for a PDU session (see example in figure 6.3.1.1). The SMF shall set the authenticator retransmission timer specified in IETF RFC 3748 [34] subclause 4.3 to infinite value. NOTE: The PDU session authentication and authorization procedure provides a reliable transport of EAP messages and therefore retransmissions at the EAP layer of the SMF do not occur.",
    "UE SMF PDU SESSION AUTHENTICATION COMMAND <EAP-request message A> Stop T3590 Start T3590 Stop T3590 Start T3590 PDU SESSION AUTHENTICATION COMPLETE <EAP-response message to EAP-request message A> PDU SESSION AUTHENTICATION COMMAND <EAP-request message B> PDU SESSION AUTHENTICATION COMPLETE <EAP-response message to EAP-request message B> PDU SESSION ESTABLISHMENT ACCEPT <EAP-success message> PDU SESSION ESTABLISHMENT REJECT <EAP-failure message> OR PDU SESSION AUTHENTICATION RESULT <EAP-success message> OR PDU SESSION RELEASE COMMAND <EAP-failure message> OR REMOTE UE REPORT RESPONSE <EAP-success message or EAP-failure message> OR Figure 6.3.1.1: PDU session authentication and authorization procedure The UE shall create a PDU SESSION AUTHENTICATION COMPLETE message when the upper layers provide an EAP-response message responding to the received EAP-request message. The UE shall set the EAP message IE of the PDU SESSION AUTHENTICATION COMPLETE message to the EAP- response message.",
    "The UE shall transport the PDU SESSION AUTHENTICATION COMPLETE message and the PDU session ID, using the NAS transport procedure as specified in subclause 5.4.5. Apart from this action, the authentication and authorization procedure initiated by the DN is transparent to the 5GSM layer of the UE. Upon receipt of a PDU SESSION AUTHENTICATION COMPLETE message, the SMF shall stop timer T3590 and provides the EAP message received in the EAP message IE of the PDU SESSION AUTHENTICATION COMPLETE message to the DN or handles it locally. PDU EAP result message transport procedure is initiated by the SMF if the PDU session authentication and authorization procedure is performed after the PDU session is established and the DN authentication of the UE completes successfully. In order to initiate the PDU EAP result message transport procedure, the SMF shall create a PDU SESSION AUTHENTICATION RESULT message.",
    "The SMF shall set the PTI IE of the PDU SESSION AUTHENTICATION RESULT message to \"No procedure transaction identity assigned\". The SMF shall set the EAP message IE of the PDU SESSION AUTHENTICATION RESULT message to the EAP- success message provided by the DN. The SMF shall send the PDU SESSION AUTHENTICATION RESULT message. Upon receipt of a PDU SESSION AUTHENTICATION RESULT message and a PDU session ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE passes to the upper layers the EAP message received in the EAP message IE of the PDU SESSION AUTHENTICATION RESULT message. Apart from this action, the authentication and authorization procedure initiated by the DN is transparent to the 5GSM layer of the UE.",
    "The purpose of the network-requested PDU session modification procedure is to enable the network to modify a PDU session, re-negotiate header compression configuration associated to a PDU session, convey a port management information container, to trigger EAS rediscovery, provide updated DNS server address(es) due to the newly selected local DNS server or the newly selected EASDF, provide updated ECS configuration information, remove joined UE from one or more multicast MBS sessions associated with a PDU session, update ATSSS parameters (e.g. ATSSS rules), update the MBS service area or the security information of multicast MBS session that the UE has joined or to inform about the result of service-level AA procedure or C2 authorization for UAS services. b) if the PDU session is a single access PDU session: - the UE should re-initiate a UE-requested PDU session establishment procedure as specified in subclause The following abnormal cases can be identified: a) Expiry of timer T3591.",
    "On the first expiry of the timer T3591, the SMF shall resend the PDU SESSION MODIFICATION COMMAND message and shall reset and restart timer T3591. This retransmission is repeated four times, i.e. on the fifth expiry of timer T3591, the SMF shall abort the procedure and enter the state PDU SESSION ACTIVE. The SMF may continue to use the previous configuration of the PDU session or initiate the network-requested PDU session release procedure. If the SMF decides to continue to use the previous configuration of the PDU session and i) the Authorized QoS rules IE is included in the PDU SESSION MODIFICATION COMMAND message, the SMF may mark the corresponding authorized QoS rule(s) of the PDU session as to be synchronised with the UE; and ii) the Authorized QoS flow descriptions IE is included in the PDU SESSION MODIFICATION COMMAND message, the SMF may mark the corresponding authorized QoS flow description(s) of the PDU session as to be synchronised with the UE. b) Void.",
    "c) Collision of UE-requested PDU session release procedure and network-requested PDU session modification procedure. If the SMF receives a PDU SESSION RELEASE REQUEST message during the network-requested PDU session modification procedure, and the PDU session indicated in the PDU SESSION RELEASE REQUEST message is the PDU session that the SMF had requested to modify, the SMF shall abort the PDU session modification procedure and proceed with the UE-requested PDU session release procedure. d) Collision of UE-requested PDU session modification procedure and network-requested PDU session modification procedure.",
    "If the network receives a PDU SESSION MODIFICATION REQUEST message during the network-requested PDU session modification procedure, and the PDU session indicated in the PDU SESSION MODIFICATION REQUEST message is the PDU session that the network had requested to modify, the network shall: i) if the received PDU SESSION MODIFICATION REQUEST message includes the URSP rule enforcement reports IE, ignore the PDU SESSION MODIFICATION REQUEST message received in the state PDU SESSION MODIFICATION PENDING except for the URSP rule enforcement reports IE and proceed with the network-requested PDU session modification procedure; or ii) otherwise, ignore the PDU SESSION MODIFICATION REQUEST message received in the state PDU SESSION MODIFICATION PENDING and proceed with the network-requested PDU session modification procedure as if no PDU SESSION MODIFICATION REQUEST message was received from the UE. e) 5G access network cannot forward the message.",
    "If the SMF determines based on content of the n2SmInfo attribute specified in 3GPP TS 29.502 [20A] that the DL NAS TRANSPORT message carrying the PDU SESSION MODIFICATION COMMAND message was not forwarded to the UE by the 5G access network, then the SMF shall abort the procedure and enter the state PDU SESSION ACTIVE. f) 5G access network cannot forward the message due to handover. If the SMF determines based on content of the n2SmInfo attribute specified in 3GPP TS 29.502 [20A] that the DL NAS TRANSPORT message carrying the PDU SESSION MODIFICATION COMMAND message was not forwarded to the UE by the 5G access network due to handover, then the SMF shall abort the procedure and enter the state PDU SESSION ACTIVE.",
    "The SMF may re-initiate, up to a pre-configured number of times, the network-requested PDU session modification procedure when the SMF detects that the handover is completed successfully or has failed or at the expiry of the configured guard timer as specified in 3GPP TS 23.502 [9]. g) Collision of re-establishment of the user-plane resources and network-requested PDU session modification procedure for the same PDU session.",
    "If the SMF receives an indication from the AMF to re-establish the user-plane resources during the network- requested PDU session modification procedure for the same PDU session, the network shall abort the network- requested PDU session modification procedure and proceed with re-establishment of the user-plane resources for the PDU session as specified in 3GPP TS 29.502 [20A] subclause 5.2.2.3.2.2. NOTE: After the completion of re-establishment of the user-plane resources for the PDU session, the SMF can re- initiate the network-requested PDU session modification procedure for the PDU session. h) Collision of UE-requested PDU session establishment procedure and network-requested PDU session modification procedure.",
    "If the network receives a PDU SESSION ESTABLISHMENT REQUEST message with request type set to \"existing PDU session\" or \"existing emergency PDU session\" during the network-requested PDU session modification procedure, and the PDU session ID indicated in the PDU SESSION ESTABLISHMENT REQUEST message is the PDU session that the network had requested to modify, the network shall abort the network-requested PDU session modification procedure and proceed with the UE-requested PDU session establishment procedure. The purpose of the network-requested PDU session release procedure is to enable the network to release a PDU session or the user-plane resources on a single access of an MA PDU session. If the PDU SESSION RELEASE COMMAND message was sent along the N1 SM delivery skip allowed indication towards AMF, then upon receipt of an indication that N1 SM delivery was skipped, the SMF shall stop timer T3592 and shall consider the PDU session as released.",
    "The purpose of the UE-requested PDU session establishment procedure is to establish a new PDU session with a DN, to perform handover of an existing PDU session between 3GPP access and non-3GPP access, to transfer an existing PDN connection in the EPS to the 5GS, to transfer an existing PDN connection in an untrusted non-3GPP access connected to the EPC to the 5GS, or to establish an MA PDU session to support ATSSS (see 3GPP TS 24.193 [13B]), or to relay the service associated with the RSC for 5G ProSe layer-3 UE-to-network relay (see 3GPP TS 24.554 [19E]). If accepted by the network, the PDU session enables exchange of PDUs between the UE and the DN.",
    "The UE shall not request a PDU session establishment: a) for an LADN, if the DNN used for that LADN is included in the LADN information IE and the UE is located outside the LADN service area indicated in the LADN information IE; a1) for an LADN, if the DNN used for that LADN is included in the Extended LADN information IE and there is no S-NSSAI used for PDU session establishment; a2) for an LADN, if the DNN used for that LADN is included in the Extended LADN information IE and the S- NSSAI used for PDU session establishment is not associated with that LADN; a3) for an LADN, if the DNN and the S-NSSAI used for that LADN are included in the Extended LADN information IE and the UE is located outside the LADN service area indicated in the Extended LADN information IE; b) to transfer a PDU session from non-3GPP access to 3GPP access when the 3GPP PS data off UE status is \"activated\" and the UE is not using the PDU session to send uplink IP packets for any of the 3GPP PS data off exempt services (see subclause 6.2.10); c) when the UE is in NB-N1 mode, the UE has indicated preference for user plane CIoT 5GS optimization, the network has accepted the use of user plane CIoT 5GS optimization for the UE, and the number of PDU sessions that currently has user-plane resources established equals to the UE's maximum number of supported user-plane resources; d) to transfer a PDU session from 3GPP access to non-3GPP access when the UE has indicated preference for control plane CIoT 5GS optimization, the network has accepted the use of control plane CIoT 5GS optimization for the UE, and the Control plane only indication IE was received in the PDU SESSION ESTABLISHMENT ACCEPT message; e) to transfer a PDU session from the non-3GPP access to the 3GPP access when the UE is in NB-N1 mode, the UE has indicated preference for user plane CIoT 5GS optimization, the network has accepted the use of user plane CIoT 5GS optimization for the UE, and the number of PDU sessions that currently has user-plane resources established equals to the UE's maximum number of supported user-plane resources; f) associated to an S-NSSAI when the UE is not in the NS-AoS of the S-NSSAI; or g) associated to an S-NSSAI included in the partially allowed NSSAI when the current TA is not in the list of TAs where the S-NSSAI is allowed.",
    "network If the 5GSM cause value is different from #26 \"insufficient resources\", #28 \"unknown PDU session type\", #39 \"reactivation requested\", #46 \"out of LADN service area\", #50 \"PDU session type IPv4 only allowed\", #51 \"PDU session type IPv6 only allowed\", #54 \"PDU session does not exist\", #57 \"PDU session type IPv4v6 only allowed\", #58 \"PDU session type Unstructured only allowed\", #61 \"PDU session type Ethernet only allowed\", #67 \"insufficient resources for specific slice and DNN\", #68 \"not supported SSC mode\", and #69 \"insufficient resources for specific slice\", #86 \"UAS services not allowed\", and #33 \"requested service option not subscribed\" upon sending PDU SESSION ESTABLISHMENT REQUEST to establish an MA PDU session, and the Back-off timer value IE is included, the UE shall behave as follows: (if the UE is a UE configured for high priority access in selected PLMN or SNPN, exceptions are specified in subclause 6.2.12): a) if the timer value indicates neither zero nor deactivated and: 1) if the UE provided a DNN and S-NSSAI to the network during the PDU session establishment and the 5GSM cause value is different from #27 \"missing or unknown DNN\", the UE shall start the back-off timer with the value provided in the Back-off timer value IE for the PDU session establishment procedure and: i) in a PLMN, [PLMN, DNN, (mapped) HPLMN S-NSSAI] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN and (mapped) HPLMN S- NSSAI in the current PLMN, until the back-off timer expires, the UE is switched off, or the USIM is removed; or ii) in an SNPN, [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, (mapped) subscribed SNPN S-NSSAI] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN and (mapped) subscribed SNPN S-NSSAI in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the back-off timer expires, the UE is switched off, the USIM is removed, or the selected entry of the \"list of subscriber data\" is updated; 2) if the UE provided a DNN to the network during the PDU session establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", the UE shall start the back-off timer with the value provided in the Back- off timer value IE for the PDU session establishment procedure and: i) in a PLMN, [PLMN, DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current PLMN, until the back-off timer expires, the UE is switched off, or the USIM is removed; or ii) in an SNPN, [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the back-off timer expires, the UE is switched off, the USIM is removed, or the selected entry of the \"list of subscriber data\" is updated; 3) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to the network during the PDU session establishment and the 5GSM cause value is different from #27 \"missing or unknown DNN\", it shall start the back-off timer accordingly for the PDU session establishment procedure and: i) in a PLMN, [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI] combination.",
    "Dependent on the combination, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI] combination in the current PLMN, until the back-off timer expires, the UE is switched off, or the USIM is removed; or ii) in an SNPN, [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed SNPN S-NSSAI] or [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI] combination.",
    "Dependent on the combination, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed SNPN S-NSSAI] or [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI] combination in the current PLMN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the back-off timer expires, the UE is switched off, the USIM is removed or the selected entry of the \"list of subscriber data\" is updated; or 4) if the UE did not provide a DNN to the network during the PDU session establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", it shall start the back-off timer accordingly for the PDU session establishment procedure and: i) in a PLMN, [PLMN, no DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same [PLMN, no DNN] in the current PLMN, until the back-off timer expires, the UE is switched off, or the USIM is removed; or ii) in an SNPN, [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN] in the current PLMN, using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the back-off timer expires, the UE is switched off, the USIM is removed or the selected entry of the \"list of subscriber data\" is updated; b) if the timer value indicates that this timer is deactivated and: 1) if the UE provided a DNN and S-NSSAI to the network during the PDU session establishment and the 5GSM cause value is different from #27 \"missing or unknown DNN\", the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for: i) in a PLMN, the same DNN and (mapped) HPLMN S-NSSAI in the current PLMN, until the UE is switched off, or the USIM is removed; or ii) in an SNPN, the same DNN and (mapped) subscribed SNPN S-NSSAI in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the UE is switched off, the USIM is removed, or the selected entry of the \"list of subscriber data\" is updated; 2) if the UE provided a DNN to the network during the PDU session establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for: i) in a PLMN, the same DNN in the current PLMN, until the UE is switched off, or the USIM is removed; or ii) in an SNPN, the same DNN in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the UE is switched off, the USIM is removed, or the selected entry of the \"list of subscriber data\" is updated; 3) if the UE did not provide a DNN or S-NSSAI or any of the two parameters to the network during the PDU session establishment and the 5GSM cause value is different from #27 \"missing or unknown DNN\", the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for: i) in a PLMN, the same [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI] combination in the current PLMN, until the UE is switched off, or the USIM is removed; or ii) in an SNPN, the same [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed SNPN S-NSSAI] or [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI] combination in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the UE is switched off, the USIM is removed, or the selected entry of the \"list of subscriber data\" is updated; or 4) if the UE did not provide a DNN to the network during the PDU session establishment and the 5GSM cause value is #27 \"missing or unknown DNN\", the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for: i) in a PLMN, the same [PLMN, no DNN] in the current PLMN, until the UE is switched off, or the USIM is removed; or ii) in an SNPN, the same [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN] in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until the UE is switched off, the USIM is removed, or the selected entry of the \"list of subscriber data\" is updated; and c) if the timer value indicates zero and the 5GSM cause value is different from #27 \"missing or unknown DNN\", the UE may send another PDU SESSION ESTABLISHMENT REQUEST message for: 1) in a PLMN, the same combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI], [PLMN, DNN, no S- NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI], or [PLMN, no DNN, no S-NSSAI] in the current PLMN.",
    "If the timer value indicates zero and the 5GSM cause value is #27 \"missing or unknown DNN\", the UE may send another PDU SESSION ESTABLISHMENT REQUEST message for the same combination of [PLMN, DNN], or [PLMN, no DNN] in the current PLMN; or 2) in an SNPN, the same combination of [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, (mapped) subscribed SNPN S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed S-NSSAI], or [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI] in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription.",
    "If the timer value indicates zero and the 5GSM cause value is #27 \"missing or unknown DNN\", the UE may send another PDU SESSION ESTABLISHMENT REQUEST message for the same combination of [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN], or [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN] in the current SNPN using the selected entry of the \"list of subscriber data\" or selected PLMN subscription. If the Back-off timer value IE is not included, then the UE shall ignore the Re-attempt indicator IE provided by the network in the PDU SESSION ESTABLISHMENT REJECT message, if any.",
    "a) Additionally, if the 5GSM cause value is #8 \"operator determined barring\", #32 \"service option not supported\", #33 \"requested service option not subscribed\" upon sending PDU SESSION ESTABLISHMENT REQUEST not to establish an MA PDU session, or #70 \"missing or unknown DNN in a slice\", then: 1) the UE not operating in SNPN access operation mode shall proceed as follows: i) if the UE is registered in the HPLMN or in a PLMN that is within the EHPLMN list, the UE shall behave as described above in the present subclause using the configured SM Retry Timer value as specified in 3GPP TS 24.368 [17] or in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22], if available, as back-off timer value; and NOTE 1: The way to choose one of the configured SM Retry Timer values for back-off timer value is up to UE implementation if the UE is configured with: - an SM Retry Timer value in ME as specified in 3GPP TS 24.368 [17]; and - an SM Retry Timer value in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22].",
    "ii) otherwise, if the UE is not registered in its HPLMN or in a PLMN that is within the EHPLMN list, or if the SM Retry Timer value is not configured, the UE shall behave as described above in the present subclause, using the default value of 12 minutes for the back-off timer; or 2) the UE operating in SNPN access operation mode shall proceed as follows: i) if: A) the SM Retry Timer value for the current SNPN as specified in 3GPP TS 24.368 [17] is available; or B) the UE used the USIM for registration to the current SNPN and the SM Retry Timer value in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22] is available; then the UE shall behave as described above in the present subclause using the configured SM Retry Timer value as back-off timer value; or NOTE 2: The way to choose one of the configured SM Retry Timer values for back-off timer value is up to UE implementation if both conditions in bullets A) and B) above are satisfied.",
    "ii) otherwise, the UE shall behave as described above in the present subclause, using the default value of 12 minutes for the back-off timer. b) For 5GSM cause value #27 \"missing or unknown DNN\", then: 1) the UE not operating in SNPN access operation mode shall proceed as follows: i) if the UE is registered in the HPLMN or in a PLMN that is within the EHPLMN list, the UE shall start the back-off timer with the configured SM Retry Timer value as specified in 3GPP TS 24.368 [17] or in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22], if available, as back-off timer value for the PDU session establishment procedure and the [PLMN, DNN] or [PLMN, no DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current PLMN, until the back-off timer expires, the UE is switched off or the USIM is removed; and NOTE 3: The way to choose one of the configured SM Retry Timer values for back-off timer value is up to UE implementation if the UE is configured with: - an SM Retry Timer value in ME as specified in 3GPP TS 24.368 [17]; and - an SM Retry Timer value in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22]. ii) otherwise, if the UE is not registered in its HPLMN or in a PLMN that is within the EHPLMN list, or if the SM Retry Timer value is not configured, the UE shall start the back-off timer with the default value of 12 minutes as back-off timer value for the PDU session establishment procedure and the [PLMN, DNN] or [PLMN, no DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current PLMN, until the back-off timer expires, the UE is switched off or the USIM is removed; or 2) the UE operating in SNPN access operation mode shall proceed as follows: i) if: A) the SM Retry Timer value for the current SNPN as specified in 3GPP TS 24.368 [17] is available; or B) the UE used the USIM for registration to the current SNPN and the SM Retry Timer value in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22] is available; then: the UE shall start the back-off timer with the configured SM Retry Timer value as back-off timer value for the PDU session establishment procedure and the [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN] or [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current SNPN using the selected entry in the \"list of subscriber data\" or selected PLMN subscription, until the back-off timer expires, the UE is switched off, the UICC containing the USIM is removed or the selected entry of the \"list of subscriber data\" is updated; or NOTE 4: The way to choose one of the configured SM Retry Timer values for back-off timer value is up to UE implementation if both conditions in bullets A) and B) above are satisfied. ii) otherwise: - the UE shall start the back-off timer with the default value of 12 min as back-off timer value for the PDU session establishment procedure and the [SNPN, selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN] or [SNPN, selected entry in the \"list of subscriber data\" or selected PLMN subscription, no DNN] combination.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message for the same DNN in the current SNPN using the selected entry of the \"list of subscriber data\", until the back-off timer expires, the UE is switched off, the UICC containing the USIM is removed or the selected entry of the \"list of subscriber data\" is updated; and c) For 5GSM cause values different from #8 \"operator determined barring\", #27 \"missing or unknown DNN\", #32 \"service option not supported\", #33 \"requested service option not subscribed\" and #70 \"missing or unknown DNN in a slice\", the UE behaviour regarding the start of a back-off timer is specified in subclause 6.2.12. The UE shall not stop any back-off timer: a) upon a PLMN or SNPN change; b) upon an inter-system change; or c) upon registration over another access type.",
    "If the network indicates that a back-off timer for the PDU session establishment procedure is deactivated, then it remains deactivated; a) upon a PLMN or SNPN change; b) upon an inter-system change; or c) upon registration over another access type. NOTE 5: This means the back-off timer can still be running or be deactivated for the given 5GSM procedure when the UE returns to the PLMN or SNPN or when it performs inter-system change back from S1 mode to N1 mode.",
    "Thus, the UE can still be prevented from sending another PDU SESSION ESTABLISHMENT REQUEST message for the combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI], [PLMN, DNN, no S-NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI], [PLMN, no DNN, no S-NSSAI], [PLMN, DNN], or [PLMN, no DNN] in the PLMN, or for the combination of [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, (mapped) subscribed S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S- NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN], or [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN] in the SNPN.",
    "If the back-off timer is started upon receipt of a PDU SESSION ESTABLISHMENT REJECT (i.e. the timer value was provided by the network, a configured value is available or the default value is used as explained above) or the back-off timer is deactivated, the UE behaves as follows: a) after a PLMN or SNPN change: 1) the UE may send a PDU SESSION ESTABLISHMENT REQUEST message for: i) in a PLMN, the combination of [new PLMN, DNN, (mapped) HPLMN S-NSSAI], [new PLMN, DNN, no S-NSSAI], [new PLMN, no DNN, (mapped) HPLMN S-NSSAI], or [new PLMN, no DNN, no S- NSSAI] in the new PLMN, if the back-off timer is not running and is not deactivated for the PDU session establishment procedure and the combination of [new PLMN, DNN, (mapped) HPLMN S-NSSAI], [new PLMN, DNN, no S-NSSAI], [new PLMN, no DNN, (mapped) HPLMN S-NSSAI], or [new PLMN, no DNN, no S-NSSAI]; or ii) in an SNPN, the combination of [new SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, (mapped) subscribed SNPN S-NSSAI], [new SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [new PLMN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed SNPN S-NSSAI], or [new SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI] in the new SNPN, if the back-off timer is not running and is not deactivated for the PDU session establishment procedure and the combination of [new SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, (mapped) subscribed SNPN S-NSSAI], [new SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [new SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed SNPN S-NSSAI], or [new SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI]; 2) as an implementation option, for the 5GSM cause value #8 \"operator determined barring\", #32 \"service option not supported\", #33 \"requested service option not subscribed\" and #70 \"missing or unknown DNN in a slice\", if the network does not include a Re-attempt indicator IE, the UE may decide not to automatically send another PDU SESSION ESTABLISHMENT REQUEST message for: i) in a PLMN, the same combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI], [PLMN, DNN, no S- NSSAI], [PLMN, no DNN, (mapped) HPLMN S-NSSAI], or [PLMN, no DNN, no S-NSSAI] using the same PDU session type if the UE is registered to a new PLMN which is in the list of equivalent PLMNs; or ii) in an SNPN, if the UE supports equivalent SNPNs, the same combination of [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, (mapped) subscribed SNPN S- NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed SNPN S-NSSAI], or [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI] using the same PDU session type and using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, if the UE is registered to a new SNPN which is in the list of equivalent SNPNs; and 3) as an implementation option, for the 5GSM cause value #27 \"missing or unknown DNN\", if the network does not include a Re-attempt indicator IE, the UE may decide not to automatically send another PDU SESSION ESTABLISHMENT REQUEST message for: i) in a PLMN, the same combination of [PLMN, DNN] or [PLMN, no DNN] using the same PDU session type if the UE is registered to a new PLMN which is in the list of equivalent PLMNs; or ii) in an SNPN, if the UE supports equivalent SNPNs, the same combination of [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN] or [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN] using the same PDU session type if the UE is registered to a new SNPN which is in the list of equivalent SNPNs; or b) if the network does not include the Re-attempt indicator IE to indicate whether re-attempt in S1 mode is allowed, or the UE ignores the Re-attempt indicator IE, e.g. because the Back-off timer value IE is not included, then: 1) if the UE is registered in its HPLMN or in a PLMN that is within the EHPLMN list and the back-off timer is running for the combination of [PLMN, DNN, (mapped) HPLMN S-NSSAI] or [PLMN, DNN, no S- NSSAI], the UE shall apply the configured SM_RetryAtRATChange value as specified in 3GPP TS 24.368 [17] or in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22], if available, to determine whether the UE may attempt a PDN connectivity procedure for the same [PLMN, DNN] combination in S1 mode.",
    "If the back-off timer is running for the combination of [PLMN, no DNN, (mapped) HPLMN S-NSSAI] or [PLMN, no DNN, no S-NSSAI], the same applies for the PDN connectivity procedure for the [PLMN, no DNN] combination in S1 mode accordingly; and NOTE 6: The way to choose one of the configured SM_RetryAtRATChange values for back-off timer value is up to UE implementation if the UE is configured with: - an SM_RetryAtRATChange value in ME as specified in 3GPP TS 24.368 [17]; and - an SM_RetryAtRATChange value in USIM file NASCONFIG as specified in 3GPP TS 31.102 [22].",
    "2) if the UE is not registered in its HPLMN or in a PLMN that is within the EHPLMN list, or if the NAS configuration MO as specified in 3GPP TS 24.368 [17] is not available and the value for inter-system change is not configured in the USIM file NASCONFIG, then the UE behaviour regarding a PDN connectivity procedure for the same [PLMN, DNN] or [PLMN, no DNN] combination in S1 mode is unspecified; and c) if the network includes the Re-attempt indicator IE indicating that re-attempt in an equivalent PLMN or SNPN is not allowed, then depending on the timer value received in the Back-off timer value IE, for: 1) in a PLMN, each combination of a PLMN from the equivalent PLMN list and the respective [DNN, (mapped) HPLMN S-NSSAI], [DNN, no S-NSSAI], [no DNN, (mapped) HPLMN S-NSSAI], or [no DNN, no S-NSSAI] combination, the UE shall start a back-off timer for the PDU session establishment procedure with the value provided by the network, or deactivate the respective back-off timer as follows: i) if the Re-attempt indicator IE additionally indicates that re-attempt in S1 mode is allowed, the UE shall start or deactivate the back-off timer for N1 mode only; and ii) otherwise, the UE shall start or deactivate the back-off timer for S1 and N1 mode; or 2) in a SNPN, if the UE supports equivalent SNPNs, each combination of a SNPN from the equivalent SNPN list and the respective [the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, (mapped) subscribed SNPN S-NSSAI], [the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI], [the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, (mapped) subscribed SNPN S-NSSAI], or [the selected entry of the \"list of subscriber data\" or selected PLMN subscription, no DNN, no S-NSSAI] combination, the UE shall start a back-off timer for the PDU session establishment procedure with the value provided by the network, or deactivate the respective back-off timer, for N1 mode.",
    "If the back-off timer for a [PLMN, DNN] or [PLMN, no DNN] combination, was started or deactivated in S1 mode upon receipt of PDN CONNECTIVITY REJECT message (see 3GPP TS 24.301 [15]) and the network indicated that re-attempt in N1 mode is allowed, then this back-off timer does not prevent the UE from sending a PDU SESSION ESTABLISHMENT REQUEST message in this PLMN for the same DNN, or without DNN, after inter-system change to N1 mode. If the network indicated that re-attempt in N1 mode is not allowed, the UE shall not send any PDU SESSION ESTABLISHMENT REQUEST message in this PLMN for the same DNN in combination with any S- NSSAI or without S-NSSAI, or in this PLMN without DNN in combination with any S-NSSAI or without S-NSSAI, after inter-system change to N1 mode until the timer expires, the UE is switched off or the USIM is removed. NOTE 7: The back-off timer is used to describe a logical model of the required UE behaviour.",
    "This model does not imply any specific implementation, e.g. as a timer or timestamp. NOTE 8: Reference to back-off timer in this section can either refer to use of timer T3396 or to use of a different packet system specific timer within the UE. Whether the UE uses T3396 as a back-off timer or it uses different packet system specific timers as back-off timers is left up to UE implementation. When the back-off timer is running or the timer is deactivated, the UE is allowed to initiate a PDU session establishment procedure if the procedure is for emergency services. If the 5GSM cause value is #28 \"unknown PDU session type\" and the PDU SESSION ESTABLISHMENT REQUEST message contained a PDU session type IE indicating a PDU session type, the UE shall ignore the Back-off timer value IE and Re-attempt indicator IE provided by the network, if any.",
    "The UE may send another PDU SESSION ESTABLISHMENT REQUEST message to establish a new PDU session with the PDU session type IE indicating another PDU session type, e.g. using another value which can be used for the rejected component in another route selection descriptor, if any, as specified in 3GPP TS 24.526 [19]. The behaviour of the UE for 5GSM cause value #28 also applies if the PDU session is a MA PDU Session. If the 5GSM cause value is #39 \"reactivation requested\", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any. NOTE 9: Further UE behaviour upon receipt of 5GSM cause value #39 is up to the UE implementation. If the 5GSM cause value is #46 \"out of LADN service area\", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any.",
    "If the UE is not located inside the LADN service area, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message or another PDU SESSION MODIFICATION REQUEST message except for indicating a change of 3GPP PS data off UE status for the LADN DNN provided by the UE during the PDU session establishment procedure until the LADN information for the specific LADN DNN or the extended LADN information for the specific LADN DNN and S-NSSAI is updated as described in subclause 5.4.4 and subclause 5.5.1. If the UE is not located inside the LADN service area, the UE shall not indicate the PDU session(s) for the LADN DNN provided by the UE during the PDU session establishment procedure in the Uplink data status IE included in the SERVICE REQUEST message until the LADN information for the specific LADN DNN or the extended LADN information for the specific LADN DNN and S-NSSAI is updated as described in subclause 5.4.4 and subclause 5.5.1. NOTE 10: Based on UE implementation, the UE locating inside the LADN service area can send another PDU SESSION ESTABLISHMENT REQUEST message or PDU SESSION MODIFICATION REQUEST message for the LADN DNN which was rejected with the 5GSM cause value #46 \"out of LADN service area\".",
    "NOTE 10A: If the UE does not receive a CONFIGURATION UPDATE COMMAND message with new LADN information within an implementation dependent time, the UE can request this information by initiating a registration procedure for mobility or periodic registration update (see subclause 5.5.1.3.2, item q). If the 5GSM cause value is #50 \"PDU session type IPv4 only allowed\", #51 \"PDU session type IPv6 only allowed\", #57 \"PDU session type IPv4v6 only allowed\", #58 \"PDU session type Unstructured only allowed\", or #61 \"PDU session type Ethernet only allowed\", the UE shall ignore the Back-off timer value IE provided by the network, if any. The UE shall evaluate the URSP rules if available as specified in 3GPP TS 24.526 [19].",
    "The UE shall not subsequently send another PDU SESSION ESTABLISHMENT REQUEST message for: a) in a PLMN, the same DNN (or no DNN, if no DNN was indicated by the UE) and the same (mapped) HPLMN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) to obtain a PDU session type different from the one allowed by the network until any of the following conditions is fulfilled: 1) the UE is registered to a new PLMN which was not in the list of equivalent PLMNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was received; 2) the UE is registered to a new PLMN which was in the list of equivalent PLMNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was received, and either the network did not include a Re- attempt indicator IE in the PDU SESSION ESTABLISHMENT REJECT message or the Re-attempt indicator IE included in the message indicated that re-attempt in an equivalent PLMN is allowed; 3) the UE is switched off; or 4) the USIM is removed; or b) in an SNPN, the same DNN (or no DNN, if no DNN was indicated by the UE) and the same (mapped) subscribed SNPN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE), using the selected entry of the \"list of subscriber data\" or selected PLMN subscription until any of the following conditions is fulfilled: 1) the UE is registered to a new SNPN which was not in the list of equivalent SNPNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was received; 2) the UE is registered to a new SNPN which was in the list of equivalent SNPNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was received, and either the network did not include a Re- attempt indicator IE in the PDU SESSION ESTABLISHMENT REJECT message or the Re-attempt indicator IE included in the message indicated that re-attempt in an equivalent SNPN is allowed; 3) the UE is switched off; 4) the USIM is removed; or 5) the selected entry of the \"list of subscriber data\" is updated.",
    "For the 5GSM cause values #50 \"PDU session type IPv4 only allowed\", #51 \"PDU session type IPv6 only allowed\", #57 \"PDU session type IPv4v6 only allowed\", #58 \"PDU session type Unstructured only allowed\", and #61 \"PDU session type Ethernet only allowed\", the UE shall ignore the value of the RATC bit in the Re-attempt indicator IE provided by the network, if any. NOTE 11: For the 5GSM cause values #50 \"PDU session type IPv4 only allowed\", #51 \"PDU session type IPv6 only allowed\", #57 \"PDU session type IPv4v6 only allowed\", #58 \"PDU session type Unstructured only allowed\", and #61 \"PDU session type Ethernet only allowed\", re-attempt in S1 mode for the same DNN (or no DNN, if no DNN was indicated by the UE) is only allowed using the PDU session type(s) indicated by the network. If the 5GSM cause value is #54 \"PDU session does not exist\", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any.",
    "If the PDU session establishment procedure is to perform handover of an existing PDU session between 3GPP access and non-3GPP access, the UE shall release locally the existing PDU session with the PDU session ID included in the PDU SESSION ESTABLISHMENT REJECT message. The UE may initiate another UE-requested PDU session establishment procedure with the request type set to \"initial request\" in the subsequent PDU SESSION ESTABLISHMENT REQUEST message to establish a PDU session with: a) in a PLMN, the same DNN (or no DNN, if no DNN was indicated by the UE) and the same (mapped) HPLMN S- NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE); or b) in an SNPN, the same DNN (or no DNN, if no DNN was indicated by the UE) and the same (mapped) subscribed SNPN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) using the selected entry of the \"list of subscriber data\" or selected PLMN subscription.",
    "NOTE 12: User interaction is necessary in some cases when the UE cannot re-establish the PDU session(s) automatically. If the 5GSM cause value is #68 \"not supported SSC mode\", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any. The UE shall evaluate the URSP rules if available as specified in 3GPP TS 24.526 [19].",
    "The UE shall not subsequently send another PDU SESSION ESTABLISHMENT REQUEST message for: a) in a PLMN, the same DNN (or no DNN, if no DNN was indicated by the UE) and the same (mapped) HPLMN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) using the same SSC mode or an SSC mode which was not included in the Allowed SSC mode IE until any of the following conditions is fulfilled: 1) the UE is registered to a new PLMN which was not in the list of equivalent PLMNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was received; 2) the SSC mode which is used to access to the DNN (or no DNN, if no DNN was indicated by the UE) and the (mapped) HPLMN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) is changed by the UE which subsequently requests a new SSC mode in the Allowed SSC mode IE or no SSC mode; 3) the UE is switched off; or 4) the USIM is removed; or b) in an SNPN, the same DNN (or no DNN, if no DNN was indicated by the UE) and the same subscribed SNPN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) using the same SSC mode or an SSC mode which was not included in the Allowed SSC mode IE, using the selected entry of the \"list of subscriber data\" or selected PLMN subscription until any of the following conditions is fulfilled: 1) the UE is registered to a new SNPN which was not in the list of equivalent SNPNs at the time when the PDU SESSION ESTABLISHMENT REJECT message was received; 2) the SSC mode which is used to access to the DNN (or no DNN, if no DNN was indicated by the UE) and the (mapped) subscribed SNPN S-NSSAI (or no S-NSSAI, if no S-NSSAI was indicated by the UE) is changed by the UE which subsequently requests a new SSC mode in the Allowed SSC mode IE or no SSC mode; 3) the UE is switched off; 4) the USIM is removed, or 5) the selected entry of the \"list of subscriber data\" is updated.",
    "If the UE receives the 5GSM cause value is #33 \"requested service option not subscribed\" upon sending PDU SESSION ESTABLISHMENT REQUEST to establish an MA PDU session, the UE shall ignore the Back-off timer value IE and Re-attempt indicator IE provided by the network, if any. The UE shall evaluate URSP rules, if available, as specified in 3GPP TS 24.526 [19] and the UE may send PDU SESSION ESTABLISHMENT REQUEST after evaluating those URSP rules.",
    "If the 5GSM cause value is #86 \"UAS services not allowed\", the UE shall ignore the Back-off timer value IE and Re- attempt indicator IE provided by the network, if any, and shall behave as specified in subcluase 6.4.1.4.1. Upon receipt of an indication from 5GMM sublayer that the 5GSM message was not forwarded because the DNN is not supported or not subscribed in a slice along with a PDU SESSION ESTABLISHMENT REQUEST message with the PDU session ID IE set to the PDU session ID of the PDU session, the UE shall stop timer T3580, shall abort the procedure and shall behave as follows: a) if the timer value indicates neither zero nor deactivated, the UE shall start the back-off timer with the value received from the 5GMM sublayer for the PDU session establishment procedure and: 1) in a PLMN, the [PLMN, DNN, S-NSSAI] combination or the [PLMN, DNN, no S-NSSAI] combination, if no S-NSSAI was provided during the PDU session establishment.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message in the PLMN for the same DNN and the same S-NSSAI that were sent by the UE, or for the same DNN and no S-NSSAI if S-NSSAI that was not sent by the UE, until: i) the back-off timer expires; ii) the UE is switched off; iii) the USIM is removed; or iv) the DNN is included in the LADN information or extended LADN information and the network provides the LADN information or extended LADN information during the registration procedure or the generic UE configuration update procedure; or 2) in an SNPN, the [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, S-NSSAI] combination or the [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI] combination, if no S-NSSAI was provided during the PDU session establishment.",
    "The UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message in the SNPN for the same DNN and the same S-NSSAI that were sent by the UE, or for the same DNN and no S-NSSAI if S-NSSAI that was not sent by the UE, using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until: i) the back-off timer expires; ii) the UE is switched off; iii) the USIM is removed; or iv) the selected entry of the \"list of subscriber data\" is updated; or v) the DNN is included in the LADN information or extended LADN information and the network provides the LADN information or extended LADN information during the registration procedure or the generic UE configuration update procedure; b) if the timer value is not received from the 5GMM sublayer or the timer value indicates that this timer is deactivated, the UE shall not send another PDU SESSION ESTABLISHMENT REQUEST message 1) in the PLMN for the same DNN and the same S-NSSAI that were sent by the UE, or for the same DNN and no S-NSSAI if S-NSSAI that was not sent by the UE, until: i) the UE is switched off; ii) the USIM is removed; or iii) the DNN is included in the LADN information or extended LADN information and the network provides the LADN information or extended LADN information during the registration procedure or the generic UE configuration update procedure; and 2) in the SNPN, for the same DNN and the same S-NSSAI that were sent by the UE, or for the same DNN and no S-NSSAI if S-NSSAI that was not sent by the UE, using the selected entry of the \"list of subscriber data\" or selected PLMN subscription, until: i) the UE is switched off; ii) the USIM is removed; iii) the selected entry of the \"list of subscriber data\" is updated; or iii) the DNN is included in the LADN information or extended LADN information and the network provides the LADN information or extended LADN information during the registration procedure or the generic UE configuration update procedure; and c) if the timer value indicates zero, the UE may send another PDU SESSION ESTABLISHMENT REQUEST message for: 1) in a PLMN, the same combination of [PLMN, DNN, S-NSSAI], [PLMN, DNN, no S-NSSAI] in the current PLMN; or 2) in an SNPN, the same combination of [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, S-NSSAI], [SNPN, the selected entry of the \"list of subscriber data\" or selected PLMN subscription, DNN, no S-NSSAI] in the current SNPN.",
    "The following abnormal cases can be identified: a) If the received request type is \"initial emergency request\" and there is an existing emergency PDU session for the UE, regardless whether the PDU session ID in the PDU SESSION ESTABLISHMENT REQUEST message is identical to the PDU session ID of the existing PDU session, the SMF shall locally release the existing emergency PDU session and proceed the new PDU SESSION ESTABLISHMENT REQUEST message b) The information for the PDU session authentication and authorization by the external DN in the SM PDU DN request container IE is not compliant with local policy and user's subscription data If the PDU session being established is a non-emergency PDU session, the request type is not set to \"existing PDU session\", the PDU session authentication and authorization by the external DN is required due to local policy and user's subscription data and the information for the PDU session authentication and authorization by the external DN in the SM PDU DN request container IE is not compliant with the local policy and user's subscription data, the SMF shall reject the PDU session establishment request including the 5GSM cause #29 \"user authentication or authorization failed\", in the PDU SESSION ESTABLISHMENT REJECT message.",
    "c) UE-requested PDU session establishment with request type set to \"initial request\" for an existing PDU session: If the SMF receives a PDU SESSION ESTABLISHMENT REQUEST message with a PDU session ID identical to the PDU session ID of an existing PDU session and with request type set to \"initial request\", the SMF shall locally release the existing PDU session and proceed with the PDU session establishment procedure. d) UE-requested PDU session establishment with request type \"existing PDU session\" or \"existing emergency PDU session\" for a PDU session that does not exist: If the SMF receives a PDU SESSION ESTABLISHMENT REQUEST message with request type set to \"existing PDU session\" or \"existing emergency PDU session\", and the SMF does not have any information about that PDU session, then the SMF shall reject the PDU session establishment procedure with the 5GSM cause set to #54 \"PDU session does not exist\" in the PDU SESSION ESTABLISHMENT REJECT message.",
    "e) 5G access network cannot forward the message: If the SMF determines based on content of the n2SmInfo attribute specified in 3GPP TS 29.502 [20A] that the DL NAS TRANSPORT message carrying the PDU SESSION ESTABLISHMENT ACCEPT was not forwarded to the UE by the 5G access network, then the SMF shall reject the PDU session establishment procedure with the 5GSM cause set to #26 \"insufficient resources\" in the PDU SESSION ESTABLISHMENT REJECT message. In order to initiate the UE-requested PDU session modification procedure, the UE shall create a PDU SESSION MODIFICATION REQUEST message. The UE shall allocate a PTI value currently not used and shall set the PTI IE of the PDU SESSION MODIFICATION REQUEST message to the allocated PTI value.",
    "The UE shall not perform the UE-requested PDU session modification procedure for an emergency PDU session, except for a procedure initiated according to subclause 6.4.2.1, item e) only, and for the error cases described in subclause 6.4.1.3 and subclause 6.3.2.3. The UE shall not perform the UE-requested PDU session modification procedure for a PDU session for LADN when the UE is located outside the LADN service area except for indicating a change of 3GPP PS data off UE status. If the UE requests a specific QoS handling and the PDU session is not associated with the control plane only indication, the UE shall include the Requested QoS rules IE indicating requested QoS rules or the Requested QoS flow descriptions IE indicating requested QoS flow descriptions or both for the specific QoS handling. The Requested QoS rules IE includes the packet filters which describe the service data flows requested by the UE.",
    "The specific QoS parameters requested by the UE are specified in the Requested QoS flow descriptions IE. If the UE requests the network to bind specific service data flows to a dedicated QoS flow, the UE shall create a new QoS rule by setting the rule operation code to \"Create new QoS rule\" and shall set the segregation bit to \"Segregation requested\" for the corresponding QoS rule in the Requested QoS rules IE. The UE shall set the QRI values to \"no QoS rule identifier assigned\" in the Requested QoS rules IE, if the QoS rules are newly created; otherwise, the UE shall set the QRI values to those of the existing QoS rules for which the specific QoS handling applies. The UE shall set the QFI values to \"no QoS flow identifier assigned\" in the Requested QoS flow descriptions IE, if the QoS flow descriptions are newly created; otherwise, the UE shall set the QFI values to the QFIs of the existing QoS flow descriptions for which the specific QoS handling applies.",
    "The UE shall not request to create more than one QoS flow in a UE-requested PDU session modification procedure. If the SMF receives a PDU SESSION MODIFICATION REQUEST message with a Requested QoS rules IE containing more than one QoS rule with the rule operation code set to \"Create new QoS rule\", the SMF shall assign the same QFI to all the QoS rules which are created. If the UE requests to join or leave one or more multicast MBS sessions associated with a PDU session, the UE shall include the Requested MBS container IE in the PDU SESSION MODIFICATION REQUEST message and shall set the MBS operation to \"Join multicast MBS session\" for the join case or to \"Leave MBS session\" for the leave case.",
    "The UE shall include the multicast MBS session information(s) and shall set the Type of multicast MBS session ID for each of the multicast MBS session information to either \"Temporary Mobile Group Identity (TMGI)\" or \"Source specific IP multicast address\" depending on the type of the multicast MBS session ID available in the UE. Then the remaining values of each of the multicast MBS session informations shall be set as following: a) if the Type of multicast MBS session ID is set to \"Temporary Mobile Group Identity (TMGI)\", the UE shall set the multicast MBS session ID to the TMGI; or b) if the Type of multicast MBS session ID is set to \"Source specific IP multicast address for IPv4\" or \" Source specific IP multicast address for IPv6\", the UE shall set the Source IP address information and the Destination IP address information to the corresponding values.",
    "The UE should not request to join a multicast MBS session for local MBS service if neither current TAI nor CGI of the current cell is part of the MBS service area(s) of the multicast MBS session, if the UE has valid information of the MBS service area(s) of the multicast MBS session. NOTE 1: The UE obtains the details of the multicast MBS session ID(s) e.g,TMGI, Source IP address information and Destination IP address information as a pre-configuration in the UE or during the MBS service announcement which is out of scope of this specification. Pre-configuration can be provided in one or more of the following ways: a) in a UE implementation-specific way (e.g. factory configuration); b) in the USIM (see EF5MBSUECONFIG file in 3GPP TS 31.102 [22]); or c) in the UE pre-configuration MO for MBS (see 3GPP TS 24.575 [65]).",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the PDU session is of \"IPv4\", \"IPv6\", \"IPv4v6\", or \"Ethernet\" PDU session type, the PDU session is not associated with the control plane only indication: a) the UE is performing the PDU session modification procedure to indicate the support of reflective QoS and the UE has not previously successfully performed the UE-requested PDU session modification to provide this indication, the UE shall set the RQoS bit to \"Reflective QoS supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; or b) the UE is performing the PDU session modification procedure to indicate that reflective QoS is not supported and the UE has not previously successfully performed the UE-requested PDU session modification to provide this indication, the UE shall set the RQoS bit to \"Reflective QoS not supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.",
    "If the UE is performing the PDU session modification procedure to revoke the previously indicated support of reflective QoS and the PDU session is not associated with the control plane only indication, the UE shall set the RQoS bit to \"Reflective QoS not supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message. The UE shall not indicate support for reflective QoS for this PDU Session for the remaining lifetime of the PDU Session. NOTE 2: The determination to revoke the usage of reflective QoS by the UE for a PDU session is implementation dependent.",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the PDU session is of \"IPv6\" or \"IPv4v6\" PDU session type, the PDU session is not associated with the control plane only indication: a) the UE is performing the PDU session modification procedure to indicate the support of Multi-homed IPv6 PDU session and the UE has not previously successfully performed the UE-requested PDU session modification to provide this indication, the UE shall set the MH6-PDU bit to \"Multi-homed IPv6 PDU session supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; or b) the UE is performing the PDU session modification procedure to indicate that Multi-homed IPv6 PDU session is not supported and the UE has not previously successfully performed the UE-requested PDU session modification to provide this indication, the UE shall set the MH6-PDU bit to \"Multi-homed IPv6 PDU session not supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the PDU session is of \"IPv4\", \"IPv6\", \"IPv4v6\", or \"Ethernet\" PDU session type, the PDU session is not associated with the control plane only indication, the UE supports more than 16 packet filters for this PDU session, and the UE has not previously successfully performed the UE-requested PDU session modification to provide this indication, the UE shall indicate the maximum number of packet filters supported for the PDU session in the Maximum number of supported packet filters IE of the PDU SESSION MODIFICATION REQUEST message.",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the PDU session is not associated with the control plane only indication, and the UE has not previously successfully performed the UE-requested PDU session modification to include the Integrity protection maximum data rate IE in the PDU SESSION MODIFICATION REQUEST message, the UE shall include the Integrity protection maximum data rate IE in the PDU SESSION MODIFICATION REQUEST message.",
    "If the UE is performing the PDU session modification procedure a) to request the deletion of a non-default QoS rule due to errors in QoS operations or packet filters; b) to request the deletion of a QoS flow description due to errors in QoS operations; or c) to request the deletion of a mapped EPS bearer context due to errors in mapped EPS bearer operation, TFT operation or packet filters, the UE shall include the 5GSM cause IE in the PDU SESSION MODIFICATION REQUEST message as described in subclauses 6.3.2.3, 6.3.2.4 and 6.4.1.3. When the UE-requested PDU session modification procedure is used to indicate a change of 3GPP PS data off UE status for a PDU session, the UE shall include the Extended protocol configuration options IE in the PDU SESSION MODIFICATION REQUEST message and setting the 3GPP PS data off UE status.",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the PDU session is not associated with the control plane only indication, the UE requests the PDU session to be an always-on PDU session in the 5GS and the UE has not previously successfully performed the UE-requested PDU session modification to request this, the UE shall include the Always-on PDU session requested IE and set the value of the IE to \"Always-on PDU session requested\" in the PDU SESSION MODIFICATION REQUEST message. If the UE supports transfer of port management information containers, the UE shall set the TPMIC bit to \"Transfer of port management information containers supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.",
    "If a port management information container needs to be delivered (see 3GPP TS 23.501 [8] and 3GPP TS 23.502 [9]), the UE shall include a Port management information container IE in the PDU SESSION MODIFICATION REQUEST message. To request re-negotiation of IP header compression configuration, the UE shall include the IP header compression configuration IE in the PDU SESSION MODIFICATION REQUEST message if the network indicated \"Control plane CIoT 5GS optimization supported\" and \"IP header compression for control plane CIoT 5GS optimization supported\" in the 5GS network support feature support IE. To request re-negotiation of Ethernet header compression configuration, the UE shall include the Ethernet header compression configuration IE in the PDU SESSION MODIFICATION REQUEST message if the network indicated \"Control plane CIoT 5GS optimization supported\" and \"Ethernet header compression for control plane CIoT 5GS optimization supported\" in the 5GS network support feature support IE.",
    "After an inter-system change from S1 mode to N1 mode, if: a) the UE is operating in single-registration mode in the network supporting N26 interface; b) the PDU session type value of the PDU session type IE is set to \"IPv4\", \"IPv6\" or \"IPv4v6\"; c) the UE indicates \"Control plane CIoT 5GS optimization supported\" and \"IP header compression for control plane CIoT 5GS optimization supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and d) the network indicates \"Control plane CIoT 5GS optimization supported\" and \"IP header compression for control plane CIoT 5GS optimization supported\" in the 5GS network support feature IE of the REGISTRATION ACCEPT message; the UE shall initiate the PDU session modification procedure to negotiate the IP header compression configuration and include the IP header compression configuration IE in the PDU SESSION MODIFICATION REQUEST message.",
    "The UE shall include the Service-level-AA container IE in the PDU SESSION MODIFICATION REQUEST message, when requesting to modify an established PDU session for C2 communication. In the Service-level-AA container IE, the UE shall include: a) the service-level device ID with the value set to the CAA-level UAV ID of the UE; and b) if available, the service-level-AA payload with the value set to the C2 authorization payload and the service- level-AA payload type with the value set to \"C2 authorization payload\". NOTE 3: The C2 authorization payload in the service-level-AA payload can include one, some or all of the pairing information for C2 communication, an indication of the request for direct C2 communication, pairing information for direct C2 communication, and the UAV flight authorization information.",
    "The UE may include the Non-3GPP delay budget IE in the PDU SESSION MODIFICATION REQUEST message, when requesting to modify an established PDU session for PIN-DN communication or PIN indirect commmunication. NOTE 3A: The Non-3GPP delay budget IE can assist the network in providing specific QoS handling for a set of packet filter(s) for the PDU session as specified in subclause 5.44.3.4 of 3GPP TS 23.501 [8].",
    "After an inter-system change from S1 mode to N1 mode, if: a) the UE is operating in single-registration mode in a network that supports N26 interface; b) the PDU session type value of the PDU session type IE is set to \"Ethernet\"; c) the UE indicates \"Control plane CIoT 5GS optimization supported\" and \"Ethernet header compression for control plane CIoT 5GS optimization supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and d) the network indicates \"Control plane CIoT 5GS optimization supported\" and \"Ethernet header compression for control plane CIoT 5GS optimization supported\" in the 5GS network support feature IE of the REGISTRATION ACCEPT message; the UE shall initiate the PDU session modification procedure to negotiate the Ethernet header compression configuration and include the Ethernet header compression configuration IE in the PDU SESSION MODIFICATION REQUEST message.",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, and if the UE is a UE operating in single-registration mode in a network supporting N26 interface, and the UE supports receiving DNS server addresses in protocol configuration options and the UE has not previously successfully performed the UE- requested PDU session modification to indicate this support, the UE shall include the Extended protocol configuration options IE in the PDU SESSION MODIFICATION REQUEST message and: a) if the PDU session is of \"IPv4\" or \"IPv4v6\" PDU session type, the UE shall include the DNS server IPv4 address request; and b) if the PDU session is of \"IPv6\" or \"IPv4v6\" PDU session type, the UE shall include the DNS server IPv6 address request.",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, and if the UE is a UE operating in single-registration mode in a network supporting N26 interface, and the UE supports the EAS rediscovery and the UE has not previously successfully performed the UE-requested PDU session modification to indicate this support, the UE shall include the Extended protocol configuration options IE in the PDU SESSION MODIFICATION REQUEST message and shall include the EAS rediscovery support indication in the Extended protocol configuration options IE.",
    "For a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, and if the UE is a UE operating in single-registration mode in a network supporting N26 interface, and the UE supports the EDC and the UE has not previously successfully performed the UE-requested PDU session modification to indicate this support, then the UE shall include the Extended protocol configuration options IE in the PDU SESSION MODIFICATION REQUEST message and shall include the EDC support indicator in the Extended protocol configuration options IE.",
    "If the UE supports reporting of URSP rule enforcement and is indicated to send URSP rule enforcement report to network based on the matching URSP rule which contains the URSP rule enforcement report indication set to \"URSP rule enforcement report is required\", the URSP rule enforcement report is associated to: a) an established PDU session; or b) a PDN connection, after an inter-system change from S1 mode to N1 mode, and if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the matching URSP rule is newly enforced while the UE was in S1 mode, then the UE shall include the URSP rule enforcement reports IE in the PDU SESSION MODIFICATION REQUEST message.",
    "The UE shall transport: a) the PDU SESSION MODIFICATION REQUEST message; b) the PDU session ID; and c) if the UE-requested PDU session modification: 1) is not initiated to indicate a change of 3GPP PS data off UE status associated to a PDU session, then the request type set to \"modification request\"; and 2) is initiated to indicate a change of 3GPP PS data off UE status associated to a PDU session, then without transporting the request type; using the NAS transport procedure as specified in subclause 5.4.5, and the UE shall start timer T3581 (see example in figure 6.4.2.2.1). For a PDN connection established when in S1 mode and not associated with the control plane only indication, after inter-system change from S1 mode to N1 mode, if the UE is registered in a network supporting the ATSSS, a) the UE may request to modify a PDU session to an MA PDU session; or b) the UE may allow the network to upgrade the PDU session to an MA PDU session.",
    "In order for the UE to allow the network to upgrade the PDU session to an MA PDU session, the UE shall set \"MA PDU session network upgrade is allowed\" in the MA PDU session information IE and set the request type to \"modification request\" in the UL NAS TRANSPORT message. NOTE 4: If the DNN corresponds to an LADN DNN, the AMF does not forward the MA PDU session information IE to the SMF but sends the message back to the UE to inform of the unhandled request (see subclause 5.4.5.2.5).",
    "In case the UE executes case a) or b): 1) if the UE supports ATSSS Low-Layer functionality with any steering mode (i.e., any steering mode allowed for ATSSS Low-Layer functionality) as specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"ATSSS Low-Layer functionality with any steering mode allowed for ATSSS-LL supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; NOTE 5: The ATSSS Low-Layer functionality cannot be used together with the redundant steering mode. When the UE indicates that it is capable of supporting the ATSSS Low-Layer functionality with any steering mode, it implies that the UE supports the ATSSS Low-Layer functionality with any steering mode except the redundant steering mode.",
    "2) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL functionality with only active- standby steering mode as specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; 3) if the UE supports MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality)as specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; 4) if a performance measurement function in the UE can perform access performance measurements using the QoS flow of the non-default QoS rule as specified in subclause 5.32.5 of 3GPP TS 23.501 [8], the UE shall set the APMQF bit to \"Access performance measurements per QoS flow supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; 5) if the UE supports MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active- standby steering mode as specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; 6) if the UE supports MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) as specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; 7) if the UE supports MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode as specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message; and 8) if the UE supports MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) as specified in subclause 5.32.6 of 3GPP TS 23.501 [8], the UE shall set the ATSSS-ST bits to \"MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\" in the 5GSM capability IE of the PDU SESSION MODIFICATION REQUEST message.",
    "Upon receipt of a PDU SESSION MODIFICATION REQUEST message for MA PDU session modification, the SMF shall check if the 5GSM capability IE in the PDU SESSION MODIFICATION REQUEST message, includes: a) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode supported\" and: i) if the DNN configuration allows for the MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) but does not allow RTT measurement without using PMF protocol, the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode and ATSSS-LL with only active-standby steering mode, load balancing steering mode or priority based steering mode in the downlink and MPTCP with any steering mode and ATSSS-LL with only active-standby steering mode in the uplink; ii) if the DNN configuration allows for the MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) and allows RTT measurement without using PMF protocol, the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode and ATSSS-LL with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) in the downlink and MPTCP with any steering mode and ATSSS-LL with only active-standby steering mode in the uplink; or iii) if the DNN configuration allows for the MPTCP functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode, the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode and ATSSS-LL with only active-standby steering mode in the downlink and the uplink; b) the ATSSS-ST bits set to \"MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode supported\" and: i) if the DNN configuration allows for the MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) but does not allow RTT measurement without using PMF protocol, the SMF shall ensure that the modified PDU session has the capability of MPQUIC with any steering mode and ATSSS-LL with only active-standby steering mode, load balancing steering mode or priority based steering mode in the downlink and MPQUIC with any steering mode and ATSSS-LL with only active-standby steering mode in the uplink; ii) if the DNN configuration allows for the MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) and allows RTT measurement without using PMF protocol, the SMF shall ensure that the modified PDU session has the capability of MPQUIC with any steering mode and ATSSS-LL with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) in the downlink and MPQUIC with any steering mode and ATSSS-LL with only active-standby steering mode in the uplink; or iii) if the DNN configuration allows for the MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode, the SMF shall ensure that the modified PDU session has the capability of MPQUIC with any steering mode and ATSSS-LL with only active-standby steering mode in the downlink and the uplink; c) the ATSSS-ST bits set to \"MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\" and if the DNN configuration allows for the MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality), the SMF shall ensure that the modified PDU session has the capability of MPQUIC with any steering mode and ATSSS-LL with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) in the downlink and the uplink; d) the ATSSS-ST bits set to \"ATSSS Low-Layer functionality with any steering mode allowed for ATSSS-LL supported\" and if the DNN configuration allows for the ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality), the SMF shall ensure that the modified PDU session has the capability of ATSSS-LL with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) in the downlink and the uplink; e) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\" and if the DNN configuration allows for the MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality), the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode and ATSSS-LL with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) in the downlink and the uplink; f) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode allowed for ATSSS-LL supported\" and if the DNN configuration allows for the MPTCP functionality with any steering mode, the MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality), the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode, the MPQUIC with any steering mode and ATSSS-LL with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) in the downlink and the uplink; or g) the ATSSS-ST bits set to \"MPTCP functionality with any steering mode, MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode supported\" and i) if the DNN configuration allows for the MPTCP functionality with any steering mode, the MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) but does not allow RTT measurement without using PMF protocol, the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode, MPQUIC with any steering mode and ATSSS-LL with only active-standby steering mode, load balancing steering mode or priority based steering mode in the downlink and MPTCP with any steering mode, MPQUIC with steering mode and ATSSS-LL with only active-standby steering mode in the uplink; ii) if the DNN configuration allows for the MPTCP functionality with any steering mode, the MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) and allows RTT measurement without using PMF protocol, the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode, MPQUIC with any steering mode and ATSSS-LL with any steering mode (i.e., any steering mode allowed for ATSSS-LL functionality) in the downlink and MPTCP with any steering mode, MPQUIC with steering mode and ATSSS-LL with only active-standby steering mode in the uplink; or iii) if the DNN configuration allows for the MPTCP functionality with any steering mode, the MPQUIC functionality with any steering mode and ATSSS-LL functionality with only active-standby steering mode, the SMF shall ensure that the modified PDU session has the capability of MPTCP with any steering mode, MPQUIC with any steering mode and ATSSS-LL with only active-standby steering mode in the downlink and the uplink.",
    "Figure 6.4.2.2.1: UE-requested PDU session modification procedure Upon receipt of a PDU SESSION MODIFICATION REQUEST message, if the SMF does not accepts the request to modify the PDU session, the SMF shall create a PDU SESSION MODIFICATION REJECT message. The SMF shall set the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT message to indicate the reason for rejecting the PDU session modification.",
    "The 5GSM cause IE typically indicates one of the following SM cause values: #26 insufficient resources; #29 user authentication or authorization failed; #31 request rejected, unspecified; #32 service option not supported; #33 requested service option not subscribed; #35 PTI already in use; #37 5GS QoS not accepted; #43 Invalid PDU session identity; #44 Semantic errors in packet filter(s); #45 Syntactical error in packet filter(s); #46 out of LADN service area; #59 unsupported 5QI value; #67 insufficient resources for specific slice and DNN; #69 insufficient resources for specific slice; #83 Semantic error in the QoS operation; #84 Syntactical error in the QoS operation; or #95 – 111 protocol errors. If the UE requests a PDU session modification for an LADN when the UE is located outside of the LADN service area, the SMF shall include the 5GSM cause value #46 \"out of LADN service area\" in the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT message.",
    "If the Extended protocol configuration options IE of the PDU SESSION MODIFICATION REQUEST message indicates 3GPP PS data off UE status and the SMF detects the change of the 3GPP PS data off UE status, the SMF shall not include the 5GSM cause value #26 \"insufficient resources\", the 5GSM cause value #67 \"insufficient resources for specific slice and DNN\", the 5GSM cause value #69 \"insufficient resources for specific slice\" and the 5GSM cause value #46 \"out of LADN service area\" in the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT message.",
    "If the UE initiates UE-requested PDU session modification procedure to modify the PDU session transferred from EPS to an MA PDU session with the Request type IE set to \"MA PDU request\" in the UL NAS TRANSPORT message as specified in 3GPP TS 24.193 [13B] and the SMF determines, based on operator policy and subscription information, that the PDU SESSION MODIFICATION REQUEST message is to be rejected, the SMF shall include the 5GSM cause value #33 \"requested service option not subscribed\" in the 5GSM cause IE of the PDU SESSION MODIFICATION REJECT message. NOTE: If the SMF determines, based on operator policy and subscription information, that the PDU SESSION MODIFICATION REQUEST message is to be accepted as single access PDU session, the ATSSS container IE cannot be included in the PDU SESSION MODIFICATION COMMAND message. The network may include a Back-off timer value IE in the PDU SESSION MODIFICATION REJECT message.",
    "If the 5GSM cause value is #26\"insufficient resources\", #67 \"insufficient resources for specific slice and DNN\", or #69 \"insufficient resources for specific slice\" and the PDU SESSION MODIFICATION REQUEST message was received from a UE configured for high priority access in selected PLMN or SNPN or the request type provided during the PDU session establishment is set to \"initial emergency request\" or \"existing emergency PDU session\", the network shall not include a Back-off timer value IE. The SMF shall send the PDU SESSION MODIFICATION REJECT message. Upon receipt of a PDU SESSION MODIFICATION REJECT message and a PDU session ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE shall stop timer T3581, release the allocated PTI value, and enter the state PROCEDURE TRANSACTION INACTIVE.",
    "If the PDU SESSION MODIFICATION REQUEST message was sent with the Requested MBS container IE included and the MBS operation set to \"Join MBS session\", and the UE receives a PDU SESSION MODIFICATION REJECT message, then the UE shall consider the requested MBS join as rejected. If the PDU SESSION MODIFICATION REQUEST message was sent with the Requested MBS container IE included and the MBS operation set to \"Leave MBS session\", and the UE receives a PDU SESSION MODIFICATION REJECT message, then the UE shall locally leave the multicast MBS session(s) corresponding to the TMGI(s) in the Requested MBS container IE of the PDU SESSION MODIFICATION REQUEST message. The following abnormal cases can be identified: a) Expiry of timer T3581.",
    "The UE shall, on the first expiry of the timer T3581, retransmit the PDU SESSION MODIFICATION REQUEST message and the PDU session information which was transported together with the initial transmission of the PDU SESSION MODIFICATION REQUEST message and shall reset and start timer T3581. This retransmission is repeated four times, i.e. on the fifth expiry of timer T3581, the UE shall abort the procedure and shall release the allocated PTI. b) Invalid PDU session identity. Upon receipt of the PDU SESSION MODIFICATION REJECT message including 5GSM cause #43 \"invalid PDU session identity\", the UE shall perform a local release of the existing PDU session and shall stop the timer T3581. c) Collision of network-requested PDU session release procedure and UE-requested PDU session modification procedure.",
    "If the UE receives a PDU SESSION RELEASE COMMAND message during the UE-requested PDU session modification procedure, and the PDU session indicated in the PDU SESSION RELEASE COMMAND message is the PDU session that the UE had requested to modify, the UE shall abort the PDU session modification procedure and proceed with the network-requested PDU session release procedure. d) Handling DL user data packets marked with RQI when UE has already revoked the usage of reflective QoS If the UE receives a DL user data packet marked with a RQI and the DL user data packet belongs to a PDU session of IPv4, IPv6, IPv4v6 or Ethernet PDU session type for which the UE has already revoked the usage of reflective QoS, then the UE shall ignore the RQI and shall handle the received DL user data packet. e) Collision of network-requested PDU session modification procedure and UE-requested PDU session modification procedure. The handling of the same abnormal case as described in subclause 6.3.2.6 applies.",
    "f) Upon receiving an indication that the 5GSM message was not forwarded due to service area restrictions along with a PDU SESSION MODIFICATION REQUEST message with the PDU session ID IE set to the same value as the PDU session ID that was sent by the UE, the UE shall abort the procedure and shall stop the timer T3581. g) Upon receiving an indication that the 5GSM message was not forwarded due to routing failure along with a PDU SESSION MODIFICATION REQUEST message with the PDU session ID IE set to the same value as the PDU session ID that was sent by the UE, the UE shall stop timer T3581 and shall abort the procedure.",
    "ga) Upon receiving an indication that the 5GSM message was not forwarded because the UE accessing via a satellite NG-RAN cell is informed that the PLMN is not allowed to operate at the present UE location along with a PDU SESSION MODIFICATION REQUEST message with the PDU session ID IE set to the same value as the PDU session ID that was sent by the UE, the UE shall stop timer T3581 and shall abort the procedure. gb) Upon receiving an indication that the 5GSM message was not forwarded due to unexpected cause along with a PDU SESSION MODIFICATION REQUEST message with the PDU session ID IE set to the same value as the PDU session ID that was sent by the UE, the UE shall stop timer T3581 and shall abort the procedure.",
    "h) Collision of UE-requested PDU session modification procedure and N1 NAS signalling connection release The UE may immediately retransmit the PDU SESSION MODIFICATION REQUEST message and stop, reset and restart timer T3581, if the following conditions apply: 1) The original UE-requested PDU session modification procedure was initiated over an existing N1 NAS signalling connection; and 2) the previous transmission of the PDU SESSION MODIFICATION REQUEST message was not initiated due to timer T3581 expiry.",
    "i) Rejection of a UE-requested PDU session modification procedure when the UE has initiated the procedure to delete one or more non-default QoS rules for the PDU session: Upon receipt of a PDU SESSION MODIFICATION REJECT message with 5GSM cause value #31 \"request rejected, unspecified\", if the UE had initiated deletion of one or more non-default QoS rules for the PDU session, as an implementation option, 1) it may perform a local release of the PDU session and shall stop the timer T3581. In order to synchronize the PDU session context with the AMF, the UE shall perform the registration procedure for mobility and periodic registration update with a REGISTRATION REQUEST message including the PDU session status IE; or 2) it shall stop the timer T3581 and initiate the UE-requested PDU session release procedure. NOTE: The UE can delay the release of the PDU session until there is no pending data transferred through the other QoS flows of the PDU session.",
    "The purpose of the UE-requested PDU session release procedure is to enable by the UE to request a release of a PDU session. The UE is allowed to initiate the PDU session release procedure even if the timer T3396 is running. The UE is allowed to initiate the PDU session release procedure even if the timer T3584 is running. The UE is allowed to initiate the PDU session release procedure even if the timer T3585 is running. The UE is allowed to initiate the PDU session release procedure even if the UE is outside the LADN service area. Upon receipt of a PDU SESSION RELEASE REQUEST message, if the SMF does not accept the request to release the PDU session, the SMF shall create a PDU SESSION RELEASE REJECT message. The SMF shall set the 5GSM cause IE of the PDU SESSION RELEASE REJECT message to indicate the reason for rejecting the PDU session release.",
    "The 5GSM cause IE typically indicates one of the following SM cause values: #35 PTI already in use; or #43 Invalid PDU session identity; or #95 – 111: protocol errors. The SMF shall send the PDU SESSION RELEASE REJECT message. Upon receipt of a PDU SESSION RELEASE REJECT message and a PDU session ID, using the NAS transport procedure as specified in subclause 5.4.5, the UE shall stop timer T3582, release the allocated PTI value and locally release the PDU session. If there is one or more multicast MBS sessions associated with the PDU session, the UE shall locally leave the associated multicast MBS sessions. The purpose of the sending of the 5GSM STATUS message is to report at any time certain error conditions detected upon receipt of 5GSM protocol data. The 5GSM STATUS message can be sent by both the network and the UE (see example in figure 6.5.1.1).",
    "UE SMF OR 5GSM STATUS 5GSM STATUS Figure 6.5.1.1: 5GSM status procedure The UE and the SMF can exchange protocol configuration options via 5GSM procedures. The protocol configuration options shall be exchanged via the Extended protocol configuration options IE. In order to initiate the 5G ProSe remote UE report procedure, the UE shall create a REMOTE UE REPORT message. The UE shall include information of newly connected or disconnected 5G ProSe remote UEs to the network in the REMOTE UE REPORT message by setting the values of the Remote UE context connected IE or the Remote UE context disconnected IE to the 5G ProSe remote UE identities that are being connected or disconnected, respectively.",
    "The UE shall set the Remote UE ID with: a) the UP-PRUK ID of the 5G ProSe remote UE, if the security for 5G ProSe communication via 5G ProSe UE-to- network relay is performed over user plane as specified in 3GPP TS 33.503 [56]; b) the CP-PRUK ID of the 5G ProSe remote UE, if the security for 5G ProSe communication via 5G ProSe UE-to- network relay is performed over control plane as specified in 3GPP TS 33.503 [56]; or c) the PEI of the 5G ProSe remote UE, if the RSC is specific for emergency services as specified in 3GPP TS 24.554 [19E], and the 5G ProSe remote UE is identified by a PEI. If the UE sets the Remote UE ID with the PRUK ID of the 5G ProSe remote UE and the UP-PRUK ID is in 64-bit string format, the UE shall include the HPLMN ID of the 5G ProSe remote UE.",
    "If the UE allocated an IPv4 address to a 5G ProSe remote UE and enabled UDP usage to the 5G ProSe remote UE, the UE shall include in the REMOTE UE REPORT message the UDP port range assigned to the 5G ProSe remote UE in the NAT function of 5G ProSe layer-3 UE-to-network relay. If the UE allocated an IPv4 address to a 5G ProSe remote UE and enabled TCP usage to the 5G ProSe remote UE, the UE shall include in the REMOTE UE REPORT message the TCP port range assigned to the 5G ProSe remote UE in the NAT function of 5G ProSe layer-3 UE-to-network relay. The UE shall set the PDU session ID IE to the value of the PDU session associated with the 5G ProSe remote UE connected to the 5G ProSe layer-3 UE-to-network relay UE or disconnected from the 5G ProSe layer-3 UE-to-network relay UE. The UE shall allocate a PTI value currently not used and shall set the PTI IE of the REMOTE UE REPORT message to the allocated PTI value.",
    "The UE shall transport the REMOTE UE REPORT message and the PDU session ID, using the NAS transport procedure as specified in subclause 5.4.5, and the UE shall start timer T3586 (see example in figure 6.6.2.2.1). UE Network REMOTE UE REPORT Start T3586 REMOTE UE REPORT RESPONSE Stop T3586 Figure 6.6.2.2.1: Remote UE report procedure The following abnormal cases have been identified: a) Collision of network-requested PDU session release procedure and remote UE report procedure: If the SMF receives a REMOTE UE REPORT message during a network-requested PDU session release procedure, and the PDU session indicated in the PDU SESSION RELEASE COMMAND message is the PDU session ID that is in the REMOTE UE REPORT message, the SMF shall abort the remote UE report procedure and proceed with the network-requested PDU session release procedure.",
    "b) PDU session inactive for the received PDU session identity: If the PDU session ID in the REMOTE UE REPORT message belongs to any PDU session in state PDU SESSION INACTIVE in the SMF, the SMF shall send the 5GSM STATUS message to the UE with the 5GSM cause #43 \"Invalid PDU session identity\". Handling of unknown, unforeseen, and erroneous protocol data When a message is received that is too short to contain a complete message type information element, that message shall be ignored, cf. 3GPP TS 24.007 [11]. The following network procedures shall apply for handling an unknown, erroneous, or unforeseen PTI received in a 5GSM message: a) In case the network receives a PDU SESSION MODIFICATION COMPLETE, a PDU SESSION RELEASE COMPLETE message or a PDU SESSION MODIFICATION COMMAND REJECT message in which the PTI value is an assigned or unassigned value that does not match any PTI in use, the network shall respond with a 5GSM STATUS message including 5GSM cause #47 \"PTI mismatch\".",
    "b) In case the network receives a PDU SESSION AUTHENTICATION COMPLETE message or a SERVICE- LEVEL AUTHENTICATION COMPLETE message in which the PTI value is an assigned value, the network shall respond with a 5GSM STATUS message including 5GSM cause #81 \"invalid PTI value\". c) In case the network receives a PDU SESSION ESTABLISHMENT REQUEST message, a PDU SESSION MODIFICATION REQUEST message or a PDU SESSION RELEASE REQUEST message in which the PTI value is an unassigned value, the network shall respond with a 5GSM STATUS message including 5GSM cause #81 \"invalid PTI value\". d) In case the network receives a 5GSM message in which the PTI value is a reserved value, the network shall ignore the message.",
    "The following UE procedures shall apply for handling an unknown, erroneous, or unforeseen PTI received in a 5GSM message: a) In case the UE receives a PDU SESSION MODIFICATION COMMAND message or a PDU SESSION MODIFICATION REJECT message in which the PTI value is an assigned value that does not match any PTI in use: 1) if the UE detects that this PDU SESSION MODIFICATION COMMAND message is a network retransmission of an already accepted request (see subclause 6.3.2.3), the UE shall respond with a PDU SESSION MODIFICATION COMPLETE message; 2) if the UE detects that this PDU SESSION MODIFICATION COMMAND message is a network retransmission of an already rejected request (see subclause 6.3.2.4), the UE shall respond with a PDU SESSION MODIFICATION COMAND REJECT message; or 3) otherwise, the UE shall respond with a 5GSM STATUS message including 5GSM cause #47 \"PTI mismatch\".",
    "b) In case the UE receives a PDU SESSION RELEASE COMMAND message or a PDU SESSION RELEASE REJECT message in which the PTI value is an assigned value that does not match any PTI in use: 1) if the UE detects that this PDU SESSION RELEASE COMMAND message is a network retransmission of an already accepted request (see subclause 6.3.3.3), the UE shall respond with a PDU SESSION RELEASE COMPLETE message; or 2) otherwise, the UE shall respond with a 5GSM STATUS message including 5GSM cause #47 \"PTI mismatch\". c) In case the UE receives a PDU SESSION ESTABLISHMENT ACCEPT message or a PDU SESSION ESTABLISHMENT REJECT message in which the PTI value is an assigned value that does not match any PTI in use: 1) the UE shall respond with a 5GSM STATUS message including 5GSM cause #47 \"PTI mismatch\".",
    "d) In case the UE receives a PDU SESSION AUTHENTICATION COMMAND message, a PDU SESSION AUTHENTICATION RESULT message or a SERVICE-LEVEL AUTHENTICATION COMMAND message in which the PTI value is an assigned value, the UE shall respond with a 5GSM STATUS message including 5GSM cause #81 \"invalid PTI value\". e) In case the UE receives a PDU SESSION ESTABLISHMENT ACCEPT message, a PDU SESSION ESTABLISHMENT REJECT message, a PDU SESSION MODIFICATION REJECT message or a PDU SESSION RELEASE REJECT message in which the PTI value is an unassigned value, the UE shall ignore the message. f) In case the UE receives a 5GSM message in which the PTI value is a reserved value, the UE shall ignore the message.",
    "When on receipt of a message, a) an \"imperative message part\" error; or b) a \"missing mandatory IE\" error is diagnosed or when a message containing: a) a syntactically incorrect mandatory IE; b) an IE with an IEI unknown in the message, but encoded as \"comprehension required\" (see 3GPP TS 24.007 [11]); or c) an out of sequence IE encoded as \"comprehension required\" (see 3GPP TS 24.007 [11]) is received, the UE shall proceed as follows: If the message is not one of the messages listed in the UE procedures in subclause 7.5.3, item a), b) or c), the UE shall return a status message (5GMM STATUS or 5GSM STATUS depending on the EPD) with cause #96 \"invalid mandatory information\"; the network shall proceed as follows: If the message is not one of the messages listed in the network procedures in subclause 7.5.3, item a), b) or c), the network shall either: 1) try to treat the message (the exact further actions are implementation dependent); or 2) ignore the message except that it should return a status message (5GMM STATUS or 5GSM STATUS depending on the EPD) with cause #96 \"invalid mandatory information\".",
    "message part If an information element with format T, TV, TLV, or TLV-E is repeated in a message in which repetition of the information element is not specified in clause 8 and clause 9 of the present document, the UE shall handle only the contents of the information element appearing first and shall ignore all subsequent repetitions of the information element. When repetition of information elements is specified, the UE shall handle only the contents of specified repeated information elements. If the limit on repetition of information elements is exceeded, the UE shall handle the contents of information elements appearing first up to the limit of repetitions and shall ignore all subsequent repetitions of the information element. The network should follow the same procedures. The UE shall ignore all out of sequence IEs in a Type 6 IE container information element which are not encoded as \"comprehension required\" (see 3GPP TS 24.007 [11]). The network should take the same approach.",
    "The UE shall treat all optional IEs that are syntactically incorrect in a message as not present in the message. The network shall take the same approach. The UE shall treat all optional IEs that are syntactically incorrect in a Type 6 IE container information element as not present in the Type 6 IE container information element. The network shall take the same approach. EXAMPLE 1: If the Type 6 IE container information element includes 2 type 6 information elements, and the first one is syntactically incorrect, the receiver ignores the first information element and continues with the processing of the second one. EXAMPLE 2: If the remaining value part of a Type 6 IE container information element is too short to contain a complete type 6 information element, the receiver ignores these octets and continues with the processing of the octets following the Type 6 IE container information element, if there are any.",
    "This clause defines the structure of the messages of the Layer 3 (L3) protocols defined in the present document. These are standard L3 messages as defined in 3GPP TS 24.007 [12]. Each definition given in the present clause includes: a) a brief description of the message direction and use, including whether the message has: b) a table listing the Information Elements (IE) known in the message and the order of their appearance in the message. All IEs that may be repeated are explicitly indicated (The V, LV and LV-E formatted IEs, which compose the imperative part of the message, occur before the T, TV, TLV and TLV-E formatted IEs which compose the non-imperative part of the message, see 3GPP TS 24.007 [12]). In a (maximal) sequence of consecutive IEs with half octet length, the first IE with half octet length occupies bits 1 to 4 of octet N, the second IE bits 5 to 8 of octet N, the third IE bits 1 to 4 of octet N+1 etc. Such a sequence always has an even number of elements.",
    "For each information element the table indicates: generally, the referenced subclause of clause 9 of the present document describing the value part of the information element. means that the maximum length of the IE is only constrained by link layer protocol. This indication is non- normative. c) subclauses specifying, where appropriate, conditions for IEs with presence requirement C or O in the relevant message which together with other conditions specified in the present document define when the information elements shall be included or not, what non-presence of such IEs means, and – for IEs with presence requirement C – the static conditions for presence or non-presence of the IEs or for both cases (see 3GPP TS 24.007 [12]). The AUTHENTICATION REQUEST message is sent by the AMF to the UE to initiate authentication of the UE identity.",
    "See table 8.2.1.1.1. Message type: AUTHENTICATION REQUEST Significance: dual Direction: network to UE Table 8.2.1.1.1: AUTHENTICATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Authentication request message identity Message type V 1/2 ABBA ABBA TLV EAP message EAP message Authentication parameter AUTN IE is included if the AUTHENTICATION REQUEST message is used in a 5G AKA authentication procedure. The AUTHENTICATION RESPONSE message is sent by the UE to the AMF to deliver a calculated authentication response to the network.",
    "See table 8.2.2.1.1. Message type: AUTHENTICATION RESPONSE Significance: dual Direction: UE to network Table 8.2.2.1.1: AUTHENTICATION RESPONSE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Authentication response message identity Message type TLV-E 7-1503 The AUTHENTICATION RESULT message is sent by the AMF to the UE to provide result of EAP authentication of the UE identity.",
    "See table 8.2.3.1.1. Message type: AUTHENTICATION RESULT Significance: dual Direction: network to UE Table 8.2.3.1.1: AUTHENTICATION RESULT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Authentication result message identity Message type V 1/2 EAP message EAP message TLV 36-n NOTE: It is possible for AMFs compliant with version 18.3.0 or 18.3.1 of this specification to send the AUN3 device security key IE with a fixed length of 66 octets. The AUTHENTICATION FAILURE message is sent by the UE to the AMF to indicate that authentication of the network has failed.",
    "See table 8.2.4.1.1. Message type: AUTHENTICATION FAILURE Significance: dual Direction: UE to network Table 8.2.4.1.1: AUTHENTICATION FAILURE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Authentication failure message identity Message type TLV The AUTHENTICATION REJECT message is sent by the AMF to the UE to indicate that the authentication procedure has failed and that the UE shall abort all activities. See table 8.2.5.1.1. Message type: AUTHENTICATION REJECT Significance: dual Direction: network to UE Table 8.2.5.1.1: AUTHENTICATION REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Authentication reject message identity Message type EAP message IE is included if the AUTHENTICATION REJECT message is used to convey EAP-failure message.",
    "V Security header type Security header type V 5GS registration type 5GS registration type LV-E 6-n C- Non-current native NAS key set identifier NAS key set identifier TLV 4-10 2F Requested NSSAI NSSAI TLV 4-15 Uplink data status Uplink data status TV 2B UE status UE status TLV 4-34 UE's usage setting UE's usage setting TLV-E 3-811 8- Payload container type Payload container type TV 5GS update type 5GS update type 9.11.3.9A O TLV Mobile station classmark 2 Mobile station classmark 2 9.11.3.31C O TLV Supported codecs Supported codec list 9.11.3.51A O TLV 5-n NAS message container NAS message container TLV 3-n Requested mapped NSSAI Mapped NSSAI 9.11.3.31B O TLV 3-42 Additional information requested Additional information requested 9.11.3.12A O TLV 1A Requested WUS assistance information WUS assistance information TLV UE request type UE request type TLV-E 4-65538 NID NID TLV 3-n 3B Requested T3512 value GPRS timer 3 TLV AUN3 indication AUN3 indication The UE shall include this IE, unless the UE performs a periodic registration updating procedure.",
    "This IE shall be included if the UE holds a valid last visited registered TAI. This IE shall be included when the UE needs to indicate the PDU sessions that are associated with the access type that the message is sent over, that are active within the UE. This IE shall be included: a) if the UE performs the registration procedure due to inter-system change from S1 mode to N1 mode, the UE operates in single-registration mode and the UE has a valid 5G-GUTI; or b) the UE holds two valid native 5G-GUTIs and one of the valid native 5G-GUTI was assigned by the PLMN with which the UE is performing the registration. If the UE wants to use or change the UE specific DRX parameters, the UE shall include the Requested DRX parameters IE in the REGISTRATION REQUEST message.",
    "Within a PLMN, this IE shall be included if: a) the UE has one or more stored UE policy sections identified by a UPSI with the PLMN ID part indicating the HPLMN or the selected PLMN for the registration procedure for mobility and periodic registration update due to inter-system change from S1 mode to N1 mode of a UE operating in the single-registration mode or for the registration procedure for initial registration; or b) the UE does not have any stored UE policy section identified by a UPSI with the PLMN ID part indicating the HPLMN or the selected PLMN for the registration procedure for mobility and periodic registration update due to inter-system change from S1 mode to N1 mode of a UE operating in the single-registration mode or for the registration procedure for initial registration and the UE needs to send a UE policy container to the network.",
    "Within an SNPN, this IE shall be included if: a) the UE has one or more stored UE policy sections for the selected SNPN for the registration procedure for initial registration; or b) the UE does not have any UE policy section for the selected SNPN for the registration procedure for initial registration and the UE needs to send a UE policy container to the network. This IE shall be included if the UE is sending a REGISTRATION REQUEST message as an initial NAS message, the UE has a valid 5G NAS security context and the UE needs to send non-cleartext IEs. The UE may include this IE during the registration update procedure if it requests to use MICO mode and use the active time timer. This IE shall be included if the UE is not in NB-N1 mode, the UE supports RACS and the UE needs to signal a UE radio capability ID to the network.",
    "The UE may include this IE if: - the UE supports WUS assistance information; - the UE is not performing initial registration for emergency services; and - the UE does not have an active emergency PDU session. The UE shall include this IE if the UE wants to use or change the UE specific DRX parameters for NB-N1 mode. The UE shall include this IE if the UE supporting UAS services requests a registration for UAS services. The UE may include this IE if the UE supports NR paging subgrouping, the UE is not performing initial registration for emergency services, is not registered for emergency services and does not have an active emergency PDU session. The UE may include this IE during the registration procedure for mobility registration update if it requests from the network to keep using the user plane resources of the old non-3GPP access during path switching to the new non-3GPP access. The REGISTRATION ACCEPT message is sent by the AMF to the UE.",
    "See table 8.2.7.1.1. Message type: REGISTRATION ACCEPT Significance: dual Direction: network to UE Table 8.2.7.1.1: REGISTRATION ACCEPT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Registration accept message identity Message type TLV-E 4A Equivalent PLMNs PLMN list TLV 4-74 Rejected NSSAI Rejected NSSAI TLV 3-6 PDU session status PDU session status TLV-E 5-515 LADN information LADN information TV Service area list Service area list TLV T3502 value GPRS timer 2 TLV-E 7-65538 SOR transparent container SOR transparent container TLV-E 3-8323 Negotiated DRX parameters 5GS DRX parameters 9.11.3.2A O TLV D- Non-3GPP NW policies Non-3GPP NW provided policies 9.11.3.36A O TV EPS bearer context status EPS bearer context status 9.11.3.23A O TLV 6E Negotiated extended DRX parameters Extended DRX parameters 9.11.3.26A O TLV 3-4 6C T3447 value GPRS timer 3 TLV UE radio capability ID UE radio capability ID TLV 4-146 Ciphering key data Ciphering key data 9.11.3.18C O TLV-E 34-n CAG information list CAG information list 9.11.3.18A O TLV-E 3-n 1B Truncated 5G-S-TMSI configuration Truncated 5G-S-TMSI configuration TLV Extended rejected NSSAI Extended rejected NSSAI TLV 3-n 5GS additional request result 5GS additional request result TLV 2C Disaster return wait range Registration wait range TLV 9-114 1E Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" 5GS tracking area identity list TLV-E 9-3143 3D Equivalent SNPNs SNPN list TLV-E 6-65538 4B RAN timing synchronization RAN timing synchronization TLV 5B S-NSSAI time validity information S-NSSAI time validity information TLV 3-257 On-demand NSSAI On-demand NSSAI This IE may be included in order to assign an equivalent PLMNs list to a UE.",
    "The network may include this IE to inform the UE of one or more S-NSSAIs that were included in the requested NSSAI in the REGISTRATION REQUEST message but were rejected by the network. This IE shall be included when the network needs to indicate the PDU sessions that are associated with the access type the message is sent over, that are active in the network. The network shall include this IE if there are valid LADN service area(s) for the subscribed DNN(s) of the UE in the current registration area. This IE may be included to assign new service area restrictions to the UE. This IE may be included to indicate a value for timer T3502. This IE may be sent by the network. This IE may be included to assign new operator-defined access category definitions to the UE or delete the operator- defined access category definitions at the UE side.",
    "The network shall include the Negotiated extended DRX parameters IE if: - the UE included the Requested extended DRX parameters IE in the REGISTRATION REQUEST message; and - the network supports eDRX and accepts the use of eDRX. The AMF shall include this IE if the UE has requested active time value in the REGISTRATION REQEUST message and the AMF decides to accept the use of MICO mode and the use of the active time. This IE may be included if the UE is not in NB-N1 mode, both the UE and the network support RACS and the network needs to trigger the UE to delete all network-assigned UE radio capability IDs stored at the UE for the serving PLMN or SNPN. This IE may be included to assign a new \"CAG information list\" to the UE or delete the \"CAG information list\" at the UE side.",
    "The network shall include the Negotiated WUS assistance information IE if: - the UE supports WUS assistance information; - the AMF supports and accepts the use of WUS assistance information; - the UE is not performing the initial registration for emergency services; and - the UE does not have an active emergency PDU session. The network shall include the Negotiated PEIPS assistance information IE if: - the UE supports NR paging subgrouping; - the AMF supports and accepts the use of PEIPS assistance information for the UE; and - the UE is not performing initial registration for emergency services and does not have an active emergency PDU session. This IE may be included to assign a new disaster roaming wait range to the UE. This IE is included to indicate the forbidden TAI(s) to be stored in the list of \"5GS forbidden tracking areas for roaming\". This IE is included only if the message is sent via satellite NG-RAN access.",
    "If the UE has set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message over 3GPP access, the network may include this IE to provide NSAG information to the UE. Otherwise, the network shall not include this IE (see the 'comprehension required' scheme in subclause 11.2.5 of 3GPP TS 24.007 [11]). This information element may be included only if the network knows that the UE will not treat this IE as unknown 'comprehension required' IE. Otherwise, the network shall not include this IE (see the 'comprehension required' scheme in subclause 11.2.5 of 3GPP TS 24.007 [11]). In this version of the specification, only the transfer of the information elements specified in table 8.2.7.54.1.1 is supported in the Registration accept type 6 IE container information element in the present message.",
    "For the handling of an information element with an IEI not listed in table 8.2.7.54.1.1, i.e., with an IEI unknown in the Registration accept type 6 IE container information element, see subclause 7.6.4.1. Table 8.2.7.54.1.1: Information elements and IEIs for the Registration accept type 6 IE container IEI Information Element Type/Reference Presence Format Length Extended LADN information Extended LADN information TLV-E 3-808 Partially rejected NSSAI Partial NSSAI Void. This IE may be included to provide information related to the RAN timing synchronization to a UE which has set the Reconnection to the network due to RAN timing synchronization status change (RANtiming) bit to \"Reconnection to the network due to RAN timing synchronization status change supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message. If the UE supports S-NSSAI time validity information, the network may include this IE to update the S-NSSAI time validity information.",
    "The network may include this IE to provide the on-demand NSSAI to the UE. V Security header type Security header type V SOR transparent container SOR transparent container The REGISTRATION REJECT message is sent by the AMF to the UE.",
    "See table 8.2.9.1.1. Message type: REGISTRATION REJECT Significance: dual Direction: network to UE Table 8.2.9.1.1: REGISTRATION REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Registration reject message identity Message type TLV T3502 value GPRS timer 2 TLV 4-42 CAG information list CAG information list 9.11.3.18A O TLV-E 3-n Extended rejected NSSAI Extended rejected NSSAI TLV-E 3-n 3A Lower bound timer value GPRS timer 3 TLV 9-114 3E N3IWF identifier N3IWF identifier TLV NOTE: It is possible for AMFs compliant with version 17.7.0 or 17.8.0 of this specification to send the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE with IEI of value \"3B\" for this message or the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE with IEI of value \"3C\" for this message.",
    "EAP message IE is included if the REGISTRATION REJECT message is used to convey EAP-failure message. If the UE supports Extended rejected NSSAI, the network may include this IE to inform the UE of one or more S- NSSAIs that were included in the requested NSSAI in the REGISTRATION REQUEST message but were rejected by the network. The AMF may include this IE when the 5GMM cause is set to #78 \"PLMN not allowed to operate at the present UE location\", to provide a minimum time value for an entry added to the list of \"PLMNs not allowed to operate at the present UE location\". The network may include this IE if the UE supports slice-based N3IWF selection over non-3GPP access network. The UL NAS TRANSPORT message transports message payload and associated information to the AMF.",
    "See table 8.2.10.1.1. Message type: UL NAS TRANSPORT Significance: dual Direction: UE to network Table 8.2.10.1.1: UL NAS TRANSPORT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 UL NAS TRANSPORT message identity Message type V 1/2 Payload container Payload container TV 8- Request type Request type TLV 3-n A- MA PDU session information MA PDU session information 9.11.3.31A O TV F- Release assistance indication Release assistance indication 9.11.3.46A O TV 4E Non-3GPP access path switching indication Non-3GPP access path switching indication TV The UE shall include this IE when the PDU session ID IE is included and the Payload container IE contains the PDU SESSION ESTABLISHMENT REQUEST message or the PDU SESSION MODIFICATION REQUEST which is not initiated to indicate a change of 3GPP PS data off UE status associated to a PDU session.",
    "This IE is included when the Payload container type IE is set to \"LTE Positioning Protocol (LPP) message container\", \"UPP-CMI container\", \"SLPP message container\", or \"Location services (LCS) message container\". The UE may include this IE when the Payload container type IE is set to \"N1 SM information\" to indicate whether the UE supports the non-3GPP access path switching for the PDU session. The DL NAS TRANSPORT message transports message payload and associated information to the UE.",
    "See table 8.2.11.1.1. Message type: DL NAS TRANSPORT Significance: dual Direction: network to UE Table 8.2.11.1.1: DL NAS TRANSPORT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 DL NAS TRANSPORT message identity Message type V 1/2 Payload container Payload container TLV 3-n 5GMM cause 5GMM cause TLV The AMF shall include this IE when the Payload container IE contains an uplink payload which was not forwarded and the Payload container type IE is not set to \"Multiple payloads\". The DEREGISTRATION REQUEST message is sent by the UE to the AMF.",
    "See table 8.2.12.1.1. Message type: DEREGISTRATION REQUEST Significance: dual Direction: UE to network Table 8.2.12.1.1: DEREGISTRATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 De-registration request message identity Message type V 1/2 5GS mobile identity 5GS mobile identity TLV-E 4-n The DEREGISTRATION ACCEPT message is sent by the AMF to the UE. See table 8.2.13.1.1. Message type: DEREGISTRATION ACCEPT Significance: dual Direction: network to UE Table 8.2.13.1.1: DEREGISTRATION ACCEPT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 De-registration accept message identity Message type The DEREGISTRATION REQUEST message is sent by the AMF to the UE.",
    "See table 8.2.14.1.1. Message type: DEREGISTRATION REQUEST Significance: dual Direction: network to UE Table 8.2.14.1.1: DEREGISTRATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 De-registration request message identity Message type V 1/2 5GMM cause 5GMM cause TLV 4-42 CAG information list CAG information list 9.11.3.18A O TLV-E 3-n Extended rejected NSSAI Extended rejected NSSAI TLV-E 3-n 3A Lower bound timer value GPRS timer 3 TLV 9-114 NOTE: It is possible for AMFs compliant with version 17.7.0 or 17.8.0 of this specification to send the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" IE with IEI of value \"3B\" for this message or the Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for regional provision of service\" IE with IEI of value \"3C\" for this message.",
    "The AMF may include this IE to inform the UE of one or more S-NSSAIs that were rejected by the network. This IE may be included to assign a new disaster return wait range to the UE. 8.2.14.7A Extended CAG information list If the UE supports Extended CAG information list, the network may include this IE to assign a new \"CAG information list\" to the UE or delete the \"CAG information list\" at the UE side. provision of service\" This IE is included to indicate the forbidden TAI(s) to be stored in the list of \"5GS forbidden tracking areas for regional provision of service\". This IE is included only if the message is sent via satellite NG-RAN access.",
    "V Security header type Security header type V V Security header type Security header type V ngKSI NAS key set identifier LV-E Uplink data status Uplink data status TLV 4-34 NAS message container NAS message container TLV 3-35 This IE shall be included if the SERVICE REQUEST message is sent as a response to paging with the access type indicating non-3GPP access or notification via 3GPP access for PDU session(s) associated with non-3GPP access. The UE shall include this IE if the Request type is set to \"NAS signalling connection release\" or to \"Rejection of paging\" in the UE request type IE and the UE requests the network to restrict paging.",
    "V Security header type Security header type V PDU session status PDU session status TLV-E 5-515 EAP message EAP message TLV 1D Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" 5GS tracking area identity list This IE shall be included when the network needs to indicate the PDU sessions that are associated with the access type that the message is sent over that are active within the network. EAP message IE is included if the SERVICE ACCEPT message is sent to a UE registered for emergency services and is used to convey EAP-failure message. This IE is included to indicate the forbidden TAI(s) to be stored in the list of \"5GS forbidden tracking areas for roaming\". This IE is included only if the message is sent via satellite NG-RAN access. The SERVICE REJECT message is sent by the AMF to the UE in order to reject the service request procedure.",
    "See table 8.2.18.1.1. Message type: SERVICE REJECT Significance: dual Direction: network to UE Table 8.2.18.1.1: SERVICE REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Service reject message identity Message type TLV 4-34 5F T3346 value GPRS timer 2 TLV CAG information list CAG information list 9.11.3.18A O TLV-E 3-n 2C Disaster return wait range Registration wait range TLV 1D Forbidden TAI(s) for the list of \"5GS forbidden tracking areas for roaming\" 5GS tracking area identity list This IE shall be included when the network needs to indicate the PDU sessions that are associated with the access type that the message is sent over, that are active within the network. The network may include this IE if the congestion control for transport of user data via the control plane is active and the UE supports the control plane CIoT 5GS optimizations.",
    "If the UE supports Extended CAG information list, the network may include this IE to assign a new \"CAG information list\" to the UE or delete the \"CAG information list\" at the UE side. provision of service\" This IE is included to indicate the forbidden TAI(s) to be stored in the list of \"5GS forbidden tracking areas for regional provision of service\". This IE is included only if the message is sent via satellite NG-RAN access.",
    "V Security header type Security header type V D- Configuration update indication Configuration update indication TLV 9-114 Allowed NSSAI NSSAI TLV 3-n Short name for network Network name TV Network daylight saving time Daylight saving time TV 9- Network slicing indication Network slicing indication TLV 4-42 Operator-defined access category definitions Operator-defined access category definitions TLV 3-n A- UE radio capability ID deletion indication UE radio capability ID deletion indication TLV C- Additional configuration indication Additional configuration indication TLV-E 4-65538 NSSRG information NSSRG information TLV List of PLMNs to be used in disaster condition List of PLMNs to be used in disaster condition TLV 3-n NSAG information NSAG information TLV Extended LADN information Extended LADN information TLV-E 17-38611 5B S-NSSAI time validity information S-NSSAI time validity information TLV-E 3-808 7A Partially rejected NSSAI Partial NSSAI TLV 5-210 This IE may be included to assign a new TAI list to the UE.",
    "This IE may be included to assign a new full name for network to the UE. This IE may be included to assign new universal time and local time zone to the UE. This IE may be included to request the UE to re-negotiate MICO mode. The network may include this IE to inform the UE of one or more S-NSSAIs that were previously sent to the UE in the allowed NSSAI or the pending NSSAI, but are now considered rejected by the network. This IE may be included to assign a new T3447 value to the UE. This IE may be included if the UE is not in NB-N1 mode, both the UE and the network support RACS and the network needs to trigger the UE to delete all network-assigned UE radio capability IDs stored at the UE for the serving PLMN or serving SNPN. The network may include this IE when requesting the UE to register without the release of the N1 NAS signalling connection. This IE may be included to provide NSSRG information associated with the configured NSSAI.",
    "This IE may be included by an allowed PLMN to assign a new \"list of PLMN(s) to be used in disaster condition\" associated with the serving PLMN to the UE. If the UE has set the NSAG bit to \"NSAG supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message and the CONFIGURATION UPDATE COMMAND message is sent over 3GPP access, the network may include this IE to provide NSAG information to the UE. This IE may be included to assign new extended LADN information to the UE or delete the extended LADN information at the UE side. The network may include this IE to update the S-NSSAI time validity information. The network may include this IE to assign a partially rejected NSSAI to the UE. The CONFIGURATION UPDATE COMPLETE message is sent by the UE to the AMF.",
    "See table 8.2.20.1.1. Message type: CONFIGURATION UPDATE COMPLETE Significance: dual Direction: UE to network Table 8.2.20.1.1: CONFIGURATION UPDATE COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Configuration update complete message identity Message type The IDENTITY REQUEST message is sent by the AMF to the UE to request the UE to provide specified identity. See table 8.2.21.1.1 Message type: IDENTITY REQUEST Significance: dual Direction: AMF to UE Table 8.2.21.1.1: IDENTITY REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Identity request message identity Message type V 1/2 V Security header type Security header type V Mobile identity 5GS mobile identity The NOTIFICATION message is sent by the AMF to the UE to notify the UE to initiate a service request procedure.",
    "See table 8.2.23.1.1. Message type: NOTIFICATION Significance: dual Direction: network to UE Table 8.2.23.1.1: NOTIFICATION message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Notification message identity Message type The NOTIFICATION RESPONSE message is sent by the UE to the AMF to notify the failure to initiate the service request procedure as a response of notification.",
    "See table 8.2.24.1.1. Message type: NOTIFICATION RESPONSE Significance: dual Direction: UE to network Table 8.2.2341.1: NOTIFICATION RESPONSE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Notification response message identity Message type This information element shall be included when the UE needs to indicate over non-3GPP access the PDU sessions that are associated with the 3GPP access type that are active within the UE.",
    "V Security header type Security header type V Selected NAS security algorithms NAS security algorithms V 1/2 Replayed UE security capabilities UE security capability TV Additional 5G security information Additional 5G security information TLV 4-n Replayed S1 UE security capabilities S1 UE security capability 9.11.3.48A O TLV 4-7 AUN3 device security key AUN3 device security key This IE shall be included if the AMF supports N26 interface, the UE set the S1 mode bit to \"S1 mode supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message, and the AMF needs to provide the selected EPS NAS security algorithms to the UE. This IE shall be included if the message contains an EAP message IE with an EAP-success message. The SECURITY MODE COMPLETE message is sent by the UE to the AMF in response to a SECURITY MODE COMMAND message.",
    "See table 8.2.26.1.1. Message type: SECURITY MODE COMPLETE Significance: dual Direction: UE to network Table 8.2.26.1.1: SECURITY MODE COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Security mode complete message identity Message type TLV-E 4-n non-IMEISV PEI 5GS mobile identity The UE shall include this information element: a) if during an ongoing registration procedure or service request procedure, the AMF included the Additional 5G security information with the RINMR bit set to \"Retransmission of the initial NAS message requested\" in the SECURITY MODE COMMAND message as described in 3GPP TS 33.501 [24]; or b) if during an ongoing registration procedure, the UE does not have a valid 5G NAS security context. The SECURITY MODE REJECT message is sent by the UE to the AMF to indicate that the corresponding security mode command has been rejected.",
    "See table 8.2.27.1.1. Message type: SECURITY MODE REJECT Significance: dual Direction: UE to network Table 8.2.27.1.1: SECURITY MODE REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Security mode reject message identity Message type This message is sent by the UE or the network to transfer a plain 5GS NAS message as specified in subclause 8.2 together with the sequence number and the message authentication code protecting the message.",
    "See table 8.2.28.1.1. Message type: SECURITY PROTECTED 5GS NAS MESSAGE Significance: dual Direction: both Table 8.2.28.1.1: SECURITY PROTECTED 5GS NAS MESSAGE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Message authentication code Message authentication code V 3-n NOTE: The minimum length of Plain 5GS NAS message IE can be 2 octets if it includes a Test Mode Control message specified in 3GPP TS 38.509 [31AA]. V Security header type Security header type V 5GMM cause 5GMM cause The CONTROL PLANE SERVICE REQUEST message is sent by the UE to the AMF when the UE is using 5GS services with control plane CIoT 5GS optimization.",
    "See table 8.2.30.1.1. Message type: CONTROL PLANE SERVICE REQUEST Significance: dual Direction: UE to network Table 8.2.30.1.1: CONTROL PLANE SERVICE REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Control plane service request message identity Message type TV 7B Payload container Payload container TLV 4-34 F- Release assistance indication Release assistance indication 9.11.3.46A O TV Uplink data status Uplink data status TLV 3-n Allowed PDU session status Allowed PDU session status TLV 3-35 This IE shall be included if the UE needs to send uplink CIoT user data, SMS or location services message.",
    "The UE may include this IE to inform the network whether: - no further uplink and no further downlink data transmission is expected; or - only a single downlink data transmission (e.g. acknowledgement or response to uplink data) and no further uplink data transmission subsequent to the uplink data transmission is expected. The UE may include this IE when the Payload container type IE is set to \"Location services message container\". The UE shall include this IE if the Request type is set to \"NAS signalling connection release\" or to \"Rejection of paging\" in the UE request type IE and the UE requests the network to restrict paging. V Security header type Security header type V S-NSSAI S-NSSAI The NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message is sent by the UE to the AMF in response to the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message and indicates acceptance of the NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message.",
    "See table 8.2.32.1.1. Message type: NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE Significance: dual Direction: UE to network Table 8.2.32.1.1: NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message identity Message type LV-E 6-1502 V Security header type Security header type V S-NSSAI S-NSSAI The RELAY KEY REQUEST message is sent by the UE to the AMF for initiation of PC5 keys establishment with the 5G ProSe remote UE or the 5G ProSe end UE as specified in 3GPP TS 33.503 [56].",
    "See table 8.2.34.1. Message type: RELAY KEY REQUEST Significance: dual Direction: UE to network Table 8.2.34.1: RELAY KEY REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Relay key request message identity Message type LV 22-65537 V Security header type Security header type V PRTI ProSe relay transaction identity TLV-E 7-1503 The RELAY KEY REJECT message is sent by the AMF to the UE to indicate the rejection of the relay key request.",
    "See table 8.2.36.1. Message type: RELAY KEY REJECT Significance: dual Direction: network to UE Table 8.2.36.1: RELAY KEY REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Relay key reject message identity Message type TLV-E 7-1503 The RELAY AUTHENTICATION REQUEST message is sent by the network to the UE to initiate authentication of the 5G ProSe remote UE or the 5G ProSe end UE as specified in 3GPP TS 33.503 [56].",
    "See table 8.2.37.1. Message type: RELAY AUTHENTICATION REQUEST Significance: dual Direction: Network to UE Table 8.2.37.1: RELAY AUTHENTICATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 1/2 Relay authentication request message identity Message type LV-E 7-1503 V Security header type Security header type V PRTI ProSe relay transaction identity The PDU SESSION ESTABLISHMENT REQUEST message is sent by the UE to the SMF to initiate establishment of a PDU session.",
    "See table 8.3.1.1.1. Message type: PDU SESSION ESTABLISHMENT REQUEST Significance: dual Direction: UE to network Table 8.3.1.1.1: PDU SESSION ESTABLISHMENT REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION ESTABLISHMENT REQUEST message identity Message type TV A- SSC mode SSC mode TV B- Always-on PDU session requested Always-on PDU session requested TLV-E 4-65538 IP header compression configuration IP header compression configuration TLV Port management information container Port management information container TLV Service-level-AA container Service-level-AA container TLV RSN RSN This IE shall be included in the message when the UE requests to establish a new PDU session.",
    "This IE is included in the message when the UE requests to establish a new PDU session or to transfer an existing PDN connection and any of the 5GSM capabilities supported by the UE is relevant for the PDU session. This IE is included in the message when the UE requests to establish a new PDU session with a DN and needs to provide information for the PDU session authentication and authorization by the external DN. This IE shall be included in the message if the UE supports transfer of port management information containers and the UE requests to establish a new PDU session of \"Ethernet\" PDU session type.",
    "The UE shall include the Ethernet header compression configuration IE if: - the PDU session type value of the PDU session type IE is set to \"Ethernet\"; - the UE indicated \"Control Plane CIoT 5GS optimization supported\" and \"Ethernet header compression for control plane CIoT 5GS optimization supported\" in the 5GMM capability IE of the REGISTRATION REQUEST message; and - the network indicated \"Control plane CIoT 5GS optimization supported\" and \"Ethernet header compression for control plane CIoT 5GS optimization supported\" in the 5GS network support feature IE of the REGISTRATION ACCEPT message. This IE is included in the message when the UE requests to join one or more multicast MBS sessions that are associated with the PDU session. This IE is included in the message when the UE sends one or more URSP rule enforcement reports to the network.",
    "V PDU session ID PDU session identity V Selected PDU session type PDU session type LV-E 6-65538 Session AMBR Session-AMBR TLV 7-31 RQ timer value GPRS timer TV Mapped EPS bearer contexts Mapped EPS bearer contexts TLV-E 6-65538 7B Extended protocol configuration options Extended protocol configuration options TLV ATSSS container ATSSS container TLV 5-257 1F Ethernet header compression configuration Ethernet header compression configuration TLV-E 9-65538 N3QAI N3QAI This IE is included when the selected PDU session type is different from the PDU session type requested by the UE. This IE shall be included in the message when the SMF received from the AMF an S-NSSAI together with the PDU SESSION ESTABLISHMENT REQUEST message, the PDU session is a non-emergency PDU session and the UE is not registered for onboarding services in SNPN. This IE is included when the external DN successfully performed authentication and authorization of the UE using EAP.",
    "The IE shall be included in the message when the PDU session is a non-emergency PDU session and the UE is not registered for onboarding services in SNPN. This IE shall be included when the network needs to indicate the maximum uplink control plane user data the UE is allowed to send per 6 minute interval. The SMF may include the IP header compression configuration IE if: - the network accepts an IP PDU session type; - control plane CIoT 5GS optimization is selected; and - the UE provided the IP header compression configuration IE in the PDU SESSION ESTABLISHMENT REQUEST message. The network shall include this IE if the UE has requested to join one or more multicast MBS sessions. The PDU SESSION ESTABLISHMENT REJECT message is sent by the SMF to the UE in response to PDU SESSION ESTABLISHMENT REQUEST message and indicates unsuccessful establishment of a PDU session.",
    "See table 8.3.3.1.1. Message type: PDU SESSION ESTABLISHMENT REJECT Significance: dual Direction: network to UE Table 8.3.3.1.1: PDU SESSION ESTABLISHMENT REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION ESTABLISHMENT REJECT message identity Message type TLV F- Allowed SSC mode Allowed SSC mode TLV 7B Extended protocol configuration options Extended protocol configuration options TLV-E 4-65538 This IE is included when the external DN unsuccessfully performed authentication and authorization of the UE using EAP. 8.3.3.4A 5GSM congestion re-attempt indicator The network may include this IE only if it includes the Back-off timer value IE and the 5GSM cause value is either #67 \"insufficient resources for specific slice and DNN\" or #69 \"insufficient resources for specific slice\".",
    "The network shall include this IE if the service-level authentication and authorization procedure has completed unsuccessfully and the 5GSM cause is #29 \"user authentication or authorization failed\". The network shall include the service-level-AA response if provided by the DN in the service-level-AA container. V PDU session ID PDU session identity V EAP message EAP message This IE is included in the message when the network needs to transmit (protocol) data (e.g. configuration parameters, error codes or messages/events) to the UE. NOTE: How the Extended protocol configuration options IE is used by the network and the UE during the PDU session authentication and authorization procedure is not specified in this release of the specification. The PDU SESSION AUTHENTICATION COMPLETE message is sent by the UE to the SMF in response to the PDU SESSION AUTHENTICATION COMMAND message and indicates acceptance of the PDU SESSION AUTHENTICATION COMMAND message.",
    "See table 8.3.5.1.1. Message type: PDU SESSION AUTHENTICATION COMPLETE Significance: dual Direction: UE to network Table 8.3.5.1.1: PDU SESSION AUTHENTICATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION AUTHENTICATION COMPLETE message identity Message type TLV-E 4-65538 The PDU SESSION AUTHENTICATION RESULT message is sent by the SMF to the UE for indication of successful result of authentication of the UE participating in the PDU session.",
    "See table 8.3.6.1.1. Message type: PDU SESSION AUTHENTICATION RESULT Significance: dual Direction: network to UE Table 8.3.6.1.1: PDU SESSION AUTHENTICATION RESULT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION AUTHENTICATION RESULT message identity Message type TLV-E 4-65538 The PDU SESSION MODIFICATION REQUEST message is sent by the UE to the SMF to request a modification of a PDU session.",
    "See table 8.3.7.1.1. Message type: PDU SESSION MODIFICATION REQUEST Significance: dual Direction: UE to network Table 8.3.7.1.1: PDU SESSION MODIFICATION REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION MODIFICATION REQUEST message identity Message type TV Maximum number of supported packet filters Maximum number of supported packet filters TV 7A Requested QoS rules QoS rules TLV-E 7-65538 7B Extended protocol configuration options Extended protocol configuration options TLV 5-257 1F Ethernet header compression configuration Ethernet header compression configuration TLV-E 4-65538 Non-3GPP delay budget Non-3GPP delay budget This IE is included in the message: 1) for a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the UE has not previously successfully performed the UE-requested PDU session modification to provide this capability, and: a) if the PDU session is of \"IPv4\", \"IPv6\", \"IPv4v6\" or \"Ethernet\" PDU session type, and the UE supports reflective QoS; or b) if the PDU session is of \"IPv6\" or \"IPv4v6\" PDU session type, and the UE supports multi-homed IPv6 PDU session; or 2) if the UE needs to revoke the previously indicated support of reflective QoS.",
    "This IE shall be included in the message for a PDN connection established when in S1 mode, after an inter-system change from S1 mode to N1 mode, if the UE is a UE operating in single-registration mode in a network supporting N26 interface, the UE has not previously successfully performed the UE-requested PDU session modification to provide this capability, and the UE requests the PDU session to be an always-on PDU session in the 5GS. This IE is included in the message when the UE requests a specific QoS flow descriptions. This IE shall be included when the UE needs to convey a port management information container. This IE is included in the message when the UE requests to join or leave one or more multicast MBS sessions that are associated with the PDU session. This IE is included in the message when the UE sends one or more URSP rule enforcement reports to the network.",
    "V PDU session ID PDU session identity V 5GSM cause 5GSM cause TLV 7B Extended protocol configuration options Extended protocol configuration options The network may include this IE if the 5GSM cause is not #26 \"insufficient resources\", #37 \"5GS QoS not accepted\", #44 \"Semantic errors in packet filter(s)\", #45 \"Syntactical error in packet filter(s)\", #46 \"out of LADN service area\", #59 \"unsupported 5QI value\", #67 \"insufficient resources for specific slice and DNN\", #69 \"insufficient resources for specific slice\", #83 \"Semantic error in the QoS operation\", or #84 \"Syntactical error in the QoS operation\" to request a minimum time interval before procedure retry is allowed. 8.3.8.2A 5GSM congestion re-attempt indicator The network may include this IE only if it includes the Back-off timer value IE and the 5GSM cause value is either #67 \"insufficient resources for specific slice and DNN\" or #69 \"insufficient resources for specific slice\".",
    "The PDU SESSION MODIFICATION COMMAND message is sent by the SMF to the UE to indicate a modification of a PDU session. See table 8.3.9.1.1. Message type: PDU SESSION MODIFICATION COMMAND Significance: dual Direction: network to UE Table 8.3.9.1.1: PDU SESSION MODIFICATION COMMAND message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION MODIFICATION COMMAND message identity Message type TLV RQ timer value GPRS timer TLV-E 7-65538 Mapped EPS bearer contexts Mapped EPS bearer contexts TLV-E 4-65538 ATSSS container ATSSS container TLV-E 4-65538 1E Serving PLMN rate control Serving PLMN rate control TLV-E 9-65538 Service-level-AA container Service-level-AA container TLV-E 9-n Protocol description Protocol description This IE is included when the session-AMBR of the PDU session is modified. This IE is included when the authorized QoS rules of the PDU session are modified.",
    "This IE is included in the message when the network needs to transmit (protocol) data (e.g. configuration parameters, error codes or messages/events) to the UE. This IE is included in the message if the network wishes to re-negotiate IP header compression configuration associated to a PDU session and both the UE and the network support Control plane CIoT 5GS optimization and IP header compression. This IE is included in the message if the network wishes to re-negotiate Ethernet header compression configuration associated to a PDU session and both the UE and the network support Control plane CIoT 5GS optimization and Ethernet header compression. This IE shall be included when the network needs to provide the alternative S-NSSAI to replace the S-NSSAI of the SSC mode 1 or SSC mode 3 PDU session.",
    "The PDU SESSION MODIFICATION COMPLETE message is sent by the UE to the SMF in response to the PDU SESSION MODIFICATION COMMAND message and indicates an acceptance of the PDU SESSION MODIFICATION COMMAND message. See table 8.3.10.1.1. Message type: PDU SESSION MODIFICATION COMPLETE Significance: dual Direction: UE to network Table 8.3.10.1.1: PDU SESSION MODIFICATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION MODIFICATION COMPLETE message identity Message type TLV-E 4-65538 NOTE: It is possible for UEs compliant with version 15.3.0 of this specification to include the 5GSM cause IE with IEI 59 in the PDU SESSION MODIFICATION COMPLETE message, and therefore the IEI 59 cannot be used for other optional IEs other than the 5GSM cause IE for future extensions of the PDU SESSION MODIFICATION COMPLETE message.",
    "The PDU SESSION MODIFICATION COMMAND REJECT message is sent by the UE to the SMF to indicate rejection of the PDU SESSION MODIFICATION COMMAND message. See table 8.3.11.1.1. Message type: PDU SESSION MODIFICATION COMMAND REJECT Significance: dual Direction: UE to network Table 8.3.11.1.1: PDU SESSION MODIFICATION COMMAND REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION MODIFICATION COMMAND REJECT message identity Message type TLV-E 4-65538 The PDU SESSION RELEASE REQUEST message is sent by the UE to the SMF to request a release of a PDU session.",
    "See table 8.3.12.1.1. Message type: PDU SESSION RELEASE REQUEST Significance: dual Direction: UE to network Table 8.3.12.1.1: PDU SESSION RELEASE REQUEST message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION RELEASE REQUEST message identity Message type TLV-E 4-65538 The PDU SESSION RELEASE REJECT message is sent by the SMF to the UE to indicate rejection of request a release of a PDU session. See table 8.3.13.1.1. Message type: PDU SESSION RELEASE REJECT Significance: dual Direction: network to UE Table 8.3.13.1.1: PDU SESSION RELEASE REJECT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION RELEASE REJECT message identity Message type TLV-E 4-65538 The PDU SESSION RELEASE COMMAND message is sent by the SMF to the UE to indicate a release of a PDU session.",
    "See table 8.3.14.1.1. Message type: PDU SESSION RELEASE COMMAND Significance: dual Direction: network to UE Table 8.3.14.1.1: PDU SESSION RELEASE COMMAND message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V PDU SESSION RELEASE COMMAND message identity Message type TLV EAP message EAP message TLV-E 4-65538 D- Access type Access type 9.11.2.1A O TV Service-level-AA container Service-level-AA container The network may include this IE to request a minimum time interval before procedure retry is allowed. The network may include this IE only if it includes the Back-off timer value IE and the 5GSM cause value is either #67 \"insufficient resources for specific slice and DNN\" or #69 \"insufficient resources for specific slice\". This IE shall be included when the network needs to trigger the re-establishment of the PDU Session with the alternative S-NSSAI in SSC mode 2 or SSC mode 1.",
    "V PDU session ID PDU session identity V 5GSM cause 5GSM cause This IE is included in the message when the UE needs to indicate to the network that an error encountered with a mandatory information element in the PDU SESSION RELEASE COMMAND message. The 5GSM STATUS message is sent by the SMF or the UE to pass information on the status of the indicated PDU session and report certain error conditions. See table 8.3.16.1.1. Message type: 5GSM STATUS Significance: dual Direction: both Table 8.3.16.1.1: 5GSM STATUS message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V 5GSM STATUS message identity Message type The SERVICE-LEVEL AUTHENTICATION COMMAND message is sent by the SMF to the UE for service-level authentication and authorization procedure.",
    "See table 8.3.17.1.1. Message type: SERVICE-LEVEL AUTHENTICATION COMMAND Significance: dual Direction: network to UE Table 8.3.17.1.1: SERVICE-LEVEL AUTHENTICATION COMMAND message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V SERVICE-LEVEL AUTHENTICATION COMMAND message identity Message type The SERVICE-LEVEL AUTHENTICATION COMPLETE message is sent by the UE to the SMF in response to the SERVICE-LEVEL AUTHENTICATION COMMAND message and indicates acceptance of the SERVICE-LEVEL AUTHENTICATION COMMAND message.",
    "See table 8.3.18.1.1. Message type: SERVICE-LEVEL AUTHENTICATION COMPLETE Significance: dual Direction: UE to network Table 8.3.18.1.1: SERVICE-LEVEL AUTHENTICATION COMPLETE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V SERVICE-LEVEL AUTHENTICATION COMPLETE message identity Message type The REMOTE UE REPORT message is sent by the UE to the network to report connection or disconnection of 5G ProSe remote UE(s). See table 8.3.19.1. Message type: REMOTE UE REPORT Significance: dual Direction: UE to network Table 8.3.19.1: REMOTE UE REPORT message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V Remote UE report message identity Message type TLV-E 16-65538 The REMOTE UE REPORT RESPONSE message is sent by the network to the UE to acknowledge receipt of a remote UE report message.",
    "See table 8.3.20.1. Message type: REMOTE UE REPORT RESPONSE Significance: dual Direction: network to UE Table 8.3.20.1: REMOTE UE REPORT RESPONSE message content IEI Information Element Type/Reference Presence Format Length Extended protocol discriminator Extended protocol discriminator V Remote UE report response message identity Message type General message format and information elements coding When a field is contained within a single octet, the lowest numbered bit of the field represents the least significant bit. When a field extends over more than one octet, the order of bit values progressively decreases as the octet number increases. In that part of the field contained in a given octet, the lowest numbered bit represents the least significant bit. The most significant bit of the field is represented by the highest numbered bit of the lowest numbered octet of the field.",
    "The least significant bit of the field is represented by the lowest numbered bit of the highest numbered octet of the field. For example, a bit number can be identified as a couple (o, b) where o is the octet number and b is the relative bit number within the octet. Figure 9.1.2.1 illustrates a field that spans from bit (1, 3) to bit (2, 7). The most significant bit of the field is mapped on bit (1, 3) and the least significant bit is mapped on bit (2, 7). 1st octet of field 2nd octet of field Figure 9.1.2.1: Field mapping convention Bits 1 to 8 of the second octet of every 5GSM message contain the PDU session identity IE. The PDU session identity and its use to identify a message flow are defined in 3GPP TS 24.007 [11]. The Message type IE and its use are defined in 3GPP TS 24.007 [11]. Tables 9.7.1 and 9.7.2 define the value part of the message type IE used in the 5GS mobility management protocol and 5GS session management protocol.",
    "Table 9.7.1: Message types for 5GS mobility management Bits 8 7 6 5 4 3 2 1 0 1 - - - - - - 5GS mobility management messages 0 1 0 0 0 0 0 1 Registration request 0 1 0 0 0 0 1 0 Registration accept 0 1 0 0 0 0 1 1 Registration complete 0 1 0 0 0 1 0 0 Registration reject 0 1 0 0 0 1 0 1 Deregistration request (UE originating) 0 1 0 0 0 1 1 0 Deregistration accept (UE originating) 0 1 0 0 0 1 1 1 Deregistration request (UE terminated) 0 1 0 0 1 0 0 0 Deregistration accept (UE terminated) 0 1 0 0 1 1 0 0 Service request 0 1 0 0 1 1 0 1 Service reject 0 1 0 0 1 1 1 0 Service accept 0 1 0 0 1 1 1 1 Control plane service request 0 1 0 1 0 0 0 0 Network slice-specific authentication command 0 1 0 1 0 0 0 1 Network slice-specific authentication complete 0 1 0 1 0 0 1 0 Network slice-specific authentication result 0 1 0 1 0 1 0 0 Configuration update command 0 1 0 1 0 1 0 1 Configuration update complete 0 1 0 1 0 1 1 0 Authentication request 0 1 0 1 0 1 1 1 Authentication response 0 1 0 1 1 0 0 0 Authentication reject 0 1 0 1 1 0 0 1 Authentication failure 0 1 0 1 1 0 1 0 Authentication result 0 1 0 1 1 0 1 1 Identity request 0 1 0 1 1 1 0 0 Identity response 0 1 0 1 1 1 0 1 Security mode command 0 1 0 1 1 1 1 0 Security mode complete 0 1 0 1 1 1 1 1 Security mode reject 0 1 1 0 0 1 0 0 5GMM status 0 1 1 0 0 1 0 1 Notification 0 1 1 0 0 1 1 0 Notification response 0 1 1 0 0 1 1 1 UL NAS transport 0 1 1 0 1 0 0 0 DL NAS transport 0 1 1 0 1 0 0 1 Relay key request 0 1 1 0 1 0 1 0 Relay key accept 0 1 1 0 1 0 1 1 Relay key reject 0 1 1 0 1 1 0 0 Relay authentication request 0 1 1 0 1 1 0 1 Relay authentication response Table 9.7.2: Message types for 5GS session management Bits 8 7 6 5 4 3 2 1 1 1 - - - - - - 5GS session management messages 1 1 0 0 0 0 0 1 PDU session establishment request 1 1 0 0 0 0 1 0 PDU session establishment accept 1 1 0 0 0 0 1 1 PDU session establishment reject 1 1 0 0 0 1 0 1 PDU session authentication command 1 1 0 0 0 1 1 0 PDU session authentication complete 1 1 0 0 0 1 1 1 PDU session authentication result 1 1 0 0 1 0 0 1 PDU session modification request 1 1 0 0 1 0 1 0 PDU session modification reject 1 1 0 0 1 0 1 1 PDU session modification command 1 1 0 0 1 1 0 0 PDU session modification complete 1 1 0 0 1 1 0 1 PDU session modification command reject 1 1 0 1 0 0 0 1 PDU session release request 1 1 0 1 0 0 1 0 PDU session release reject 1 1 0 1 0 0 1 1 PDU session release command 1 1 0 1 0 1 0 0 PDU session release complete 1 1 0 1 0 1 1 0 5GSM status 1 1 0 1 1 0 0 0 Service-level authentication command 1 1 0 1 1 0 0 1 Service-level authentication complete 1 1 0 1 1 0 1 0 Remote UE report 1 1 0 1 1 0 1 1 Remote UE report response This IE includes the NAS message sequence number (SN) which consists of the eight least significant bits of the NAS COUNT for a SECURITY PROTECTED 5GS NAS MESSAGE message.",
    "The NAS message sequence number (SN) with the eight least significant bits of the NAS COUNT is also included in the Intra N1 mode NAS transparent container IE and in the N1 mode to S1 mode NAS transparent container IE. The usage of SN is specified in subclause 4.4.3. The purpose of the Additional information information element is to provide additional information to upper layers in relation to the NAS transport mechanism. The Additional information information element is coded as shown in figure 9.11.2.1.1 and table 9.11.2.1.1. The Additional information is a type 4 information element with a minimum length of 3 octets. Additional information IEI octet 1 Additional information length octet 2 Additional information value octets 3-n Figure 9.11.2.1.1: Additional information information element Table 9.11.2.1.1 : Additional information information element Additional information value (octet 3 to octet n) The coding of the additional information value is dependent on the LCS application.",
    "9.11.2.1A Access type The purpose of the access type information element is to indicate the access type over which the signalling or user data is pending to be sent to the UE. The access type is a type 1 information element. The access type information element is coded as shown in figure 9.11.2.1A.1 and table 9.11.2.1A.1. Access type IEI spare Access type octet 1 Figure 9.11.2.1A.1: Access type information element Table 9.11.2.1A.1: Access type information element Access type value (octet 1, bit 1 to bit 2) Bits 2 1 0 1 3GPP access 1 0 Non-3GPP access All other values are reserved. 9.11.2.1B DNN The purpose of the DNN information element is to identify the data network. The DNN information element is coded as shown in figure 9.11.2.1B.1. The DNN is a type 4 information element with a minimum length of 3 octets and a maximum length of 102 octets.",
    "DNN IEI octet 1 Length of DNN contents octet 2 DNN value octet 3 octet n Figure 9.11.2.1B.1: DNN information element A DNN value field contains an APN as defined in 3GPP TS 23.003 [4]. See subclause 10.5.7.4 in 3GPP TS 24.008 [12]. The purpose of the N1 mode to S1 mode NAS transparent container information element is to provide the UE with information that enables the UE to create a mapped EPS security context. The N1 mode to S1 mode NAS transparent container information element is coded as shown in figure 9.11.2.7.1 and table 9.11.2.7.1. The N1 mode to S1 mode NAS transparent container is a type 3 information element with a length of 2 octets. The value part of the N1 mode to S1 mode NAS transparent container information element is included in specific information elements within some RRC messages sent to the UE; see 3GPP TS 38.331 [30]. For these cases the coding of the information element identifier and length information is defined in 3GPP TS 38.331 [30].",
    "N1 mode to S1 mode NAS transparent container IEI octet 1 Sequence number octet 2 Figure 9.11.2.7.1: N1 mode to S1 mode NAS transparent container information element Table 9.11.2.7.1: N1 mode to S1 mode NAS transparent container information element Sequence number (octet 2) This field is coded as the Sequence number information element (see subclause 9.10). The purpose of the Service-level-AA container information element is to transfer upper layer information for authentication and authorization between the UE and the network. The Service-level-AA container information element is coded as shown in figure 9.11.2.10.1, figure 9.11.2.10.2, figure 9.11.2.10.3, figure 9.11.2.10.4 and table 9.11.2.10.1. The Service-level-AA container information element is a type 6 information element with a minimum length of 4 octets and a maximum length of 65538 octets.",
    "Service-level-AA container IEI octet 1 Length of Service-level-AA container contents octet 2 octet 3 octet 4 Service-level-AA container contents octet n Figure 9.11.2.10.1: Service-level-AA container information element Service-level-AA parameter 1 octet 4 octet x1 Service-level-AA parameter 2 octet x1+1* octet x2* …… … Service-level-AA parameter n octet xi +1* octet n* Figure 9.11.2.10.2: Service-level-AA container contents Type of service-level-AA parameter octet xi +1 Length of service-level-AA parameter octet xi +2 Value of service-level-AA parameter octet xi +3 octet n Figure 9.11.2.10.3: Service-level-AA parameter (when the type of service-level-AA parameter field contains an IEI of a type 4 information element as specified in 3GPP TS 24.007 [11]) Type of service-level-AA parameter octet xi +1 Length of service-level-AA parameter octet xi +2 octet xi +3 Value of service-level-AA parameter octet xi +4 octet n Figure 9.11.2.10.4: Service-level-AA parameter (when the type of service-level-AA parameter field contains an IEI of a type 6 information element as specified in 3GPP TS 24.007 [11]) Service-level-AA payload type octet xi +1 octet xi +3 Service-level-AA payload octet xi +4 octet n Figure 9.11.2.10.5: Service-level-AA parameter (when Service-level-AA payload type and its associated Service-level-AA payload are included in the Service-level-AA container contents) Type of service-level-AA parameter Value of service-level-AA parameter octet xi+1 Figure 9.11.2.10.6: Service-level-AA parameter (when the type of service-level-AA parameter field contains an IEI of a type 1 information element as specified in 3GPP TS 24.007 [11]) Table 9.11.2.10.1: Service-level-AA container information element Service-level-AA container contents (octet 4 to octet n); max value of 65535 octets The error handlings for service-level-AA parameters specified in subclauses 7.6.1, 7.6.3 and 7.7.1 shall apply to the service-level-AA parameters included in the service-level-AA container contents.",
    "Service-level-AA parameters Type of service-level-AA parameter (octet xi +1) This field contains the IEI of the service-level-AA parameter. Length of service-level-AA parameter This field indicates binary coded length of the value of the service-level-AA parameter. Value of service-level-AA parameter This field contains the value of the service-level-AA parameter with the value part of the referred information element based on following service-level-AA parameter reference. The receiving entity shall ignore service-level-AA parameter with type of service-level-AA parameter field containing an unknown IEI.",
    "IEI (hexadec imal) Service-level-AA parameter name Service-level-AA parameter reference Service-level device ID Service-level device ID (see subclause 9.11.2.11) Service-level-AA server address Service-level-AA server address (see subclause 9.11.2.12) Service-level-AA response Service-level-AA response (see subclause 9.11.2.14) Service-level-AA payload type Service-level-AA payload type (see subclause 9.11.2.15) (NOTE) Service-level-AA payload Service-level-AA payload (see subclause 9.11.2.13) A- Service-level-AA pending indication Service-level-AA pending indication (see subclause 9.11.2.17) Service-level-AA service status indication Service-level-AA service status indication (see subclause 9.11.2.18) NOTE: A service-level-AA payload type is always followed by the associated service- level-AA payload as shown in figure 9.11.2.10.5. The purpose of the Service-level-AA payload information element is to carry the upper layer payload for authentication and authorization between the UE and the service-level-AA server.",
    "The Service-level-AA payload information element is coded as shown in figure 9.11.2.13.1 and table 9.11.2.13.1. The Service-level-AA payload information element is a type 6 information element with minimum length of 4 octets and maximum length of 65538 octets. Service-level-AA payload IEI octet 1 Service-level-AA payload length octet 2 octet 3 Service-level-AA payload octets 4-s Figure 9.11.2.13.1: Service-level-AA payload information element Table 9.11.2.13.1: Service-level-AA payload information element Service-level-AA payload (octet 4 to octet s) A payload for authentication and authorization transparently transported and which is provided from/to the upper layers. The purpose of the Service-level-AA pending indication information element is to provide an indication that the service level authentication and authorization procedure is to be performed.",
    "The Service-level-AA pending indication information element is coded as shown in figure 9.11.2.17.1 and table 9.11.2.17.1. The Service-level-AA pending indication information element is a type 1 information element. Service-level-AA pending indication IEI Spare Spare Spare SLAPI octet 1 Figure 9.11.2.17.1: Service-level-AA pending indication Table 9.11.2.17.1: Service-level-AA pending indication Service-level-AA pending indication (SLAPI) (octet 1, bit 1) Bit 0 reserved 1 Service-level-AA procedure is to be performed See subclause 9.9.3.69 in 3GPP TS 24.301 [15]. The purpose of the 5GMM capability information element is to provide the network with information concerning aspects of the UE related to the 5GCN or interworking with the EPS. The contents might affect the manner in which the network handles the operation of the UE.",
    "The 5GMM capability information element is coded as shown in figure 9.11.3.1.1 and table 9.11.3.1.1. The 5GMM capability is a type 4 information element with a minimum length of 3 octets and a maximum length of 15 octets.",
    "5GMM capability IEI octet 1 Length of 5GMM capability contents octet 2 SGC 5G- IPHC- CP CIoT N3 data 5G-CP CIoT Restric tEC LPP HO attach S1 mode octet 3 RACS NSSA A 5G- LCS V2XC NPC5 V2XC EPC5 V2X 5G-UP CIoT 5GSR VCC octet 4* 5G ProSe- l2relay 5G ProSe- dc 5G ProSe- dd ER- NSSAI 5G- EHC- CP CIoT multipl eUP WUSA CAG octet 5* PR RPR PIV NCR NR- PSSI 5G ProSe- l3rmt 5G ProSe- l2rmt 5G ProSe- l3relay octet 6* MPSIU UAS NSAG Ex- CAG SSNP NSI Event Notific ation MINT NSSR G octet 7* SBTS NSR LADN- DS RAN timing ECI ESI RCMA N RCMA P octet 8* 5G ProSe- l2end 5G ProSe- l3U2U relay 5G ProSe- l2U2U relay RSLP S SBNS UN- PER A2XN PC5 A2XEP C5 octet 9* A2X- Uu SLVI Temp NS SUPL LCS- UPP PNS RSLP 5G ProSe- l3end octet 10* spare spare spare spare NSUC RSLPL NVL- SATN R MCSIU octet 11* octet 12*- 15* Spare Figure 9.11.3.1.1: 5GMM capability information element Table 9.11.3.1.1: 5GMM capability information element EPC NAS supported (S1 mode) (octet 3, bit 1) Bit S1 mode not supported S1 mode supported ATTACH REQUEST message containing PDN CONNECTIVITY REQUEST message for handover support (HO attach) (octet 3, bit 2) Bit ATTACH REQUEST message containing PDN CONNECTIVITY REQUEST message with request type set to \"handover\" or \"handover of emergency bearer services\" to transfer PDU session from N1 mode to S1 mode not supported ATTACH REQUEST message containing PDN CONNECTIVITY REQUEST message with request type set to \"handover\" or \"handover of emergency bearer services\" to transfer PDU session from N1 mode to S1 mode supported LTE Positioning Protocol (LPP) capability (octet 3, bit 3) This bit indicates the capability to support LTE Positioning Protocol (LPP) (see 3GPP TS 37.355 [26]).",
    "Bit LPP in N1 mode not supported LPP in N1 mode supported Restriction on use of enhanced coverage support (RestrictEC) (octet 3, bit 4) This bit indicates the capability to support restriction on use of enhanced coverage. Bit Restriction on use of enhanced coverage not supported Restriction on use of enhanced coverage supported Control plane CIoT 5GS optimization (5G-CP CIoT) (octet 3, bit 5) This bit indicates the capability for control plane CIoT 5GS optimization. Bit Control plane CIoT 5GS optimization not supported Control plane CIoT 5GS optimization supported N3 data transfer (N3 data) (octet 3, bit 6) This bit indicates the capability for N3 data transfer. Bit N3 data transfer supported N3 data transfer not supported IP header compression for control plane CIoT 5GS optimization (5G-IPHC-CP CIoT) (octet 3, bit 7) This bit indicates the capability for IP header compression for control plane CIoT 5GS optimization.",
    "Bit IP header compression for control plane CIoT 5GS optimization not supported IP header compression for control plane CIoT 5GS optimization supported Service gap control (SGC) (octet 3, bit 8) Bit service gap control not supported service gap control supported 5G-SRVCC from NG-RAN to UTRAN (5GSRVCC) capability (octet 4, bit 1) This bit indicates the capability for 5G-SRVCC from NG-RAN to UTRAN (5GSRVCC) (see 3GPP TS 23.216 [6A]). Bit 5G-SRVCC from NG-RAN to UTRAN not supported 5G-SRVCC from NG-RAN to UTRAN supported User plane CIoT 5GS optimization (5G-UP CIoT) (octet 4, bit 2) This bit indicates the capability for user plane CIoT 5GS optimization. Bit User plane CIoT 5GS optimization not supported User plane CIoT 5GS optimization supported V2X capability (V2X) (octet 4, bit 3) This bit indicates the capability for V2X, as specified in 3GPP TS 24.587 [19B].",
    "Bit V2X not supported V2X supported V2X communication over E-UTRA-PC5 capability (V2XCEPC5) (octet 4, bit 4) This bit indicates the capability for V2X communication over E-UTRA-PC5, as specified in 3GPP TS 24.587 [19B]. Bit V2X communication over E-UTRA-PC5 not supported V2X communication over E-UTRA-PC5 supported V2X communication over NR-PC5 capability (V2XCNPC5) (octet 4, bit 5) This bit indicates the capability for V2X communication over NR-PC5, as specified in 3GPP TS 24.587 [19B]. Bit V2X communication over NR-PC5 not supported V2X communication over NR-PC5 supported Location Services (5G-LCS) notification mechanisms capability (octet 4, bit 6) This bit indicates the capability to support Location Services (5G-LCS) notification mechanisms (see 3GPP TS 23.273 [6B]).",
    "Bit LCS notification mechanisms not supported LCS notification mechanisms supported Network slice-specific authentication and authorization (NSSAA) (octet 4, bit 7) This bit indicates the capability to support network slice-specific authentication and authorization. Bit Network slice-specific authentication and authorization not supported Network slice-specific authentication and authorization supported Radio capability signalling optimisation (RACS) capability (octet 4, bit 8) Bit RACS not supported RACS supported Closed Access Group (CAG) capability (octet 5, bit 1) Bit CAG not supported CAG supported WUS assistance (WUSA) information reception capability (octet 5, bit 2) Bit WUS assistance information reception not supported WUS assistance information reception supported Multiple user-plane resources support (multipleUP) (octet 5, bit 3) This bit indicates the capability to support multiple user-plane resources in NB-N1 mode.",
    "Bit Multiple user-plane resources not supported Multiple user-plane resources supported Ethernet header compression for control plane CIoT 5GS optimization (5G-EHC-CP CIoT) (octet 5, bit 4) Bit Ethernet header compression for control plane CIoT 5GS optimization not supported Ethernet header compression for control plane CIoT 5GS optimization supported Extended rejected NSSAI support (ER-NSSAI) (octet 5, bit 5) This bit indicates the capability to support extended rejected NSSAI. Bit Extended rejected NSSAI not supported Extended rejected NSSAI supported 5G ProSe direct discovery (5G ProSe-dd) (octet 5, bit 6) This bit indicates the capability for 5G ProSe direct discovery. Bit 5G ProSe direct discovery not supported 5G ProSe direct discovery supported 5G ProSe direct communication (5G ProSe-dc) (octet 5, bit 7) This bit indicates the capability for 5G ProSe direct communication.",
    "Bit 5G ProSe direct communication not supported 5G ProSe direct communication supported 5G ProSe layer-2 UE-to-network-relay (5G ProSe-l2relay) (octet 5, bit 8) This bit indicates the capability to act as a 5G ProSe layer-2 UE-to-network relay UE.",
    "Bit Acting as a 5G ProSe layer-2 UE-to-network relay UE not supported Acting as a 5G ProSe layer-2 UE-to-network relay UE supported 5G ProSe layer-3 UE-to-network-relay (5G ProSe-l3relay) (octet 6, bit 1) This bit indicates the capability to act as a 5G ProSe layer-3 UE-to-network relay UE Bit Acting as a 5G ProSe layer-3 UE-to-network relay UE not supported Acting as a 5G ProSe layer-3 UE-to-network relay UE supported 5G ProSe layer-2 UE-to-network-remote (5G ProSe-l2rmt) (octet 6, bit 2) This bit indicates the capability to act as a 5G ProSe layer-2 UE-to-network remote UE Bit Acting as a 5G ProSe layer-2 UE-to-network remote UE not supported Acting as a 5G ProSe layer-2 UE-to-network remote UE supported 5G ProSe layer-3 UE-to-network-remote (5G ProSe-l3rmt) (octet 6, bit 3) This bit indicates the capability to act as a 5G ProSe layer-3 UE-to-network remote UE Bit Acting as a 5G ProSe layer-3 UE-to-network remote UE not supported Acting as a 5G ProSe layer-3 UE-to-network remote UE supported NR paging subgroup support indication (NR-PSSI) (octet 6, bit 4) This bit indicates the capability to support NR paging subgrouping Bit NR paging subgrouping not supported NR paging subgrouping supported N1 NAS signalling connection release (NCR) (octet 6, bit 5) This bit indicates whether N1 NAS signalling connection release is supported.",
    "Bit N1 NAS signalling connection release not supported N1 NAS signalling connection release supported Paging indication for voice services (PIV) (octet 6, bit 6) This bit indicates whether paging indication for voice services is supported. Bit paging indication for voice services not supported paging indication for voice services supported Reject paging request (RPR) (octet 6, bit 7) This bit indicates whether reject paging request is supported. Bit reject paging request not supported reject paging request supported Paging restriction (PR) (octet 6, bit 8) This bit indicates whether paging restriction is supported. Bit paging restriction not supported paging restriction supported NSSRG (octet 7, bit 1) This bit indicates the capability to support the NSSRG.",
    "Bit NSSRG not supported NSSRG supported Minimization of service interruption (MINT) (octet 7, bit 2) This bit indicates the capability to support Minimization of service interruption (MINT) Bit MINT not supported MINT supported Event notification (EventNotification) (octet 7, bit 3) This bit indicates the capability to support event notification for upper layers Bit Event notification not supported Event notification supported SOR-SNPN-SI (SOR SNPN SI) (octet 7, bit 4) This bit indicates the capability to support SOR-SNPN-SI. Bit SOR-SNPN-SI not supported SOR-SNPN-SI supported Extended CAG information list support (Ex-CAG) (octet 7, bit 5) This bit indicates the capability to support extended CAG information list. Bit Extended CAG information list not supported Extended CAG information list supported NSAG (octet 7, bit 6) This bit indicates the capability to support NSAG.",
    "Bit NSAG not supported NSAG supported UAS (octet 7, bit 7) This bit indicates the capability to support UAS services. Bit UAS services not supported UAS services supported MPS indicator update (MPSIU) (octet 7, bit 8) This bit indicates the capability to support MPS indicator update via the UE configuration update procedure. Bit MPS indicator update not supported MPS indicator update supported Registration complete message for acknowledging negotiated PEIPS assistance information (RCMAP) (octet 8, bit 1) This bit indicates the capability for sending REGISTRATION COMPLETE message when Negotiated PEIPS assistance information IE is included in the REGISTRATION ACCEPT message.",
    "Bit Sending of REGISTRATION COMPLETE message for negotiated PEIPS assistance information not supported Sending of REGISTRATION COMPLETE message for negotiated PEIPS assistance information supported Registration complete message for acknowledging NSAG information (RCMAN) (octet 8, bit 2) This bit indicates the capability for sending REGISTRATION COMPLETE message when NSAG information IE is included in the REGISTRATION ACCEPT message. Bit Sending of REGISTRATION COMPLETE message for NSAG information not supported Sending of REGISTRATION COMPLETE message for NSAG information supported Equivalent SNPNs indicator (ESI) (octet 8, bit 3) This bit indicates the capability to support equivalent SNPNs. Bit Equivalent SNPNs not supported Equivalent SNPNs supported Enhanced CAG information (ECI) (octet 8, bit 4) This bit indicates the capability to support enhanced CAG information.",
    "Bit Enhanced CAG information not supported Enhanced CAG information supported Reconnection to the network due to RAN timing synchronization status change (RANtiming) (octet 8, bit 5) This bit indicates the capability to support Reconnection to the network due to RAN timing synchronization status change. Bit Reconnection to the network due to RAN timing synchronization status change not supported Reconnection to the network due to RAN timing synchronization status change supported LADN per DNN and S-NSSAI support (LADN-DS) (octet 8, bit 6) This bit indicates the capability to support LADN per DNN and S-NSSAI. Bit LADN per DNN and S-NSSAI not supported LADN per DNN and S-NSSAI supported Network slice replacement (NSR) (octet 8, bit 7) This bit indicates the capability to support network slice replacement.",
    "Bit Network slice replacement not supported Network slice replacement supported Slice-based TNGF selection support (SBTS) (octet 8, bit 8) This bit indicates the capability to support slice-based TNGF selection. Bit Slice-based TNGF selection not supported Slice-based TNGF selection supported A2X over E-UTRA-PC5 (A2XEPC5) (octet 9, bit 1) This bit indicates the capability for A2X over E-UTRA-PC5, as specified in 3GPP TS 24.577 [60]. Bit A2X over E-UTRA-PC5 not supported A2X over E-UTRA-PC5 supported A2X over NR-PC5 (A2XNPC5) (octet 9, bit 2) This bit indicates the capability for A2X over NR-PC5, as specified in 3GPP TS 24.577 [60]. Bit A2X over NR-PC5 not supported A2X over NR-PC5 supported Unavailability period (UN-PER) (octet 9, bit 3) This bit indicates the capability to support unavailability period.",
    "Bit Unavailability period not supported Unavailability period supported Slice-based N3IWFselection support (SBNS) (octet 9, bit 4) This bit indicates the capability to support slide-based N3IWF selection Bit Slice-based N3IWF selection not supported Slice-based N3IWF selection supported SL positioning server UE (RSLPS) (octet 9, bit 5) This bit indicates the capability for SL positioning server UE, as specified in 3GPP TS 24.586 [ts23586]. Bit Ranging and sidelink positioning for SL positioning server UE not supported Ranging and sidelink positioning for SL positioning server UE supported 5G ProSe layer-2 UE-to-UE relay (5G ProSe-l2U2U relay) (octet 9, bit 6) This bit indicates the capability to act as a 5G ProSe layer-2 UE-to-UE relay UE.",
    "Bit Acting as a 5G ProSe layer-2 UE-to-UE relay UE not supported Acting as a 5G ProSe layer-2 UE-to-UE relay UE supported 5G ProSe layer-3 UE-to-UE relay (5G ProSe-l3U2U relay) (octet 9, bit 7) This bit indicates the capability to act as a 5G ProSe layer-3 UE-to-UE relay UE. Bit Acting as a 5G ProSe layer-3 UE-to-UE relay UE not supported Acting as a 5G ProSe layer-3 UE-to-UE relay UE supported 5G ProSe layer-2 end UE (5G ProSe-l2end) (octet 9, bit 8) This bit indicates the capability to act as a 5G ProSe layer-2 end UE. Bit Acting as a 5G ProSe layer-23 UE-to-UE relayend UE not supported Acting as a 5G ProSe layer-23 UE-to-UE relayend UE supported 5G ProSe layer-3 end UE (5G ProSe-l3end) (octet 10, bit 1) This bit indicates the capability to act as a 5G ProSe layer-3 end UE.",
    "Bit Acting as a 5G ProSe layer-3 end UE not supported Acting as a 5G ProSe layer-3 end UE supported Ranging and sidelink positioning support (RSLP) (octet 10, bit 2) Bit Ranging and sidelink positioning not supported Ranging and sidelink positioning supported Partial network slice (PNS) (octet 10, bit 3) This bit indicates whether the UE support partial network slice in the registration area. Bit Partial network slice not supported Partial network slice supported LCS-UPP user plane positioning (LCS-UPP) (octet 10, bit 4) This bit indicates the capability to support LCS-UPP user plane positioning (see 3GPP TS 23.273 [6B]). Bit User plane positioning using LCS-UPP not supported User plane positioning using LCS-UPP supported SUPL user plane positioning (SUPL) (octet 10, bit 5) This bit indicates the capability to support SUPL user plane positioning (see 3GPP TS 38.305 [67] and 3GPP TS 23.271 [68]).",
    "Bit User plane positioning using SUPL not supported User plane positioning using SUPL supported S-NSSAI time validity information (TempNS) (octet 10, bit 6) This bit indicates the capability to support the S-NSSAI time validity information. Bit S-NSSAI time validity information not supported S-NSSAI time validity information supported S-NSSAI location validity information (SLVI) (octet 10, bit 7) This bit indicates the capability to support S-NSSAI location validity information. Bit S-NSSAI location validity information not supported S-NSSAI location validity information supported A2X over Uu capability (A2X-Uu) (octet 10, bit 8) This bit indicates the capability for A2X over Uu, as specified in 3GPP TS 24.577 [60]. Bit A2X over Uu not supported A2X over Uu supported MCS indicator update (MCSIU) (octet 11, bit 1) This bit indicates the capability to support MCS indicator update via the UE configuration update procedure.",
    "Bit MCS indicator update not supported MCS indicator update supported Network verified UE location over satellite NG-RAN (NVL-SATNR) (octet 11, bit 2) This bit indicates the capability to support network verified UE location over satellite NG-RAN as specified in 3GPP TS 23.501 [8]. Bit Network verified UE location over satellite NG-RAN not supported Network verified UE location over satellite NG-RAN supported Ranging and sidelink positioning over PC5 for located UE support (RSLPL) (octet 11, bit 3) This bit indicates the capability to support ranging and sidelink positioning over PC5 for located UE support. Bit Ranging and sidelink positioning for located UE not supported Ranging and sidelink positioning for located UE supported Network slice usage control (NSUC) (octet 11, bit 4) This bit indicates the capability to support network slice usage control.",
    "Bit Network slice usage control not supported Network slice usage control supported Bits 5 to 8 in octet 11 and bits in octets 12 to 15 are spare and shall be coded as zero, if the respective octet is included in the information element. The purpose of the 5GS mobile identity information element is to provide either the SUCI, the 5G-GUTI, the IMEI, the IMEISV, the 5G-S-TMSI, the MAC address or the EUI-64. The 5GS mobile identity information element is coded as shown in figures 9.11.3.4.1, 9.11.3.4.2, 9.11.3.4.3, 9.11.3.4.4, 9.11.3.4.5, 9.11.3.4.6, 9.11.3.4.8 and 9.11.3.4.7, and table 9.11.3.4.1. The 5GS mobile identity is a type 6 information element with a minimum length of 4.",
    "5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 spare Type of identity octet 4 MCC digit 2 MCC digit 1 octet 5 MNC digit 3 MCC digit 3 octet 6 MNC digit 2 MNC digit 1 octet 7 AMF Region ID octet 8 AMF Set ID octet 9 AMF Set ID (continued) AMF Pointer octet 10 5G-TMSI octet 11 5G-TMSI (continued) octet 12 5G-TMSI (continued) octet 13 5G-TMSI (continued) octet 14 Figure 9.11.3.4.1: 5GS mobile identity information element for type of identity \"5G-GUTI\" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 Identity digit 1 odd/ even indic Type of identity octet 4 Identity digit p+1 Identity digit p octet 5* Figure 9.11.3.4.2: 5GS mobile identity information element for type of identity \"IMEI\" or \"IMEISV\" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 spare SUPI format spare Type of identity octet 4 MCC digit 2 MCC digit 1 octet 5 MNC digit 3 MCC digit 3 octet 6 MNC digit 2 MNC digit 1 octet 7 Routing indicator digit 2 Routing indicator digit 1 octet 8 Routing indicator digit 4 Routing indicator digit 3 octet 9 Spare Spare Spare Spare Protection scheme Id octet 10 Home network public key identifier octet 11 Scheme output octet 12 - x Figure 9.11.3.4.3: 5GS mobile identity information element for type of identity \"SUCI\" and SUPI format \"IMSI\" MSIN digit 2 MSIN digit 1 octet 12 … MSIN digit n+1 MSIN digit n octet x Figure 9.11.3.4.3a: Scheme output for type of identity \"SUCI\", SUPI format \"IMSI\" and Protection scheme Id \"Null scheme\" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 Spare SUPI format Spare Type of identity octet 4 SUCI NAI octet 5 - y Figure 9.11.3.4.4: 5GS mobile identity information element for type of identity \"SUCI\" and SUPI format \"Network specific identifier\", \"GCI\" or \"GLI\" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 spare Type of identity octet 4 AMF Set ID octet 5 AMF Set ID (continued) AMF Pointer octet 6 5G-TMSI octet 7 5G-TMSI (continued) octet 8 5G-TMSI (continued) octet 9 5G-TMSI (continued) octet 10 Figure 9.11.3.4.5: 5GS mobile identity information element for type of identity \"5G-S-TMSI\" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 Type of identity octet 4 spare Figure 9.11.3.4.6: 5GS mobile identity information element for type of identity \"No identity\" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 spare spare spare spare MAUR I Type of identity octet 4 MAC address octet 5 octet 10 Figure 9.11.3.4.7: 5GS mobile identity information element for type of identity \"MAC address\" 5GS mobile identity IEI octet 1 Length of 5GS mobile identity contents octet 2 octet 3 spare spare spare spare spare Type of identity octet 4 EUI-64 octet 5 octet 12 Figure 9.11.3.4.8: 5GS mobile identity information element for type of identity \"EUI-64\" Table 9.11.3.4.1: 5GS mobile identity information element Type of identity (octet 4) Bits 3 2 1 0 0 0 No identity (see NOTE 1) 0 0 1 SUCI 0 1 0 5G-GUTI 0 1 1 IMEI 1 0 0 5G-S-TMSI 1 0 1 IMEISV 1 1 0 MAC address 1 1 1 EUI-64 All other values are reserved.",
    "Odd/even indication (octet 4) Bit even number of identity digits odd number of identity digits For the 5G-GUTI, then bits 5 to 8 of octet 4 are coded as \"1111\", octet 5 through 7 contain the MCC and MNC values as specified below, octet 8 through 10 contain the AMF Region ID, the AMF Set ID and the AMF Pointer values and octet 11 through 14 contain the 5G-TMSI as defined in 3GPP TS 23.003 [4]. MCC, Mobile country code (octet 5, octet 6 bits 1 to 4) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A. MNC, Mobile network code (octet 6 bits 5 to 8, octet 7) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, bits 5 to 8 of octet 6 shall be coded as \"1111\". The MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group identity IE in figure 10.5.154 of 3GPP TS 24.008 [12].",
    "AMF Region ID (octet 8) This field contains the binary encoding of the AMF Region ID. Bit 8 of octet 7 is the most significant bit and bit 1 of octet 7 is the least significant bit. AMF Set ID (octet 9, octet 10 bits 7 to 8) This field contains the binary encoding of the AMF Set ID. Bit 8 of octet 9 is the most significant bit and bit 7 of octet 10 is the least significant bit. AMF Pointer (octet 10 bits 1 to 6) This field contains the binary encoding of the AMF Pointer. Bit 6 of octet 9 is the most significant bit and bit 1 of octet 9 is the least significant bit. 5G-TMSI (octet 11 to 14) Bit 8 of octet 11 is the most significant bit and bit 1 of octet 14 is the least significant bit. Identity digit (octet 4 bits 5 to 8, octet 5 etc.) For the IMEI, Identity digit field is coded using BCD coding. If the number of identity digits is even then bits 5 to 8 of the last octet shall be filled with an end mark coded as \"1111\". The format of the IMEI is described in 3GPP TS 23.003 [4].",
    "For the IMEISV, Identity digit field is coded using BCD coding. Bits 5 to 8 of the last octet shall be filled with an end mark coded as \"1111\". The format of the IMEISV is described in 3GPP TS 23.003 [4]. For the SUCI, bit 8 of octet 4 is spare and shall be coded as zero. Bits 5-7 of octet 4 contain the SUPI format and are coded as shown below. SUPI format (octet 4, bits 5-7) Bits 7 6 5 0 0 0 IMSI 0 0 1 Network specific identifier 0 1 0 GCI 0 1 1 GLI All other values are interpreted as IMSI by this version of the protocol. For the SUCI with SUPI format \"IMSI\", octets 5 through 7 contain the MCC and MNC values as specified below. For subsequent fields, bit 8 of octet 8 is the most significant bit and bit 1 of the last octet the least significant bit. The required fields for the SUCI are as defined in 3GPP TS 23.003 [4]. MCC, Mobile country code (octet 5, octet 6 bits 1 to 4) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A.",
    "MNC, Mobile network code (octet 6 bits 5 to 8, octet 7) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, bits 5 to 8 of octet 6 shall be coded as \"1111\". The MCC and MNC digits are coded as octets 6 to 8 of the Temporary mobile group identity IE in figure 10.5.154 of 3GPP TS 24.008 [12]. Routing indicator (octets 8-9) Routing Indicator shall consist of 1 to 4 digits. The coding of this field is the responsibility of home network operator but BCD coding shall be used. If a network operator decides to assign less than 4 digits to Routing Indicator, the remaining digits shall be coded as \"1111\" to fill the 4 digits coding of Routing Indicator (see NOTE 2). If no Routing Indicator is configured in the USIM or the ME, the UE shall code bits 1 to 4 of octet 8 of the Routing Indicator as \"0000\" and the remaining digits as \"1111\".",
    "Protection scheme identifier (octet 10 bits 1 to 4) Bits 4 3 2 1 0 0 0 0 Null scheme 0 0 0 1 ECIES scheme profile A 0 0 1 0 ECIES scheme profile B 0 0 1 1 to Reserved 1 0 1 1 1 1 0 0 to Operator-specific protection scheme 1 1 1 1 Bits 5-8 of octet 10 are spare and shall be coded as zero. Home network public key identifier (octet 11) The Home network public key identifier (PKI) field is coded as defined in 3GPP TS 23.003 [4]. Home network public key identifier shall be coded as \"00000000\" when Protection scheme identifier is set to \"0000\" (i.e. Null scheme). Bits 8 7 6 5 4 3 2 1 0 0 0 0 0 0 0 0 Home network PKI value 0 0 0 0 0 0 0 0 1 to Home network PKI value (1-254) 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 Reserved Scheme output (octets 12 to x) The Scheme output field consists of a string of characters with a variable length or hexadecimal digits as specified in 3GPP TS 23.003 [4].",
    "If Protection scheme identifier is set to \"0000\" (i.e. Null scheme), then the Scheme output consists of the MSIN and is coded using BCD coding with each digit of the MSIN coded over 4 bits. If the MSIN includes an odd number of digits, bits 5 to 8 of octet x shall be coded as \"1111\". If Protection scheme identifier is not \"0000\" (i.e. ECIES scheme profile A, ECIES scheme profile B or Operator-specific protection scheme), then Scheme output is coded as hexadecimal digits. For the SUCI with SUPI format set to \"Network specific identifier\", the SUCI NAI field contains an NAI constructed as specified in subclause 28.7.3 of 3GPP TS 23.003 [4] and encoded as UTF-8 string. For the SUCI with SUPI format set to \"GCI\", the SUCI NAI field contains an NAI constructed as specified in subclause 28.15.5 of 3GPP TS 23.003 [4] and encoded as UTF-8 string.",
    "For the SUCI with SUPI format set to \"GLI\", the SUCI NAI field contains an NAI constructed as specified in subclause 28.16.5 of 3GPP TS 23.003 [4] and encoded as UTF-8 string. For the 5G-S-TMSI, bits 5 to 8 of octet 4 are coded as \"1111\". The coding of the 5G-S- TMSI is left open for each administration. AMF Set ID (octet 5, octet 6 bits 7 to 8) This field contains the binary encoding of the AMF Set ID. Bit 8 of octet 5 is the most significant bit and bit 7 of octet 6 is the least significant bit. AMF Pointer (octet 6 bits 1 to 6) This field contains the binary encoding of the AMF Pointer. Bit 6 of octet 6 is the most significant bit and bit 1 of octet 6 is the least significant bit. 5G-TMSI (octet 7 to 10) Bit 8 of octet 7 is the most significant bit and bit 1 of octet 10 is the least significant bit. For Type of identity \"No identity\", the length of mobile identity contents parameter shall be set to 1 and the bits 4-8 of octet 4 are spare and shall be coded as zero.",
    "MAC address usage restriction indication (MAURI) (octet 4 bit 4) Bit No restrictions MAC address is not usable as an equipment identifier MAC address (octets 5 to 10) This field contains the MAC address as defined in subclause 8 of IEEE Std 802 [43]. Bit 8 of octet 5 is the most significant bit and bit 1 of octet 10 is the least significant bit. EUI-64 (octets 5 to 12) This field contains an EUI-64 as defined in [48]. Bit 8 of octet 5 is the most significant bit and bit 1 of octet 12 is the least significant bit. NOTE 1: This can be used when the requested identity is not available at the UE during the identification procedure. NOTE 2: For a 3-digit Routing Indicator, e.g \"567\", bits 1 to 4 of octet 8 are coded as \"0101\", bits 5 to 8 of octet 8 are coded as \"0110\", bits 1 to 4 of octet 9 are coded as \"0111\", bits 5 to 8 of octet 9 are coded as \"1111\". The purpose of the 5GS registration type information element is to indicate the type of the requested registration.",
    "The 5GS registration type information element is coded as shown in figure 9.11.3.7.1 and table 9.11.3.7.1. The 5GS registration type is a type 1 information element with a length of 1 octet. 5GS registration type IEI FOR 5GS registration type value octet 1 Figure 9.11.3.7.1: 5GS registration type information element Table 9.11.3.7.1: 5GS registration type information element 5GS registration type value (octet 1, bits 1 to 3) Bits 3 2 1 0 0 1 initial registration 0 1 0 mobility registration updating 0 1 1 periodic registration updating 1 0 0 emergency registration 1 0 1 SNPN onboarding registration 1 1 0 disaster roaming mobility registration updating 1 1 1 disaster roaming initial registration All other values are unused and shall be interpreted as \"initial registration\", if received by the network.",
    "Follow-on request bit (FOR) (octet 1, bit 4) Bit No follow-on request pending Follow-on request pending The purpose of the ABBA information element is to enable the bidding down protection of security features. The ABBA information element is coded as shown in figure 9.11.3.10.1 and table 9.11.3.10.1. The ABBA is a type 4 information element with a minimum length of 4 octets and maximum length of 257 octets. ABBA IEI octet 1 Length of ABBA contents octet 2 ABBA contents octet 3 octet n Figure 9.11.3.10.1: ABBA information element Table 9.11.3.10.1: ABBA information element ABBA contents (octet 3-n): indicate set of security features defined for 5GS as described in 3GPP TS 33.501 [24]. NOTE 1: If the UE receives the ABBA IE with a length that is set to a value of 2 and with a value of 0000H, the UE shall use the length and the contents of the ABBA IE as received from the network.",
    "NOTE 2: If the UE receives the ABBA IE with a length that is set to a value larger than 2 or with a value that is different from 0000H, the UE shall use the length and the contents of the ABBA IE as received from the network. The purpose of the Allowed PDU session status information element is to indicate to the network user-plane resources of PDU sessions associated with non-3GPP access that are allowed to be re-established over 3GPP access or if there is no PDU session(s) for which the UE allows the user-plane resources to be re-established over 3GPP access. NOTE: Allowed PDU session status IE is not applicable for MA PDU session(s) in this release of specification. The Allowed PDU session status information element is coded as shown in figure 9.11.3.13.1 and table 9.11.3.13.1. The Allowed PDU session status is a type 4 information element with minimum length of 4 octets and maximum length of 34 octets.",
    "Allowed PDU session status IEI octet 1 Length of Allowed PDU session status contents octet 2 PSI (7) PSI (6) PSI (5) PSI (4) PSI (3) PSI (2) PSI (1) PSI (0) octet 3 PSI (15) PSI (14) PSI (13) PSI (12) PSI (11) PSI (10) PSI (9) PSI (8) octet 4 Spare octet 5* -34* Figure 9.11.3.13.1: Allowed PDU session status information element Table 9.11.3.13.1: Allowed PDU session status information element PSI(x) shall be coded as follows: PSI(0): Bit 1 octet 3 is spare and shall be coded as zero. PSI(1) – PSI(15): 0 indicates that the user-plane resources of corresponding PDU session is not allowed to be re-established over 3GPP access. 1 indicates that the user-plane resources of corresponding PDU session can be re-established over 3GPP access. If there is no PDU session for which the user-plane resources can be re-established over 3GPP access, all bits in PSI(1) – PSI(15) shall be coded as zero.",
    "All bits in octet 5 to 34 are spare and shall be coded as zero, if the respective octet is included in the information element. See subclause 10.5.3.1 in 3GPP TS 24.008 [12]. See subclause 10.5.3.12 in 3GPP TS 24.008 [12]. See subclause 10.5.3.13 in 3GPP TS 24.008 [12]. 9.11.3.23A EPS bearer context status See subclause 9.9.2.1 in 3GPP TS 24.301 [15]. See subclause 9.9.3.37A in 3GPP TS 24.301 [15]. 9.11.3.26A Extended DRX parameters See subclause 10.5.5.32 in 3GPP TS 24.008 [12]. The purpose of the LADN indication information element is to request the network for LADN information for specific LADN DNN(s) or to indicate a request for LADN information. The LADN indication information element is coded as shown in figure 9.11.3.29.1 and table 9.11.3.29.1. The LADN indication is a type 6 information element with a minimum length of 3 octets and a maximum length of 811 octets. The LADN indication information element can contain a minimum of 0 and a maximum of 8 different LADN DNN values.",
    "LADN indication IEI octet 1 Length of LADN indication contents octet 2 octet 3 LADN DNN value 1 octet 4* octet a* LADN DNN value 2 octet a+1* octet b* … octet b+1* octet g* LADN DNN value n octet g+1* octet h* Figure 9.11.3.29.1: LADN indication information element Table 9.11.3.29.1: LADN indication information element Value part of the LADN indication information element (octet 4 to h): The value part of the LADN indication information element consists of zero or more LADN DNN values. If the LADN indication information element conveys more than 8 LADN DNN values in this information element, the network shall consider the first 8 LADN DNN values and ignore the remaining octets of the information element. LADN DNN value: LADN DNN value is coded as the length and value part of DNN information element as specified in subclause 9.11.2.1B starting with the second octet. NOTE 2: If the octet 5 is included, then octet 6 and octet 7 shall be included.",
    "9.11.3.31C Mobile station classmark 2 See subclause 10.5.1.6 in 3GPP TS 24.008 [12]. The purpose of the NAS security algorithms information element is to indicate the 5G algorithms to be used for ciphering and integrity protection. The NAS security algorithms information element is coded as shown in figure 9.11.3.34.1 and table 9.11.3.34.1. The NAS security algorithms is a type 3 information element with a length of 2 octets.",
    "NAS security algorithms IEI octet 1 Type of ciphering algorithm Type of integrity protection algorithm octet 2 Figure 9.11.3.34.1: NAS security algorithms information element Table 9.11.3.34.1: NAS security algorithms information element Type of integrity protection algorithm (octet 2, bit 1 to 3) Bits 4 3 2 1 0 0 0 0 5G integrity algorithm 5G-IA0 (null integrity protection algorithm) 0 0 0 1 5G integrity algorithm 128-5G-IA1 0 0 1 0 5G integrity algorithm 128-5G-IA2 0 0 1 1 5G integrity algorithm 128-5G-IA3 0 1 0 0 5G integrity algorithm 5G-IA4 0 1 0 1 5G integrity algorithm 5G-IA5 0 1 1 0 5G integrity algorithm 5G-IA6 0 1 1 1 5G integrity algorithm 5G-IA7 All other values are reserved.",
    "Type of ciphering algorithm (octet 2, bit 5 to 7) Bits 8 7 6 5 0 0 0 0 5G encryption algorithm 5G-EA0 (null ciphering algorithm) 0 0 0 1 5G encryption algorithm 128-5G-EA1 0 0 1 0 5G encryption algorithm 128-5G-EA2 0 0 1 1 5G encryption algorithm 128-5G-EA3 0 1 0 0 5G encryption algorithm 5G-EA4 0 1 0 1 5G encryption algorithm 5G-EA5 0 1 1 0 5G encryption algorithm 5G-EA6 0 1 1 1 5G encryption algorithm 5G-EA7 All other values are reserved. The purpose of the NSSAI information element is to identify a collection of S-NSSAIs The NSSAI information element is coded as shown in figure 9.11.3.37.1 and table 9.11.3.37.1. The NSSAI is a type 4 information element with a minimum length of 4 octets and a maximum length of 146 octets. NOTE: More than one S-NSSAIs in an NSSAI can have the same SST values, and optionally same SD values, which are associated with different mapped HPLMN SST values and optionally mapped HPLMN SD values.",
    "NSSAI IEI octet 1 Length of NSSAI contents octet 2 S-NSSAI value 1 octet 3 octet m S-NSSAI value 2 octet m+1* octet n* … octet n+1* octet u* S-NSSAI value n octet u+1* octet v* Figure 9.11.3.37.1: NSSAI information element Table 9.11.3.37.1: NSSAI information element Value part of the NSSAI information element (octet 3 to v) The value part of the NSSAI information element consists of one or more S-NSSAI values. Each S-NSSAI value consists of one S-NSSAI and optionally one mapped S- NSSAI. The recipient of this information element shall store the complete list received (NOTE 1, NOTE 2, NOTE 3). If the NSSAI information element conveys an allowed NSSAI and more than 8 S-NSSAI values are included in this information element, the UE shall store the first 8 S-NSSAI values and ignore the remaining octets of the information element.",
    "If the NSSAI information element conveys a configured NSSAI (including the default configured NSSAI) or pending NSSAI and more than 16 S-NSSAI values are included in this information element, the UE shall store the first 16 S-NSSAI values and ignore the remaining octets of the information element. S-NSSAI value: S-NSSAI value is coded as the length and value part of S-NSSAI information element as specified in subclause 9.11.2.8 starting with the second octet. NOTE 1: The total number of S-NSSAI values in a requested NSSAI shall not exceed eight. NOTE 2: The number of S-NSSAI values in an allowed NSSAI shall not exceed eight. NOTE 3: The number of S-NSSAI values in a configured NSSAI (including the default configured NSSAI) or pending NSSAI shall not exceed sixteen. 9.11.3.37A NSSAI inclusion mode The purpose of the NSSAI inclusion mode information element is to indicate the NSSAI inclusion mode in which the UE shall operate. The NSSAI inclusion mode is a type 1 information element.",
    "The NSSAI inclusion mode information element is coded as shown in figure 9.11.3.37A.1 and table 9.11.3.37A.1. NSSAI inclusion mode IEI spare spare NSSAI inclusion mode octet 1 Figure 9.11.3.37A.1: NSSAI inclusion mode information element Table 9.11.3.37A.1: NSSAI inclusion mode information element NSSAI inclusion mode (octet 1, bit 1 to bit 2) Bits 2 1 0 0 NSSAI inclusion mode A 0 1 NSSAI inclusion mode B 1 0 NSSAI inclusion mode C 1 1 NSSAI inclusion mode D The purpose of the Payload container type information element indicates type of payload included in the payload container information element. The Payload container type information element is coded as shown in figure 9.11.3.40.1 and table 9.11.3.40.1. The Payload container type information element is a type 1 information element.",
    "Payload container type IEI Payload container type value octet 1 Figure 9.11.3.40.1: Payload container type information element Table 9.11.3.40.1: Payload container type information element Payload container type value (octet 1) Bits 4 3 2 1 0 0 0 1 N1 SM information 0 0 1 0 SMS 0 0 1 1 LTE Positioning Protocol (LPP) message container 0 1 0 0 SOR transparent container 0 1 0 1 UE policy container 0 1 1 0 UE parameters update transparent container 0 1 1 1 Location services message container (see 3GPP TS 23.273 [6B]) 1 0 0 0 CIoT user data container 1 0 0 1 Service-level-AA container 1 0 1 0 Event notification 1 0 1 1 UPP-CMI container 1 1 0 0 SLPP message container 1 1 1 1 Multiple payloads All other values are reserved.",
    "NOTE: The value \"Multiple payloads\" is only used when the Payload container contents in figure 9.11.3.39.1 contains multiple payloads as shown in figure 9.11.3.39.2. The purpose of the PDU session reactivation result error cause information element is to indicate error causes for PDU session ID(s) where there was a failure to establish the user-plane resources. The PDU session reactivation result error cause information element is coded as shown in figure 9.11.3.43.1 and table 9.11.3.43.1. The PDU session reactivation result error cause is a type 6 information element with a minimum length of 5 octets and a maximum length of 515 octets. PDU session reactivation result error cause IEI octet 1 Length of PDU session reactivation result error cause octet 2 octet 3 PDU session ID octet 4 cause value octet 5 ….",
    "PDU session ID octet 514* cause value octet 515* Figure 9.11.3.43.1: PDU session reactivation result error cause information element Table 9.11.3.43.1: PDU session reactivation result error cause information element PDU session ID is coded same as PDU session ID IE (see subclause 9.4). The cause value is coded same as second octet of 5GMM cause information element (see subclause 9.11.3.2). The purpose of the Rejected NSSAI information element is to identify a collection of rejected S-NSSAIs. The Rejected NSSAI information element is coded as shown in figure 9.11.3.46.1, figure 9.11.3.46.2 and table 9.11.3.46.1. The Rejected NSSAI is a type 4 information element with a minimum length of 4 octets and a maximum length of 42 octets.",
    "Rejected NSSAI IEI octet 1 Length of Rejected NSSAI contents octet 2 Rejected S-NSSAI 1 octet 3 octet m Rejected S-NSSAI 2 octet m+1* octet n* … octet n+1* octet u* Rejected S-NSSAI n octet u+1* octet v* Figure 9.11.3.46.1: Rejected NSSAI information element Length of rejected S-NSSAI Cause value octet 3 SST octet 4 SD octet 5* octet 7* Figure 9.11.3.46.2: Rejected S-NSSAI Table 9.11.3.46.1: Rejected NSSAI information element Value part of the Rejected NSSAI information element (octet 3 to v) The value part of the Rejected NSSAI information element consists of one or more rejected S-NSSAIs. Each rejected S-NSSAI consists of one S-NSSAI and an associated cause value. The length of each rejected S-NSSAI can be determined by the 'length of rejected S-NSSAI' field in the first octet of the rejected S-NSSAI. The UE shall store the complete list received (NOTE 0).",
    "If more than 8 rejected S- NSSAIs are included in this information element, the UE shall store the first 8 rejected S-NSSAIs and ignore the remaining octets of the information element. Rejected S-NSSAI: Cause value (octet 3) Bits 4 3 2 1 0 0 0 0 S-NSSAI not available in the current PLMN or SNPN 0 0 0 1 S-NSSAI not available in the current registration area 0 0 1 0 S-NSSAI not available due to the failed or revoked network slice- specific authentication and authorization All other values are reserved. Slice/service type (SST) (octet 4) This field contains the 8 bit SST value. The coding of the SST value part is defined in 3GPP TS 23.003 [4]. (NOTE 2) Slice differentiator (SD) (octet 5 to octet 7) This field contains the 24 bit SD value. The coding of the SD value part is defined in 3GPP TS 23.003 [4]. (NOTE 3) NOTE 0: The number of rejected S-NSSAI(s) shall not exceed eight. NOTE 1: If octet 5 is included, then octet 6 and octet 7 shall be included.",
    "NOTE 2: If the Cause value is \"S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization\", this field shall contain the 8 bit SST value of an S-NSSAI in the S-NSSAI(s) of the HPLMN. NOTE 3: If the Cause value is \"S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization\", this field, if included, shall contain the 24 bit SD value of an S-NSSAI in the S-NSSAI(s) of the HPLMN. 9.11.3.46A Release assistance indication See subclause 9.9.4.25 in 3GPP TS 24.301 [15]. The purpose of the Service area list information element is to transfer a list of allowed tracking areas for an allowed area or a list of non-allowed tracking areas for a non-allowed area from the network to the UE. The coding of the information element allows combining different types of lists. The lists of type \"00\" and \"01\" allow a more compact encoding, when the different TAIs are sharing the PLMN identity.",
    "The lists of type \"11\" indicate all TAIs of the PLMNs in the registration area are allowed area. The Service area list information element is coded as shown in figure 9.11.3.49.1, figure 9.11.3.49.2, figure 9.11.3.49.3, figure 9.11.3.49.4, figure 9.11.3.49.5 and table 9.11.3.49.1. The Service area list is a type 4 information element with a minimum length of 6 octets and a maximum length of 114 octets. The list can contain a maximum of 16 different tracking area identities.",
    "Service area list IEI octet 1 Length of service area list contents octet 2 Partial service area list 1 octet 3 octet i Partial service area list 2 octet i+1* octet l* … octet l+1* octet m* Partial service area list p octet m+1* octet n* Figure 9.11.3.49.1: Service area list information element Allowed type Type of list Number of elements octet 1 MCC digit 2 MCC digit 1 octet 2 MNC digit 3 MCC digit 3 octet 3 MNC digit 2 MNC digit 1 octet 4 TAC 1 octet 5 TAC 1 (continued) octet 6 TAC 1 (continued) octet 7 … … TAC k octet 3k+2* TAC k (continued) octet 3k+3* TAC k (continued) octet 3k+4* Figure 9.11.3.49.2: Partial service area list – type of list = \"00\" Allowed type Type of list Number of elements octet 1 MCC digit 2 MCC digit 1 octet 2 MNC digit 3 MCC digit 3 octet 3 MNC digit 2 MNC digit 1 octet 4 TAC 1 octet 5 TAC 1 (continued) octet 6 TAC 1 (continued) octet 7 Figure 9.11.3.49.3: Partial service area list – type of list = \"01\" Allowed type Type of list Number of elements octet 1 MCC digit 2 MCC digit 1 octet 2 MNC digit 3 MCC digit 3 octet 3 MNC digit 2 MNC digit 1 octet 4 TAC 1 octet 5 TAC 1 (continued) octet 6 TAC 1 (continued) octet 7 MCC digit 2 MCC digit 1 octet 8* MNC digit 3 MCC digit 3 octet 9* MNC digit 2 MNC digit 1 octet 10* TAC 2 octet 11* TAC 2 (continued) octet 12* TAC 2 (continued) octet 13* … MCC digit 2 MCC digit 1 octet 6k-4* MNC digit 3 MCC digit 3 octet 6k-3* MNC digit 2 MNC digit 1 octet 6k-2* TAC k octet 6k*-1 TAC k (continued) octet 6k* TAC k (continued) octet 6k+1* Figure 9.11.3.49.4: Partial service area list – type of list = \"10\" Allowed type Type of list Number of elements octet 1 MCC digit 2 MCC digit 1 octet 2 MNC digit 3 MCC digit 3 octet 3 MNC digit 2 MNC digit 1 octet 4 Figure 9.11.3.49.5: Partial service area list – type of list = \"11\" Table 9.11.3.49.1: Service area list information element Value part of the Service area list information element (octets 3 to n) The value part of the Service area list information element consists of one or several partial service area lists.",
    "The length of each partial service area list can be determined from the 'type of list' field and the 'number of elements' field in the first octet of the partial service area list. The \"Allowed type\" fields in all the partial service area lists shall have the same value. For allowed type \"0\", TAIs contained in all partial service area lists are in the allowed area. For allowed type \"1\", TAIs contained in all partial service area lists are in the non- allowed area. The UE shall store the complete list received. If more than 16 TAIs are included in this information element, the UE shall store the first 16 TAIs and ignore the remaining octets of the information element.",
    "Partial service area list: Allowed type (octet 1) Bit TAIs in the list are in the allowed area TAIs in the list are in the non-allowed area Type of list (octet 1) Bits 7 6 0 0 list of TACs belonging to one PLMN, with non-consecutive TAC values 0 1 list of TACs belonging to one PLMN, with consecutive TAC values 1 0 list of TAIs belonging to different PLMNs (see NOTE) 1 1 All TAIs belonging to the PLMNs in the registration area are in the allowed area Number of elements (octet 1) Bits 5 4 3 2 1 0 0 0 0 0 1 element 0 0 0 0 1 2 elements 0 0 0 1 0 3 elements to 0 1 1 0 1 14 elements 0 1 1 1 0 15 elements 0 1 1 1 1 16 elements All other values are unused and shall be interpreted as 16, if received by the UE.",
    "For type of list = \"00\" and number of elements = k: octets 2 to 4 contain the MCC+MNC, and for j = 1, …, k: octets 3j+2 to 3j+4 contain the TAC of the j-th TAI belonging to the partial list, For type of list = \"01\" and number of elements = k: octets 2 to 4 contain the MCC+MNC, and octets 5 to 7 contain the TAC of the first TAI belonging to the partial list. The TAC values of the other k-1 TAIs are TAC+1, TAC+2, …, TAC+k-1. For type of list = \"10\" and number of elements = k: for j = 1, …, k. octets 6j-4 to 6j-2 contain the MCC+MNC, and octets 6j-1 to 6j+1 contain the TAC of the j-th TAI belonging to the partial list. For type of list = \"11\": Allowed type shall be coded as \"0\" and number of elements shall be ignored, and octets 2 to 4 containing the MCC+MNC can be ignored. If allowed type is coded as \"1\", it shall be interpreted as \"0\". MCC, Mobile country code The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A.",
    "MNC, Mobile network code The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, MNC digit 3 shall be coded as \"1111\". TAC, Tracking area code In the TAC field bit 8 of the first octet is the most significant bit and bit 1 of the third octet the least significant bit. The coding of the tracking area code is the responsibility of each administration. Coding using full hexadecimal representation may be used. The tracking area code consists of 3 octets. NOTE: If the \"list of TAIs belonging to different PLMNs\" is used, the PLMNs included in the list need to be present in the list of equivalent PLMNs. This type is not applicable in an SNPN. See subclause 10.5.3.8 in 3GPP TS 24.008 [12]. The purpose of the UE's usage setting information element is to provide the network with the UE's usage setting as defined in 3GPP TS 24.301 [15].",
    "The network uses the UE's usage setting to select the RFSP index. The UE's usage setting information element is coded as shown in figure 9.11.3.55.1 and table 9.11.3.55.1. The UE's usage setting is a type 4 information element with a length of 3 octets. UE's usage setting IEI octet 1 Length of UE's usage setting contents octet 2 Spare Spare Spare Spare Spare Spare Spare UE's usage setting octet 3 Figure 9.11.3.55.1: UE's usage setting information element Table 9.11.3.55.1: UE's usage setting information element UE's usage setting (octet 3, bit 1) voice centric data centric All other bits in the octet 3 are spare and shall be coded as zero, The purpose of the UE radio capability ID information element is to carry a UE radio capability ID. The UE radio capability ID information element is coded as shown in figure 9.11.3.68.1 and table 9.11.3.68.1. The UE radio capability ID is a type 4 information element with a length of n octets.",
    "UE radio capability ID IEI octet 1 Length of UE radio capability ID contents octet 2 UE radio capability ID octet 3 octet n Figure 9.11.3.68.1: UE radio capability ID information element Table 9.11.3.68.1: UE radio capability ID information element UE radio capability ID (octets 3 to n) The UE radio capability ID contents contain the UE radio capability ID as specified in 3GPP TS 23.003 [4], with each hexadecimal digit coded over 4 bits, starting with the first hexadecimal digit coded in bits 4 to 1 of octet 3, the second hexadecimal digit coded in bits 8 to 5 of octet 3, and so on. If the UE radio capability ID contains an odd number of hexadecimal digits, bits 8 to 5 of the last octet (octet n) shall be coded as \"1111\". See subclause 9.9.3.62 in 3GPP TS 24.301 [15]. The purpose of the Additional configuration indication information element is to indicate additional information associated with the generic UE configuration update procedure.",
    "The Additional configuration indication information element is coded as shown in figure 9.11.3.74.1 and table 9.11.3.74.1. The Additional configuration indication is a type 1 information element. Additional configuration indication IEI Spare Spare Spare SCMR octet 1 Figure 9.11.3.74.1: Additional configuration indication Table 9.11.3.74.1: Additional configuration indication Signalling connection maintain request (SCMR) (octet 1, bit 1) Bit 0 no additional information 1 release of N1 NAS signalling connection not required Bits 2 to 4 are spare and shall be coded as zero, The purpose of the Paging restriction information element is to request the network to restrict paging. The Paging restriction information element is coded as shown in figure 9.11.3.77.1, figure 9.11.3.77.2 and table 9.11.3.77.1. The Paging restriction is a type 4 information element with a minimum length of 3 octets and a maximum length of 35 octets.",
    "Paging restriction IEI octet 1 Length of Paging restriction contents octet 2 Spare Spare Spare Spare Paging restriction type octet 3 Figure 9.11.3.77.1: Paging restriction information element for Paging restriction type = \"All paging is restricted\" and for Paging restriction type = \"All paging is restricted except voice\" Paging restriction IEI octet 1 Length of Paging restriction contents octet 2 Spare Spare Spare Spare Paging restriction type octet 3 PSI (7) PSI (6) PSI (5) PSI (4) PSI (3) PSI (2) PSI (1) PSI (0) octet 4 PSI (15) PSI (14) PSI (13) PSI (12) PSI (11) PSI (10) PSI (9) PSI (8) octet 5 0 0 0 0 0 0 0 0 spare octet 6*-35* Figure 9.11.3.77.2: Paging restriction information element for Paging restriction type = \"All paging is restricted except for specified PDU session(s)\" and for Paging restriction type = \"All paging is restricted except for voice service and specified PDU session(s)\" Table 9.11.3.77.1: Paging restriction information element Paging restriction type (bits 4 to 1 of octet 3) Bits 4 3 2 1 0 0 0 0 reserved 0 0 0 1 All paging is restricted 0 0 1 0 All paging is restricted except for voice service 0 0 1 1 All paging is restricted except for specified PDU session(s) 0 1 0 0 All paging is restricted except for voice service and specified PDU session(s) All other values are reserved.",
    "Bits 5 to 8 of octet 3 are spare and shall be coded as zero. PSI(x) (bits 8 to 1 of octet 4 and octet 5): This field indicates the PDU session identity of the PDU session for which paging is restricted. PSI(0): (bit 1 of octet 4) Spare and shall be coded as zero. PSI(1) – PSI(15): 0 indicates that paging is restricted for the PDU session associated with the PDU session identity. 1 indicates that paging is not restricted for the PDU session associated with the PDU session identity. All bits in octet 6 to 35 are spare and shall be coded as zero, if the respective octet is included in the information element. The purpose of the PEIPS assistance information, information element is to transfer the required assistance information to indicate the paging subgroup used when paging the UE. The coding of the information element allows combining different types of PEIPS assistance information.",
    "The PEIPS assistance information, information element is coded as shown in figure 9.11.3.80.1, figure 9.11.3.80.2, figure 9.11.3.80.3 and table 9.11.3.80.1. The PEIPS assistance information is a type 4 information element, with a minimum length of 3 octets.",
    "PEIPS assistance information IEI octet 1 Length of PEIPS assistance information contents octet 2 PEIPS assistance information type 1 octet 3 octet i PEIPS assistance information type 2 octet i+1* octet l* … octet l+1* octet m* PEIPS assistance information type p octet m+1* octet n* Figure 9.11.3.80.1: PEIPS assistance information information element Type of information Paging subgroup ID value octet 1 Figure 9.11.3.80.2: PEIPS assistance information type –type of information= \"000\" Type of information UE paging probability information value octet 1 Figure 9.11.3.80.3: PEIPS assistance information type –type of information= \"001\" Table 9.11.3.80.1: PEIPS assistance information information element Value part of the PEIPS assistance information information element (octets 3 to n) The value part of the PEIPS assistance information information element consists of one or several types of PEIPS assistance information.",
    "PEIPS assistance information type: Type of information (octet 1) Bits 7 6 0 0 Paging subgroup ID 0 1 UE paging probability information All other values are reserved. Paging subgroup ID value: (octet 1, bits 1-5) This field contains the value (in decimal) of paging subgroup ID that is assigned by the AMF for paging the UE. This field has a valid range of values from (0-7). All other values are unused and shall be interpreted as 0 by this version of the protocol. UE paging probability information value: (octet 1, bits 1-5) This field contains the value of UE paging probability information provided by the UE to the AMF. It represents the probability of the UE receiving the paging.",
    "Bit 4 3 2 1 UE paging probability information value 0 0 0 0 p00 (UE calculated paging probability is 0%) 0 0 0 1 p05 (UE calculated paging probability > 0% and <= 5%) 0 0 1 0 p10 (UE calculated paging probability > 5% and <= 10%) 0 0 1 1 p15 (UE calculated paging probability > 10% and <= 15%) 0 1 0 0 p20 (UE calculated paging probability > 15% and <= 20%) 0 1 0 1 p25 (UE calculated paging probability > 20% and <= 25%) 0 1 1 0 p30 (UE calculated paging probability > 25% and <= 30%) 0 1 1 1 p35 (UE calculated paging probability > 30% and <= 35%) 1 0 0 0 p40 (UE calculated paging probability > 35% and <= 40%) 1 0 0 1 p45 (UE calculated paging probability > 40% and <= 45%) 1 0 1 0 p50 (UE calculated paging probability > 45% and <= 50%) 1 0 1 1 p55 (UE calculated paging probability > 50% and <= 55%) 1 1 0 0 p60 (UE calculated paging probability > 55% and <= 60%) 1 1 0 1 p65 (UE calculated paging probability > 60% and <= 65%) 1 1 1 0 p70 (UE calculated paging probability > 65% and <= 70%) 1 1 1 1 p75 (UE calculated paging probability > 70% and <= 75%) 0 0 0 0 p80 (UE calculated paging probability > 75% and <= 80%) 0 0 0 1 p85 (UE calculated paging probability > 80% and <= 85%) 0 0 1 0 p90 (UE calculated paging probability > 85% and <= 90%) 0 0 1 1 p95 (UE calculated paging probability > 90% and <= 95%) 0 1 0 0 p100 (UE calculated paging probability > 95% and <= 100%) All other values shall be interpreted as 10100 by this version of the protocol.",
    "information, then the UE shall retain only the first 16 NSSRG values and ignore the rest. The purpose of the registration wait range information element is to provide the disaster roaming wait range or the disaster return wait range to the UE. The registration wait range information element is coded as shown in figure 9.11.3.84.1 and table 9.11.3.84.1. The registration wait range is a type 4 information element, with a length of 4 octets. Registration wait range IEI octet 1 Length of registration wait range octet 2 Minimum registration wait time octet 3 Maximum registration wait time octet 4 Figure 9.11.3.84.1: Registration wait range information element Table 9.11.3.84.1: Registration wait range information element Minimum registration wait time (octet 3) The minimum registration wait time contains the minimum duration of the registration wait time, encoded as octet 2 of the GPRS timer information element (see 3GPP TS 24.008 [12] subclause 10.5.7.3).",
    "Maximum registration wait time (octet 4) The maximum registration wait time contains the maximum duration of the registration wait time, encoded as octet 2 of the GPRS timer information element (see 3GPP TS 24.008 [12] subclause 10.5.7.3). The purpose of the NSAG information information element is to provide the NSAG information to the UE. The NSAG information information element is coded as shown in figures 9.11.3.87.1, 9.11.3.87.2 and 9.11.3.87.3, and table 9.11.3.87.1. The NSAG information information element can contain a maximum of 32 NSAG entries. In the NSAG information information element, at most 4 NSAG entries can contain a TAI list. The NSAG information is a type 6 information element, with a minimum length of 9 octets and a maximum length of 3143 octets.",
    "NSAG information IEI octet 1 Length of NSAG information contents octet 2 octet 3 NSAG 1 octet 4 octet m NSAG 2 octet m+1* octet n* … octet n+1* octet u* NSAG x octet u+1* octet v* Figure 9.11.3.87.1: NSAG information information element Length of NSAG octet 4 NSAG identifier octet 5 S-NSSAI list of NSAG octet 6 octet j NSAG priority octet j+1 TAI list octet j+2* octet m* Figure 9.11.3.87.2: NSAG Length of S-NSSAI list of NSAG octet 6 S-NSSAI value 1 octet 7 octet k S-NSSAI value 2 octet k+1* octet s* … octet s+1* octet i-1* S-NSSAI value x octet i* octet j* Figure 9.11.3.87.3: S-NSSAI list of NSAG Table 9.11.3.87.1: NSAG information information element NSAG part of the NSAG information information element (octet 4 to m) Each entry of the NSAG information information element consists of one NSAG in the NSAG information IE. NSAG identifier(octet 5) NSAG identifier field contains an 8 bits NSAG ID value.",
    "S-NSSAI list of NSAG (octet 6 to j) S-NSSAI list of NSAG field consists of one or more S-NSSAIs in the configured NSSAI. Each S-NSSAI in S-NSSAI list of NSAG field is coded as the length and value part of S-NSSAI information element as specified in subclause 9.11.2.8 starting with the second octet, without the mapped HPLMN SST field and without the mapped HPLMN SD field. NSAG priority (octet j+1) The NSAG priority field represents the binary coded value of NSAG priority for cell reselection (see 3GPP TS 38.304 [28]) and random access (see 3GPP TS 38.321 [58]). The range of the NSAG priority is 0 to 255. A lower value indicates a higher priority, with 0 as the highest priority. TAI list (octet j+2 to m) The TAI list field is coded as the length and value part of the 5GS tracking area identity list IE defined in subclause 9.11.3.9 starting with the second octet.",
    "The purpose of the relay key response parameters information element is to transport the parameters of the key response for 5G ProSe UE-to-network relay or 5G ProSe UE-to-UE relay as specified in 3GPP TS 33.503 [56]. The relay key response parameters information element is coded as shown in figure 9.11.3.90.1 and table 9.11.3.90.1. The relay key response parameters is a type 6 information element. Relay key response parameters IEI octet 1 Length of Relay key response parameters octet 2 octet 3 Key KNR_ProSe octet 4 octet 35 Nonce_2 octet 36 octet 51 CP-PRUK ID octet 52 octet m Figure 9.11.3.90.1: Relay key response parameters information element Table 9.11.3.90.1: Relay key response parameters information element Key KNR_ProSe (octet 5 to 35) Key KNR_ProSe contains a 256-bit root key that is established between the two entities that communicating using NR PC5 unicast link as defined in 3GPP TS 33.503 [56].",
    "Nonce_2 (octet 36 to 51) Nonce_2 is the 128-bit nonce value as defined in 3GPP TS 24.554 [19E]. CP-PRUK ID (octet 52 to m) The CP-PRUK ID is defined in 3GPP TS 33.503 [56]. The purpose of the N3IWF identifier information element is to enable the network to assign the UE, a suitable N3IWF for the requested NSSAI. The N3IWF identifier information element is coded as shown in figure 9.11.3.93.1, figure 9.11.3.93.2, figure 9.11.3.93.3 and table 9.11.3.93.1. The N3IWF identifier information element is a type 4 information element with a minimum length of 7 octets.",
    "N3IWF identifier IEI octet 1 Length of N3IWF identifier contents octet 2 N3IWF identifier type octet 3 N3IWF identifier entry octet 4 octet k Figure 9.11.3.93.1: N3IWF identifier information element N3IWF IP address octet 4 octet m Figure 9.11.3.93.2: N3IWF address entry (N3IWF identifier type = \"IPv4\", \"IPv6\" or \"IPv4v6\") N3IWF FQDN octet 4 octet n Figure 9.11.3.93.3: N3IWF identifier entry (N3IWF identifiertype =\"FQDN\") Table 9.11.3.93.1: N3IWF address entry N3IWF identifier type (octet 3) is set as follows: IPv4 IPv6 IPv4v6 FQDN All other values are reserved. If the N3IWF identifier type indicates IPv4, then the N3IWF IP address field contains an IPv4 address in octet 4 to octet 7. If the N3IWF identifier type indicates IPv6, then the N3IWF IP address field contains an IPv6 address in octet 4 to octet 19. If the N3IWF identifier type indicates IPv4v6, then the N3IWF IP address field contains two IP addresses. The first IP address is an IPv4 address in octet 4 to octet 7.",
    "The second IP address is an IPv6 address in octet 8 to octet 23. If the N3IWF identifier type indicates FQDN, the N3IWF FQDN field in octet 4 to octet n is encoded as defined in subclauses 28.3.2.2.2, 28.3.2.2.3, 28.3.2.2.8 or 28.3.2.2.9 in 3GPP TS 23.003 [4]. The purpose of the RAN timing synchronization IE is to provide information related to the RAN timing synchronization. The RAN timing synchronization information element is coded as shown in figure 9.11.3.95.1 and table 9.11.3.95.1. The RAN timing synchronization is a type 4 information element with a length of 3 octets.",
    "RAN timing synchronization IEI octet 1 Length of RAN timing synchronization octet 2 Spare Spare Spare Spare Spare Spare Spare Rec Req octet 3 Figure 9.11.3.95.1: RAN timing synchronization information element Table 9.11.3.95.1: RAN timing synchronization information element Request to reconnect to the network upon receiving an indication of a change in the RAN timing synchronization status (RecReq) (octet 3, bit 1) Bit Reconnection not requested Reconnection requested Bits 2 to 8 of octet 3 are spare and shall be coded as zero. The purpose of the Type 6 IE container information element is to transfer type 6 IEs of format TLV-E explicitly specified for inclusion in this information element for the respective message. NOTE: Use of this information element is intended only for type 6 IEs added to a message in Rel-18 or later.",
    "The rules for the IEI value encoding specified in 3GPP TS 24.007 [11], subclause 11.2.4, are not applicable for the IEIs of the type 6 IEs within the Type 6 IE container information element. These IEIs can take any value in the range 00 to FF (hexadecimal). The type 6 IE container information element is coded as shown in figure 9.11.3.98.1, figure 9.11.3.98.2 and table 9.11.3.98.1. The type 6 IE container is a type 6 information element with a minimum length of 6 octets. Type 6 IE container IEI octet 1 Length of Type 6 IE container contents octet 2 octet 3 octet 4 Type 6 IE container contents octet n Figure 9.11.3.98.1: Type 6 IE container information element Type 6 IE 1 octet 4 octet j Type 6 IE 2 octet j + 1* octet k* …..",
    "octet k+1* octet m* Type 6 IE z octet m+1* octet n* Figure 9.11.3.98.2: Type 6 IE container contents Table 9.11.3.98.1: Type 6 IE container contents Type 6 IE container contents (octets 4 to n) The Type 6 IE container is coded according to figure 9.11.3.98.2. The sender of this information element shall encode each type 6 IE included in the contents in format TLV-E. For the coding of each of the type 6 IEs in the type 6 IE container, see the definition of the respective type 6 IE in subclause 9.11 The purpose of the S-NSSAI time validity information information element is to provide S-NSSAI time validity information of one or more S-NSSAIs to the UE.",
    "The S-NSSAI time validity information information element is coded as shown in figures 9.11.3.101.1 and 9.11.3.101.2 and table 9.11.3.101.1. The S-NSSAI time validity information information element can contain per-S-NSSAI time validity information for maximum 16 S-NSSAIs. The S-NSSAI time validity information information is a type 4 information element with a minimum length of 23 octets and a maximum length of 257 octets.",
    "S-NSSAI time validity information information IEI octet 1 Length of S-NSSAI time validity information contents octet 2 Per-S-NSSAI time validity information for S-NSSAI 1 octet 3 octet a Per-S-NSSAI time validity information for S-NSSAI 2 octet a+1* octet b* … octet b+1* octet c* Per-S-NSSAI time validity information for S-NSSAI n octet c+1* octet d* Figure 9.11.3.101.1: S-NSSAI time validity information information element Length of Per-S-NSSAI time validity information for S-NSSAI octet 3 S-NSSAI octet 4 octet e Per-S-NSSAI time validity information for the S-NSSAI octet e+1 octet a Figure 9.11.3.101.2: Per-S-NSSAI time validity information for S-NSSAI 1 Length of Per-S-NSSAI time validity information for the S-NSSAI octet e+1 Time window 1 octet e+2 octet f Time window 2 octet f+1* octet g* … octet g+1* octet h* Time window m octet h+1* octet i* Figure 9.11.3.101.3: Per-S-NSSAI time validity information for the S-NSSAI Length of Time window 1 octet e+2 Start time octet e+3 octet e+10 Stop time octet e+11 octet e+18 Spare Spare Spare Spare Recurrence pattern octet e+19* Recurrence end time octet e+20* octet e+27* Figure 9.11.3.101.4: Time window 1 Table 9.11.3.101.1: S-NSSAI time validity information information element S-NSSAI (octet 6 to octet e) S-NSSAI value is coded as the length and value part of S-NSSAI information element as specified in subclause 9.11.2.8 starting with the second octet.",
    "Start time (octet e+3 to octet e+10) The field indicates the time when the network slice identified by the S-NSSAI becomes available (for the first time if octet e+20 is included) and is represented by the number of seconds since 00:00:00 on 1 January 1970 UTC and is encoded as the 64-bit NTP timestamp format defined in IETF RFC 5905 [36A], where binary encoding of the integer part is in the first 32 bits and binary encoding of the fraction part in the last 32 bits. Stop time (octet e+11 to octet e+18) The field indicates the time when the network slice identified by the S-NSSAI becomes unavailable (for the first time if octet e+20 is included) and is represented by the number of seconds since 00:00:00 on 1 January 1970 UTC and is encoded as the 64-bit NTP timestamp format defined in IETF RFC 5905 [36A], where binary encoding of the integer part is in the first 32 bits and binary encoding of the fraction part in the last 32 bits.",
    "Recurrence pattern (bit 1 to bit 4 of octet e+19) Bits 4 3 2 1 0 0 0 0 Everyday 0 0 0 1 Every weekday 0 0 1 0 Every week 0 0 1 1 Every 2 weeks 0 1 0 0 Every month (absolute) 0 1 0 1 Every month (relative) 0 1 1 0 Every quarter (absolute) 0 1 1 1 Every quarter (relative) 1 0 0 0 Every 6 months (absolute) 1 0 0 1 Every 6 months (relative) All other values are reserved. The recurrence pattern indicates how often the time window is repeated. For example, if the time window starts at 13:00 on Wednesday January 1st 2020 and stops at 13:30 on Wednesday January 1st 2020 and the recurrent pattern is set to: - \"Everyday\", the time window repeats everyday from 13:00 to 13:30; - \"Every week\", the time window repeats every Wednesday from 13:00 to 13:30; - \"Every month (absolute)\", the time window repeats every 1st day of the month from 13:00 to 13:30; and - \"Every month (relative)\", the time window repeats every month on the first Wednesday from 13:00 to 13:30.",
    "Recurrence end time (octet e+20 to octet e+27) The field indicates the time when the repetition of the time window ends. If the field is not included and octet e+19 is included in the IE, the time window is repeated indefinitely. The field is represented by the number of seconds since 00:00:00 on 1 January 1970 UTC and is encoded as the 64-bit NTP timestamp format defined in IETF RFC 5905 [36A], where binary encoding of the integer part is in the first 32 bits and binary encoding of the fraction part in the last 32 bits. the partial tracking area identity list can contain at the most 15 tracking area identities. NOTE 3: The AMF shall set the Length of partial NSSAI contents to 0 if there are no S-NSSAIs to deliver in a set of tracking areas of a registration area and, the UE shall delete any existing stored partially allowed NSSAI for the current registration area or partially rejected NSSAI for the current registration area.",
    "The purpose of the Payload container information information element is to provide information related to a payload container. The Payload container information is a type 1 information element. The Payload container information information element is coded as shown in figure 9.11.3.106.1 and table 9.11.3.106.1. Payload container information IEI spare PRU octet 1 Figure 9.11.3.106.1: Payload container information information element Table 9.11.3.106.1: Payload container information information element PRU related content (PRU) (octet 1, bit 1) Bit Payload container not related to PRU Payload container related to PRU Bits 2 to 4 are spare and shall be coded as zero. The purpose of the Extended 5GMM cause information element is to indicate additional information associated with a 5GMM cause. The Extended 5GMM cause information element is coded as shown in figure 9.11.3.109.1 and table 9.11.3.109.1. The Extended 5GMM cause is a type 4 information element with a length of 3 octets.",
    "Extended 5GMM cause IEI octet 1 Length of Extended 5GMM cause contents octet 2 Spare Spare Spare Spare Spare Spare Spare Sat-NR octet 3 Figure 9.11.3.109.1: Extended 5GMM cause information element Table 9.11.3.109.1: Extended 5GMM cause information element Sat-NR value (octet 3, bit 1) Bit Satellite NG-RAN allowed in PLMN Satellite NG-RAN not allowed in PLMN Bit 2 to 8 of octet 3 are spare and shall be coded as zero. The purpose of the 5GSM cause information element is to indicate the reason why a 5GSM request is rejected. The 5GSM cause information element is coded as shown in figure 9.11.4.2.1 and table 9.11.4.2.1. The 5GSM cause is a type 3 information element with a length of 2 octets.",
    "5GSM cause IEI octet 1 Cause value octet 2 Figure 9.11.4.2.1: 5GSM cause information element Table 9.11.4.2.1: 5GSM cause information element Cause value (octet 2) Bits 7 6 5 3 2 1 0 0 0 0 0 0 Operator determined barring 0 0 1 0 1 0 Insufficient resources 0 0 1 0 1 1 Missing or unknown DNN 0 0 1 1 0 0 Unknown PDU session type 0 0 1 1 0 1 User authentication or authorization failed 0 0 1 1 1 1 Request rejected, unspecified 0 1 0 0 0 0 Service option not supported 0 1 0 0 0 1 Requested service option not subscribed 0 1 0 0 1 1 PTI already in use 0 1 0 1 0 0 Regular deactivation 0 1 0 1 0 1 5GS QoS not accepted 0 1 0 1 1 0 Network failure 0 1 0 1 1 1 Reactivation requested 0 1 0 0 0 1 Semantic error in the TFT operation 0 1 0 0 1 0 Syntactical error in the TFT operation 0 1 0 0 1 1 Invalid PDU session identity 0 1 0 1 0 0 Semantic errors in packet filter(s) 0 1 0 1 0 1 Syntactical error in packet filter(s) 0 1 0 1 1 0 Out of LADN service area 0 1 0 1 1 1 PTI mismatch 0 1 1 0 1 0 PDU session type IPv4 only allowed 0 1 1 0 1 1 PDU session type IPv6 only allowed 0 1 1 1 1 0 PDU session does not exist 0 1 1 0 0 1 PDU session type IPv4v6 only allowed 0 1 1 0 1 0 PDU session type Unstructured only allowed 0 1 1 0 1 1 Unsupported 5QI value 0 1 1 1 0 1 PDU session type Ethernet only allowed 1 0 0 0 1 1 Insufficient resources for specific slice and DNN 1 0 0 1 0 0 Not supported SSC mode 1 0 0 1 0 1 Insufficient resources for specific slice 1 0 0 1 1 0 Missing or unknown DNN in a slice 1 0 1 0 0 1 Invalid PTI value 1 0 1 0 1 0 Maximum data rate per UE for user-plane integrity protection is too low 1 0 1 0 1 1 Semantic error in the QoS operation 1 0 1 1 0 0 Syntactical error in the QoS operation 1 0 1 1 0 1 Invalid mapped EPS bearer identity 1 0 1 1 1 0 UAS services not allowed 1 0 1 1 1 1 Semantically incorrect message 1 1 0 0 0 0 Invalid mandatory information 1 1 0 0 0 1 Message type non-existent or not implemented 1 1 0 0 1 0 Message type not compatible with the protocol state 1 1 0 0 1 1 Information element non-existent or not implemented 1 1 0 1 0 0 Conditional IE error 1 1 0 1 0 1 Message not compatible with the protocol state 1 1 0 1 1 1 Protocol error, unspecified Any other value received by the UE shall be treated as 0001 1111, \" Request rejected, unspecified \".",
    "Any other value received by the network shall be treated as 0110 1111, \"protocol error, unspecified\". The purpose of the Allowed SSC mode information element is to indicate the SSC modes allowed to be used by the UE for the PDU session. The Allowed SSC mode information element is coded as shown in figure 9.11.4.5.1 and table 9.11.4.5.1. The Allowed SSC mode is a type 1 information element. Allowed SSC mode IEI Spare SSC3 SSC2 SSC1 octet 1 Figure 9.11.4.5.1: Allowed SSC mode information element Table 9.11.4.5.1: Allowed SSC mode information element SSC1 (octet 1, bit 1) Bit SSC mode 1 not allowed SSC mode 1 allowed SSC2 (octet 1, bit 2) Bit SSC mode 2 not allowed SSC mode 2 allowed SSC3 (octet 1, bit 3) Bit SSC mode 3 not allowed SSC mode 3 allowed Bit 4 is spare and shall be encoded as zero.",
    "The purpose of the mapped EPS bearer contexts information element is to indicate a set of EPS bearer contexts for a PDU session, as described in subclause 6.1.4.1. The mapped EPS bearer contexts information element is a type 6 information element with a minimum length of 7 octet and a maximum length of 65538 octets.",
    "The mapped EPS bearer contexts information element is coded as shown in figure 9.11.4.8.1, figure 9.11.4.8.2, figure 9.11.4.8.3 and table 9.11.4.8.1. Mapped EPS bearer contexts IEI octet 1 Length of Mapped EPS bearer contexts contents octet 2 octet 3 Mapped EPS bearer context 1 octet 4 octet u Mapped EPS bearer context 2 octet u+1 octet v … octet v+1 octet w Mapped EPS bearer context n octet w+1 octet x Figure 9.11.4.8.1: Mapped EPS bearer contexts EPS bearer identity octet 4 Length of Mapped EPS bearer context octet 5 octet 6 Operation code Spare E bit Number of EPS parameters octet 7 EPS parameters list octet 8* octet u* Figure 9.11.4.8.2: Mapped EPS bearer context EPS parameter identifier 1 octet 8 Length of EPS parameter contents 1 octet 9 EPS parameter contents 1 octet 10 octet h EPS parameter identifier 2 octet h+1 Length of EPS parameter contents 2 octet h+2 EPS parameter contents 2 octet h+3 octet i … octet i+1 octet j EPS parameter identifier N octet j+1 Length of EPS parameter contents N octet j+2 EPS parameter contents N octet j+3 octet u Figure 9.11.4.8.3: EPS parameters list Table 9.11.4.8.1: Mapped EPS bearer contexts information element EPS bearer identity (octet 4) Bits 5 to 8 contain the EPS bearer identity, and are coded as specified in subclause 9.3.2 of 3GPP TS 24.301 [15].",
    "Bits 1 to 4 are spare and shall be coded as zero. Operation code (bits 8 to 7 of octet 7) Bits 8 7 0 0 Reserved 0 1 Create new EPS bearer 1 0 Delete existing EPS bearer 1 1 Modify existing EPS bearer Bit 6 of octet 7 is spare and shall be coded as zero. E bit (bit 5 of octet 7) For the \"create new EPS bearer\" operation, the E bit is encoded as follows: Bit 0 parameters list is not included (NOTE) 1 parameters list is included For the \"modify existing EPS bearer\" operation, the E bit is encoded as follows: Bit 0 extension of previously provided parameters list 1 replacement of all previously provided parameters list If the E bit is set to \"parameters list is included\", the number of EPS parameters field has non-zero value. If the E bit is set to \"extension of previously provided parameters list\" or \"replacement of previously provided parameters list\", the number of parameters field has non-zero value.",
    "If the E bit is set to \"extension of previously provided parameters\" and one of the parameters in the new parameters list already exists in the previously provided parameters, the parameter shall be set to the new value. If the E bit is set to \"replacement of all previously provided parameters list\" and a parameter in the previously provided parameters is not provided in the new parameters list, the parameter shall be deleted. For the \"create new EPS bearer\" operation and \"delete existing EPS bearer\" operation, bit 5 of octet 7 is ignored. Number of EPS parameters (bits 4 to 1 of octet 7) The number of EPS parameters contains the binary coding for the number of EPS parameters in the EPS parameters list field. The number of EPS parameters field is encoded in bits 4 through 1 of octet 7 where bit 4 is the most significant and bit 1 is the least significant bit. EPS parameters list (octets 8 to u) The EPS parameters list contains a variable number of EPS parameters.",
    "Each EPS parameter included in the EPS parameters list is of variable length and consists of: - an EPS parameter identifier (1 octet); - the length of the EPS parameter contents (1 octet); and - the EPS parameter contents itself (variable amount of octets). The EPS parameter identifier field is used to identify each EPS parameter included in the EPS parameters list and it contains the hexadecimal coding of the EPS parameter identifier. Bit 8 of the EPS parameter identifier field contains the most significant bit and bit 1 contains the least significant bit. In this version of the protocol, the following EPS parameter identifiers are specified: - 01H (Mapped EPS QoS parameters); - 02H (Mapped extended EPS QoS parameters); and - 03H (Traffic flow template). - 04H (APN-AMBR). - 05H (extended APN-AMBR). If the EPS parameters list contains an EPS parameter identifier that is not supported by the receiving entity the corresponding EPS parameter shall be discarded.",
    "The length of EPS parameter contents field contains the binary coded representation of the length of the EPS parameter contents field. The first bit in transmission order is the most significant bit. When the parameter identifier indicates mapped EPS QoS parameters, the length and parameter contents field are coded as specified in subclause 9.9.4.3 of 3GPP TS 24.301 [15]. When the parameter identifier indicates mapped extended EPS QoS parameters, the length and parameter contents field are coded as specified in subclause 9.9.4.30 of 3GPP TS 24.301 [15]. When the parameter identifier indicates traffic flow template, the length and parameter contents field are coded from octet 2 as shown figure 10.5.144 and table 10.5.162 of 3GPP TS 24.008 [12]. When the parameter identifier indicates APN-AMBR, the length and parameter contents field are coded as specified in subclause 9.9.4.2 of 3GPP TS 24.301 [15].",
    "When the parameter identifier indicates Extended APN-AMBR, the length and parameter contents field are coded as specified in subclause 9.9.4.29 of 3GPP TS 24.301 [15]. NOTE: This value shall not be used In this version of the specification. The purpose of the PDU session type information element is to indicate type of the PDU session. The PDU session type information element is coded as shown in figure 9.11.4.11.1 and table 9.11.4.11.1. The PDU session type is a type 1 information element. PDU session type IEI Spare PDU session type value octet 1 Figure 9.11.4.11.1: PDU session type information element Table 9.11.4.11.1: PDU session type information element PDU session type value (octet 1, bit 1 to bit 3) Bits 3 2 1 0 0 1 IPv4 0 1 0 IPv6 0 1 1 IPv4v6 1 0 0 Unstructured 1 0 1 Ethernet 1 1 1 reserved All other values are unused and shall be interpreted as \"IPv4v6\", if received by the UE or the network.",
    "The purpose of the Session-AMBR information element is to indicate the initial subscribed PDU session aggregate maximum bit rate when the UE establishes a PDU session or to indicate the new subscribed PDU session aggregate maximum bit rate if it is changed by the network. The Session-AMBR information element is coded as shown in figure 9.11.4.14.1 and table 9.11.4.14.1. The Session-AMBR is a type 4 information element with a length of 8 octets.",
    "Session-AMBR IEI octet 1 Length of Session-AMBR contents octet 2 Unit for Session-AMBR for downlink octet 3 Session-AMBR for downlink octet 4-5 Unit for Session-AMBR for uplink octet 6 Session-AMBR for uplink octet 7-8 Figure 9.11.4.14.1: Session-AMBR information element Table 9.11.4.14.1: Session-AMBR information element Unit for Session-AMBR for downlink (octet 3) 0 0 0 0 0 0 0 0 value is not used (see NOTE) 0 0 0 0 0 0 0 1 value is incremented in multiples of 1 Kbps 0 0 0 0 0 0 1 0 value is incremented in multiples of 4 Kbps 0 0 0 0 0 0 1 1 value is incremented in multiples of 16 Kbps 0 0 0 0 0 1 0 0 value is incremented in multiples of 64 Kbps 0 0 0 0 0 1 0 1 value is incremented in multiples of 256 kbps 0 0 0 0 0 1 1 0 value is incremented in multiples of 1 Mbps 0 0 0 0 0 1 1 1 value is incremented in multiples of 4 Mbps 0 0 0 0 1 0 0 0 value is incremented in multiples of 16 Mbps 0 0 0 0 1 0 0 1 value is incremented in multiples of 64 Mbps 0 0 0 0 1 0 1 0 value is incremented in multiples of 256 Mbps 0 0 0 0 1 0 1 1 value is incremented in multiples of 1 Gbps 0 0 0 0 1 1 0 0 value is incremented in multiples of 4 Gbps 0 0 0 0 1 1 0 1 value is incremented in multiples of 16 Gbps 0 0 0 0 1 1 1 0 value is incremented in multiples of 64 Gbps 0 0 0 0 1 1 1 1 value is incremented in multiples of 256 Gbps 0 0 0 1 0 0 0 0 value is incremented in multiples of 1 Tbps 0 0 0 1 0 0 0 1 value is incremented in multiples of 4 Tbps 0 0 0 1 0 0 1 0 value is incremented in multiples of 16 Tbps 0 0 0 1 0 0 1 1 value is incremented in multiples of 64 Tbps 0 0 0 1 0 1 0 0 value is incremented in multiples of 256 Tbps 0 0 0 1 0 1 0 1 value is incremented in multiples of 1 Pbps 0 0 0 1 0 1 1 0 value is incremented in multiples of 4 Pbps 0 0 0 1 0 1 1 1 value is incremented in multiples of 16 Pbps 0 0 0 1 1 0 0 0 value is incremented in multiples of 64 Pbps 0 0 0 1 1 0 0 1 value is incremented in multiples of 256 Pbps Other values shall be interpreted as multiples of 256 Pbps in this version of the protocol.",
    "Session-AMBR for downlink (octets 4 and 5) Octets 4 and 5 represent the binary coded value of PDU session aggregated maximum bit rate for downlink in units defined by octet 3. Unit for Session-AMBR for uplink (octet 6) The coding is identical to the unit coding defined for Session-AMBR for downlink (octet 3) Session-AMBR for uplink (octets 7 and 8) Octets 7 and 8 represent the binary coded value of PDU session aggregated maximum bit rate for uplink in units defined by octet 6. NOTE: In this release of the specifications if received it shall be interpreted as value is incremented in multiples of 1 Kbps. In earlier releases of specifications, the interpretation of this value is up to implementation.",
    "The purpose of the Re-attempt indicator information element is to indicate a condition under which the UE is allowed in the current PLMN or its equivalent PLMN(s) or the current SNPN or its equivalent SNPNs for the same DNN, to re- attempt a session management procedure (see 3GPP TS 24.301 [15]) corresponding to the 5GS session management procedure which was rejected by the network. The Re-attempt indicator information element is coded as shown in figure 9.11.4.17.1 and table 9.11.4.17.1. The Re-attempt indicator is a type 4 information element with a length of 3 octets.",
    "Re-attempt indicator IEI octet 1 Length of Re-attempt indicator contents octet 2 Spare Spare Spare Spare Spare Spare EPLM NC RATC octet 3 Figure 9.11.4.17.1: Re-attempt indicator Table 9.11.4.17.1: Re-attempt indicator RATC (octet 3, bit 1) Bit 0 UE is allowed to re-attempt the procedure in S1 mode 1 UE is not allowed to re-attempt the procedure in S1 mode EPLMNC (octet 3, bit 2) Bit 0 UE is allowed to re-attempt the procedure in an equivalent PLMN or equivalent SNPN 1 UE is not allowed to re-attempt the procedure in an equivalent PLMN or equivalent SNPN Bits 3 to 8 of octet 3 are spare and shall be encoded as zero. See subclause 9.9.4.28 in 3GPP TS 24.301 [15]. The purpose of the control plane only indication information element is to indicate that a PDU session is only for control plane CIoT 5GS optimization. The control plane only indication information element is coded as shown in figure 9.11.4.23.1. The control plane only indication is a type 1 information element.",
    "Control plane only indication IEI Spare Spare Spare CPOI value octet 1 Figure 9.11.4.23.1: Control plane only indication information element Table 9.11.4.23.1: Control plane only indication information element Control plane only indication value (CPOI) (octet 1) Bit 0 reserved 1 PDU session can be used for control plane CIoT 5GS optimization only The value 0 is reserved. If received, it shall be interpreted as if the control plane only indication IE was not included in the message. Bits 4 to 2 of octet 1 are spare and shall be all encoded as zero. The purpose of the UE-DS-TT residence time information element is to signal the time taken within the UE and the DS- TT to forward a packet i.e. between the ingress of the UE and the DS-TT port in the DL direction, or between the DS- TT port and the egress of the UE in the UL direction.",
    "The UE- DS-TT residence time information element is coded as shown in figure 9.11.4.26.1 and table 9.11.4.26.1. The UE-DS-TT residence time is a type 4 information element with a length of 10 octets. UE-DS-TT residence time IEI octet 1 Length of UE-DS-TT residence time contents octet 2 octet 3 UE-DS-TT residence time contents octet 10 Figure 9.11.4.26.1: UE-DS-TT residence time information element Table 9.11.4.26.1: UE-DS-TT residence time information element UE-DS-TT residence time contents (octets 3 to 10) The UE-DS-TT residence time contents contain the UE-DS-TT residence time encoded as specified for the correctionField in IEEE Std 1588-2019 [43B], with the LSB bit of the first octet of the UE-DS-TT residence time included in bit 1 of octet 3. If the UE-DS-TT residence time.is too big to be represented, all bits of octets 3 to 10 shall be coded as \"1\" except the MSB bit of octet 10.",
    "The purpose of the Remote UE context list information element is to provide identity and optionally IP address of a 5G ProSe remote UE connected to, or disconnected from, a UE acting as a 5G ProSe layer-3 UE-to-network relay. The Remote UE context list information element is coded as shown in figure 9.11.4.29.1, figure 9.11.4.29.2, table 9.11.4.29.1 and table 9.11.4.29.2. The Remote UE context list is a type 6 information element with a minimum length of 16 octets and a maximum length of 65538 octets.",
    "Remote UE context list IEI octet 1 Length of remote UE context list contents octet 2 octet 3 Number of remote UE contexts octet 4 Remote UE context 1 octet 5 octet a … octet a+1* octet b* Remote UE context k octet b+1* octet c* Figure 9.11.4.29.1: Remote UE context list Table 9.11.4.29.1: Remote UE context list Remote UE context (octet 5 etc) The contents of remote UE context are applicable for one individual UE and are coded as shown in figure 9.11.4.29.2 and table 9.11.4.29.2. Length of remote UE context octet 5 Spare Spare Spare Spare Remot e UE ID format Remote UE ID type octet 6 Length of remote UE ID octet 7 Remote UE ID octet 8 Octet j* Spare UPRI4 I TPRI4I Protocol used by remote UE octet j+1* Address information octet j+2* octet j+k* HPLMN ID octet (j+k+1)* octet (j+k+3)* Figure 9.11.4.29.2: Remote UE context Table 9.11.4.29.2: Remote UE context Remote UE ID type (bits 1 to 3 of octet 6) Bits 3 2 1 0 0 1 UP-PRUK ID 0 1 0 CP-PRUK ID 0 1 1 IMEI 1 0 0 IMEISV All other values are reserved.",
    "Remote UE ID format (bit 4 of octet 6) (NOTE) Bit Network access identifier (NAI) 64-bit string Bits 5 to 8 of octet 6 are spare and shall be coded as zero. Remote UE ID (octet 8 to octet j) The UP-PRUK ID as specified in 3GPP TS 33.503 [56], the CP-PRUK ID as specified in 3GPP TS 33.503 [56], the IMEI or the IMEISV of the 5G ProSe Remote UE. If the remote UE ID type field indicates \"UP-PRUK ID\" or \"CP-PRUK ID\", and the remote UE ID format field indicates \"NAI\", the remote UE ID field contains the UP-PRUK ID or the CP-PRUK ID in the NAI format as defined in 3GPP TS 23.003 [4], encoded as UTF-8 string. If the remote UE ID type field indicates \"UP-PRUK ID\", and the remote UE ID format field indicates \"64-bit string\", the remote UE ID field contains the UP-PRUK ID as a 64-bit string, encoded using binary encoding.",
    "If the remote UE ID type field indicates \"IMEI\" or \"IMEISV\", the remote UE ID field contains the IMEI or the IMEISV encoded as 5GS mobile identity information element for type of identity \"IMEI\" or \"IMEISV\" as specified in subclause 9.11.3.4, starting with the fourth octet. Protocol used by remote UE (octet j+1, bits 1 to 3) Bits 3 2 1 0 0 0 No IP info 0 0 1 IPv4 0 1 0 IPv6 1 0 0 Unstructured 1 0 1 Ethernet All other values are reserved. TCP port range for IPv4 indicator (TPRI4I) (octet j+1, bits 4) Bit TCP port range for IPv4 absent TCP port range for IPv4 present UDP port range for IPv4 indicator (UPRI4I) (octet j+1, bits 5) Bit UDP port range for IPv4 absent UDP port range for IPv4 present Bits 4 to 8 of octet j+1 are spare and shall be coded as zero. The length of remote UE ID field contains the binary coded representation of the length of the remote UE ID field. The first bit in transmission order is the most significant bit.",
    "If the Protocol used by remote UE indicates IPv4 and: - TPRI4I bit indicates \"TCP port range for IPv4 absent\" and UPRI4I bit indicates \"UDP port range for IPv4 absent\", the Address information in octet j+2 to octet j+5 contains the IPv4 address. - TPRI4I bit indicates \"TCP port range for IPv4 present\" and UPRI4I bit indicates \"UDP port range for IPv4 absent\", the Address information in octet j+2 to octet j+9 contains the IPv4 address followed by the TCP port range field. - TPRI4I bit indicates \"TCP port range for IPv4 absent\" and UPRI4I bit indicates \"UDP port range for IPv4 present\", the Address information in octet j+2 to octet j+9 contains the IPv4 address followed by the UDP port range field. - TPRI4I bit indicates \"TCP port range for IPv4 present\" and UPRI4I bit indicates \"UDP port range for IPv4 present\", the Address information in octet j+2 to octet j+13 contains the IPv4 address followed by the UDP port range field followed by the TCP port range field. See NOTE.",
    "The UDP port range field consists of the lowest UDP port number field followed by the highest UDP port number field, of the UDP port range assigned to the remote UE in the NAT function of 5G ProSe layer-3 UE-to-network relay. The TCP port range field consists of the lowest TCP port number field followed by highest TCP port number field, of the TCP port range assigned to the remote UE in the NAT function of 5G ProSe layer-3 UE-to-network relay. Each port number field is two octets long and bit 8 of first octet of the port number field represents the most significant bit of the port number and bit 1 of second octet of the port number field the least significant bit. If the Protocol used by remote UE indicates IPv6, the Address information in octet j+2 to octet j+9 contains the /64 IPv6 prefix of a remote UE. Bit 8 of octet j+2 represents the most significant bit of the /64 IPv6 prefix and bit 1 of octet j+9 the least significant bit.",
    "If the Protocol used by remote UE indicates Ethernet, the Address information in octet j+2 to octet j+7 contains the remote UE MAC address. Bit 8 of octet j+2 represents the most significant bit of the MAC address and bit 1 of octet j+7 the least significant bit. If the Protocol used by remote UE indicates Unstructured, the Address information octets are not included. If the Protocol used by remote UE indicates No IP info, the Address information octets are not included If the Remote UE ID type field indicates \"PRUK ID\" and the Remote UE ID format field indicates \"64-bit string\", then the HPLMN ID field is present otherwise the HPLMN ID field is absent. The HPLMN ID field indicates HPLMN ID of the 5G ProSe remote UE and is coded as value part of the PLMN ID information element as specified in 3GPP TS 24.554 [19E] subclause 11.3.33 starting with the second octet.",
    "NOTE: In the present release of the specification, providing information for IP protocols other than UDP or TCP is not specified The purpose of the PDU session pair ID information element is to indicate a PDU session pair ID. The PDU session pair ID information element is coded as shown in figure 9.11.4.32.1 and table 9.11.4.32.1. The PDU session pair ID is a type 4 information element with a length of 3 octets. PDU session pair ID IEI octet 1 Length of PDU session pair ID IE octet 2 PDU session pair ID octet 3 Figure 9.11.4.32.1: PDU session pair ID information element Table 9.11.4.32.1: PDU session pair ID information element PDU session pair ID (octet 3) Bits 8 7 6 5 3 2 1 0 0 0 0 0 0 0 PDU session pair ID 0 to to 0 0 0 0 1 1 0 PDU session pair ID 6 All other values are reserved. The purpose of the N3QAI information element is to indicate a set of QoS parameters to be used by the UE for non- 3GPP access network resource management behind the UE.",
    "The N3QAI information element is a type 6 information element with a minimum length of 9 octets. The maximum length for the information element is 65538 octets. The N3QAI information element is coded as shown in figure 9.11.4.36.1, figure 9.11.4.36.2, figure 9.11.4.36.3, figure 9.11.4.36.4, and table 9.11.4.36.1. N3QAI IEI octet 1 Length of N3QAI contents octet 2 octet 3 N3QAI 1 octet 4 octet u* N3QAI 2 octet (u+1)* octet v* ... octet (v+1)* octet w* N3QAI n octet (w+1)* octet x* Figure 9.11.4.36.1: N3QAI information element Number of QFIs octet 4 List of QFIs octet 5 octet m Number of N3QAI parameters octet (m+1) N3QAI parameters list octet (m+2) octet u* Figure 9.11.4.36.2: N3QAI N3QAI parameter 1 octet (m+2) octet n* N3QAI parameter 2 octet (n+1)* octet o* ...",
    "octet (o+1)* octet p* N3QAI parameter n octet (p+1)* octet u* Figure 9.11.4.36.3: N3QAI parameters list N3QAI parameter identifier octet (m+2) Length of N3QAI parameter contents octet (m+3) N3QAI parameter contents octet (m+4) octet n* Figure 9.11.4.36.4: N3QAI parameter Table 9.11.4.36.1: N3QAI information element Number of QFIs (octet 4) The number of QFIs field contains the binary coding for the number of QFIs associated with the same N3QAI parameters. This field is encoded in bits 8 through 1 of octet 4 where bit 8 is he most significant and bit 1 is the least significant bit. List of QFIs (octet 5 to octet m) This field indicates QoS flow(s) associated with the same N3QAI parameters. This field contains QFI values encoded as below: Bits 8 7 6 5 4 3 2 1 0 0 0 0 0 0 0 0 Reserved 0 0 0 0 0 0 0 1 QFI 1 to 0 0 1 1 1 1 1 1 QFI 63 The other values are spare. If spare value is used, the UE shall ignore the value.",
    "Number of N3QAI parameters (bits 8 to 1 of octet (m+1)) The number of N3QAI parameters field contains the binary coding for the number of N3QAI parameters in the N3QAI parameters list field. The number of N3QAI parameters field is encoded in bits 8 through 1 of octet (m+1) where bit 8 is the most significant and bit 1 is the least significant bit. N3QAI parameters list (octets (m+2) to q*) The N3QAI parameters list field contains a variable number of N3QAI parameters. Each N3QAI parameter included in the N3QAI parameters list is of variable length and consists of: - a N3QAI parameter identifier (1 octet); - the length of the N3QAI parameter contents (1 octet); and - the N3QAI parameter contents itself (variable number of octets). The N3QAI parameter identifier field is used to identify each parameter included in the N3QAI parameters list and it contains the hexadecimal coding of the parameter identifier.",
    "Bit 8 of the parameter identifier field contains the most significant bit and bit 1 contains the least significant bit. In this version of the protocol, the following parameter identifiers are specified: - 01H (5QI); - 02H (GFBR uplink); - 03H (GFBR downlink); - 04H (MFBR uplink); - 05H (MFBR downlink); - 06H (Averaging window); - 07H (Resource type); - 08H (Priority level); - 09H (Packet delay budget); - 0AH (Packet error rate); - 0BH (Maximum data burst volume); - 0CH (Maximum packet loss rate downlink); - 0DH (Maximum packet loss rate uplink); - 0EH (ARP); and - 0FH (Periodicity). If the N3QAI parameters list contains a N3QAI parameter identifier that is not supported by the receiving entity, the corresponding parameter shall be discarded. The length of N3QAI parameter contents field contains the binary coded representation of the length of the parameter contents field. The first bit in transmission order is the most significant bit.",
    "For the N3QAI parameter identifiers indicating \"5QI\", \"GFBR uplink\", \"GFBR downlink\", \"MFBR uplink\", \"MFBR downlink\", and \"Averaging window\", the format of the N3QAI parameter contents follows the table 9.11.4.12.1 of subclause 9.11.4.12 of this specification. For the N3QAI parameter identifiers indicating \"Resource type\", \"Priority level\", \"Packet delay budget\", \"Packet error rate\", \"Maximum data burst volume\", \"Maximum packet loss rate downlink\", and \"Maximum packet loss rate uplink\", the format of the N3QAI parameter contents follows the table 9.3.1.1-2 of subclause 9.3.1.1 of 3GPP TS 24.502 [18]. When the N3QAI parameter identifier indicates \"ARP\", the N3QAI parameter contents field contains the binary representation of ARP that is one octet in length. The range of the ARP priority level is 1 to 15 with 1 as the highest priority as specified in subclause 5.7.2.2 of 3GPP TS.23.501 [8].",
    "When the N3QAI parameter identifier indicates \"Periodicity\", the N3QAI parameter contents field contains the binary representation of the periodicity for the traffic with a unit of microsecond. (NOTE 1) NOTE 1: The periodicity refers to the time interval between start of two data bursts for supporting consumer real time applications e.g., XR. The purpose of the Protocol description information element is to provide protocol description for UL PDU set handling to the UE. The Protocol description information element is a type 6 information element with a minimum length of 6 octets. The Protocol description information element is coded as shown in figure 9.11.4.39.1, figure 9.11.4.39.2, figure 9.11.4.39.3, figure 9.11.4.39.4, and table 9.11.4.39.1. Protocol description IEI octet 1 Length of Protocol description contents octet 2 octet 3 Protocol description 1 octet 4 octet u Protocol description 2 octet (u+1)* octet w* ...",
    "Protocol description n octet (w+1)* octet s* Figure 9.11.4.39.1: Protocol description information element Length of protocol description octet 4 octet 5 QoS Rule Identifier (QRI) octet 6 PILPI HEIPI Transport Protocol octet 7* Spare Spare RTP header extension type octet 8* RTP header extension id octet 9* RTP payload information list octet 10* octet u* Figure 9.11.4.39.2: Protocol description Length of RTP payload information list octet 10 octet 11 RTP payload information 1 octet 12 octet o RTP payload information 2 octet (o+1)* octet p* ... RTP payload information m octet q* octet r* Figure 9.11.4.39.3: RTP payload information list RTP payload format octet 12 Number of RTP payload type octet 13 RTP payload type 1 octet 14 RTP payload type 2 octet 15* ...",
    "RTP payload type t octet (13+t)* Figure 9.11.4.39.4: RTP payload information Table 9.11.4.39.1: Protocol description information element Length of protocol description (octet 4 and octet 5) (see NOTE 1) The length of protocol description field indicates the length of the protocol description entry. QoS Rule Identifier (QRI) (octet 6) The QoS Rule Identifier (QRI) field contains the QoS rule identifier as specified in subclause 9.11.4.13. Each protocol description entry is associated with the QoS rule identified by the QRI field. Transport Protocol (octet 7, bits 1 to 4) The Transport Protocol field indicates the transport protocol used by the media flow, e.g., RTP or SRTP as specified in 3GPP TS 26.522 [69]. Bits RTP SRTP All other values are spare.",
    "RTP header extension information presence indicator (HEIPI) (bit 5 of octet 7) The HEIPI field indicates whether the RTP header extension information (RTP header extension type field and RTP header extension id field) is included in the IE or not. Bit RTP header extension information not included RTP header extension information included RTP payload information list presence indicator (PILPI) (bit 6 of octet 7) The PILPI field indicates whether the RTP payload information list is included in the IE or not. Bit RTP payload information list not included RTP payload information list included RTP header extension type (octet 8) The RTP header extension type field contains the RTP header extension type, i.e the RTP Header Extension for PDU Set Marking as specified in subclause 4.2 of 3GPP TS 26.522 [69]. Bits RTP Header Extension for PDU Set Marking All other values are spare.",
    "RTP header extension id (octet 9) The RTP header extension id field contains the RTP header extension id which is coded as binary representation of an integer between 1(inclusive) and 255(inclusive) as defined in IETF RFC 8285 [70]. RTP payload information list (octets 10 to u) (see NOTE 2) The RTP payload information list contains the RTP payload information for the RTP stream, which can be used to derive the PDU set information. RTP payload format (octet 12) Bits RTP payload format for H.264/AVC codec as specified in subclause A.2.2 of 3GPP TS 26.522 [69] RTP payload format for H.265/HEVC codec as specified in subclause A.2.2 of 3GPP TS 26.522 [69] All other values are spare and not used. RTP payload type (octet 14) The RTP payload type field indicates the RTP or SRTP payload type, it contains the binary representation of an integer between 1(inclusive) and 127(inclusive). The other values are spare. If spare value is used, the UE shall ignore the value.",
    "NOTE 1: If the value of the length of protocol description field is set to 1, the protocol description entry is deleted for the associated QoS rule. If the value of the length of protocol description field is greater than 1, the protocol description entry is added or replaced for the associated QoS rule. NOTE 2: In this release of the specification, the RTP payload information list contains only one RTP payload information entry. The description of timers in the following tables should be considered a brief summary. The precise details are found in clauses 4 to 6, which should be considered the definitive descriptions.",
    "COMPLETE message received Retransmission of REGISTRATION ACCEPT message T3555 NOTE 6 NOTE 8 6s In WB- N1/CE mode, 24s For access via a satellite NG-RAN cell, 11s NOTE 12 5GMM- REGISTERED Transmission of CONFIGURATION UPDATE COMMAND message with \"acknowledgement requested\" set in the Acknowledgement bit of the Configuration update indication IE CONFIGURATION UPDATE COMPLETE message received Retransmission of CONFIGURATION UPDATE COMMAND message T3560 NOTE 6 NOTE 8 6s In WB- N1/CE mode, 24s For access via a satellite NG-RAN cell, 11s 5GMM-COMMON- PROCEDURE- INITIATED Transmission of AUTHENTICATION REQUEST message Transmission of SECURITY MODE COMMAND message AUTHENTICATION RESPONSE message received AUTHENTICATION FAILURE message received SECURITY MODE COMPLETE message received SECURITY MODE REJECT message received Retransmission of AUTHENTICATION REQUEST message or SECURITY MODE COMMAND message TIMER NUM.",
    "TIMER VALUE STATE CAUSE OF START NORMAL STOP ON EXPIRY T3565 NOTE 6 NOTE 8 6s In WB- N1/CE mode, 24s For access via a satellite NG-RAN cell, 11s NOTE 12 5GMM- REGISTERED Transmission of NOTIFICATION message SERVICE REQUEST message received CONTROL PLANE SERVICE REQUEST message received NOTIFICATION RESPONSE message received REGISTRATION REQUEST Message received DEREGISTRATION REQUEST message received NGAP UE context resume request message as specified in 3GPP TS 38.413 [3 1] received Retransmission of NOTIFICATION message T3570 NOTE 6 NOTE 8 6s In WB- N1/CE mode, 24s For access via a satellite NG-RAN cell, 11s NOTE 12 5GMM-COMMON- PROCEDURE- INITIATED Transmission of IDENTITY REQUEST message IDENTITY RESPONSE message received Retransmission of IDENTITY REQUEST message T3575 NOTE 6 NOTE 8 15s In WB- N1/CE mode, 60s For access via a satellite NG-RAN cell, 27s NOTE 12 5GMM- REGISTERED Transmission of NETWORK SLICE-SPECIFIC AUTHENTICATION COMMAND message NETWORK SLICE- SPECIFIC AUTHENTICATION COMPLETE message received Retransmission of NETWORK SLICE- SPECIFIC AUTHENTICATION COMMAND message Active timer NOTE 10 All except 5GMM- DEREGISTERED Entering 5GMM-IDLE mode after indicating MICO mode activation to the UE with an active timer value.",
    "N1 NAS signalling connection established Activate MICO mode for the UE. Implicit de- registration timer NOTE 2 All except 5GMM- DEREGISTERED The mobile reachable timer expires while the network is in 5GMM-IDLE mode Entering 5GMM-IDLE mode over 3GPP access if the MICO mode is activated and strictly periodic monitoring timer is not running The strictly periodic monitoring timer expires while the network is in 5GMM-IDLE mode N1 NAS signalling connection established Implicitly de-register the UE on 1st expiry TIMER NUM. TIMER VALUE STATE CAUSE OF START NORMAL STOP ON EXPIRY Mobile reachable timer NOTE 1 All except 5GMM- DEREGISTERED Entering 5GMM-IDLE mode N1 NAS signalling connection established Network dependent, but typically paging is halted on 1st expiry, and start implicit de- registration timer, if the UE is not registered for emergency services.",
    "Implicitly de-register the UE which is registered for emergency services Non-3GPP implicit de- registration timer NOTE 3 All except 5GMM- DEREGISTERED Entering 5GMM-IDLE mode over non-3GPP access N1 NAS signalling connection over non-3GPP access established Implicitly de-register the UE for non- 3GPP access on 1s expiry Strictly periodic monitoring timer NOTE 5 All except 5GMM- DEREGISTERED At the successful completion of registration update procedure if strictly periodic registration timer indication is supported as specified in subclause 5.3.7. Entering 5GMM- DEREGISTERED.",
    "In 5GMM-IDLE mode, start implicit de-registration timer as specified in subclause 5.3.7. In 5GMM- CONNECTED mode, Strictly periodic monitoring timer is started again as specified in subclause 5.3.7. Implement ation specific timer for onboarding services NOTE 11 5GMM- REGISTERED At the successful completion of initial registration for onboarding services in SNPN or initial registration for the UE which the subscription is only for configuration of SNPN subscription parameters in PLMN via the user plane or successful completion of registration procedure for mobility and periodic registration update if the implementation specific timer for onboarding services is not running and: - the UE is registered for onboarding services in SNPN; or - the UE's subscription only allows for configuration of SNPN subscription parameters in PLMN via the user plane. DEREGISTRATION REQUEST message received. Network-initiated de- registration procedure performed TIMER NUM.",
    "TIMER VALUE STATE CAUSE OF START NORMAL STOP ON EXPIRY NOTE 1: The default value of this timer is 4 minutes greater than the value of timer T3512. If the UE is registered for emergency services, the value of this timer is set equal to the value of timer T3512. If the T3346 value provided in the mobility management messages is greater than the value of the timer T3512, the AMF sets the mobile reachable timer and the implicit de-registration timer such that the sum of the timer values is greater than the value of timer T3346. NOTE 2: The value of this timer is network dependent. If MICO is activated, the default value of this timer is 4 minutes greater than the value of timer T3512. NOTE 3: The value of this timer is network dependent. The default value of this timer is 4 minutes greater than the non- 3GPP de-registration timer.",
    "If the T3346 value provided in the mobility management messages is greater than the value of the non-3GPP de-registration timer, the AMF sets the non-3GPP implicit de-registration timer value to be 8 minutes greater than the value of timer T3346. NOTE 4: The value of this timer is network dependent. NOTE 5: The value of this timer is the same as the value of timer T3512. NOTE 6: In NB-N1 mode, the timer value shall be calculated as described in subclause 4.17. NOTE 7: In NB-N1 mode, the timer value shall be calculated by using an NAS timer value which is network dependent. NOTE 8: In WB-N1 mode, if the UE supports CE mode B and operates in either CE mode A or CE mode B, then the timer value is as described in this table for the case of WB-N1/CE mode (see subclause 4.19). NOTE 9: In WB-N1 mode, if the UE supports CE mode B, then the timer value shall be calculated by using an NAS timer value which value is network dependent.",
    "NOTE 10: If the AMF includes timer T3324 in the REGISTRATION ACCEPT message and if the UE is not registered for emergency services, the value of this timer is equal to the value of timer T3324. NOTE 11: The value of this timer needs to be large enough to allow a UE to complete the configuration of one or more entries of the \"list of subscriber data\" and considering that configuration of SNPN subscription parameters in PLMN via the user plane or onboarding services in SNPN involves third party entities outside of the operator's network. NOTE 12: In satellite NG-RAN access, this value shall be selected when satellite NG-RAN RAT type is NR(MEO) or NR(GEO).",
    "V MANAGE UE POLICY COMMAND message identity UE policy delivery service message type D.6.1 M V UE policy section management list UE policy section management list D.6.2 M LV-E 11-65533 UE policy network classmark UE policy network classmark D.6.7 O TLV 3-5 VPS URSP configuration VPS URSP configuration D.6.8 O TLV-E 3-65533 NOTE: The total length of the MANAGE UE POLICY COMMAND message content cannot exceed 65535 octets (see Payload container contents maximum length as specified in subclause 9.11.3.39.1). D.5.1.2 UE policy network classmark The UE policy network classmark is included when the PCF of a PLMN or an SNPN intends to provide the UE with information about the policy aspects of the network. D.5.1.3 VPS URSP configuration The VPS URSP configuration IE is included when the PCF of a PLMN intends to provide the UE with the VPS URSP configuration.",
    "D.5.2 Manage UE policy complete D.5.2.1 Message definition The MANAGE UE POLICY COMPLETE message is sent by the UE to the PCF to report that all received instructions have been successfully executed at the UE, see table D.5.2.1.1 Message type: MANAGE UE POLICY COMPLETE Significance: dual Direction: UE to network Table D.5.2.1.1: MANAGE UE POLICY COMPLETE message content IEI Information Element Type/Reference Presence Format Length PTI Procedure transaction identity V UE STATE INDICATION message identity UE policy delivery service message type D.6.1 M V UPSI list UPSI list D.6.4 M LV-E 2-65531 UE policy classmark UE policy classmark D.6.5 M LV 2-4 UE OS Id OS Id D.6.6 O TLV 18-242 NOTE: The total length of the UE STATE INDICATION message content cannot exceed 65535 octets (see Payload container contents maximum length as specified in subclause 9.11.3.39.1).",
    "D.6 Information elements coding D.6.1 UE policy delivery service message type Table D.6.1.1: UE policy delivery service message type Bits 8 7 6 5 4 3 2 1 0 0 0 0 0 0 0 0 Reserved 0 0 0 0 0 0 0 1 MANAGE UE POLICY COMMAND message 0 0 0 0 0 0 1 0 MANAGE UE POLICY COMPLETE message 0 0 0 0 0 0 1 1 MANAGE UE POLICY COMMAND REJECT message 0 0 0 0 0 1 0 0 UE STATE INDICATION message 0 0 0 0 0 1 0 1 UE POLICY PROVISIONING REQUEST message (see NOTE) 0 0 0 0 0 1 1 0 UE POLICY PROVISIONING REJECT message (see NOTE) All other values are reserved NOTE: Coding of UE POLICY PROVISIONING REQUEST message and UE POLICY PROVISIONING REJECT message are specified in 3GPP TS 24.587 [19B]. Usage of UE POLICY PROVISIONING REQUEST message and UE POLICY PROVISIONING REJECT message for V2X policy is specified in 3GPP TS 24.587 [19B]. Usage of UE POLICY PROVISIONING REQUEST message and UE POLICY PROVISIONING REJECT message for ProSeP policy is specified in 3GPP TS 24.554 [19E].",
    "Usage of UE POLICY PROVISIONING REQUEST message and UE POLICY PROVISIONING REJECT message for A2X policy is specified in 3GPP TS 24.577 [60]. Usage of UE POLICY PROVISIONING REQUEST message and UE POLICY PROVISIONING REJECT message for RSLPP policy is specified in 3GPP TS 24.514 [62]. D.6.2 UE policy section management list The purpose of the UE policy section management list information element is to transfer from the PCF to the UE a list of instructions to be performed at the UE for management of UE policy section stored at the UE. The UE policy section management list information element is coded as shown in figure D.6.2.1, figure D.6.2.2, figure D.6.2.3, figure D.6.2.4, figure D.6.2.5, figure D.6.2.6, figure D.6.2.7 and table D.6.2.1. The UE policy section management list information element has a minimum length of 12 octets and a maximum length of 65534 octets.",
    "UE policy section management list IEI octet 1 Length of UE policy section management list contents octet 2 octet 3 UE policy section management list contents octet 4 octet z Figure D.6.2.1: UE policy section management list information element UE policy section management sublist (PLMN 1) octet 4 octet a UE policy section management sublist (PLMN 2) octet (a+1)* octet b* … octet (b+1)* … octet c* UE policy section management sublist (PLMN N) octet (c+1)* octet z* Figure D.6.2.2: UE policy section management list contents Length of UE policy section management sublist octet d octet d+1 MCC digit 1 octet d+2 MCC digit 2 MCC digit 3 octet d+3 MNC digit 3 MNC digit 1 octet d+4 MNC digit 2 UE policy section management sublist contents octet d+5 octet y Figure D.6.2.3: UE policy section management sublist Instruction 1 octet d+5 octet e Instruction 2 octet (e+1)* octet f* … octet (f+1)* … octet g* Instruction N octet (g+1)* octet e* Figure D.6.2.4: UE policy section management sublist contents Instruction contents length octet d+5 octet d+6 UPSC octet d+7 octet d+8 UE policy section contents octet (d+9)* octet k* Figure D.6.2.5: Instruction UE policy part 1 octet l octet m UE policy part 2 octet (m+1)* octet n* … octet (n+1)* … octet o* UE policy part N octet (o+1)* octet p* Figure D.6.2.6: UE policy section contents UE policy part contents length octet q octet q+1 UE policy part type octet q+2 Spare UE policy part contents octet q+3 octet r Figure D.6.2.7: UE policy part Table D.6.2.1: UE policy section management list information element Value part of the UE policy section management list information element (octets 4 to z) The value part of the UE policy section management list information element consists of one or several UE policy section management sublists.",
    "UE policy section management sublist: Length of UE policy section management sublist (octets d to d+1) This field contains the binary encoding of the length of the UE policy section management sublist in units of octets. MCC, Mobile country code (octet d+2, and bits 4 to 1 of octet d+3) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A. MNC, Mobile network code (bits 8 to 5 of octet d+3, and octet d+4) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, MNC digit 3 shall be coded as \"1111\". (NOTE 1) UE policy section management sublist contents (octets d+5 to y) The UE policy section management sublist contents consist of one or several instructions. Instruction: Instruction contents length (octets d+5 to d+6) This field contains the binary encoding of the instruction contents length in units of octets.",
    "UPSC (octets d+7 to d+8) This field contains the binary encoding of the UPSC. The value of the UPSC is set by the PCF. UE policy section contents (octets d+9 to k) The UE policy section contents consist of one or several UE policy parts. UE policy part: UE policy part contents length (octets q to q+1) This field contains the binary encoding of the UE policy part contents length in units of octets (NOTE 2). UE policy part type (bits 4 to 1 of octet q+2) Bits 4 3 2 1 0 0 0 0 Reserved 0 0 0 1 URSP 0 0 1 0 ANDSP 0 0 1 1 V2XP 0 1 0 0 ProSeP 0 1 0 1 A2XP 0 1 1 0 RSLPP All other values are reserved. Bits 8 to 5 of octet q+2 are spare and shall be coded as zero.",
    "UE policy part contents (octets q+3 to r) This field contains a UE policy part encoded as specified in 3GPP TS 24.526 [19] for the UE policy part type field set to \"URSP\" or \"ANDSP\", in 3GPP TS 24.588 [19C] for the UE policy part type field set to \"V2XP\", in 3GPP TS 24.555 [19F] for the UE policy part type field set to \"ProSeP\" and in 3GPP TS 24.514 [62] for the UE policy part type field set to \"RSLPP\" and in 3GPP TS 24.578 [61] for the UE policy part type field set to \"A2XP\" respectively. NOTE 1: When the PCF is in an SNPN, the PCF shall include the PLMN ID part of the SNPN identity in the UE policy section management sublist. NOTE 2: The UE policy part contents length indicates the length of the value part of the UE policy part field (i.e. octet q+2 to octet r).",
    "D.6.3 UE policy section management result The purpose of the UE policy section management result information element is to transfer from the UE to the PCF information about instructions for UE policy section management which the UE could not execute successfully. The UE policy section management result information element is coded as shown in figure D.6.3.1, figure D.6.3.2, figure D.6.3.3, figure D.6.3.4, figure D.6.3.5 and table D.6.3.1. The UE policy section management result information element has a minimum length of 12 octets and a maximum length of 65534 octets.",
    "UE policy section management result IEI octet 1 Length of UE policy section management result contents octet 2 octet 3 UE policy section management result contents octet 4 octet z Figure D.6.3.1: UE policy section management result information element UE policy section management subresult (PLMN 1) octet 4 octet a UE policy section management subresult (PLMN 2) octet (a+1)* octet b* … octet (b+1)* … octet c* UE policy section management subresult (PLMN N) octet (c+1)* octet z* Figure D.6.3.2: UE policy section management result contents Number of results octet d MCC digit 1 octet d+1 MCC digit 2 MCC digit 3 octet d+2 MNC digit 3 MNC digit 1 octet d+3 MNC digit 2 UE policy section management subresult contents octet d+4 octet y Figure D.6.3.3: UE policy section management subresult Result 1 octet d+4 octet d+8 Result 2 octet (d+9)* octet (d+13)* … Octet (d+14)* … octet e* Result N Octet (e+1)* octet (e+5)* Figure D.6.3.4: UE policy section management subresult contents UPSC octet f octet f+1 Failed instruction order octet f+2 octet f+3 Cause octet f+4 Figure D.6.3.5: Result Table D.6.3.1: UE policy section management result information element Value part of the UE policy section management result information element (octets 4 to z) The value part of the UE policy section management result information element consists of one or several UE policy section management subresults.",
    "UE policy section management subresult: Number of results (octet d) This field contains the binary encoding of number of results included in the UE policy section management subresult. MCC, Mobile country code (octet d+1, and bits 4 to 1 of octet d+2) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A. MNC, Mobile network code (bits 8 to 5 of octet d+2, and octet d+3) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, MNC digit 3 shall be coded as \"1111\". (NOTE) UE policy section management subresult contents (octets d+4 to y) The UE policy section management subresult contents consist of one or several results. Result (octet f to f+4) UPSC (octet f to f+1) This field contains the binary encoding of the UPSC.",
    "The value of the UPSC is set by the PCF Failed instruction order (octets f+2 to f+3) This field contains the binary encoding of the order of the instruction in the UE policy section management sublist contents as specified in Figure D.6.2.4, which could not be executed successfully. The value of failed instruction order set to one indicates that the first instruction in the UE policy section management sublist contents could not be executed successfully. Cause (octet f+4) Bits 8 7 6 5 4 3 2 1 0 1 1 0 1 1 1 1 Protocol error, unspecified The receiving entity shall treat any other value as 0110 1111, \"Protocol error, unspecified\". NOTE: The UE operating in the SNPN access operation mode shall include the PLMN ID part of the SNPN identity of the SNPN in the UE policy section management subresult.",
    "D.6.4 UPSI list The purpose of the UPSI list information element is to transfer from the UE to the PCF a list of UPSIs. The UPSI list information element is coded as shown in figure D.6.4.1, figure D.6.4.2, and table D.6.4.1. The UPSI list information element has a minimum length of 3 octets and a maximum length of 65532 octets. NOTE: A PCF implementing a previous version of the present specification will expect the UPSI list information element to have a minimum length of 10 octets and could be unable to decode a UPSI list information element with a length of 3 octets i.e. a UPSI list information element not containing any UPSI.",
    "UPSI list IEI octet 1 Length of UPSI list contents octet 2 octet 3 UPSI sublist (PLMN 1) octet 4* octet a* UPSI sublist (PLMN 2) octet a+1* octet b* … octet b+1* octet c* UPSI sublist (PLMN N) octet c+1* octet z* Figure D.6.4.1: UPSI list information element Length of UPSI sublist octet d octet d+1 MCC digit 2 MCC digit 1 octet d+2 MNC digit 3 MCC digit 3 octet d+3 MNC digit 2 MNC digit 1 octet d+4 UPSC 1 octet d+5 octet d+6 UPSC 2 octet d+7* octet d+8* … octet d+9* octet e* UPSC M octet e+1* octet e+2* Figure D.6.4.2: UPSI sublist Table D.6.4.1: UPSI list information element Length of UPSI list contents (octets 2 to 3) This field indicates the length of the UPSI list contents. If no UPSIs are included in the UPSI list, the UE shall set the length of UPSI list contents to zero. MCC, Mobile country code (octet d+2, and bits 4 to 1 of octet d+3) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A.",
    "MNC, Mobile network code (bits 8 to 5 of octet d+3, and octet d+4) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, MNC digit 3 shall be coded as \"1111\". (NOTE) UPSC (octets d+5 to d+6) This field contains the binary encoding of the UPSC. The value of the UPSC is set by the PCF. NOTE: The UE operating in the SNPN access operation mode shall include the PLMN ID part of the SNPN identity in the UPSI sublist. D.6.5 UE policy classmark The purpose of the UE policy classmark information element is to provide the network with information about the policy aspects of the UE. The UE policy classmark information element is coded as shown in figure D.6.5.1 and table D.6.5.1. The UE policy classmark is a type 4 information element with a minimum length of 3 octets and a maximum length of 5 octets.",
    "Policy information IEI octet 1 Length of Policy information contents octet 2 Spare Spare Spare Spare Suppor tRURE SVPS U EPSU RSP Suppor tANDS P octet 3 octet 4* -5* Spare Figure D.6.5.1: UE policy classmark information element Table D.6.5.1: UE policy classmark information element Support of ANDSP by the UE (SupportANDSP) (octet 3, bit 1) Bit 0 ANDSP not supported by the UE 1 ANDSP supported by the UE Support of URSP provisioning in EPS by the UE (EPSURSP) (octet 3, bit 2) (see NOTE) Bit 0 URSP provisioning in EPS not supported by the UE 1 URSP provisioning in EPS supported by the UE Support of VPS URSP (SVPSU) (octet 3, bit 3) Bit 0 VPS URSP not supported by the UE 1 VPS URSP supported by the UE Support of Reporting URSP Rule Enforcement by the UE (SupportRURE) (octet 3, bit 4) Bit 0 Reporting URSP rule enforcement not supported by the UE 1 Reporting URSP rule enforcement supported by the UE All other bits in octet 3 to 5 are spare and shall be coded as zero, if the respective octet is included in the information element.",
    "NOTE: This indicator shall be ignored by an EPS receiving entity as the UE in EPS providing UE STATE INDICATION message, supports URSP provisioning in EPS. D.6.6 UE OS Id The purpose of the UE OS Id information element is to provide the network with information about the OS of the UE. The UE OS Id information element is coded as shown in figure D.6.6.1 and table D.6.6.1. The UE OS Id is a type 4 information element with a minimum length of 18 octet and a maximum length of 242 octets. OS Id IEI octet 1 Length of OS Id information contents octet 2 OS Id_1 octets 3 - 18 … … OS Id_15 octets 227* -242* Figure D.6.6.1: UE OS Id information element Table D.6.6.1: UE OS Id information element OS Id: The OS Id is coded as a sequence of a sixteen octet OS Id value field. The OS Id value field is defined as Universally Unique IDentifier (UUID) as specified in IETF RFC 4122 [35A].",
    "D.6.7 UE policy network classmark The purpose of the UE policy network classmark information element is to provide the UE with information about the policy aspects of the network. The UE policy network classmark information element is coded as shown in figure D.6.7.1 and table D.6.7.1. The UE policy network classmark is a type 4 information element with a minimum length of 3 octets and a maximum length of 5 octets.",
    "UE policy network classmark IEI octet 1 Length of UE policy network classmark contents octet 2 Spare Spare Spare Spare Spare Spare Spare NSSUI octet 3 octet 4* -5* Spare Figure D.6.7.1: UE policy network classmark information element Table D.6.7.1: UE policy network classmark information element Non-subscribed SNPN signalled URSP handling indication (NSSUI) (octet 3, bit 1) (see NOTE) Bits 0 UE is allowed to accept URSP signalled by non-subscribed SNPNs 1 UE is not allowed to accept URSP signalled by non-subscribed SNPNs All other bits in octet 3 to 5 are spare and shall be coded as zero, if the respective octet is included in the information element. NOTE: Receiving UE shall ignore this bit, if i) UE has an empty or non-present EHPLMN list and the bit is received from the RPLMN which is not the HPLMN, ii) UE has non-empty EHPLMN list and the bit is received from the RPLMN which is not an EHPLMN or iii) the bit is received from the RSNPN which is not the subscribed SNPN.",
    "D.6.8 VPS URSP configuration The purpose of the VPS URSP configuration information element is to transfer the VPS URSP configuration from the PCF to the UE. The VPS URSP configuration contains zero or more tuples. Each tuple contains the tuple ID identifying the tuple, the network descriptor identifying one or more VPLMNs, and zero or more UPSCs of HPLMN's UE policy sections which contain solely one or more UE policy parts with the UE policy part type set to \"URSP\", such that the URSP rules in those one or more UE policy parts are applicable to the VPLMN and its equivalent PLMN. The VPS URSP configuration information element is coded as shown in figure D.6.8.1, figure D.6.8.2, figure D.6.8.3, figure D.6.8.4, figure D.6.8.5, figure D.6.8.6, figure D.6.8.7, figure D.6.8.8, figure D.6.8.9, and table D.6.8.1. The VPS URSP configuration is type 6 information element with a minimum length of 3 octets and a maximum length of 65533 octets.",
    "VPS URSP configuration IEI octet 1 Length of VPS URSP configuration contents octet 2 octet 3 Spare Spare Spare Spare Spare Spare RT octet 4 Tuple 1 octet 5* octet a* Tuple 2 octet (a+1)* octet b* … octet (b+1)* octet c* Tuple N octet (c+1)* octet z* Figure D.6.8.1: VPS URSP configuration information element Length of tuple contents octet a+1 octet a+2 Tuple ID octet a+3 Network descriptor octet a+4 octet e UPSC 1 octet (e+1)* octet (e+2)* UPSC 2 octet (e+3)* octet (e+4)* … octet (e+5)* octet (e+n*2e- 2)* UPSC n octet (e+n*2- 1)* octet (e+n*2)* = octet b* Figure D.6.8.2: Tuple Number of network descriptor entries octet a+4 Network descriptor entry 1 octet (a+5) octet f Network descriptor entry 2 octet (f+1)* octet g* ...",
    "octet (g+1)* octet h* Network descriptor entry m octet (h+1)* octet e* Figure D.6.8.3: Network descriptor Network descriptor entry type octet f+1 Network descriptor entry value octet (f+2)* octet g* Figure D.6.8.4: Network descriptor entry Number of PLMN IDs octet (f+2) PLMN ID 1 octet (f+3) octet (f+5) PLMN ID 2 octet (f+6)* octet (f+8)* ... PLMN ID m octet (m*3+f)* octet (m*3+f+2)* = octet g* Figure D.6.8.5: Network descriptor entry value for network descriptor entry type set to \"one or more VPLMNs\" MCC digit 2 MCC digit 1 octet f+6 MNC digit 3 MCC digit 3 octet f+7 MNC digit 2 MNC digit 1 octet f+8 Figure D.6.8.6: PLMN ID Number of MCCs octet (f+2) MCC pair 1 octet (f+3) octet (f+5) MCC pair 2 octet (f+6)* octet (f+8)* ...",
    "MCC pair m octet (m*3+f)* octet (m*3+f+2)* Odd MCC octet (m*3+f+3)* octet (m*3+f+4)* = octet g* Figure D.6.8.7: Network descriptor entry value for network descriptor entry type set to \"one or more MCCs\" MCC 1 digit 2 MCC 1 digit 1 octet f+6 MCC 2 digit 3 MCC 1 digit 3 octet f+7 MCC 2 digit 2 MCC 2 digit 1 octet f+8 Figure D.6.8.8: MCC pair MCC digit 2 MCC digit 1 octet (m*3+f+3) Spare Spare Spare Spare MCC digit 3 octet (m*3+f+4) = octet g Figure D.6.8.9: Odd MCC Table D.6.8.1: VPS URSP configuration information element Replacement type (octet 4, bits 1 and 2) Bits 2 1 0 1 per-tuple replacement 1 0 full list of tuples All other values are reserved. Tuple ID (octet a+3) This field contains the binary encoding of the tuple ID. The value of the tuple ID is set by the PCF. Network descriptor entry type (octet f+1) Bits 8 7 6 5 4 3 2 1 0 0 0 0 0 0 0 1 one or more VPLMNs 0 0 0 0 0 0 1 0 one or more MCCs 0 0 0 0 0 0 1 1 any VPLMN All other values are reserved.",
    "If the network descriptor entry type field is set to \"one or more VPLMNs\" or \"one or more MCCs\", then the network descriptor entry value field is present. If the network descriptor entry type field is set to \"any VPLMN\", then the network descriptor entry value field is absent. Number of PLMN IDs (octet (f+2) of the network descriptor entry value for network descriptor entry type set to \"one or more VPLMNs\") The number of PLMN IDs field indicates the number of the PLMN IDs in the network descriptor entry value field. MCC, Mobile country code (octet f+6 and bits 4 to 1 of octet f+7 of the PLMN ID, octet f+6 and bits 4 to 1 of octet f+7 of the MCC pair, and octet f+8 and bits 8 to 5 of octet f+7 of the MCC pair, octet m*3+f+3 and bits 4 to 1 of m*3+f+4 of the odd MCC) The MCC field is coded as in ITU-T Recommendation E.212 [42], annex A.",
    "MNC, Mobile network code (bits 8 to 5 of octet f+7, and octet f+8) The coding of this field is the responsibility of each administration but BCD coding shall be used. The MNC shall consist of 2 or 3 digits. If a network operator decides to use only two digits in the MNC, MNC digit 3 shall be coded as \"1111\". Number of MCCs (octet (f+2) of the network descriptor entry value for network descriptor entry type set to \"one or more MCCs\") The number of MCCs field indicates the number of the MCCs in the network descriptor entry value field. If the number of MCCs field is an odd value, then the odd MCC field is present otherwise the odd MCC field is absent.",
    "UPSC (octets e+3 to e+4) This field contains the binary encoding of the UPSC of an UPSI of a UE policy section of the HPLMN (see NOTE), which contains solely one or more UE policy parts with the UE policy part type set to \"URSP\", such that the URSP rules in those one or more UE policy parts are applicable to the VPLMN and its equivalent PLMN. NOTE: PLMN ID of the UPSI is not indicated. D.7 Timers of UE policy delivery service Timers of UE policy delivery service are shown in table D.7.1. Table D.7.1: Timers of UE policy delivery service – PCF side TIMER NUM. TIMER VALUE CAUSE OF START NORMAL STOP ON THE 1st, 2nd, 3rd, 4th EXPIRY T3501 NOTE 1 Transmission of MANAGE UE POLICY COMMAND MANAGE UE POLICY COMMAND COMPLETE or MANAGE UE POLICY COMMAND REJECT message received Retransmission of MANAGE UE POLICY COMMAND message NOTE 1: The value of this timer is network dependent.",
    "D.8 Handling of unknown, unforeseen, and erroneous UPDS data D.8.1 General The procedures specified in the subclause apply to those messages which pass the checks described in this subclause. This subclause also specifies procedures for the handling of unknown, unforeseen, and erroneous UPDS data by the receiving entity. These procedures are called \"error handling procedures\", but in addition to providing recovery mechanisms for error situations they define a compatibility mechanism for future extensions of the UPDS. Subclauses D.8.1 to D.8.8 shall be applied in order of precedence. Detailed error handling procedures in the network are implementation dependent and may vary from PLMN to PLMN. However, when extensions of UPDS are developed, networks are assumed to have the error handling which is indicated in this subclause as mandatory (\"shall\") and that is indicated as strongly recommended (\"should\").",
    "Also, the error handling of the network is only considered as mandatory or strongly recommended when certain thresholds for errors are not reached during a dedicated connection. For definition of semantical and syntactical errors see 3GPP TS 24.007 [11], subclause 11.4.2. D.8.2 Message too short or too long D.8.2.1 Message too short When a message is received that is too short to contain a complete message type information element, that message shall be ignored, c.f. 3GPP TS 24.007 [11]. D.8.2.2 Message too long The maximum size of a UE policy delivery service message is 65535 octets.",
    "D.8.3 Unknown or unforeseen procedure transaction identity D.8.3.1 Procedure transaction identity The following network procedures shall apply for handling an unknown, erroneous, or unforeseen PTI received in a UPDS message: a) In case the network receives a MANAGE UE POLICY COMPLETE message or MANAGE UE POLICY COMMAND REJECT message in which the PTI value is an assigned or unassigned value that does not match any PTI in use, the network shall ignore the UPDS message. b) In case the network receives a UPDS message in which the PTI value is a reserved value, the network shall ignore the UPDS message. The following UE procedures shall apply for handling an unknown, erroneous, or unforeseen PTI received in a UPDS message: a) In case the UE receives a UPDS message in which the PTI value is a reserved value, the UE shall ignore the UPDS message.",
    "D.8.4 Unknown or unforeseen message type If the UE or the network receives a UPDS message with message type not defined for the UPDS or not implemented by the receiver, it shall ignore the UPDS message. NOTE: A message type not defined for the UPDS in the given direction is regarded by the receiver as a message type not defined for the UPDS, see 3GPP TS 24.007 [11]. If the UE receives a message not compatible with the UPDS state, the UE shall ignore the UPDS message. If the network receives a message not compatible with the UPDS state, the network actions are implementation dependent.",
    "D.8.5 Non-semantical mandatory information element errors D.8.5.1 Common procedures When on receipt of a message, a) an \"imperative message part\" error; or b) a \"missing mandatory IE\" error is diagnosed or when a message containing: a) a syntactically incorrect mandatory IE; b) an IE with an IEI unknown in the message, but encoded as \"comprehension required\" (see 3GPP TS 24.007 [11]); or c) an out of sequence IE encoded as \"comprehension required\" (see 3GPP TS 24.007 [11]) is received, the UE shall ignore the UPDS message; the network shall proceed as follows: the network shall: 1) try to treat the message (the exact further actions are implementation dependent); or 2) ignore the message. D.8.6 Unknown and unforeseen IEs in the non-imperative message part D.8.6.1 IEIs unknown in the message The UE shall ignore all IEs unknown in a message which are not encoded as \"comprehension required\" (see 3GPP TS 24.007 [11]). The network shall take the same approach.",
    "D.8.6.2 Out of sequence IEs The UE shall ignore all out of sequence IEs in a message which are not encoded as \"comprehension required\" (see 3GPP TS 24.007 [11]). The network should take the same approach. D.8.6.3 Repeated IEs If an information element with format T, TV, TLV, or TLV-E is repeated in a message in which repetition of the information element is not specified in subclause D.5, the UE shall handle only the contents of the information element appearing first and shall ignore all subsequent repetitions of the information element. When repetition of information elements is specified, the UE shall handle only the contents of specified repeated information elements. If the limit on repetition of information elements is exceeded, the UE shall handle the contents of information elements appearing first up to the limit of repetitions and shall ignore all subsequent repetitions of the information element. The network should follow the same procedures.",
    "D.8.7 Non-imperative message part errors This category includes: a) syntactically incorrect optional IEs; and b) conditional IE errors. D.8.7.1 Syntactically incorrect optional IEs The UE shall treat all optional IEs that are syntactically incorrect in a message as not present in the message. The network shall take the same approach. D.8.7.2 Conditional IE errors When upon receipt of a UPDS message the UE diagnoses a \"missing conditional IE\" error or an \"unexpected conditional IE\" error, or when it receives a UPDS message containing at least one syntactically incorrect conditional IE, the UE shall ignore the message. When the network receives a message and diagnoses a \"missing conditional IE\" error or an \"unexpected conditional IE\" error or when it receives a message containing at least one syntactically incorrect conditional IE, the network shall either: a) try to treat the message (the exact further actions are implementation dependent); or b) ignore the message.",
    "D.8.8 Messages with semantically incorrect contents When a message with semantically incorrect contents is received, the UE shall perform the foreseen reactions of the procedural part of subclauses D.2. If, however no such reactions are specified, the UE shall ignore the message. The network should follow the same procedure. Annex E (informative): Void Annex F (informative): Change history Change history Date Meeting Tdoc CR Rev Cat Subject/Comment New version 2017-10 CT1#106 C1-174182 Draft skeleton provided by the rapporteur. CT1 e- mail review Editorial corrections.",
    "CT1 e- mail review Resolution of collision among C1-180679, C1-180721 and C1- Implementing the following p-CRs agreed by CT1: C1-181362, C1-181377, C1-181456, C1-181457, C1-181703, C1-181748, C1-181462, C1-181786, C1-181168, C1-181269, C1-181278, C1-181307, C1-181180, C1-181279, C1-181280, C1-181281, C1-181354, C1-181283, C1-181284, C1-181287, C1-181305, C1-181352, C1-181364, C1-181365, C1-181366, C1-181399, C1-181466, C1-181467, C1-181468, C1-181470, C1-181471, C1-181473, C1-181474, C1-181477, C1-181628, C1-181629, C1-181633, C1-181661, C1-181663, C1-181666, C1-181668, C1-181670, C1-181681, C1-181682, C1-181683, C1-181684, C1-181695, C1-181696, C1-181707, C1-181713, C1-181715, C1-181716, C1-181717, C1-181718, C1-181733, C1-181734, C1-181735, C1-181736, C1-181737, C1-181738, C1-181739, C1-181740, C1-181741, C1-181747, C1-181752, C1-181764, C1-181770, C1-181771, C1-181781, C1-181782, C1-181785, C1-181182, C1-181120, C1-181121, C1-181395, C1-181480, C1-181482, C1-181484, C1-181485, C1-181486, C1-181487, C1-181488, C1-181650, C1-181651, C1-181652, C1-181678, C1-181726, C1-181751, C1-181273, C1-181274, C1-181276, C1-181277, C1-181496, C1-181784, C1-181312, C1-181357, C1-181605, C1-181606, C1-181609, C1-181645, C1-181674, C1-181675, C1-181677, C1-181679, C1-181708, C1-181710, C1-181728, C1-181613, C1-181615, C1-181680, C1-181750, C1-181618, C1-181619, C1-181779, C1-181360, C1-181636, C1-181640, C1-181643, C1-181729, C1-181730, C1-181731, C1-181732 Corrections done by the rapporteur.",
    "Implementing the following p-CRs agreed by CT1: C1-182219, C1-182493, C1-182496, C1-182202, C1-182497, C1-182053, C1-182311, C1-182019, C1-182359, C1-182360, C1-182361, C1-182358, C1-182305, C1-182306, C1-182354, C1-182117, C1-182182, C1-182455, C1-182459, C1-182491, C1-182600, C1-182601, C1-182605, C1-182606, C1-182607, C1-182608, C1-182609, C1-182610, C1-182614, C1-182615, C1-182621, C1-182662, C1-182664, C1-182665, C1-182708, C1-182728, C1-182730, C1-182733, C1-182724, C1-182757, C1-182759, C1-182760, C1-182768, C1-182772, C1-182775, C1-182786, C1-182787, C1-182791, C1-182831, C1-182832, C1-182833, C1-182834, C1-182835, C1-183836, C1-182838, C1-182840, C1-182844, C1-182067, C1-182073, C1-182303, C1-182321, C1-182352, C1-182385, C1-182645, C1-182646, C1-182647, C1-182648, C1-182650, C1-182651, C1-182657, C1-182659, C1-182660, C1-182741, C1-182742, C1-182761, C1-182762, C1-182763, C1-182764, C1-182765, C1-182774, C1-182789, C1-182789, C1-182815, C1-182845, C1-182797, C1-182232, C1-182230, C1-182666, C1-182667, C1-182671, C1-182673, C1-182677, C1-182800, C1-182824, C1-182710, C1-182072, C1-182078, C1-182174, C1-182190, C1-182456, C1-182636, C1-182637, C1-182638, C1-182639, C1-182726, C1-182729, C1-182747, C1-182749, C1-182766, C1-182767, C1-182841, C1-182847, C1-182043, C1-182057, C1-182260, C1-182044, C1-182617, C1-182618, C1-182619, C1-182620, C1-182622, C1-182623, C1-182624, C1-182627, C1-182628, C1-182629, C1-182802, C1-182808, C1-182345, C1-182461, C1-182630 Corrections done by the rapporteur.",
    "CT1 e- mail review Re-implementation of C1-183535, C1-183813, C1-183408, C1- 183766 and C1-183831. Implementation of C1-183816 which was missed. Editorial corrections of some of the implemented p-CRs. Corrections done by the rapporteur.",
    "CT#81 CP-182139 0001 F Replace unknown \"registration update accept\" CT#81 CP-182138 0006 1 F Referring to the correct bits for SMS over NAS during the registration procedure CT#81 CP-182141 0009 1 F Timer T3540 clarifications CT#81 CP-182133 0013 1 F Correction for establishment of user-plane resources CT#81 CP-182137 0018 3 F Invalid DNN CT#81 CP-182136 0023 2 F Exchange of extended protocol configuration options CT#81 CP-182132 0026 F Correction and alignment of cause code values CT#81 CP-182131 0030 1 F AMF Region ID (8 bits), AMF Set ID (10 bits), and AMF Pointer (6 bits) CT#81 CP-182131 0035 2 F Authentication for normal services not accepted by network CT#81 CP-182130 0038 1 C Addition of NAS container IE for N1 mode HO CT#81 CP-182139 0041 1 F Removal of transparent container at N1 mode to S1 mode HO CT#81 CP-182139 0044 2 B Request for Kamf re-derivation CT#81 CP-182140 0047 1 F Single-registration mode CT#81 CP-182136 0054 2 F Equivalent PLMNs CT#81 CP-182131 0058 1 F Clarification on NAS level MM congestion Control CT#81 CP-182137 0065 4 C LADN indication from UE at registration CT#81 CP-182134 0070 1 D Correction to 5GMM Substate CT#81 CP-182140 0075 3 F Service request allowed for PDU release outside LADN CT#81 CP-182141 0079 2 F UAC and setting of the Uplink data status IE CT#81 CP-182141 0083 B UE configuration for AC 11-15 and MCS (access identity 2) CT#81 CP-182132 0086 2 F Clarifications on ATTEMPTING-REGISTRATION-UPDATE CT#81 CP-182136 0091 1 F Handling of forbidden tracking area list CT#81 CP-182130 0095 F Abnormal cases in the UE for network-initiated de-registration procedure CT#81 CP-182138 0098 4 F Registration procedure for mobility and periodic registration update CT#81 CP-182138 0101 4 F On #27 N1 mode not allowed CT#81 CP-182134 0105 F Corrections for interworking with EPS CT#81 CP-182135 0108 F Corrections on inconsistent descriptions for 5GSM and 5GMM CT#81 CP-182134 0113 1 F Correction on UE behaviour for 5GSM congestion control CT#81 CP-182142 0116 3 F Updates to deleting a derived QoS rule in the UE CT#81 CP-182130 0120 2 F Addition of ngKSI in DEREGISTRATION REQUEST CT#81 CP-182131 0125 1 F Addtion of cause values for service request reject CT#81 CP-182134 0130 F Correction to general message format CT#81 CP-182134 0135 F Correction to the 5GS identity type IE CT#81 CP-182140 0138 F Security procedures and handling after inter-system change CT#81 CP-182140 0142 F Resolution of editor's notes on 5GMM sub-layer design CT#81 CP-182139 0145 3 F Resolution of editor's note on sub-states of state 5GMM- REGISTERED CT#81 CP-182139 0148 F Removal of unnecesary editor's notes FFS CT#81 CP-182131 0154 1 F Clarification on SM congestion control specific to PLMN CT#81 CP-182131 0157 1 F Clarification for registration attempt counter handling and introduction of lower layer failure CT#81 CP-182137 0160 F Lists of 5GS forbidden tracking areas CT#81 CP-182134 0164 F Correction to 5GSM/ESM coordination CT#81 CP-182136 0167 3 F Exception handling in QoS operation CT#81 CP-182138 0170 2 F Release of N1 NAS signalling connection due to change in the network slicing information CT#81 CP-182136 0174 1 B Interworking between ePDG/EPC and NG-RAN/5GCN CT#81 CP-182137 0180 2 F Local release of a PDU session due to 5GSM cause #43: Invalid PDU session identity CT#81 CP-182131 0185 2 F Allowed NSSAI of a single-registration mode UE within a network with N26 CT#81 CP-182133 0189 3 F Correction on emergency PDU session handling CT#81 CP-182130 0194 1 B Access attempt barred for the UE-initiated NAS transport procedure CT#81 CP-182133 0198 4 F Correction of S-NSSAI based congestion control CT#81 CP-182141 0203 2 B Storing Configured NSSAI when the PLMN is changed CT#81 CP-182135 0208 2 F Corrections to terms and references CT#81 CP-182138 0212 6 B Preferred list terminating at ME or USIM CT#81 CP-182132 0215 F Clarification on S-NSSAI based congestion control for PDU session modification procedure CT#81 CP-182134 0233 2 F Corrections in EAP based primary authentication procedure (alternative 2) CT#81 CP-182133 0237 1 F Correction for generation of QoS rules CT#81 CP-182139 0242 1 F Requests for emergency services fallback from upper layers CT#81 CP-182137 0247 1 F Non-IP PDN connection type for S1 to N1 interworking CT#81 CP-182142 0251 1 F Updating NS Configuration via registration procedure CT#81 CP-182132 0258 2 F Correction for abnormal cases in the UE of service request procedure CT#81 CP-182141 0263 1 F TAI removed from list of Servie area lists after reject from network 15.1.0 2018-09 CT#81 CP-182135 0264 1 F EAP message IE mandatory in PDU SESSION AUTHENTICATION messages CT#81 CP-182130 0272 2 F Adding procedures for updating local emergency numbers in other modes CT#81 CP-182138 0277 2 F Reactivation result indicating insufficient resources during service request procedure CT#81 CP-182138 0281 2 C PDU Session Release due to Semantic or Syntactical Errors CT#81 CP-182140 0284 1 F Resolving EN on fatal causes in 5GMM/5GSM state machine CT#81 CP-182134 0287 1 F Correction on PDU session modification procedure CT#81 CP-182134 0291 1 F Correction to the UE security capability IE encoding CT#81 CP-182140 0294 F Resolution of editor's notes in D.3 and D.6.2 CT#81 CP-182140 0297 2 F Resolution of editor's note on unknown or unforeseen PDU session identity CT#81 CP-182136 0301 1 B Initial registration not accepted due to serving network not authorized CT#81 CP-182131 0305 1 F AMF pointer pointing one or more AMFs CT#81 CP-182137 0311 1 F Interworking with E-UTRAN connected to EPC of a UE registered to 5GC via non-3GPP access CT#81 CP-182130 0319 1 F 5GSM sublayer states for PDU session inactive CT#81 CP-182133 0323 1 F Correction on NW initiated de-registration procedure CT#81 CP-182131 0328 1 F Clarification on packet filters CT#81 CP-182133 0331 F Correction on 5GSM state mapping when interworking CT#81 CP-182140 0337 2 F Security Context CT#81 CP-182138 0341 2 F PDU session status in notification response message CT#81 CP-182135 0345 1 F Definition of user-plane resources CT#81 CP-182132 0352 1 F Clarification on the temporary identity in the service request procedure CT#81 CP-182135 0356 1 D Editorial corrections CT#81 CP-182132 0359 1 F Condition for starting timer T3540 CT#81 CP-182130 0365 3 F Adding the reference to T3346 CT#82 CP-183032 0121 10 F Clarification to VoPS indicator CT#82 CP-183032 0371 2 F Correction for maximum data rate per UE for integrity protection for DRBs for PDU sessions in non-3GPP access which are transferable to 3GPP access CT#82 CP-183032 0374 F Corrections for MTU PCO parameters handling CT#82 CP-183032 0380 2 F UAC: Correction for operator-defined access categories CT#82 CP-183032 0385 F Correct procedure for determining registered PLMN CT#82 CP-183032 0394 F Correction for LADN information encoding CT#82 CP-183032 0399 2 F ABBA handling when initiating EAP procedures CT#82 CP-183032 0403 1 F Signalling Default Configured NSSAI indication in the registration procedure CT#82 CP-183033 0406 1 F S-NSSAI not allowed by AMF CT#82 CP-183033 0409 F Change EMCW to EMCN3 CT#82 CP-183033 0413 1 F Rejected NSSAI sent in CONFIGURATION UPDATE COMMAND – Alt 2 CT#82 CP-183033 0417 5 F Updates on steering of roaming handling and information coding CT#82 CP-183033 0421 1 F Correction to UE behavior when disabling N1 mode for non- 3GPP access CT#82 CP-183033 0425 4 B Support for protection of initial NAS messages CT#82 CP-183033 0428 F No interworking to ePDG/EPC for Ethernet and unstructured PDU sessions CT#82 CP-183033 0431 1 F Change UE policy classmark as mandatory IE CT#82 CP-183033 0434 1 F Applicability of UAC for other cases of NAS message transport CT#82 CP-183034 0438 F UL data status upon fallback indication from lower layers CT#82 CP-183034 0442 2 F Correction to determination method of LADN DNN CT#82 CP-183034 0445 1 F Correction in emergency reg cause name CT#82 CP-183034 0448 3 F Resetting service request attempt counter upon receipt of the REGISTRATION ACCEPT message CT#82 CP-183034 0452 2 F Clarification on UE identities used for registration CT#82 CP-183034 0458 1 F Local PDU session release upon receipt of PDU Session Release Reject with 5GSM cause #34 (service option temporarily out of order) or #35 (PTI already in use) CT#82 CP-183034 0464 1 F Clarification on PDU session transfer from non-3GPP to 3GPP access when 3GPP PS data off UE status is activated CT#82 CP-183034 0471 1 F Network initiated de-registration in case of emergency PDU session CT#82 CP-183035 0474 F Resolution of editor's note on operator-defined access category CT#82 CP-183035 0480 F Aborted UE-initiated NAS transport procedure for delivery of SMS/LPP message/UE policy container CT#82 CP-183035 0490 2 F Correction on Network slicing indication CT#82 CP-183035 0494 1 F Correction to Configured NSSAI for the HPLMN CT#82 CP-183035 0501 3 F Adding necessary term defintions CT#82 CP-183035 0505 1 F Resolution of editor's note in sub-clause 4.8.3 CT#82 CP-183035 0509 1 F Remove editor's note for MT LCS CT#82 CP-183035 0516 1 F Correction on handling of mandatory IE errors CT#82 CP-183036 0519 1 F Handling on collision of PDU session establishment and release procedures CT#82 CP-183036 0523 1 F Correction of storage of operator-defined access categories CT#82 CP-183036 0528 1 F Enabling use of and disabling use of MICO mode CT#82 CP-183036 0532 F Clarifications on UE behaviour upon receiving RRC fallback indication CT#82 CP-183036 0535 1 F QoS rules verification during PDU session establishment procedure CT#82 CP-183036 0540 2 F Revisions on N1 NAS signaling connection establishment and release CT#82 CP-183036 0544 F Context management for 3GPP access and non-3GPP access due to SR rejection CT#82 CP-183036 0547 F Distinction in AMF-side abnormal cases for generic UE configuration update procedure with respect to 5G-GUTI update CT#82 CP-183037 0550 2 D Terminology alignment regarding support for interworking without N26 CT#82 CP-183037 0557 2 F Correction of LADN information for generic UE configuration update procedure CT#82 CP-183037 0562 1 F No S-NSSAI for emergency PDU sessions CT#82 CP-183037 0569 1 F Abnormal Cases in the UE for initial registration CT#82 CP-183037 0574 1 F Completion of mobile identity IE definition in messages CT#82 CP-183037 0577 3 F UAC - providing access identities for barring checks of AS triggered access attempts CT#82 CP-183037 0582 1 F Initial registration for emergency PDU session CT#82 CP-183037 0585 F T3584 and T3585 update in Timer table CT#82 CP-183038 0591 2 F Clarifications on NAS level mobility management congestion control CT#82 CP-183038 0594 3 C Procedure for UDM-triggered UE parameters update CT#82 CP-183038 0598 2 C Clarification on 5GSM cause_#46 out of LADN service area CT#82 CP-183038 0606 1 F Correcting the structure of LADN related description CT#82 CP-183038 0609 1 F Abnormal cases in the UE side for Configuration update prcedure.",
    "CT#82 CP-183038 0612 1 F QoS rules verification during PDU session modification. CT#82 CP-183038 0615 3 F SUCI encoding and support of NAI format CT#82 CP-183038 0619 F Reset of service request attempt counter CT#82 CP-183039 0625 F Correction on 'E' bit for deleting QoS flow description CT#82 CP-183039 0628 2 F Correction to SUPI definition due to NAI format CT#82 CP-183039 0631 1 F CONFIGURATION UPDATE COMMAND with no parameters other than registraion requested.",
    "CT#82 CP-183039 0635 1 F Stopping T3511 after transitioning to 5GMM-CONNECTED mode 15.2.0 2018-12 CT#82 CP-183039 0636 2 F Clarification on storage of UE policy sections of multiple PLMNs CT#82 CP-183039 0641 3 F Handling errors due to missing QoS flow descriptions parameters for GBR QoS flows CT#82 CP-183039 0646 1 F Always-on PDU sessions and associated access CT#82 CP-183039 0649 1 F QFI and QRI values in 5GSM messages CT#82 CP-183039 0652 F Clarifications on Configuration Update procedure CT#82 CP-183040 0655 1 F Clarification on handling of invalid LADN DNN in registration procedure – Alt 1 CT#82 CP-183040 0660 1 F UE behavior in ATTEMPTING-REGISTRATION state CT#82 CP-183029 0663 1 F UAC: Correction for operator-defined access categories of acknowledgement CT#82 CP-183040 0666 2 F Indication of a reason for failure in reactivating a PDU session CT#82 CP-183040 0669 2 F Mobility and periodic registration update triggered by indications from lower layers CT#82 CP-183040 0677 1 F Exceptions for UEs configured for high priority access in handling T3396, T3584, and T3585 CT#82 CP-183040 0680 1 F Revisons on PDU Session Eestablishment procedure CT#82 CP-183040 0686 2 F Support sending multiple payloads via Payload container CT#82 CP-183041 0690 2 F Transmission of SUCI in DEREGISTRATION REQUEST CT#82 CP-183041 0693 1 F Limited service and no SUPI states in 5GMM instance for non- 3GPP accesst CT#82 CP-183041 0697 1 F Correction on 5GSM congestion control CT#82 CP-183041 0700 1 F UE handling for semantic error in the QoS operation CT#82 CP-183041 0703 F Resolution of editor's note on the information the N3IWF maintains for a registered UE CT#82 CP-183041 0712 1 F Corrections for non-3GPP access idle mode CT#82 CP-183041 0718 F T35xx in Annex D CT#83 CP-190084 0638 3 F Clarification for abnormal case handling of registration procedure after inter-system change from S1 mode to N1 mode CT#83 CP-190084 0724 4 F Corrections to Annex D CT#83 CP-190084 0729 2 F UAC - access attempt matching criteria of operator-defined access categoryt CT#83 CP-190084 0734 2 F AMF rejecting PDU session establishment when the DNN is not subscribed CT#83 CP-190084 0743 1 F PDU session status for IWK without N26 CT#83 CP-190084 0746 3 F S1 UE security capability CT#83 CP-190085 0752 1 F PDU session modification for emergency PDU sessions.",
    "CT#83 CP-190100 0758 F Correction of the erroneous length of EAP messageIE CT#83 CP-190085 0763 2 F Cleanup on support of multiple payloads for NAS transport CT#83 CP-190085 0767 1 F Addition of the 5GSM cause IE in the PDU SESSION MODIFICATION COMPLETE message CT#83 CP-190085 0771 2 F Adding missing abnormal cases for initial registration (UE side) CT#83 CP-190085 0774 2 F Clarification on NSSAI inclusion mode after an inter-system change from S1 mode to N1 mode CT#83 CP-190085 0788 D DNN as a common IE CT#83 CP-190086 0796 1 F Corrections on fallback indication from lower layers CT#83 CP-190086 0802 3 F Handling of QoS flow description without valid EPS bearer contextt CT#83 CP-190086 0805 2 F Handling of missing QoS flow description and QoS rule CT#83 CP-190086 0808 1 F Adjustment of relevent timers when T3346 is included in the 5GMM message CT#83 CP-190086 0812 2 F Several corrections to messages and IEs CT#83 CP-190086 0817 F Correction to the definition of UE STATE INDICATION message content CT#83 CP-190086 0821 1 F Informing the UE about the integrity protection failure at S1 to N1 mode change CT#83 CP-190087 0829 3 F Correction on handling of invalid PSI CT#83 CP-190087 0834 2 F Skip barring checks during fallback handling CT#83 CP-190087 0838 1 F Handling of abnormal authentication errors CT#83 CP-190087 0845 1 F Removal of Editor's note on home network public key and home network public key identifier update and removal of protection scheme identifier CT#83 CP-190087 0849 1 F Correction for Cause code #7 CT#83 CP-190087 0857 1 F Retransmission of PDU SESSION RELEASE REQUEST CT#83 CP-190087 0862 2 F Temporary identity allocation CT#83 CP-190088 0867 F Correction to the inclusion of requested QoS rule and requested QoS flow descripstion in PDU session modification request.",
    "CT#83 CP-190088 0873 1 F Transmission failure at UE side for UE policy delivery procedure CT#83 CP-190088 0877 2 F OS Id information element CT#83 CP-190088 0883 1 F Handling on errors of QoS flow description operations CT#83 CP-190088 0889 1 F Correction in UE-initiated de-registration procedure initiation CT#83 CP-190088 0894 2 F Mandating UE sending registration complete for SOR CT#83 CP-190089 0901 1 F Clarification on congestion control upon intersystem change CT#83 CP-190089 0910 2 F 5GSM messages for a PDU session associated with non-3GPP access exchanged via 3GPP access CT#83 CP-190089 0914 1 F Inclusion of a 5G-GUTI mapped from the valid 4G-GUTI in the REGISTRATION REQUEST message during an initial registration is not available in Rel-15 CT#83 CP-190089 0918 1 F Correcton on handing of downlink signalling and data for non- 3GPP PDU session CT#83 CP-190089 0921 1 F Mapped configured S-NSSAI from the S-NSSAI(s) of the HPLMN 15.3.0 2019-03 CT#83 CP-190089 0922 F Use of stored NSSAI inclusion mode during initial registrationt CT#83 CP-190089 0926 1 F Correction to Service area list IE Type of list \"11\" CT#83 CP-190089 0930 1 F Adding the UE local configuration option in 24.501 CT#83 CP-190106 0730 4 B SINE_5G: Back-off control and retry restriction mechanisms in 5GS CT#83 CP-190101 0775 5 F Clarification on rejected NSSAI for the PLMN CT#83 CP-190101 0787 1 F Correction to TFT check CT#83 CP-190108 0830 B New 5QIs for Enhanced Framework for Uplink Streaming CT#83 CP-190101 0842 1 F Provision of NSSAI information to the lower layers CT#83 CP-190101 0851 1 F Update of validity conditions for access identities 1 and 2 CT#83 CP-190101 0866 1 F UE state at lower layer failure on the NW side at initial registration CT#83 CP-190101 0881 D Correction of wrong reference CT#83 CP-190101 0897 1 F Correction on abnormal case handlng at AMF for registration CT#83 CP-190101 0924 F Correction to N1 NAS signalling connection establishment CT#84 CP-191147 0936 B Interworking of Ethernet PDU session to Ethernet PDN connection CT#84 CP-191137 0939 B Session-TMBR for PDU session in W-5GAN CT#84 CP-191124 0948 2 A Precedence between access identities for derivation of RRC establishment cause and for derivation of establishment cause for non-3GPP access CT#84 CP-191122 0953 1 A Correction on T3396 CT#84 CP-191124 0959 1 A SR procedure for emergency services fallback when T3346 timer running CT#84 CP-191132 0965 3 F Clarification on the stop of T3540 CT#84 CP-191129 0969 1 B Introduction of extended DRX for 5G CIoT CT#84 CP-191129 0972 4 B Serving PLMN rate control, general description CT#84 CP-191129 0975 3 B Service Gap control in 5GS, activation with IE and indication flag CT#84 CP-191129 0979 1 B Service Gap control in 5GS, new time value via UCU procedure CT#84 CP-191132 0983 1 F Handling 5GMM cause #5 \"PEI not accepted\" CT#84 CP-191129 0986 3 B General introduction on CIoT 5GS optimizations CT#84 CP-191129 0989 2 B Inter-RAT mobility to and from NB-IoT in 5GS CT#84 CP-191132 0993 2 F Network slicing indication CT#84 CP-191132 0998 5 B UE behaviour upon receiving non-integrity protected NAS reject messages in 5GS CT#84 CP-191132 1018 6 F UE-requested PDU session modification procedure and exemption indication CT#84 CP-191138 1021 4 B Update PDU session establishment procedure to support MA PDU session CT#84 CP-191122 1025 A Correction of timer table CT#84 CP-191129 1030 2 B Strictly periodic registration timer indication for MICO mode CT#84 CP-191132 1039 F Stopping T3519 and deleting SUCI when receiving authentication reject CT#84 CP-191132 1045 1 F Correction on Payload container type information element CT#84 CP-191124 1050 1 A PDU SESSION ESTABLISHMENT message sent via target access in case of handover of an existing PDU session between 3GPP access and non-3GPP access CT#84 CP-191148 1054 4 B Introduction of non-public network CT#84 CP-191133 1059 F Corrections on security context terminologies CT#84 CP-191133 1062 2 F Correction on coding of \"all other values are spare\" CT#84 CP-191133 1067 1 F Clarification related to dual registration mode CT#84 CP-191122 1073 3 A Correction because of wrong implementation of CR0763 and CR0919 CT#84 CP-191137 1078 3 B Introduction of general aspects of wireline access CT#84 CP-191133 1090 1 F Correction on PTI error handling of the network CT#84 CP-191133 1096 2 F Correction on associating default EPS bearer with the default QoS rule CT#84 CP-191133 1105 1 F Security Mode Command procedure when S1 mode supported CT#84 CP-191133 1114 2 F Modification of the maximum number of supported packet filters CT#84 CP-191133 1119 F Clarification of emergency support indications CT#84 CP-191122 1124 1 A 5GSM cause value #29 semantic extension CT#84 CP-191224 1130 4 B User plane CIoT 5GS optimization CT#84 CP-191148 1134 1 B Adding support for unified access control in SNPNs (Stand-alone Non-Public Networks) CT#84 CP-191124 1140 1 A UE policy length mismatch CT#84 CP-191134 1147 1 F Disabling of N1 mode capability after emergency services fallback CT#84 CP-191134 1156 1 F Clarification of \"registration requested\" with no other parameters CT#84 CP-191207 1162 4 F Applicability of the allowed NSSAI in an equivalent PLMN outside the UE's registration area CT#84 CP-191123 1168 1 A IEI for the Non-3GPP NW provided policies IE CT#84 CP-191123 1173 1 A IEI for the UE OS Id IE CT#84 CP-191134 1176 1 F Correction to PDU session authentication result transport procedure.",
    "CT#84 CP-191134 1179 F Clarification for 5GMM cause #3 and #6 in the SERVICE REJECT message CT#84 CP-191122 1185 1 A Always-on PDU session CT#84 CP-191130 1188 1 B MS classmark 2 and supported codec CT#84 CP-191123 1195 1 A DNN based congestion control for PDU session for LADN CT#84 CP-191129 1200 F No CIoT 5GS optimizations for non-3GPP access CT#84 CP-191135 1205 F Correction on UE behaviour in 5GMM-REGISTERED.PLMN- SEARCH CT#84 CP-191129 1210 F Alignment of the Abnormal cases for eDRX between 5GS and EPS CT#84 CP-191129 1213 3 B Uplink NAS message transmission and CIoT data transfer CT#84 CP-191135 1220 2 F Conditions to apply the \"null-scheme\" to generate the SUCI CT#84 CP-191135 1228 3 F Handling of Radio Link failure during service Req proc CT#84 CP-191124 1238 1 A QoS flow for SIP signalling after inter-system change CT#84 CP-191135 1241 F Add codings of 5GSM causes #41 and #42 CT#84 CP-191135 1248 F Non-overlapping tracking areas CT#84 CP-191135 1254 2 F Originating MMTEL voice due to upper layers request while T3346 is running CT#85 CP-192073 1056 5 B Provisioning of an allowed CAG list and a CAG access only indication CT#85 CP-192073 1236 3 B Storage for CAG information CT#85 CP-192060 1271 2 B NSSAI not allowed for MA PDU session establishment CT#85 CP-192059 1276 2 F Management of service area restrictions in wireline access CT#85 CP-192059 1279 1 C Alignment with stage-2 on PEI for 5G-RG and FN-RG CT#85 CP-192056 1282 F Incorrect security algorithm CT#85 CP-192052 1287 1 F Clarification for UE selecting a suitable cell that supports CIoT optimisation CT#85 CP-192060 1293 1 C PDU Session release for MA PDU Session CT#85 CP-192056 1298 F Clarification for T3580 Stop condition CT#85 CP-192045 1306 1 A Maintaining the UL and DL NAS COUNTs after a handover from 5GS to EPS CT#85 CP-192056 1315 1 F Performing registration update upon resume failure for reasons other than barring CT#85 CP-192052 1322 1 B UE behavior when RRC connection resume failst CT#85 CP-192052 1325 1 F Alleviation of SM congestion CT#85 CP-192056 1330 1 F Correction to SM procedures for back off timer not forwarded from 5GMM case.",
    "CT#85 CP-192052 1334 1 F Removal of Editors Note for active timers in the NW CT#85 CP-192056 1337 F Minor miscellaneous corrections CT#85 CP-192056 1344 F Correction to handling of operator-defined access category missing a standardized access category CT#85 CP-192057 1348 1 F IMEI not required for non-3GPP only UEs CT#85 CP-192057 1354 1 F Trigger for NAS procedure retry in case NAS is put back in RRC inactivet CT#85 CP-192069 1357 2 B UE radio capability ID assignment by the network CT#85 CP-192073 1360 1 F Removal of Editor's note on adding unified access control configuration to \"list of subscriber data\" for access to SNPNs CT#85 CP-192073 1364 1 F Update of requirements on UE to construct packet filters based on the N3IWF destination IP address and the SPI for the IPsec SA CT#85 CP-192052 1367 1 B Small data rate control parameters received in EPS CT#85 CP-192052 1371 F No RRC inactive for NB-IoT CT#85 CP-192052 1384 1 F Service gap control timer and MICO mode CT#85 CP-192052 1387 2 C Service gap control, follow-on request indicator at mobility update registration CT#85 CP-192062 1395 3 C Registration reject due to no available allowed S-NSSAI(s) CT#85 CP-192057 1399 F Service reject without integrity protection CT#85 CP-192057 1408 F Collision of deregistration and other NAS procedure CT#85 CP-192057 1412 1 F Initial NAS message protection CT#85 CP-192060 1425 1 F Updates to UE-requested PDU session procedures for converting to MA PDU session CT#85 CP-192057 1435 1 F Corrections to the disabling and re-enabling of N1 mode CT#85 CP-192083 1440 1 B Access control on MO-LR CT#85 CP-192073 1453 2 B Handling of non-integrity protected messages in an SNPN CT#85 CP-192073 1457 1 F Lists of forbidden TAIs in an SNPN CT#85 CP-192057 1461 2 F Alignment on the implication description of type of list = \"11\" in service area list IE CT#85 CP-192054 1474 2 F Update the UE-requested PDU session establishment procedure regarding always-on PDU session for URLLC service CT#86 CP-193094 1233 4 F QoS operation upon activation of dedicated EPS bearer CT#86 CP-193094 1327 4 F Handing of 5GMM parameters during certain mobility registration failurest CT#86 CP-193094 1349 3 F UAC check for services started in WLAN and being transferred to 3GPP access CT#86 CP-193094 1374 2 F EMM parameters handling for 5G ony causes CT#86 CP-193094 1378 3 F 5G NAS security context for interworking CT#86 CP-193094 1401 4 F QoS rule and QoS flow error handling CT#86 CP-193094 1404 1 F Additional 5GS PDU session rejection cause values CT#86 CP-193094 1418 3 F Emergency PDU session establishment upon expiry of timer T3580 CT#86 CP-193095 1432 3 F Correction of 5GMM state for cause #27 \"N1 mode not allowed\" CT#86 CP-193104 1450 5 B Slice-specific authentication and authorization procedure CT#86 CP-193095 1480 7 F Correction to delivery of mapped S-NSSAI(s) CT#86 CP-193095 1493 1 F Removal of update status dependency for sub-state selection CT#86 CP-193095 1496 2 F Receiving deregistration with cause #72 when registered for both 3GPP and Non-3GPP accesst CT#86 CP-193101 1500 2 B MA PDU session release CT#86 CP-193104 1505 6 C Introduction of pending NSSAI for network slice-specific authentication and authorization CT#86 CP-193088 1509 2 F Corrections of service gap controlt CT#86 CP-193118 1512 2 B Extensions of EAP-TLS usage in primary authentication CT#86 CP-193100 1515 1 F Corrections for wireline access service area restrictions CT#86 CP-193089 1518 2 F NAS message container for Control plane service request CT#86 CP-193118 1523 F Corrections on the Port management information container IE CT#86 CP-193089 1529 F Inclusion of the T3324 IE in REGISTRATION ACCEPT CT#86 CP-193113 1539 1 F UE storage of RACS parameters in non-volatile memory CT#86 CP-193095 1543 F Incorrect reference in Authentication subclause CT#86 CP-193095 1546 1 F Corrrection to the notification procedure and collision with UE initiated de-registration CT#86 CP-193104 1549 3 F Registration reject due to no allowed slices and NW slice specific authentication and authorization CT#86 CP-193118 1553 1 F Correction to SNPN enabled terminology.",
    "CT#86 CP-193118 1558 F Handling of the DEREGISTRATION REQUEST message with 5GMM cause value #74 or #75 in a PLMN CT#86 CP-193118 1561 4 F Missing requirement on UE policies for SNPN CT#86 CP-193118 1565 F Correction to name of IE carrying residence time for TSN CT#86 CP-193104 1571 2 F 5GMM Cause #62 CT#86 CP-193088 1577 1 F Applying small data rate control at inter-system change CT#86 CP-193101 1580 1 F Provision of MA PDU session information during the UE-initiated NAS transport procedure initiation CT#86 CP-193089 1585 1 C Resolving Editor's notes on the Data Type field for the Control Plane Service Request message CT#86 CP-193096 1590 1 F Correction to the indication upon receipt of 5GMM cause #91 CT#86 CP-193104 1598 4 B \"S-NSSAI not available in the current PLMN\" when non NSSAA supported UE requesting the S-NSSAI subjects to NSSAA CT#86 CP-193119 1604 7 F CAG only UE and emergency procedure.",
    "CT#86 CP-193106 1619 1 B Release of NAS signalling connection for the UE authorized for V2X communication over PC5 CT#86 CP-193096 1625 2 F Precedence for segregation flow CT#86 CP-193101 1636 D Editorial on PDU session establisment request upgraded to MA PDU session CT#86 CP-193089 1648 1 C Serving PLMN rate control at PDU session modification CT#86 CP-193089 1651 1 F Short MAC and ngKSI in Control plane service request NAS message CT#86 CP-193089 1660 2 F UE behaviour when T3448 timer running CT#86 CP-193096 1663 1 F DNN Replacement CT#86 CP-193096 1666 1 F Corrections and enhancements for T3540 CT#86 CP-193104 1674 1 F No info on S-NSSAI subject to NSSAA in UE CT#86 CP-193096 1681 1 F Registration attempt counter reset by single-registered UE CT#86 CP-193097 1684 1 F Clarification to forbidden PLMN list CT#86 CP-193100 1687 C Removal of Session-TMBRt CT#86 CP-193106 1692 1 B UPDS updates enabling UE-requested V2X policy provisioning procedure CT#86 CP-193106 1697 1 B 5QI 86 introduction CT#86 CP-193115 1700 1 F No retry restriction for 5GSM cause value #39 CT#86 CP-193089 1707 F Timer T3448 CT#86 CP-193088 1711 1 F Correction of the format of CIoT small data container CT#86 CP-193097 1716 F Correction to UE OS ID encoding CT#86 CP-193119 1719 2 F Handling of Service request message in a non-subscribed CAG cell CT#86 CP-193104 1723 2 F Network slice authentication and emergency procedure CT#86 CP-193097 1731 F Inclusion of PDU session reactivation result error cause IE CT#86 CP-193097 1737 1 F Correction to the coding of EPS bearer identity CT#86 CP-193088 1749 2 F Correction on the condition for including CP only indication CT#86 CP-193119 1754 2 F Abnormal cases for 5GMM cause values #74 and #75 CT#86 CP-193119 1758 1 F Maintenance of forbidden TA lists for non-integrity protected NAS reject in an SNPN CT#86 CP-193119 1766 2 F Moving Annex E to TS 24.5xy CT#86 CP-193119 1772 2 F Coding of the CAG-ID CT#86 CP-193097 1775 2 F Correction to PLMN change with 5G-EA0 B CAG information towards the lower layers for paging C Secondary authentication and W-AGF acting on behalf of FN-RG 16.4.0 2020-03 CT#87e CP-200111 1781 3 F Correcting unimplementable condition regarding N26 interworking support detection D Editorial correction of an input parameter for 5G NAS message integrity protection F Handling of unsupported SSC mode F Service Request for PS Data Off D Editorial correction to T3447 timer behavior F Correction on NAS transparent container for 5G-4G interworking F Correction on T3502 for deactivated value F Correction on N26 interface indicator F Inclusion of 5GSM cause in PDU session release request F Correction on NAS COUNT handling for intra-N1 handover F Update bullet index to include all NAS transport cases D Corrections in specifying reasons for errors F Optional IE description for release assistance indication IE F Abnormal case handling for 5GMM cause value #90 along with a PDU SESSION MODIFICATION REQUEST message F Reject non-emergency PDU session request attempt while UE registered for emergency services in the network F Correction to UCU procedure abnormal cases on NW side for a new TAI list D Correcting reference to 5GSM procedures F Cleanups on introduction of pending NSSAI F Resolving editor's note on service area restrictions in case of FN- BRG F PEI clean up F Always-On PDU session and URLLC F Removal of Editor's note on the use of the NOTIFICATION message in SNPNs F Removal of Editor's note on applicability of RACS to SNPNs B Handling of S-NSSAIs in the pending NSSAI F Clarification on HPLMN S-NSSAI F Stop T3565 upon connection resumption B Support for the signalling of the capability for receiving WUS assistance information F Pending NSSAI update for the configured NSSAI in the CUC message F UE behaviour when T3447 running D Name of the rejected NSSAI cause values F Deletion of all CAG-IDs of a CAG cell 5GMM cause for #76 F Definition alignment for UE-DS-TT residence time F AMF behavior on stop T3448 F Correction on term \"non-3GPP access\" used in SNPN D Consistent name for NSSAA F Clarification on Public Network Integrated NPN in TS 24.501 F ATSSS Non-MPTCP traffic support F Stopping of T3513 after connection resume for user plane CIoT 5GS optimization C Recovery from fallback for UEs using CP CIoT optimization F Additional triggers for deletion of pending S-NSSAI F Correction to UL CIoT user data container not routable or not allowed to be routed F Service gap control, correction when to start service gap control timer in UE and NW B Clarification on the use of exception data reporting F AMF updates the UE NSSAI storage after network slice-specific authentication and authorization is completed F Additional conditions to the presence in the subscribed S-NSSAIs 16.4.0 2020-03 CT#87e CP-200130 1998 1 F Triggering mobility registration update due to manual CAG selection F Additional condition to change UE radio capability ID during mobility registration update F N1 mode capability disabling and re-enabling for SNPN F Handling of 5GMM cause values #62 in an SNPN F 5GMM cause value #74 in an SNPN with a globally-unique SNPN identity F Corrections on N5CW support F Corrections on the abnormal cases of registration procedure for initial registration F S-NSSAI in rejected NSSAI for the failed or revoked NSSAA not to be requested F Clarification on use of operator-defined access categories F Paging with two valid 5G-GUTIs F Dual-registration requirements for EHPLMNs B EPS interworking of MA PDU session of 5G-RG when N26 is not supported F Indication of change in the use of enhanced coverage F Correction of certain erroneous Information Element Identifiers F Clarification on DL only match-all packet filer F Pending NSSAI update for the configured NSSAI in the UCU message F AMF triggers PDU session release F Specify UE behaviour for NOTIFICATION message for additional state/sub-states C Adding a new abnormal case on the network side for CPSR F Definition of registered SNPN F update of the counter for SNPN F 5G GUTI of SNPN F Clarification of the cause of start of T3550 D Editorial corrections F RACS parameters in generic UE configuration procedure F Alignment of UE actions of rejected NSSAI for the failed or revoked NSSAA F Missing condition at registration reject due to no available slices F Correct parameters included by AMF during inter-system change from S1 mode to N1 mode in 5GMM-CONNECTED mode F Inclusion of NSSAI in AN Parameters for non-3GPP access D Unify terms network-initiated and network-requested F PDU session release due to CP only revocation F Clarification on the UE behaviour when receiving T3448 F Initial Registration after 5G-SRVCC F Initial registration for initiating emergency PDU session F Correction on terminology for the Control plane CIoT 5GS optimization F NSSAA in an SNPN F Indication that the emergency services fallback attempt failed F NB-IoT not applicable for SNPN F Service area restrictions in an SNPN F UE in the 5GMM-REGISTERED.ATTEMPTING- REGISTRATION-UPDATE substate operating in SNPN access mode F Correction to conditions for including the S-NSSAI(s) from default NSSAI in the requested NSSAI B Ethernet header compression for CP CIoT – 5GMM aspects F NAS-MAC calculation for RRC connection reestablishment for NB-IoT CP optimisation F Non-3GPP access for PLMN and SNPN F Clarification on handling of pending NSSAI F Handling of unallowed SSC mode F Correction to criteria to enter 5GMM-REGISTERED.UPDATE- NEEDED substate after resumption failure F Correction to Handling of #31 F De-registration before initial registration for Emergency Services F UE behaviour when the UE receives the rejected NSSAI for the current RA and does not have a valid RA F Addition of 5GSM cause #59 F Correction on LADN DNN based congestion control F Introduction of ATSSS F Adding AAA-S via NSSAAF to support NSSAA F Default S-NSSAI not subject to network slice-specific authentication and authorization F UE stopping back-off timer when receiving PDU SESSION AUTHENTICATION COMMAND F Avoiding too frequent registration procedures due to signalling of UE radio capability ID F Change of E-UTRAN UE Capability F Clarification of the forbidden PLMN list used for non-3GPP access F Native 5G-GUTI in Additional GUTI IE F Operation of UE in SNPN access mode when timer T3247 expires F Condition under which the UE shall enter 5GMM-IDLE mode when user plane CIoT 5GS optimization is used F Clarification in state transition of 5GMM-DEREGISTERED from another 5GMM state F Clarification on missing subclause in 5GMM- REGISTERED.ATTEMPTING-REGISTRATION-UPDATE D Correction to spelling mistakes F Clarification on S-NSSAI deletion based on the rejected NSSAI due to NSSAA in the roaming case F PDU session release upon receipt of PDU session status IE D Removal of duplicate words F Correction to 5GMM-DEREGISTERED.NORMAL-SERVICE F Support for continuity of emergency session upon registration failure F Additional stop condition for timer T3580 F Service gap control: Exceptions to start of timer T3447 F Provision of CAG information list in SERVICE REJECT message.",
    "16.5.0 2020-06 CT#88e CP-201114 2315 1 F Size of pending NSSAI in REGISTRATION ACCEPT message F AMF not using 5GMM registration status in UE status IE B Ethernet header compression for CP CIoT – 5GSM aspects F Correction of RACS ID deletion via UCU F Clarification on S-NSSAI(s) in URSP(NSSP) be added into the request NSSAI F A default S-NSSAI not subject to NSSAA F IP header compression after inter-system change from S1 mode to N1 mode F Adding a missing case on the UE side for CPSR F Unify terminology for default S-NSSAIs and subscribed S-NSSAIs marked as default F Ciphering initial registration message with NULL algorithm D Editorial change to SNPN F Management for SNPN access mode per access type F PDU session transfer between 3GPP and non-3GPP when CP CIoT 5GS optimization is being used F Maximum length of Unstructured data via the control plane F Clarification of NAS COUNT handling in 5G B N5GC NAS aspects F N5CW device registration and IP assignment F S-NSSAIs always selected by AMF from allowed NSSAI F Disabling of N1 capabilities when all requested S-NSSAIs subjected to NSSAA are rejected due to failure of NSSAA or when no slice is available for UE F Transfer of PDN connection from untrusted non-3GPP access connected to EPC to 5GS F Consistency of the term on rejected NSSAI for the failed or revoked NSSAA F Support of User Plane Integrity Protection for any data rates F NSSAA Slice handling for 1-to-many mapping in roaming scenario F \"MA PDU request\" when the 5G-RG performs inter-system change from S1 mode to N1 mode with an MA PDU session with a PDN connection as a user-plane resource F NAS MAC terminology F Removal of Editor's note on inter PLMN mobility under same AMF F Correction to the 5GS network feature support IE F NSSAA during PDU session modification procedure F Correction on PDU session status IE handling for MA PDU sessions F Handling for SR in 5U2 state F Deleting Editors note regarding to network slice-specific re- authorization and re-authorization F Mapped dedicated EPS bearer without default EPS bearer F Clarification of Rejected NSSAI associated with 5GMM cause #62 F Correction on UE behavior for the rejected NSSAI for the failed or revoked NSSAA and the pending NSSAI when the Allowed NSSAI is received F UE behavior on SNPN access mode when accessing to PLMN services via a SNPN F Corrections on the error check of QoS rules F UE specific DRX value for NB-IoT F Finding a suitable cell in a PLMN where a UE is allowed to access a non-CAG cell F T3245 for a UE operating in SNPN access mode F Delete unimplementable QoS operations in ESM procedure F Infinite De-registration attempt F Clarification of conditions which the rejected NSSAI for the failed or revoked NSSAA is deleted F Minimum length of \"Plain 5GS NAS message\" C Allowed NSSAI assignment based on default subscribed NSSAI F Deleting pending NSSAI when moving to 4G F Correction that service reject is received not service request F Fix of Timer T3448 encoding F Correction of the IEI of UE radio capability ID deletion indication F Clarification on the applicable access type for persistent PDU session D Editorial changes – red text corrected to black text F Selected PDU session type F Dual-registration mode list correction D Abbreviations correction D Several editorial changes D Restructure the statement on establishment cause for non-3GPP access F Handling of 5GSM procedures when fallback is triggered F Exceptions in providing NSSAI to lower layers F UE behaviour for service reject with #15 C Rejected NSSAI due to subscription F Correction on Payload container IE F The suggestion on back-off timer for 5GSM #29 F Clarification on HPLMN S-NSSAI A Alignment of User Plane Integrity Protection description F Correction on UE behaviour after receiving \"Network slicing subscription changed\" indication F AMF behavior upon receipt of NETWORK SLICE-SPECIFIC AUTHENTICATION COMPLETE message F Clarification on the 5GMM procedures which can be initiated by the UE in substate 5GMM-REGISTERED.ATTEMPTING- REGISTRATION-UPDATE D Phrase that the abbreviation PCO represents F Handling of QoS flow description without associated QoS rule F Clarification on the SPRTI bit of the MICO indication IE A Adding a missing \"modification request\" for the Request type IE during NSSAA F Uplink data status IE in CPSR after integrity check failure A Clarifications on Necessity of ATSSS Container IE F Update cases where whether ER-NSSAI IE is used A Excluding the S-NSSAI(s) in the pending NSSAI from the requested NSSAI A Timer value of active timer A EN resolution on 5QI as criteria type for ODAC F Set T3517 to smaller value for emergency services fallback A Correct pending NSSAI handling D Improve \"Emergency PDU session\" definition F Correction on inclusion criteria for IP header compression configuration IE F SNPN access mode over 3GPP access when accessing SNPN services via a PLMN F Correction in the N1 mode capability handling F Correction in the AUSF operation in terms of checking the presence of the AT_RESULT_IND attribute in the EAP- response/AKA'-challenge message F Mobility Registration after back to coverage A PDU session release in CP-SR F Correct reference of SM timer F Clarification on LADN Information update D IE length style in message definition F N5CW device clean up A 5GMM cause value #76 mapped to a different 5GMM cause value in network-initiated de-registration procedure F Addition of 5GSM cause #37 F Delete EBI in the QoS flow description when the corresponding mapped EPS bearer context is deleted A PLMN selection condition upon reception Registration Reject with cause #62 B Notification to upper layer upper layer for MMTEL video call when T3346 or T3525 running F Deregistration before initial registration in SNPN selection A Rapporteur cleanup of editor's notes for 5G_CIoT F Addition of used abbreviations D Consistent usage of acronym UE F Mobility and periodic registration update when the UE receives \"RRC Connection failure\" indication F Default configured NSSAI storage after update by UE Parameters Update via UDM Control Plane Procedure F Correction on the condition of filling allowed NSSAI in registration accept message F The handling of a CAG information list with no entry F Clarify PDU session modification command reject due to QoS- related errors B DNN setting in the 5GSM sublayer F NAS signalling connection release when SAR list is received F Clarification on Selected EPS NAS security algorithms IE F Protection of 5GSM message A AN Release triggered by CAG information Update F Provide different UE IDs for trusted and untrusted non-3GPP access F Correction of UE handlings on 5GSM cause #50 and #51 F PDU session ID in CPSR message F Correction on MICO indication IE A SM/MM coordination for MAPDUs F Checking ACK bit of the SOR container in the DL NAS TRANSPORT F The selected PLMN for emergency services via trusted non- 3GPP access F Delete previously allowed NSSAI upon receipt of \"NSSAA to be performed\" F Local release of PDU session due to Service Area Restriction F Kausf change F Collision of AKMA and NAS AKA procedure handling F Correction of Requested NSSAI handling A Correction for SNPN access mode in non-3GPP access F Handling of Kausf and Kseaf created before EAP-success A Fixing mis-implementation of CR2140 F Correction for NB-N1 mode and maximum number of PDU sessions with active user plane resources F Re-initiation of NSSAA when S-NSSAI rejected for the failed or revoked NSSAA F Clarify UE handling of receiving DL NAS TRANSPORT message with 5GMM cause #28 A Fix location of 5GSM congestion re-attempt indicator IE in PDU session establishment reject message and PDU session modification reject message F Actions on T3247 expiry for other supported RATs F Clarifications to the handling of the stored pending NSSAI F Consistency of the term on rejection cause \"S-NSSAI not available due to the failed or revoked network slice-specific authentication and authorization\" F Correction of storage of operator-defined access categories F Deletion of the duplicated content about new allowed NSSAI storage F Clarification of maintaining 5G-GUTI in an abnormal case F Remove the error case for mandatory IE of PDU SESSION MODIFICATION COMMAND message A T3575 F S-NSSAI association for 5GSM non-congestion control F Correction to the QoS operation error handlings in PDU session establishment procedure F AN Release triggered by CAG information list in Registration Accept message F Clarification on the handling of QoS flow description without associated QoS rule F Error check and handling for match-all packet filter F PLMN Search at Registered State F Disable N1 mode after change to S1 mode for emergency services F 5GSM cause handling in UE-requested PDU session modification procedure F Correction on semantic errors in QoS operations F Correction on UE retry restriction for 5GSM cause #68 F Clarifications on PLMN and SNPN URSP storage - 24.501 part F Clarification on NAS security context alignment on 3GPP access and non-3GPP access F The UE behavior when the UE receives the allowed NSSAI Correction of misimplementation of CR 3091 F DS-TT Ethernet port MAC address only sent when the PDU session type is Ethernet F Clarification on port management information container 3137 1 B SNN verification for SNPN supporting AAA-Server for primary authentication and authorization B Enabling selection of an SNPN other than the subscribed SNPN 3133 3 B \"List of subscriber data\" handling for SNPN supporting AAA- Server for primary authentication and authorization B Support of the default configured NSSAI in the SNPN B Slice handling in registration for SNPN onboarding 3323 1 B PVS information providing in PDU session establishment for onboarding 3194 1 F Indication of UE supporting 3GPP access leg in EPC during MA PDU session establishment procedure B Definitions and abbreviations for Multi-USIM in 5GS 3225 1 B The MUSIM capable UE shall not initiate Service Request procedure for Leaving the network if Emergency service is ongoing in 5GS 3170 2 C Handling of service request when responding to paging with voice service indication F Correction of the definition of the Rejected NSSAI 3123 4 B S-NSSAI rejected due to maximum number of UEs reached and BO timer value B Definition of UAV for purpose of UE NAS B ProSe as a trigger for Service Request procedure B UE ProSe policy transmission F Clarification on handling maximum number of established PDU sessions for MA PDU session F Update cause of start T3540 F Conditions for applying 5G-EA0 for the initial NAS message F Abnormal cases in the PDU session authentication and authorization procedure F Clarification on the setting of packet filter identifier value F Alignment on UE retry restriction for 5GSM causes #50/#51/#57/#58/#61 3193 1 F CIoT, nw initiated re-negotiation of any header compression configuration F Correction in the CAG only UE F Correction to T3540 handling 2961 2 F Handling of collisions between UE-requested 5GSM procedures and N1 NAS signalling connection release F Forbidding registration area when no slice available F Relaxing requirement for NSSAA timing 3175 1 F Add EMM SR procedure for non-integrity protected reject message 3230 1 F Disabling of N1 mode capability after failure in service request procedure triggered due to Emergency Service Fallback F UE handling of S-NSSAI when interworking with ePDG and EPC 3232 1 F AMF handling when none of the DNN's in LADN Indication IE are part of subscribed DNN list D Remove duplicated text about semantic error handling F Storage on counters and keys in 5G AKA F Clarification on UE initialted MA PDU deactivation F Registration attempt counter reset when in SNPN F The list of NSSAI(s) F Non-3GPP access T3540 timer after service procedure F MMTEL Voice and MMTEL Video in non-3GPP D Various editorial corrections F Support of SOR-CMCI B 5QI for satellite access B PDU session establishment for NR satellite access B Encoding of API-based DN-AA B Onboarding in SNPN - initial registration Editorial correction in clause 5.3.19a B Multiple round-trips of AA messages during UUAA-MM B C2 pairing authorization at PDU session modification F UE-DS-TT residence time defined in 3GPP TS 23.501 F Supporting of TSCTSF B Slice handling for SNPN onboarding C No support for eCall over IMS in SNPNs 3390 1 F S-NSSAI not provided when registered for onboarding services in SNPN 3384 1 F NID of SNPN which assigned 5G-GUTI in mobility registration update 3377 1 B Clarification of UE status during registration procedure for onboarding F Corrections in Service Request procedure B NAS leaving to reject RAN paging F Timer handling for MUSIM UEs (for 24.501) B T3540 for MUSIM B Clarification of the UCU procedure upon completion of NSSAA B AMF handling on NSAC based on EAC mode F Removal of unnecessary ENs 3515 1 B Clarification of mobility management based NSAC for roaming case F Update the description of NSAC about SNPN 3510 1 F Handling of a reject message including 5GMM cause value #78 without integrity protection F Consistent term on USS communication B UAV registered as normal UE 3520 1 F Clarification on UE behavior after Registration reject with UAV service is not allowed 3486 - F Add the missing description on ProSe under avoiding double barring 3420 1 F Resuming a connection due to ProSe discovery/communication over PC5 3399 1 B Network-requested PDU session modification procedure to be used for removing joined UE from MBS session(s) B Multicast join procedure - Alt.1 F Sending P-CSCF address(es) 3423 - F Add handling of 5GMM cause #76 when UE does not have any stored CAG information list 3452 - F Resolving the Editor's note in AKMA procedure related to K_AUSF change after 5G AKA based primary authentication F Handling of multiple S-TAGs in the Ethernet header D Editorial corrections F Correction to #62 handling 3422 - F Fix inconsistent QoS handling for network-requested PDU session modification procedure F 5GSM state transition of MA PDU session 3502 1 F Processing Authentication Reject only if timer T3516 or T3520 is running F Align deregistration #62 with initial registration reject D Remove duplicated MCC F Not start T3540 if 5GMM cause is considered as abnormal cases 17.4.0 2021-09 CT#93e CP-212154 3531 1 F Include UE radio capability ID deletion indication IE and UE radio capability ID IE simultaneously F Clarification of PF for Ethernet PDU session F 3554 1 F Correction on indication of support of local address in TFT in S1 mode 3493 1 F Discarding the content of the container for SOR when the security check about the container is failed.",
    "3449 1 F Resuming the RRC connection upon requesting resources for V2X communication over PC5 F Correction of PCO related terminology F Registered for emergency services due to CAG restrictions 3279 1 F Handling of N1 mode capability for non-3GPP access for voice domain selection Editorial corrections and IEIs values added in tables 8.3.1.1.1, 8.3.2.1.1, 8.3.7.1.1 and 8.3.9.1.1 3780 2 F Access attempt of 5GMM CM management procedure without ongoing 5G-MO-LR 3796 1 F PTI assignment in MANAGE UE POLICY COMMAND triggered by UE POLICY PROVISIONING REQUEST B Add requirements to support NR RedCap devices F DNS server security information UE capability D Minor corrections F UE handling upon receipt of 5GSM cause #33 3755 - F UE re-initiate initial registration procedure if authentication procedure is failed F Clarification on destination and source MAC address range B CP SoR in SNPN - procedures and coding F SMF selection for SNPN onboarding F an indication registered for SNPN onboarding 3675 4 F Kausf generation when AAA server of CH is EAP server of EAP based primary authentication and key agreement procedure F Secondary authentication/authorization by a DN-AAA server B Reject RAN paging with optional paging restrictions 3619 1 F Service request procedure due to MUSIM when no allowed NSSAI is available B 5GS MUSIM SR transmission failure F T3447 handling for MUSIM capable UE C Remove paging restrictions in case of service area restrictions 3809 1 B Network to accept or reject the paging restriction requested by MUSIM capable UE in 5GS F Clarification of the timer T3526 F Skip NSAC for existing PDU session request type F AMF handling of NSAC function for legacy UE.",
    "3692 1 F Correction of the rejected NSSAI for the maximum number of UEs reached handling F Clarification on SMF performing NSAC for an MA PDU session B Common IE for C2 authorization F Miscellaneous corrections on Service-level-AA container IE B C2 aviation payload F Restriction to non3gpp access B SM request while UUAA-SM is ongoing 3790 1 B Collision between UUAA-SM and UE requested PDU session release 3616 1 F NAS signalling recovery from fallback when the UE was only performing ProSe PC5 procedures 3775 1 B IPv6 prefix delegation via DHCPv6 for 5G ProSe layer-3 UE-to- network relay 3812 - F Correcting the reference of the spec in which the UE requests the PCF to provide ProSeP 3729 1 F Clarification on when a 5GSM procedure can be initiated for LADN 3734 1 F Collision handling of UE-requested PDU session establishment procedure and network-requested PDU session modification procedure F UE behaviour on #29 related back-off timer F Reservation of a bit in an entry of the CAG information list IE D Editorial corrections in TS 24.501 3412 3 F The solution to the case the allowed CAG IDs of a PLMN beyond the limit of one Entry-1 3737 1 F Delete the PCO parameters after handover between 3GPP and non-3GPP access B Derived QoS for UDP encapsulated IPsec packets F S-NSSAI with non-standard values F ECS configuration information provisioning corrections B Introducing MBS back-off timer for MBS join rejection 3777 1 F Correction to type of MBS session ID source specific IP multicast address 3818 - B Removing joined UE from MBS sessions at inter-system change from N1 mode to S1 mode B Provisioning of parameters for disaster roaming in the UE F Correction of implementation errors of CR3512 (C1-215139) 3742 - B Unnecessary signalling for providing selected EPS NAS security algorithms to disaster roaming UEs F SOR-CMCI storage B Validity of cause code #78 C Clarification of UE location verification in registration procedure F Paging restrictions with Connection Release in 5GS B MUSIM support for SNPN access mode B UAS security information obtained during UUAA A RID update for SNPN UEs F Clarification on lists of forbidden SNPNs in an ON-SNPN 3874 - F Handling of non-integrity protected reject messages with 5GMM cause value #3, #6, or #7 in an ON-SNPN F Correction in 5GMM cause value #93 handling F NID IE inclusion condition F NSAC for S-NSSAI used for onboarding services in SNPN 3986 - F Providing PVS information for obtaining credentials for NSSAA or PDU session authentication and authorization procedure in SNPN 3843 2 B Usage of indication to use MSK for derivation of KAUSF after success of primary authentication and key agreement procedure 3988 1 B Providing PVS addresses for obtaining SO-SNPN credentials when registered for non-onboarding services in SNPN 4048 1 F Clarification of the UE behavior for the pending NSSAI for the current SNPN 3861 1 F Clarification on maximum number of PDU sessions has been reached F Clarification on QoS rules merge for MA PDU session F N1 NAS signalling connection release reformulation F The interaction of AS-NAS layer on RAN paging C PTCC handling during emergency registration F Clarification on Paging cause F Correction of T3447 handling for Multi-USIM UE F Uplink data status IE not included when requesting release 3536 2 F Rejected NSSAI for the maximum number of UE reached with different PLMNs in RA F Clarification on NSAC for emergency and priority services F Provide all subscribed S-NSSAIs in configured NSSAI 3906 1 F Access type for rejected NSSAI for the maximum number of UEs reached F NSAC applicable for SNPN F NSSRG feature applicable to SNPN 3792 5 B PDU session establishment with the DNN/S-NSSAI for UAS service from the UE whch has valid aerial subscription but UUAA- MM is failed abnormally 3889 1 F Clarification on PDU session establishment for valid subscription of DNN/S-NSSAI F Remove resolved ENs C The handling of 5GMM#79 F Clarification for revocation of C2 authorization F Correction on service-level-AA response bit name 3956 - F Corrections for Service Request procedure when requesting 5G ProSe resources is the trigger for the procedure 3967 - F DNN as an optional parameter for emergency PDU session when interworking with EPS F Lost text in 6.4.1.2 F Correction to 5GSM capability IE D Editorial correction of 5GS network support F Correction of eDRX handling in 5GS F Correction to the MBS back-off timer F Correction on #62 4034 1 F Starting T3540 only considers Service Request message but not the CPSR Message 4093 - F No modification operation permitted in ACTIVATE BEARER CONTEXT REQUEST message 4107 - F Clarification on SM_RetryAtRATChange values configured in both ME and USIM F Indication of pending PDU session for NAS recovery F The handling of eDRX in the AMF D Service request for redirecting CIoT UEs to EPC 4091 2 F Indicate change of PS data off UE status outside of LADN service area 4096 1 F Protect emergency PDU session when receiving #28 in the service reject message F Authorized QoS flow provided by network 4124 1 C The solution to CAG IDs of a PLMN beyond the limit of one Entry- IE part B EDC related PCO parameters usage B Update for multicast session release B UE handling of MBS back-off timer B Using separate QoS flows dedicated for multicast 3953 2 F Including the reason of removing a joined UE from an MBS session by the network F MCC and MNC coding in Received MBS container IE 4035 1 F UE locally leaves the MBS sessions locally when the PDU session is released locally F MBS inapplicability over non-3GPP access B PDU session associating with PDU session pair ID and RSN B AMF behaviors during the registration for disaster roaming 4101 - F Correction to disaster return wait range in Service reject message.",
    "F Clarifications on wait timer 3909 1 F Mismatch for MO SMS over NAS or MO SMSoIP service type criterion between TS23.122 and TS24.501 F De-registration handling due to Tsor-cm timer expiry 3974 - F Remove Editor's Note in TS24.501 about RAN work on UPIP support for EPC C Taking GNSS fix time into account in UE NAS layer F Handling of PDU session modification not forwarded due to #78 F Paging subgroup during emergency call CT#96 CP-221189 4139 4 F Anonymous SUCI usage CT#96 CP-221343 4327 3 F UE enter in substate NO-SUPI CT#96 CP-221202 4295 1 B Support NSAG in 5GMM capability CT#96 CP-221203 4261 1 F list of configuration data CT#96 CP-221203 4267 1 F AMF onboarding configuration data clean up CT#96 CP-221203 4286 D Editorial change : onboarding indicator CT#96 CP-221203 4369 - F Correction for the note about the UE policy sections stored for PLMNs or SNPNs CT#96 CP-221203 4422 1 F Storage of SNPN Forbidden List Across Power Cycle CT#96 CP-221204 4162 - F Correction on session-AMBR for MA PDU session CT#96 CP-221205 4140 - F Completing terminology clean up in 5GS CT#96 CP-221205 4160 1 F PEI handling for the MUSIM UE CT#96 CP-221205 4374 2 F UE no longer a MUSIM UE CT#96 CP-221206 4182 1 F Clarification on NSAC for SNPN onboarding CT#96 CP-221206 4185 - F Clarification on update of pending NSSAI if UE receives rejected NSSAI CT#96 CP-221206 4204 - F The S-NSSAIs in an NSSAI associated with one or more common NSSRG values CT#96 CP-221206 4241 1 F EAC mode is activated when the number of UEs associated with S-NSSAI reaches a certain threshold CT#96 CP-221206 4335 1 F Correcton on NSSRG information CT#96 CP-221206 4382 - F Incorrect statement subscribed S-NSSAI(s) marked as default subject to NSAC CT#96 CP-221208 4168 - F Correction to the Service-level-AA container IEI value CT#96 CP-221208 4175 1 F USS FQDN as service-level-AA server address CT#96 CP-221208 4179 - F Retry restriction for 5GSM cause #86 CT#96 CP-221208 4192 1 F Correction of the condition when the network initiates de- registration CT#96 CP-221208 4387 1 F Clarification on service level AA procedure for NI PDU modification CT#96 CP-221209 4316 1 F Interaction between 5GSM entity and upper layers with respect to the ProSeP CT#96 CP-221209 4360 - F Invalid PDU session identity in Remote UE Report message CT#96 CP-221211 4280 - F Correction on UE 5GMM state for 5GMM cause #76 CT#96 CP-221211 4289 - F Correction to PDU session type CT#96 CP-221211 4269 - F Skipping access control checking for NAS signalling connection recovery after IRAT change from LTE to NR CT#96 CP-221211 4325 - F Removing the obsolete description of C1-211443 CT#96 CP-221211 4341 - F Coordination between 5GMM and EMM state CT#96 CP-221211 4356 - F Storing Allowed NSSAIs for EPLMNs during registration CT#96 CP-221211 4378 - F Start T3540 when non-switch-off de-registration procedure complete CT#96 CP-221211 4259 1 F Correction of duplicated info in the Generic UE Configuration Update procedure CT#96 CP-221212 4300 1 F Note on the default configured NSSAI CT#96 CP-221212 4321 1 F Scenarios to stop T3526 CT#96 CP-221212 4329 1 F Perform eCall inactivity procedure in 5GMM-REGISTERED.NON- ALLOWED-SERVICE substate CT#96 CP-221212 4347 1 F Correction on the IE coding CT#96 CP-221212 4414 1 F Length information correction of 5GS update type IE CT#96 CP-221212 4359 1 F Deleting PEIPS assistance information on Registration procedure failure CT#96 CP-221213 4309 1 F Network slicing features applicable in SNPN CT#96 CP-221213 4326 1 F Clarification on UE action for not forwarded 5GSM message CT#96 CP-221213 4350 1 F The handling of establishing an emergency PDU session after WUS negotiation in 5GS CT#96 CP-221213 4380 1 F Handling of multiple TAGs in the Ethernet header for signalled and derived QoS rules CT#96 CP-221213 4392 1 F Clarification of UE configuration parameter updates CT#96 CP-221213 4395 1 D Editorial corrections CT#96 CP-221214 4431 1 B Support of provisioning ECS configuration info per ECSP CT#96 CP-221218 4225 1 F Updating the MBS service area of MBS multicast session using MBS Service Announcement CT#96 CP-221218 4228 1 F Applicability of security protection for MBS session CT#96 CP-221218 4270 1 F Maximum number of associated MBS sessions CT#96 CP-221218 4406 1 F Removing the EN related to the maximum lengths of the Received MBS container IE CT#96 CP-221219 4149 1 F Cause code for MINT CT#96 CP-221219 4223 1 F Clarification on DREI.",
    "CT#96 CP-221219 4265 1 F Editor's notes in subclause 5.4.4.1 and subclause 5.4.4.2 CT#96 CP-221219 4384 1 F Storage of List of PLMNs to be used in disaster condition to NVM 17.7.0 2022-06 CT#96 CP-221219 4411 - F Resolution of editors note for registration type CT#96 CP-221223 4362 1 B SDT support 2022-06 CT#96 CP-221224 3588 11 B Multiple TACs from the lower layers CT#96 CP-221224 4165 1 B Definition of last visited registered TAI for 5GSat CT#96 CP-221224 4272 - B Addition of lower bound IEs for #78, alt 2 CT#96 CP-221224 4372 1 F Clarification on emergency service intiation via the PLMN which is not allowed to operate at the present UE location CT#96 CP-221224 3976 7 C Forbidden TAI handling in case of multiple TACs CT#96 CP-221242 4221 1 F UE-requested PDU session establishment procedure based on ProSeP CT#96 CP-221249 4137 1 F Editor's note in subclause 5.5.1.3.4 CT#96 CP-221249 4186 1 F Support of mapped S-NSSAI in SNPN CT#96 CP-221249 4203 2 F Clarification of ProSe support in NPN CT#96 CP-221256 4145 1 F UCU for MPS CT#96 Some IEI values assigned by the rapporteur of the TS F Precedence between PVS addresses or PVS names F PVS information in SMF 4636 1 F Storage and access of 5GMM parameters mapping with SUPI from USIM for AKA based SNPN F Rejection of paging correction F Provide new NSSRG information to UE F Service-level-AA timer name correction F Use the term 5G ProSe C Remove secondary authentication for U2N relay 4553 1 F Providing HPLMN ID together with PRUK ID in 64-bit string format B Introducing the 5GPRUK ID in the Relay key Request procedure 4501 1 C New 5QI values to support Advance Interactive Services (AIS) in 5G F Clarification on indicating the EDC support to network 4582 1 F MBS session maintenance when releasing user-plane resources of a MA PDU session F MBS session maintenance after handover 4609 - F Correction for the condition of including the Security container in the Received MBS container IE F Errors in PLMN ID IE 4450 1 F Clarification that the NSAG information can not be sent with a request to perform the registration procedure F Support NSAG for SNPN F The consideration of avoiding unnecessary TAI change F Suggest simplifying the selection for the current TAI F Clarification on handling related to #78 F MPS exemption in Attempting to Register F Check the match-all packet filter in QoS rule 4463 1 F Add back off timer handling for rejected nssai for max UE reached for MT Deregistration procedure with cause #62.",
    "4551 1 F Clarification of interworking between N1 mode over non-3GPP access and ePDG F Registration attempt counter reset for successful TAU F Handling the DRX parameter on the AMF side F Handling when FPLMN is declared allowable PLMN by network D Editorial corrections to TS 24.501 F Clarification of 5GS registration result value handling F Storage of NSSAI for EPLMNs in updated registration area 4531 1 F UE behavior after receiving registration requested in CUC message 4574 1 F Corrections related to cause value #78 PLMN not allowed to operate at the present UE location F Covering a missing semantic errors in QoS operations 4612 1 F Corrections for UE behaviour upon receiving CONFIGURATION UPDATE COMMAND message that indicates registration requested Editorial correction done by MCC F Using UE local configuration for default DNN and S-NSSAI A Editor's note in subclause 5.3.2 A Correction to PDU session types F Clarification on packet filter in signalled QoS rule F Correction to default NSSAI inclusion mode F Abnormal case handling D Editorial Corrections A NSAG priority handling at the AMF F Correction on identical QRIs semantic errors in QoS operations F Update the description on the subscribed SNPN F Correction on semantic error about UL PF of TFT 4706 1 A Registration update triggered by NSSRG update in UCU procedure A NSAG information provision over 3GPP access only 4715 1 F Condition of including equivalent PLMNs in Registration Accept message A Correction on USS FQDN 4726 1 F Clarification on initiating registration procedure when timer T3512 expires F Alignment of the abbreviation NITZ A Correction on handling of the MBS multicast session F Correction on WUS handling in 5GS F NSSAA and SR procedure collision handling A Mapped S-NSSAI when UE is roaming F Clarification on the S-NSSAIs included in the rejected NSSAI of the REGISTRATION REJECT message A Including TCP/UDP port ranges in REMOTE UE REPORT F Addition of missing maximum size for Default configured NSSAI F Adding ANDSP to abbreviations A Paging rejection in RRC inactive A Indicate to lower layer to delete stored TMGI R18 F 5GC MPS exemption for non-congestion back-off A Allowed access attempts while timer precluding registration is running in 24.501 B Equivalent SNPNs usage for mobility 4839 2 B Equivalent SNPNs usage in 5GMM-CONNECTED mode with RRC inactive indication F Issues in slicing and SNPN F Corrections and clarifications for the case when T3502 is “Zero” A UE behaviour on Forbidden TAIs list IEs F Correction on session-AMBR handling F The handling on high priority access in SNPN F QoS flow description correction B Support for Unavailability Period F Missing registration updates for emergency service fallback in 5GMM-REGISTERED.ATTEMPTING-REGISTRATION-UPDATE.",
    "A TAI lists restriction for NSAG information 4889 1 A Modify network handling of PDU sessions for emergency request in abnormal case 4894 1 F Correction to MA PDU session status when user plane resources are establishing F Deleting NSSRG Information 4910 3 A Handling of pending NSSAI in NSSRG procedure Rel18 - option F S-NSSAI added to configured NSSAI only if there is less than 16 entries F Clarification on derived QoS Rules for an IPv6 UDP encapsulated ESP packet F Correction on format of Extended rejected NSSAI A Multicast MBS session join or leave for local multicast service A Maximum length of NSSRG information IE 4964 1 B Indicating the capability of supporting SDNAEPC during the PDU session establishment procedure A Correction of IEI values 032022- CT#99 CP-230265 4978 - B Enhanced CAG selection - enforcement in unsuccessful cases CT#99 CP-230217 5021 - F Correction to the coding of N3IWF address IE CT#99 CP-230219 5027 - B Equivalent SNPNs: NSSAIs, network-assigned UE radio capability ID, maximum number of established PDU sessions and 5GMM parameters in annex C stored per selected entry CT#99 CP-230215 5041 - F Clarification on PDU session type in PDU session establishment request CT#99 CP-230285 5075 - F NSAC applicability in SNPN CT#99 CP-230219 5085 - F Correction on the equivalent SNPNs usage for congestion control 18.2.0 2023-03 CT#99 CP-230214 5090 - A Correction of incomplete implementation of CR4380 (C1-224129) 18.2.0 2023-03 CT#99 CP-230250 5103 - F Abnormal case handling for registration procedure due to Unavailability period duaration CT#99 CP-230285 F Store the rejected NSSAI for failed or revoked NSSAA associated with EPLMN CT#99 CP-230219 5026 1 B Equivalent SNPNs: forbidden SNPNs in TS 24.501 CT#99 CP-230307 5073 1 A Clarification on NSAG information validity when TAI list is absent 18.2.0 2023-03 CT#99 CP-230214 4993 1 A 5GMM IEI Duplicated in Registration Accept CT#99 CP-230307 5164 2 A Correction of misimplementation of CR 4883, 4665, and 4678 (Rel 18) CT#99 CP-230215 4991 2 F Clarification on UE policy part contents CT#99 CP-230214 5010 2 F No PDU session release for non-current access CT#99 CP-230278 4985 1 B Equivalent SNPNs: MPS and MCS indicators CT#99 CP-230278 4981 1 B Equivalent SNPNs: service area restrictions CT#99 CP-230218 4944 3 B Support for UE accessing SNPN services using non-3GPP access CT#99 CP-230217 5123 1 B Introducing the TNAN information IE CT#99 CP-230250 5053 1 B Handling UE NAS timers in duration of unavailability period CT#99 CP-230262 5081 1 B Introduction of general aspects of PIN CT#99 CP-230257 5003 1 B Update UE handling of the MA PDU session CT#99 CP-230260 5013 1 B 5GSM procedure updates for LADN per DNN & S-NSSAI CT#99 CP-230215 5031 1 B Protocol error handling enhancements for Type 6 IE container IEs 18.2.0 2023-03 CT#99 CP-230215 5047 1 F Extended CAG information list in CONFIGURATION UPDATE COMMAND CT#99 CP-230285 5093 1 F Clarification on remote UE ID CT#99 CP-230220 5049 1 F MBS handling in abnormal and PDU session rejection cases CT#99 CP-230258 5071 1 B Support of network slice replacement during UCU procedure CT#99 CP-230219 5029 1 B Equivalent SNPNs: last visited TAI CT#99 CP-230285 5019 1 F Correction to NSAG CT#99 CP-230232 4910 6 F Handling of pending NSSAI in NSSRG procedure-option 1 CT#99 CP-230219 5118 4 F Save NID value of registered SNPN in NV memory.",
    "CT#99 CP-230254 5056 2 B Indication of support for reconnection to the network due to RAN timing synchronization status change via the 5GMM capability IE CT#99 CP-230219 5097 3 B Equivalent SNPN information provided to lower layers for cell reselection CT#99 CP-230219 5036 3 B CH controlled prioritized list of preferred SNPNs and GINs for access for localized services in SNPN F Inconsistent description of UE policy section management list IE B Transmission of A2X Policy F Correcting few errors in UE handing of QoS rules F Correction of Paging Subgroup ID value F Correction to handling of FTAI list on receiving #62 5313 - B UE to indicate the capability of supporting non-3GPP access path switching 5250 1 B AMF should not release NAS signalling after Registration procedure if the UE is authorized A2X 5176 1 B Mobility management for the support of optimised handling of temporarily available network slices F Support of PRUs in NAS transport procedure B Capability indication to support of network slice usage control F Correction to LADN restriction for UE to create PDU session B Authorization of A2X Direct C2 Communications in 5GS 5149 3 F Add the definition of satellite NG-RAN cell and non-satellite NG- RAN cell F Clarify AMF behaviour when S-NSSAI to be replaced is available 18.3.0 2023-06 CT#100 CP-231216 5183 1 F Send 5GMM cause #62 during NW-initiated de-registration procedure F Condition for mobility registration update in SNPN F Correction in references of non-3GPP access for SNPNs 5288 2 F Clarification on handling of received T3502 in registration accept message 5172 1 F Emergency service handling when low layer failure and NW initiated deregistration F Correction to Extended LADN information F Removal of redundant description of NID coding in SNPN list IE 5322 1 F Correction related to receiving N3IWF identifier IE in the REGISTRATION REJECT 5248 2 B Supoort of network slice replacement during PDU session modification procedure 5310 1 F Restriction in the requested NSSAI creation if an S-NSSAI is temporarily unavailable B Storing validity time B S-NSSAI location availability information via UCU D Editorial corrections to the ECS address clause B LADN per DNN & S-NSSAI handling for legacy UE F Partially allowed NSSAI for RFSP derivation F Correction on onboarding in SNPN supporting localized services F UE-ID based Paging Early Indication 5355 1 F Interaction between a 5GSM entity and upper layers for URSP handling B UL/DL NAS transport updates for user plane positioning B UE reporting of URSP rule enforcement in TS 24.501 B Handling of forbidden SNPN lists for localized services 5203 3 B CH controlled prioritized list of preferred SNPNs and GINs for access for localized services in SNPN 5430 1 B Clarification about the condition of the PCF initiating the Network- requested UE policy management procedure B Support of AUN3/NAUN3 device behind 5G-RG 5375 1 F Clarification on alternative S-NSSAI being part of the subscribed S-NSSAIs F Deleting Alternative NSSAI 5425 1 B The condition that the UE does not trigger a service request procedure B Enhancement on partial network slice storage F Adding inclusion criteria for newly added IE B 5GMM state for unavailability period B The partially allowed NSSAI - registration procedures B Partial rejected NSSAI to registration procedure 5214 3 B Inclusion of Extended LADN information IE in REGISTRATION ACCEPT message 5449 1 B PDU session IDs not included in Uplink data status IE during non- 3GPP access path switching F Correction on UE handling of NAS security context F Clarification of T3540 and CAG cell 5420 1 F QoS rule handling for a GBR QoS flow during modification procedure 5358 3 B Authorization of A2X direct C2 communication during registration in 5GS 5345 1 F Correction of the deletion of mapped S-NSSAIs for the rejected NSSAI B The partial network slice feature - general introduction 5451 1 F Additional NAS handling for SNPN related to timers T3584 T3585 & SM level rejection causes #50 and #51.",
    "5207 6 B UE configuration update when supporting the partial network slice support 5448 2 A Sending registration complete message for PEIPS information acknowledgment.",
    "F NSSAI in Requested mapped NSSAI IE Share NSSRG value Clashes and other editorials addressed B Handling on UE requested UPP not authorized by network F Correction to clause reference to the Non-3GPP delay budget IE 5561 - F Condition on providing S-NSSAI time validity information to supporting UE F General cleanup regarding partial network slice F Clarification on the usage of WUS F Clarification in the Delete existing EPS bearer operation F Forbidden SNPN list for localized services for 3GPP access only F Default NSSAI inclusion mode pre-configuration F Clarification of the use of counters regarding SNPN B MBSR authorization update B Requirements for supporting AUN3 devices connected to 5G-RG 18.4.0 2023-09 CT#101 CP-232266 5645 1 B Impact on registration procedure for authenticating AUN3 device behind 5G-RG 5533 1 F Correction to the CONFIGURATION UPDATE COMMAND message content F Include N3QAI in PDU session establishment procedure F PDU session re-establishment on the alternative S-NSSAI C PDU session establishment from non-supporting UE outside AoS 18.4.0 2023-09 CT#101 CP-232187 5519 1 F Correction on S-NSSAI location validity information 5594 1 B 5GSM operation for a UE with S-NSSAI location validity information F Correction on Partial NSSAI IE coding F Clarification on partially allowed NSSAI and NSAC 5529 1 F Correction to the condition of RAN timing synchronization status change B Clarification to storage of NAS context 5623 1 B Clarification to the trigger of mobility registration due to unavailability F Correction on the Received MBS container IE 5696 1 F Update the terminology of user plane positioning connection management information 5659 2 F Path switching while using old n3 for at least one PDU session supporting path switching A Handling of un-authorized IAB UEs F Equivalent SNPNs: congestion control corrections B Identification of PRU related to forwarded LCS messages 5549 3 B UE unavailability period reporting overrides mobility management congestion control F Release PDU session to share NSSRG value F Cleanup on N5CW device supporting 3GPP access 5682 3 B Time validity information and location assistance information in SOR transport container F Use the null scheme if USIM is valid F Optional support of network slice related features 5672 1 F Clarification on abnormal case handling when PEIPS information is negotiatied F Correction to the Payload container IE F NAS procdure collision with Validity information becomes not met 18.4.0 2023-09 CT#101 CP-232188 5443 4 F NAS message handling in case of transmission failure for UE supporting partial network slice 5493 1 F Clarification of handling of the slice deregistration inactivity timer in a case of MA PDU session 5517 1 F Correction to starting T3540 timer 5738 - F Correction to ranging and sidelink positioning capability F Alternative NSSAI update during UCU and registration procedure 18.5.0 2023-12 CT#102 CP-233166 5809 F URSP rule enforcement indication corrections 5666 1 F Correction on starting timer T3540 if indicate re-registration required F Clarify on Discontinuous Coverage Support negotiation 5810 1 B Updating the name for maximum time offset for unavailability period F Correction on term name of UPP information container CP-233166 5706 1 F Received VPS URSP configuration when UE has no stored VPS URSP configuration C Forbidden Area for AUN3 device behind 5G-RG F NS-AoS of alternative S-NSSAI F Control plane user data when the UE is outside NS-AoS CP-233164 5749 1 F Correction to the CONFIGURATION UPDATE COMMAND message 5756 1 F Missing consideration of partially allowed NSSAI for handover of a session from non-3gpp to 3gpp 5779 1 F Addition of SNPNs for localized service in SNPN along with GINs in forbidden lists F Extended LADN information deletion when enter deregistered F Clarification of the UE behavior disabling N1 mode capability 5489 2 F Access check of IMS registration during an ongoing IMS voice or video call 5814 1 B Deactivate MICO mode at the broadcast start time/activation times of a broadcast MBS session F 5GMM context storage when emergency attached 5639 4 B Update to discontinuous coverage overload control for mobility registration update 5812 2 B Impact on NAS signalling for supporting authentication of AUN3 devices supporting and not supporting 5G key hierarchy 5774 2 F Correction on handling of PDU sessions that are not requested to be moved to the new non-3GPP access F PDU session release collision 5772 3 B Support of network slice usage control during the registration procedure B Remote UE identified by PEI F Clarification on service request for ranging B Adding the A2X capability F Handling of emergency services request when auth rejected F Correction to the condition for stopping timer T3584 and T3585 5837 1 F Clarification for the PDU session status IE in NOTIFICATION RESPONSE message F Corrections in storage of Extended Rejected NSSAI B WLANSP from RSNPN F Clarification of LADN service area 5932 - B Protecting the N3IWF/TNGF identifier information in the REGISTRATION REJECT message F Selection of an S-NSSAI by the AMF F Correction to SOR for Signal level enhanced network selection 5959 1 F Clarification on support for unavailability period in non-3GPP accss F 5GMM sub-state handling for localized services in SNPN 5934 1 F Clarification for NAUN3 device connecting to 5GC via 5G-RG that is connected to NG-RAN B General introduction on support of network slice usage control F Partially rejected NSSAI for RFSP derivation F Releasing PDU sessions for temporarily available network slices B The end of unavailability period report handling 5935 2 F Corrections related to ATSSS steering functionalities and their usage (TS 24.501) D Editorial corrections for NOTEs F Clarification of MPS validity 5906 1 F List of networks where the N1 mode capability was disabled upon receipt of 5GMM cause #62 5856 1 F Correction due to PLMN Search state is not applicable to non- 3GPP access A Correction of definition and handling of HPLMN S-NSSAIs F Clarification on 5GMM context B On-demand NSSAI storage 5957 2 F Minor corrections of ambiguous texts in clause related to unavailability period 5863 2 F UE behaviour in case of RRC Connection failure and fallback indication from lower layers F Clarification on UE stored slice usage control information F Correction to forbidden TAI handling for reject cause #62 5942 2 B UE behaviour of slice deregistration inactivity timer regarding MA PDU session in PDU session establishment procedure F Clarificaiton on storage of NSAG information 5927 3 F Clarification on the unavalability period in deregistration procedure F Correction on the definition of UPP-CMI 5993 - F UE capability indication to the network for network verified UE location support 6017 - F Corrections on coding description of the Service-level-AA container F Correction to an unnecessary sentence F Correction on the PLMN code F Performing both UUAA-MM and UUAA-SM F Correction to encoding of unavailability configuration 6079 1 B Removal of replaced slice from allowed NSSAI due to being out of NS-AoS F Downlink data handling when UE location is unknown F Condition for inclusion of partially allowed NSSAI 6056 1 F Clarifies when the slice deregistration inactivity timer starts when it is updated.",
    "F Correction to the term unavailability duration F UE handling of SOR-SNPN-SI-LS B Connection Capabilities in N1 SM container F Clarification on the periodic registration update timer 6009 1 F Storing NAS security context due to registering to different PLMN in the same access F Missing clause for KAMF derivation for SNPN 6050 1 F DL NAS TRANSPORT message with N1 SM information and undefined cause value 6101 1 F Provision of NSAG information to lower layers for SR for UL signalling F Modification on naming of ranging and sidelink capability 6022 1 F Clarfication on the MRU procedure for on-demand S-NSSAI(s) registration 6105 1 F Clarification on maximum number of S-NSSAI in requested NSSAI F Deleting Partially Allowed and Partially Rejected NSSAI F 5GMM handling when receiving cause 80 F UAC and network-requested PDU session modification procedure 18.6.0 2024-03 CT#103 CP-240106 6034 2 F Correction on NSUC bit in the 5GMM capability IE F Further clarification on the handle of changed TAI case 5978 3 F S-NSSAI time validity expiry for last allowed S-NSSAI, alternative 6108 3 F Clarification on inter-system change for UE registered for emergency services F Re-enable N1 mode for SNPN on validity condition met B Slice replacement back to the replaced S-NSSAI F Correction on support for unavailability period 6018 2 F Correction of the conditions for initiating a de-registration in 5GMM-REGISTERED.ATTEMPTING-TO-UPDATE and 5GMM- REGISTERED.UPDATE-NEEDED F Clarifications on Network slice replacement F Reset counter when activating unavailability period F Correction to timers handling in unavailability period 6142 - F Corrections to incorrect agreed CR5983 not noticed till CR implementation 6158 - F Congestion handling for SNPN providing access for localized services in SNPN F Term consistency for replaced S-NSSAI F Correction for the Start of the unavailability period 6147 1 F Correction to the CONFIGURATION UPDATE COMMAND message 6217 1 F Correction on the parameter name in the S-NSSAI time validity information IE 6153 1 F SOR-SNPN-SI and SOR-SNPN-SI-SL indicators set in UL NAS transport 6192 1 F Definitions and abbreviations for NAUN3 device and AUN3 device F Tsense timer handling for MICO mode 6185 1 F Corrections to NAS transport for Non-3GPP access path switching 6193 1 F Correction to the inclusion condition of extended LADN information F Clarification of ANDSP and URSP coding 6052 2 F Clarification on disabling and enabling N1 mode for deregistration abnormal 6202 1 F Handling of congestion control for transport of user data via the control plane timer for emergency services 6071 4 F Inter-system change for SSC mode 2 or SSC mode 3 PDU session 6207 2 F Handling of collision between 5GMM common procedure and deregistration procedure.",
    "F Handling of Restricted service area cause in non-restricting cases 18.7.0 2024-06 CT#104 CP-241180 6137 2 F Handling of UAS services not allowed cause for a UE not supporting UAS services 6251 - F Missing occurrence of the CPSR message for existing abnormal cases 6257 - F Network slice replacement during PDU session establishment procedure F Slice deregistration inactivity timer per access type F Delete protocol description associated with a QoS rule F NR disable timers and unavailability period F Add reference to the satellite coverage availability information F Correction on coding of S-NSSAI location validity information F Slice deregistration timer during MICO 6268 1 D Editorial corrections on unavailability configuration and unavailability information 6174 1 F Maximum number of S-NSSAIs in S-NSSAI location validity information IE F Clarification on the end of unavailability period report 6242 1 D Replacement of MS with UE for the term MS determined PLMN with disaster condition 6140 2 F UE identity handling in case of a USIM removal during a registration procedure F Correction on Extended CAG information list IE F Revise confusing statement in HPLMN S-NSSAI(s) handling 6275 2 F Corrections on supporting steering modes for the MA PDU session 6278 2 F Clarification on the unavailability configuration during initial registration F Disaster timers handling F Slice deregistration inactivity timer at unavailability activation F NSSAI List Clarification B Update to add security parameter to ECS address IE F Disaster return wait range timer F Correction of IEI for Protocol description IE F 5GMM capability IE definition errors 6352 1 F Clarification for coding and usage of UE POLICY PROVISIONING REQUEST message F Update description on requirements to be met for MT SMSoIP 6345 2 F Add list of supported PLMNs with ECSP information to the ECS address information F FSNPN in shared network F Correction to the Note for UEs supporting MUSIM F AMF provision of unavailability information at DC only F Correction on handling of the slice deregistration inactivity timer 2024-12 CT#106 CP-243187 6580 1 F Paging procedure for PDU session associated with partially allowed S-NSSAI History Document history V18.6.0 May 2024 Publication V18.7.0 July 2024 Publication V18.8.0 October 2024 Publication V18.9.0 January 2025 Publication"
  ]
}