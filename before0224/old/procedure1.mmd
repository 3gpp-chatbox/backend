graph TD
    A["UE in state 5GMM-DEREGISTERED"] --> B{ "UE initiates registration?" };
    B -- "Yes" --> C["Send REGISTRATION REQUEST to AMF"];
    B -- "No" --> D["End"];
    C --> E{ "5GS registration type?" };
    E -- "initial registration" --> F["Indicate ""initial registration"" in 5GS registration type IE"];
    E -- "emergency registration" --> G["Indicate ""emergency registration"" in 5GS registration type IE"];
    E -- "SNPN onboarding registration" --> H["Indicate ""SNPN onboarding registration"" in 5GS registration type IE"];
    E -- "disaster roaming initial registration" --> I["Indicate ""disaster roaming initial registration"" in 5GS registration type IE"];
    F --> J["Start timer T3510"];
    G --> K["Start timer T3510"];
    H --> K;
    I --> K;
    J --> K;
    K --> L{ "MUSIM UE and ""emergency registration""?" };
    L -- "Yes" --> M["Network shall not indicate support for N1 NAS signalling connection release, paging indication for voice services, reject paging request, or paging restriction"];
    L -- "No" --> N["Continue"];
    M --> N;
    N --> O{ "Handle 5GS mobile identity IE" };
    O --> P["Include UE status IE and ATTACH REQUEST (if applicable)"];
    P --> Q{ "Include Additional GUTI IE (if applicable)" };
    Q --> R["Start timer T3519 (if applicable)"];
    R --> S["Include stored SUCI (if applicable)"];
    S --> T["Include last visited registered TAI (if applicable)"];
    T --> U{ "SMS over NAS requested?" };
    U -- "Yes" --> V["Include 5GS update type IE with SMS requested bit set to ""SMS over NAS supported"""];
    U -- "No" --> W["Include 5GS update type IE with SMS requested bit set to ""SMS over NAS not supported"""];
    V --> X["Include other IEs as needed"];
    W --> X;
    X --> Y["Send REGISTRATION REQUEST"];
    Y --> Z;
    Z --> D;